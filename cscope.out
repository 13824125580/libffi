cscope 15 $HOME/WorkSpace/ffi/libffi-test -q 0000004762 0001109110
	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/include/ffi_common.h

10 #i‚de‡
FFI_COMMON_H


11 
	#FFI_COMMON_H


	)

13 #ifde‡
__˝lu•lus


17 
	~<ffic⁄fig.h
>

21 #ifde‡
__GNUC__


22 #i‡
HAVE_ALLOCA_H


23 
	~<Æloˇ.h
>

26 #i‚de‡
Æloˇ


27 
	#Æloˇ
 
__buûtö_Æloˇ


	)

30 
	#MAYBE_UNUSED
 
	`__©åibuã__
((
__unu£d__
))

	)

32 
	#MAYBE_UNUSED


	)

33 #i‡
HAVE_ALLOCA_H


34 
	~<Æloˇ.h
>

36 #ifde‡
_AIX


37 #¥agm®
Æloˇ


39 #i‚de‡
Æloˇ


40 #ifde‡
_MSC_VER


41 
	#Æloˇ
 
_Æloˇ


	)

43 *
Æloˇ
 ();

51 #i‡
STDC_HEADERS


52 
	~<°rög.h
>

54 #i‚de‡
HAVE_MEMCPY


55 
	#mem˝y
(
d
, 
s
, 
n
Ë
	`bc›y
 ((s), (d), (n))

	)

59 #i‡
deföed
(
FFI_DEBUG
)

60 
	~<°dio.h
>

63 #ifde‡
FFI_DEBUG


64 
ffi_as£π
(*
ex¥
, *
fûe
, 
löe
);

65 
ffi_°›_hîe
();

66 
ffi_ty≥_ã°
(
ffi_ty≥
 *
a
, *
fûe
, 
löe
);

68 
	#FFI_ASSERT
(
x
Ë((xË? ()0 : 
	`ffi_as£π
(#x, 
__FILE__
,
__LINE__
))

	)

69 
	#FFI_ASSERT_AT
(
x
, 
f
, 
l
Ë((xË? 0 : 
	`ffi_as£π
(#x, (f), (l)))

	)

70 
	#FFI_ASSERT_VALID_TYPE
(
x
Ë
	`ffi_ty≥_ã°
 (x, 
__FILE__
, 
__LINE__
)

	)

72 
	#FFI_ASSERT
(
x
)

	)

73 
	#FFI_ASSERT_AT
(
x
, 
f
, 
l
)

	)

74 
	#FFI_ASSERT_VALID_TYPE
(
x
)

	)

77 
	#ALIGN
(
v
, 
a
Ë(((((
size_t
Ë(v))-1Ë| (◊)-1))+1)

	)

78 
	#ALIGN_DOWN
(
v
, 
a
Ë(((
size_t
Ë(v)Ë& -a)

	)

81 
ffi_°©us
 
ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
);

82 
ffi_°©us
 
ffi_¥ï_cif_machdï_v¨
(
ffi_cif
 *
cif
,

83 
nfixed¨gs
, 
¡ŸÆ¨gs
);

88 
ffi_cif
 *
cif
;

89 *
rvÆue
;

90 **
avÆue
;

91 } 
	texãnded_cif
;

94 #i‡
deföed
(
_MSC_VER
Ë|| deföed(
__sgi
Ë|| deföed(
__SUNPRO_C
)

95 
	tUINT8
;

96 sig√d 
	tSINT8
;

97 
	tUINT16
;

98 sig√d 
	tSINT16
;

99 
	tUINT32
;

100 sig√d 
	tSINT32
;

101 #ifde‡
_MSC_VER


102 
	t__öt64
 
	tUINT64
;

103 sig√d 
	t__öt64
 
	tSINT64
;

105 
	~<öây≥s.h
>

106 
uöt64_t
 
	tUINT64
;

107 
öt64_t
 
	tSINT64
;

110 
	tUINT8
 
	t__©åibuã__
((
	t__mode__
(
	t__QI__
)));

111 sig√d 
	tSINT8
 
	t__©åibuã__
((
	t__mode__
(
	t__QI__
)));

112 
	tUINT16
 
	t__©åibuã__
((
	t__mode__
(
	t__HI__
)));

113 sig√d 
	tSINT16
 
	t__©åibuã__
((
	t__mode__
(
	t__HI__
)));

114 
	tUINT32
 
	t__©åibuã__
((
	t__mode__
(
	t__SI__
)));

115 sig√d 
	tSINT32
 
	t__©åibuã__
((
	t__mode__
(
	t__SI__
)));

116 
	tUINT64
 
	t__©åibuã__
((
	t__mode__
(
	t__DI__
)));

117 sig√d 
	tSINT64
 
	t__©åibuã__
((
	t__mode__
(
	t__DI__
)));

120 
	tFLOAT32
;

122 #i‚de‡
__GNUC__


123 
	#__buûtö_ex≥˘
(
x
, 
ex≥˘ed_vÆue
Ë(x)

	)

125 
	#LIKELY
(
x
Ë
	`__buûtö_ex≥˘
(!!(x),1)

	)

126 
	#UNLIKELY
(
x
Ë
	`__buûtö_ex≥˘
((x)!=0,0)

	)

128 #ifde‡
__˝lu•lus


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/aarch64/ffi.c

22 
	~<°dio.h
>

24 
	~<ffi.h
>

25 
	~<ffi_comm⁄.h
>

27 
	~<°dlib.h
>

30 #i‡
deföed
 (
__APPLE__
)

31 
	#AARCH64_STACK_ALIGN
 1

	)

33 
	#AARCH64_STACK_ALIGN
 16

	)

36 
	#N_X_ARG_REG
 8

	)

37 
	#N_V_ARG_REG
 8

	)

39 
	#AARCH64_FFI_WITH_V
 (1 << 
AARCH64_FFI_WITH_V_BIT
)

	)

41 
	u_d


43 
UINT64
 
	md
;

44 
UINT32
 
	ms
[2];

47 
	sˇŒ_c⁄ãxt


49 
UINT64
 
	mx
 [
AARCH64_N_XREG
];

52 
_d
 
	md
[2];

53 } 
	mv
 [
AARCH64_N_VREG
];

56 #i‡
deföed
 (
__˛™g__
Ë&& deföed (
__APPLE__
)

58 
sys_iˇche_övÆid©e
 (*
°¨t
, 
size_t
 
Àn
);

61 
ölöe
 

62 
	$ffi_˛ór_ˇche
 (*
°¨t
, *
íd
)

64 #i‡
	`deföed
 (
__˛™g__
Ë&& deföed (
__APPLE__
)

65 
	`sys_iˇche_övÆid©e
 (
°¨t
, (*)
íd
 - (*)start);

66 #ñi‡
	`deföed
 (
__GNUC__
)

67 
	`__buûtö___˛ór_ˇche
 (
°¨t
, 
íd
);

71 
	}
}

74 
	$gë_x_addr
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, 
n
)

76  &
c⁄ãxt
->
x
[
n
];

77 
	}
}

80 
	$gë_s_addr
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, 
n
)

82 #i‡
deföed
 
__AARCH64EB__


83  &
c⁄ãxt
->
v
[
n
].
d
[1].
s
[1];

85  &
c⁄ãxt
->
v
[
n
].
d
[0].
s
[0];

87 
	}
}

90 
	$gë_d_addr
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, 
n
)

92 #i‡
deföed
 
__AARCH64EB__


93  &
c⁄ãxt
->
v
[
n
].
d
[1];

95  &
c⁄ãxt
->
v
[
n
].
d
[0];

97 
	}
}

100 
	$gë_v_addr
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, 
n
)

102  &
c⁄ãxt
->
v
[
n
];

103 
	}
}

109 
	$gë_basic_ty≥_addr
 (
ty≥
, 
ˇŒ_c⁄ãxt
 *
c⁄ãxt
,

110 
n
)

112 
ty≥
)

114 
FFI_TYPE_FLOAT
:

115  
	`gë_s_addr
 (
c⁄ãxt
, 
n
);

116 
FFI_TYPE_DOUBLE
:

117  
	`gë_d_addr
 (
c⁄ãxt
, 
n
);

118 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


119 
FFI_TYPE_LONGDOUBLE
:

120  
	`gë_v_addr
 (
c⁄ãxt
, 
n
);

122 
FFI_TYPE_UINT8
:

123 
FFI_TYPE_SINT8
:

124 
FFI_TYPE_UINT16
:

125 
FFI_TYPE_SINT16
:

126 
FFI_TYPE_UINT32
:

127 
FFI_TYPE_SINT32
:

128 
FFI_TYPE_INT
:

129 
FFI_TYPE_POINTER
:

130 
FFI_TYPE_UINT64
:

131 
FFI_TYPE_SINT64
:

132  
	`gë_x_addr
 (
c⁄ãxt
, 
n
);

133 
FFI_TYPE_VOID
:

134  
NULL
;

136 
	`FFI_ASSERT
 (0);

137  
NULL
;

139 
	}
}

143 
size_t


144 
	$gë_basic_ty≥_Æignmít
 (
ty≥
)

146 
ty≥
)

148 
FFI_TYPE_FLOAT
:

149 #i‡
	`deföed
 (
__APPLE__
)

150   (
UINT32
);

152 
FFI_TYPE_DOUBLE
:

153   (
UINT64
);

154 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


155 
FFI_TYPE_LONGDOUBLE
:

158 
FFI_TYPE_UINT8
:

159 
FFI_TYPE_SINT8
:

160 #i‡
	`deföed
 (
__APPLE__
)

161   (
UINT8
);

163 
FFI_TYPE_UINT16
:

164 
FFI_TYPE_SINT16
:

165 #i‡
	`deföed
 (
__APPLE__
)

166   (
UINT16
);

168 
FFI_TYPE_UINT32
:

169 
FFI_TYPE_INT
:

170 
FFI_TYPE_SINT32
:

171 #i‡
	`deföed
 (
__APPLE__
)

172   (
UINT32
);

174 
FFI_TYPE_POINTER
:

175 
FFI_TYPE_UINT64
:

176 
FFI_TYPE_SINT64
:

177   (
UINT64
);

180 
	`FFI_ASSERT
 (0);

183 
	}
}

187 
size_t


188 
	$gë_basic_ty≥_size
 (
ty≥
)

190 
ty≥
)

192 
FFI_TYPE_FLOAT
:

193   (
UINT32
);

194 
FFI_TYPE_DOUBLE
:

195   (
UINT64
);

196 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


197 
FFI_TYPE_LONGDOUBLE
:

200 
FFI_TYPE_UINT8
:

201   (
UINT8
);

202 
FFI_TYPE_SINT8
:

203   (
SINT8
);

204 
FFI_TYPE_UINT16
:

205   (
UINT16
);

206 
FFI_TYPE_SINT16
:

207   (
SINT16
);

208 
FFI_TYPE_UINT32
:

209   (
UINT32
);

210 
FFI_TYPE_INT
:

211 
FFI_TYPE_SINT32
:

212   (
SINT32
);

213 
FFI_TYPE_POINTER
:

214 
FFI_TYPE_UINT64
:

215   (
UINT64
);

216 
FFI_TYPE_SINT64
:

217   (
SINT64
);

220 
	`FFI_ASSERT
 (0);

223 
	}
}

226 
ffi_ˇŒ_SYSV
 ((*)(
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, *,

227 
exãnded_cif
 *),

228 
ˇŒ_c⁄ãxt
 *
c⁄ãxt
,

229 
exãnded_cif
 *,

230 
size_t
,

231 (*
‚
)());

234 
	`ffi_˛osuª_SYSV
 (
ffi_˛osuª
 *);

239 
	$is_Êﬂtög_ty≥
 (
ty≥
)

241  (
ty≥
 =
FFI_TYPE_FLOAT
 ||Åy≥ =
FFI_TYPE_DOUBLE


242 || 
ty≥
 =
FFI_TYPE_LONGDOUBLE
);

243 
	}
}

248 
	$gë_homogíeous_ty≥
 (
ffi_ty≥
 *
ty
)

250 i‡(
ty
->
ty≥
 =
FFI_TYPE_STRUCT
 &&Åy->
ñemíts
)

252 
i
;

253 
ˇndid©e_ty≥


254 
	`gë_homogíeous_ty≥
 (
ty
->
ñemíts
[0]);

255 
i
 =1; 
ty
->
ñemíts
[i]; i++)

257 
ôî©i⁄_ty≥
 = 0;

261 i‡(
ty
->
ñemíts
[
i
]->
ty≥
 =
FFI_TYPE_STRUCT


262 && 
ty
->
ñemíts
[
i
]->elements)

264 
ôî©i⁄_ty≥
 = 
	`gë_homogíeous_ty≥
 (
ty
->
ñemíts
[
i
]);

268 
ôî©i⁄_ty≥
 = 
ty
->
ñemíts
[
i
]->
ty≥
;

272 i‡(
ˇndid©e_ty≥
 !
ôî©i⁄_ty≥
)

273  
FFI_TYPE_STRUCT
;

275  
ˇndid©e_ty≥
;

280  
ty
->
ty≥
;

281 
	}
}

290 
	$ñemít_cou¡
 (
ffi_ty≥
 *
ty
)

292 i‡(
ty
->
ty≥
 =
FFI_TYPE_STRUCT
 &&Åy->
ñemíts
)

294 
n
;

295 
ñems
 = 0;

296 
n
 = 0; 
ty
->
ñemíts
[n];Ç++)

298 i‡(
ty
->
ñemíts
[
n
]->
ty≥
 =
FFI_TYPE_STRUCT


299 && 
ty
->
ñemíts
[
n
]->elements)

300 
ñems
 +
	`ñemít_cou¡
 (
ty
->
ñemíts
[
n
]);

302 
ñems
++;

304  
ñems
;

307 
	}
}

317 
	$is_hÁ
 (
ffi_ty≥
 *
ty
)

319 i‡(
ty
->
ty≥
 =
FFI_TYPE_STRUCT


320 && 
ty
->
ñemíts
[0]

321 && 
	`is_Êﬂtög_ty≥
 (
	`gë_homogíeous_ty≥
 (
ty
)))

323 
n
 = 
	`ñemít_cou¡
 (
ty
);

324  
n
 >= 1 &&Ç <= 4;

327 
	}
}

342 
	$is_ªgi°î_ˇndid©e
 (
ffi_ty≥
 *
ty
)

344 
ty
->
ty≥
)

346 
FFI_TYPE_VOID
:

347 
FFI_TYPE_FLOAT
:

348 
FFI_TYPE_DOUBLE
:

349 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


350 
FFI_TYPE_LONGDOUBLE
:

352 
FFI_TYPE_UINT8
:

353 
FFI_TYPE_UINT16
:

354 
FFI_TYPE_UINT32
:

355 
FFI_TYPE_UINT64
:

356 
FFI_TYPE_POINTER
:

357 
FFI_TYPE_SINT8
:

358 
FFI_TYPE_SINT16
:

359 
FFI_TYPE_SINT32
:

360 
FFI_TYPE_INT
:

361 
FFI_TYPE_SINT64
:

364 
FFI_TYPE_STRUCT
:

365 i‡(
	`is_hÁ
 (
ty
))

369 i‡(
ty
->
size
 > 16)

381  (
ty
->
size
 + 7Ë/ 8 < 
N_X_ARG_REG
;

386 
	`FFI_ASSERT
 (0);

391 
	}
}

397 
	$is_v_ªgi°î_ˇndid©e
 (
ffi_ty≥
 *
ty
)

399  
	`is_Êﬂtög_ty≥
 (
ty
->
ty≥
)

400 || (
ty
->
ty≥
 =
FFI_TYPE_STRUCT
 && 
	`is_hÁ
 (ty));

401 
	}
}

409 
	s¨g_°©e


411 
	mng∫
;

412 
	mn§n
;

413 
size_t
 
	mnßa
;

415 #i‡
deföed
 (
__APPLE__
)

416 
	mÆloˇtög_v¨üdic
;

422 
	$¨g_öô
 (
¨g_°©e
 *
°©e
, 
size_t
 
ˇŒ_‰ame_size
)

424 
°©e
->
ng∫
 = 0;

425 
°©e
->
n§n
 = 0;

426 
°©e
->
nßa
 = 0;

428 #i‡
	`deföed
 (
__APPLE__
)

429 
°©e
->
Æloˇtög_v¨üdic
 = 0;

431 
	}
}

437 
	$avaûabÀ_x
 (
¨g_°©e
 *
°©e
)

439  
N_X_ARG_REG
 - 
°©e
->
ng∫
;

440 
	}
}

446 
	$avaûabÀ_v
 (
¨g_°©e
 *
°©e
)

448  
N_V_ARG_REG
 - 
°©e
->
n§n
;

449 
	}
}

452 
	$Æloˇã_to_x
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, 
¨g_°©e
 *
°©e
)

454 
	`FFI_ASSERT
 (
°©e
->
ng∫
 < 
N_X_ARG_REG
);

455  
	`gë_x_addr
 (
c⁄ãxt
, (
°©e
->
ng∫
)++);

456 
	}
}

459 
	$Æloˇã_to_s
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, 
¨g_°©e
 *
°©e
)

461 
	`FFI_ASSERT
 (
°©e
->
n§n
 < 
N_V_ARG_REG
);

462  
	`gë_s_addr
 (
c⁄ãxt
, (
°©e
->
n§n
)++);

463 
	}
}

466 
	$Æloˇã_to_d
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, 
¨g_°©e
 *
°©e
)

468 
	`FFI_ASSERT
 (
°©e
->
n§n
 < 
N_V_ARG_REG
);

469  
	`gë_d_addr
 (
c⁄ãxt
, (
°©e
->
n§n
)++);

470 
	}
}

473 
	$Æloˇã_to_v
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, 
¨g_°©e
 *
°©e
)

475 
	`FFI_ASSERT
 (
°©e
->
n§n
 < 
N_V_ARG_REG
);

476  
	`gë_v_addr
 (
c⁄ãxt
, (
°©e
->
n§n
)++);

477 
	}
}

481 
	$Æloˇã_to_°ack
 (
¨g_°©e
 *
°©e
, *
°ack
, 
size_t
 
Æignmít
,

482 
size_t
 
size
)

484 *
Æloˇti⁄
;

488 
°©e
->
nßa
 = 
	`ALIGN
 (°©e->nßa, 
Æignmít
);

489 
°©e
->
nßa
 = 
	`ALIGN
 (°©e->nßa, 
Æignmít
);

490 #i‡
	`deföed
 (
__APPLE__
)

491 i‡(
°©e
->
Æloˇtög_v¨üdic
)

492 
°©e
->
nßa
 = 
	`ALIGN
 (state->nsaa, 8);

494 
°©e
->
nßa
 = 
	`ALIGN
 (state->nsaa, 8);

497 
Æloˇti⁄
 = 
°ack
 + 
°©e
->
nßa
;

499 
°©e
->
nßa
 +
size
;

500  
Æloˇti⁄
;

501 
	}
}

504 
	$c›y_basic_ty≥
 (*
de°
, *
sour˚
, 
ty≥
)

508 
ty≥
)

510 
FFI_TYPE_FLOAT
:

511 *(*Ë
de°
 = *(*Ë
sour˚
;

513 
FFI_TYPE_DOUBLE
:

514 *(*Ë
de°
 = *(*Ë
sour˚
;

516 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


517 
FFI_TYPE_LONGDOUBLE
:

518 *(*Ë
de°
 = *(*Ë
sour˚
;

521 
FFI_TYPE_UINT8
:

522 *(
ffi_¨g
 *Ë
de°
 = *(
UINT8
 *Ë
sour˚
;

524 
FFI_TYPE_SINT8
:

525 *(
ffi_ßrg
 *Ë
de°
 = *(
SINT8
 *Ë
sour˚
;

527 
FFI_TYPE_UINT16
:

528 *(
ffi_¨g
 *Ë
de°
 = *(
UINT16
 *Ë
sour˚
;

530 
FFI_TYPE_SINT16
:

531 *(
ffi_ßrg
 *Ë
de°
 = *(
SINT16
 *Ë
sour˚
;

533 
FFI_TYPE_UINT32
:

534 *(
ffi_¨g
 *Ë
de°
 = *(
UINT32
 *Ë
sour˚
;

536 
FFI_TYPE_INT
:

537 
FFI_TYPE_SINT32
:

538 *(
ffi_ßrg
 *Ë
de°
 = *(
SINT32
 *Ë
sour˚
;

540 
FFI_TYPE_POINTER
:

541 
FFI_TYPE_UINT64
:

542 *(
ffi_¨g
 *Ë
de°
 = *(
UINT64
 *Ë
sour˚
;

544 
FFI_TYPE_SINT64
:

545 *(
ffi_ßrg
 *Ë
de°
 = *(
SINT64
 *Ë
sour˚
;

547 
FFI_TYPE_VOID
:

551 
	`FFI_ASSERT
 (0);

553 
	}
}

556 
	$c›y_hÁ_to_ªg_‹_°ack
 (*
mem‹y
,

557 
ffi_ty≥
 *
ty
,

558 
ˇŒ_c⁄ãxt
 *
c⁄ãxt
,

559 *
°ack
,

560 
¨g_°©e
 *
°©e
)

562 
ñems
 = 
	`ñemít_cou¡
 (
ty
);

563 i‡(
	`avaûabÀ_v
 (
°©e
Ë< 
ñems
)

568 
°©e
->
n§n
 = 
N_V_ARG_REG
;

569 
	`mem˝y
 (
	`Æloˇã_to_°ack
 (
°©e
, 
°ack
, 
ty
->
Æignmít
,Åy->
size
),

570 
mem‹y
,

571 
ty
->
size
);

575 
i
;

576 
ty≥
 = 
	`gë_homogíeous_ty≥
 (
ty
);

577 
i
 = 0; i < 
ñems
; i++)

579 *
ªg
 = 
	`Æloˇã_to_v
 (
c⁄ãxt
, 
°©e
);

580 
	`c›y_basic_ty≥
 (
ªg
, 
mem‹y
, 
ty≥
);

581 
mem‹y
 +
	`gë_basic_ty≥_size
 (
ty≥
);

584 
	}
}

591 
	$Æloˇã_to_ªgi°î_‹_°ack
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
,

592 *
°ack
,

593 
¨g_°©e
 *
°©e
,

594 
ty≥
)

596 
size_t
 
Æignmít
 = 
	`gë_basic_ty≥_Æignmít
 (
ty≥
);

597 
size_t
 
size
 = 
Æignmít
;

598 
ty≥
)

600 
FFI_TYPE_FLOAT
:

603 
size
 =  (
UINT32
);

605 
FFI_TYPE_DOUBLE
:

606 i‡(
°©e
->
n§n
 < 
N_V_ARG_REG
)

607  
	`Æloˇã_to_d
 (
c⁄ãxt
, 
°©e
);

608 
°©e
->
n§n
 = 
N_V_ARG_REG
;

610 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


611 
FFI_TYPE_LONGDOUBLE
:

612 i‡(
°©e
->
n§n
 < 
N_V_ARG_REG
)

613  
	`Æloˇã_to_v
 (
c⁄ãxt
, 
°©e
);

614 
°©e
->
n§n
 = 
N_V_ARG_REG
;

617 
FFI_TYPE_UINT8
:

618 
FFI_TYPE_SINT8
:

619 
FFI_TYPE_UINT16
:

620 
FFI_TYPE_SINT16
:

621 
FFI_TYPE_UINT32
:

622 
FFI_TYPE_SINT32
:

623 
FFI_TYPE_INT
:

624 
FFI_TYPE_POINTER
:

625 
FFI_TYPE_UINT64
:

626 
FFI_TYPE_SINT64
:

627 i‡(
°©e
->
ng∫
 < 
N_X_ARG_REG
)

628  
	`Æloˇã_to_x
 (
c⁄ãxt
, 
°©e
);

629 
°©e
->
ng∫
 = 
N_X_ARG_REG
;

632 
	`FFI_ASSERT
 (0);

635  
	`Æloˇã_to_°ack
 (
°©e
, 
°ack
, 
Æignmít
, 
size
);

636 
	}
}

642 
	$c›y_to_ªgi°î_‹_°ack
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
,

643 *
°ack
,

644 
¨g_°©e
 *
°©e
,

645 *
vÆue
,

646 
ty≥
)

648 
	`c›y_basic_ty≥
 (

649 
	`Æloˇã_to_ªgi°î_‹_°ack
 (
c⁄ãxt
, 
°ack
, 
°©e
, 
ty≥
),

650 
vÆue
,

651 
ty≥
);

652 
	}
}

658 
	$Ørch64_¥ï_¨gs
 (
ˇŒ_c⁄ãxt
 *
c⁄ãxt
, *
°ack
,

659 
exãnded_cif
 *
ecif
)

661 
i
;

662 
¨g_°©e
 
°©e
;

664 
	`¨g_öô
 (&
°©e
, 
	`ALIGN
(
ecif
->
cif
->
byãs
, 16));

666 
i
 = 0; i < 
ecif
->
cif
->
«rgs
; i++)

668 
ffi_ty≥
 *
ty
 = 
ecif
->
cif
->
¨g_ty≥s
[
i
];

669 
ty
->
ty≥
)

671 
FFI_TYPE_VOID
:

672 
	`FFI_ASSERT
 (0);

677 
FFI_TYPE_FLOAT
:

678 
FFI_TYPE_DOUBLE
:

679 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


680 
FFI_TYPE_LONGDOUBLE
:

682 
FFI_TYPE_UINT8
:

683 
FFI_TYPE_SINT8
:

684 
FFI_TYPE_UINT16
:

685 
FFI_TYPE_SINT16
:

686 
FFI_TYPE_UINT32
:

687 
FFI_TYPE_INT
:

688 
FFI_TYPE_SINT32
:

689 
FFI_TYPE_POINTER
:

690 
FFI_TYPE_UINT64
:

691 
FFI_TYPE_SINT64
:

692 
	`c›y_to_ªgi°î_‹_°ack
 (
c⁄ãxt
, 
°ack
, &
°©e
,

693 
ecif
->
avÆue
[
i
], 
ty
->
ty≥
);

696 
FFI_TYPE_STRUCT
:

697 i‡(
	`is_hÁ
 (
ty
))

699 
	`c›y_hÁ_to_ªg_‹_°ack
 (
ecif
->
avÆue
[
i
], 
ty
, 
c⁄ãxt
,

700 
°ack
, &
°©e
);

702 i‡(
ty
->
size
 > 16)

708 
	`c›y_to_ªgi°î_‹_°ack
 (
c⁄ãxt
, 
°ack
, &
°©e
,

709 &(
ecif
->
avÆue
[
i
]), 
FFI_TYPE_POINTER
);

711 i‡(
	`avaûabÀ_x
 (&
°©e
Ë>(
ty
->
size
 + 7) / 8)

717 
j
;

718 
j
 = 0; j < (
ty
->
size
 + 7) / 8; j++)

720 
	`mem˝y
 (
	`Æloˇã_to_x
 (
c⁄ãxt
, &
°©e
),

721 &(((
UINT64
 *Ë
ecif
->
avÆue
[
i
])[
j
]),

722  (
UINT64
));

731 
°©e
.
ng∫
 = 
N_X_ARG_REG
;

733 
	`mem˝y
 (
	`Æloˇã_to_°ack
 (&
°©e
, 
°ack
, 
ty
->
Æignmít
,

734 
ty
->
size
), 
ecif
->
avÆue
 + 
i
,Åy->size);

739 
	`FFI_ASSERT
 (0);

743 #i‡
	`deföed
 (
__APPLE__
)

744 i‡(
i
 + 1 =
ecif
->
cif
->
Ørch64_nfixed¨gs
)

746 
°©e
.
ng∫
 = 
N_X_ARG_REG
;

747 
°©e
.
n§n
 = 
N_V_ARG_REG
;

749 
°©e
.
Æloˇtög_v¨üdic
 = 1;

754  
ecif
->
cif
->
Ørch64_Êags
;

755 
	}
}

757 
ffi_°©us


758 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

761 
cif
->
byãs
 =

762 (
cif
->
byãs
 + (
AARCH64_STACK_ALIGN
 - 1)) & ~ (AARCH64_STACK_ALIGN - 1);

768 
cif
->
Ørch64_Êags
 = 0;

770 i‡(
	`is_v_ªgi°î_ˇndid©e
 (
cif
->
πy≥
))

772 
cif
->
Ørch64_Êags
 |
AARCH64_FFI_WITH_V
;

776 
i
;

777 
i
 = 0; i < 
cif
->
«rgs
; i++)

778 i‡(
	`is_v_ªgi°î_ˇndid©e
 (
cif
->
¨g_ty≥s
[
i
]))

780 
cif
->
Ørch64_Êags
 |
AARCH64_FFI_WITH_V
;

785 #i‡
	`deföed
 (
__APPLE__
)

786 
cif
->
Ørch64_nfixed¨gs
 = 0;

789  
FFI_OK
;

790 
	}
}

792 #i‡
deföed
 (
__APPLE__
)

795 
ffi_°©us
 
	$ffi_¥ï_cif_machdï_v¨
(
ffi_cif
 *
cif
,

796 
nfixed¨gs
,

797 
¡ŸÆ¨gs
)

799 
ffi_°©us
 
°©us
;

801 
°©us
 = 
	`ffi_¥ï_cif_machdï
 (
cif
);

803 
cif
->
Ørch64_nfixed¨gs
 = 
nfixed¨gs
;

805  
°©us
;

806 
	}
}

813 
ffi_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

815 
exãnded_cif
 
ecif
;

817 
ecif
.
cif
 = cif;

818 
ecif
.
avÆue
 =ávalue;

819 
ecif
.
rvÆue
 =Ñvalue;

821 
cif
->
abi
)

823 
FFI_SYSV
:

825 
ˇŒ_c⁄ãxt
 
c⁄ãxt
;

826 
size_t
 
°ack_byãs
;

832 
°ack_byãs
 = 
	`ALIGN
(
cif
->
byãs
, 16);

834 
	`mem£t
 (&
c⁄ãxt
, 0,  (context));

835 i‡(
	`is_ªgi°î_ˇndid©e
 (
cif
->
πy≥
))

837 
	`ffi_ˇŒ_SYSV
 (
Ørch64_¥ï_¨gs
, &
c⁄ãxt
, &
ecif
, 
°ack_byãs
, 
‚
);

838 
cif
->
πy≥
->
ty≥
)

840 
FFI_TYPE_VOID
:

841 
FFI_TYPE_FLOAT
:

842 
FFI_TYPE_DOUBLE
:

843 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


844 
FFI_TYPE_LONGDOUBLE
:

846 
FFI_TYPE_UINT8
:

847 
FFI_TYPE_SINT8
:

848 
FFI_TYPE_UINT16
:

849 
FFI_TYPE_SINT16
:

850 
FFI_TYPE_UINT32
:

851 
FFI_TYPE_SINT32
:

852 
FFI_TYPE_POINTER
:

853 
FFI_TYPE_UINT64
:

854 
FFI_TYPE_INT
:

855 
FFI_TYPE_SINT64
:

857 *
addr
 = 
	`gë_basic_ty≥_addr
 (
cif
->
πy≥
->
ty≥
,

858 &
c⁄ãxt
, 0);

859 
	`c›y_basic_ty≥
 (
rvÆue
, 
addr
, 
cif
->
πy≥
->
ty≥
);

863 
FFI_TYPE_STRUCT
:

864 i‡(
	`is_hÁ
 (
cif
->
πy≥
))

866 
j
;

867 
ty≥
 = 
	`gë_homogíeous_ty≥
 (
cif
->
πy≥
);

868 
ñems
 = 
	`ñemít_cou¡
 (
cif
->
πy≥
);

869 
j
 = 0; j < 
ñems
; j++)

871 *
ªg
 = 
	`gë_basic_ty≥_addr
 (
ty≥
, &
c⁄ãxt
, 
j
);

872 
	`c›y_basic_ty≥
 (
rvÆue
, 
ªg
, 
ty≥
);

873 
rvÆue
 +
	`gë_basic_ty≥_size
 (
ty≥
);

876 i‡((
cif
->
πy≥
->
size
 + 7Ë/ 8 < 
N_X_ARG_REG
)

878 
size_t
 
size
 = 
	`ALIGN
 (
cif
->
πy≥
->size,  (
UINT64
));

879 
	`mem˝y
 (
rvÆue
, 
	`gë_x_addr
 (&
c⁄ãxt
, 0), 
size
);

883 
	`FFI_ASSERT
 (0);

888 
	`FFI_ASSERT
 (0);

894 
	`mem˝y
 (
	`gë_x_addr
 (&
c⁄ãxt
, 8), &
rvÆue
,  (
UINT64
));

895 
	`ffi_ˇŒ_SYSV
 (
Ørch64_¥ï_¨gs
, &
c⁄ãxt
, &
ecif
,

896 
°ack_byãs
, 
‚
);

902 
	`FFI_ASSERT
 (0);

905 
	}
}

907 
	gåampﬁöe
 [] =

915 
	#FFI_INIT_TRAMPOLINE
(
TRAMP
,
FUN
,
CTX
,
FLAGS
) \

916 ({*
__åamp
 = (*)(
TRAMP
); \

917 
UINT64
 
__fun
 = (UINT64)(
FUN
); \

918 
UINT64
 
__˘x
 = (UINT64)(
CTX
); \

919 
UINT64
 
__Êags
 = (UINT64)(
FLAGS
); \

920 
	`mem˝y
 (
__åamp
, 
åampﬁöe
,  (trampoline)); \

921 
	`mem˝y
 (
__åamp
 + 12, &
__fun
,  (__fun)); \

922 
	`mem˝y
 (
__åamp
 + 20, &
__˘x
,  (__ctx)); \

923 
	`mem˝y
 (
__åamp
 + 28, &
__Êags
,  (__flags)); \

924 
	`ffi_˛ór_ˇche
(
__åamp
, __åam∞+ 
FFI_TRAMPOLINE_SIZE
); \

925 })

	)

927 
ffi_°©us


928 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

929 
ffi_cif
* 
cif
,

930 (*
fun
)(
ffi_cif
*,*,**,*),

931 *
u£r_d©a
,

932 *
codñoc
)

934 i‡(
cif
->
abi
 !
FFI_SYSV
)

935  
FFI_BAD_ABI
;

937 
	`FFI_INIT_TRAMPOLINE
 (&
˛osuª
->
åamp
[0], &
ffi_˛osuª_SYSV
, 
codñoc
,

938 
cif
->
Ørch64_Êags
);

940 
˛osuª
->
cif
 = cif;

941 
˛osuª
->
u£r_d©a
 = user_data;

942 
˛osuª
->
fun
 = fun;

944  
FFI_OK
;

945 
	}
}

963 
FFI_HIDDEN


964 
	$ffi_˛osuª_SYSV_ö√r
 (
ffi_˛osuª
 *
˛osuª
, 
ˇŒ_c⁄ãxt
 *
c⁄ãxt
,

965 *
°ack
)

967 
ffi_cif
 *
cif
 = 
˛osuª
->cif;

968 **
avÆue
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

969 *
rvÆue
 = 
NULL
;

970 
i
;

971 
¨g_°©e
 
°©e
;

973 
	`¨g_öô
 (&
°©e
, 
	`ALIGN
(
cif
->
byãs
, 16));

975 
i
 = 0; i < 
cif
->
«rgs
; i++)

977 
ffi_ty≥
 *
ty
 = 
cif
->
¨g_ty≥s
[
i
];

979 
ty
->
ty≥
)

981 
FFI_TYPE_VOID
:

982 
	`FFI_ASSERT
 (0);

985 
FFI_TYPE_UINT8
:

986 
FFI_TYPE_SINT8
:

987 
FFI_TYPE_UINT16
:

988 
FFI_TYPE_SINT16
:

989 
FFI_TYPE_UINT32
:

990 
FFI_TYPE_SINT32
:

991 
FFI_TYPE_INT
:

992 
FFI_TYPE_POINTER
:

993 
FFI_TYPE_UINT64
:

994 
FFI_TYPE_SINT64
:

995 
FFI_TYPE_FLOAT
:

996 
FFI_TYPE_DOUBLE
:

997 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


998 
FFI_TYPE_LONGDOUBLE
:

999 
avÆue
[
i
] = 
	`Æloˇã_to_ªgi°î_‹_°ack
 (
c⁄ãxt
, 
°ack
,

1000 &
°©e
, 
ty
->
ty≥
);

1004 
FFI_TYPE_STRUCT
:

1005 i‡(
	`is_hÁ
 (
ty
))

1007 
n
 = 
	`ñemít_cou¡
 (
ty
);

1008 i‡(
	`avaûabÀ_v
 (&
°©e
Ë< 
n
)

1010 
°©e
.
n§n
 = 
N_V_ARG_REG
;

1011 
avÆue
[
i
] = 
	`Æloˇã_to_°ack
 (&
°©e
, 
°ack
, 
ty
->
Æignmít
,

1012 
ty
->
size
);

1016 
	`gë_homogíeous_ty≥
 (
ty
))

1018 
FFI_TYPE_FLOAT
:

1030 
j
;

1031 
UINT32
 *
p
 = 
avÆue
[
i
] = 
	`Æloˇ
 (
ty
->
size
);

1032 
j
 = 0; j < 
	`ñemít_cou¡
 (
ty
); j++)

1033 
	`mem˝y
 (&
p
[
j
],

1034 
	`Æloˇã_to_s
 (
c⁄ãxt
, &
°©e
),

1035  (*
p
));

1039 
FFI_TYPE_DOUBLE
:

1051 
j
;

1052 
UINT64
 *
p
 = 
avÆue
[
i
] = 
	`Æloˇ
 (
ty
->
size
);

1053 
j
 = 0; j < 
	`ñemít_cou¡
 (
ty
); j++)

1054 
	`mem˝y
 (&
p
[
j
],

1055 
	`Æloˇã_to_d
 (
c⁄ãxt
, &
°©e
),

1056  (*
p
));

1060 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


1061 
FFI_TYPE_LONGDOUBLE
:

1062 
	`mem˝y
 (&
avÆue
[
i
],

1063 
	`Æloˇã_to_v
 (
c⁄ãxt
, &
°©e
),

1064  (*
avÆue
));

1069 
	`FFI_ASSERT
 (0);

1074 i‡(
ty
->
size
 > 16)

1078 
	`mem˝y
 (&
avÆue
[
i
],

1079 
	`Æloˇã_to_ªgi°î_‹_°ack
 (
c⁄ãxt
, 
°ack
,

1080 &
°©e
, 
FFI_TYPE_POINTER
),

1081  (
avÆue
[
i
]));

1083 i‡(
	`avaûabÀ_x
 (&
°©e
Ë>(
ty
->
size
 + 7) / 8)

1085 
avÆue
[
i
] = 
	`gë_x_addr
 (
c⁄ãxt
, 
°©e
.
ng∫
);

1086 
°©e
.
ng∫
 +(
ty
->
size
 + 7) / 8;

1090 
°©e
.
ng∫
 = 
N_X_ARG_REG
;

1092 
avÆue
[
i
] = 
	`Æloˇã_to_°ack
 (&
°©e
, 
°ack
, 
ty
->
Æignmít
,

1093 
ty
->
size
);

1098 
	`FFI_ASSERT
 (0);

1107 i‡(
	`is_ªgi°î_ˇndid©e
 (
cif
->
πy≥
))

1115 
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

1116 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

1120 
cif
->
πy≥
->
ty≥
)

1122 
FFI_TYPE_VOID
:

1125 
FFI_TYPE_UINT8
:

1126 
FFI_TYPE_UINT16
:

1127 
FFI_TYPE_UINT32
:

1128 
FFI_TYPE_POINTER
:

1129 
FFI_TYPE_UINT64
:

1130 
FFI_TYPE_SINT8
:

1131 
FFI_TYPE_SINT16
:

1132 
FFI_TYPE_INT
:

1133 
FFI_TYPE_SINT32
:

1134 
FFI_TYPE_SINT64
:

1135 
FFI_TYPE_FLOAT
:

1136 
FFI_TYPE_DOUBLE
:

1137 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


1138 
FFI_TYPE_LONGDOUBLE
:

1141 *
addr
 = 
	`gë_basic_ty≥_addr
 (
cif
->
πy≥
->
ty≥
, 
c⁄ãxt
, 0);

1142 
	`c›y_basic_ty≥
 (
addr
, 
rvÆue
, 
cif
->
πy≥
->
ty≥
);

1145 
FFI_TYPE_STRUCT
:

1146 i‡(
	`is_hÁ
 (
cif
->
πy≥
))

1148 
j
;

1149 
ty≥
 = 
	`gë_homogíeous_ty≥
 (
cif
->
πy≥
);

1150 
ñems
 = 
	`ñemít_cou¡
 (
cif
->
πy≥
);

1151 
j
 = 0; j < 
ñems
; j++)

1153 *
ªg
 = 
	`gë_basic_ty≥_addr
 (
ty≥
, 
c⁄ãxt
, 
j
);

1154 
	`c›y_basic_ty≥
 (
ªg
, 
rvÆue
, 
ty≥
);

1155 
rvÆue
 +
	`gë_basic_ty≥_size
 (
ty≥
);

1158 i‡((
cif
->
πy≥
->
size
 + 7Ë/ 8 < 
N_X_ARG_REG
)

1160 
size_t
 
size
 = 
	`ALIGN
 (
cif
->
πy≥
->size,  (
UINT64
)) ;

1161 
	`mem˝y
 (
	`gë_x_addr
 (
c⁄ãxt
, 0), 
rvÆue
, 
size
);

1165 
	`FFI_ASSERT
 (0);

1169 
	`FFI_ASSERT
 (0);

1175 
	`mem˝y
 (&
rvÆue
, 
	`gë_x_addr
 (
c⁄ãxt
, 8),  (
UINT64
));

1176 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

1178 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/aarch64/ffitarget.h

22 #i‚de‡
LIBFFI_TARGET_H


23 
	#LIBFFI_TARGET_H


	)

25 #i‚de‡
LIBFFI_H


29 #i‚de‡
LIBFFI_ASM


30 
	tffi_¨g
;

31 sig√d 
	tffi_ßrg
;

33 
	effi_abi


35 
	mFFI_FIRST_ABI
 = 0,

36 
	mFFI_SYSV
,

37 
	mFFI_LAST_ABI
,

38 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


39 } 
	tffi_abi
;

44 
	#FFI_CLOSURES
 1

	)

45 
	#FFI_TRAMPOLINE_SIZE
 36

	)

46 
	#FFI_NATIVE_RAW_API
 0

	)

50 #i‡
deföed
 (
__APPLE__
)

51 
	#FFI_TARGET_SPECIFIC_VARIADIC


	)

52 
	#FFI_EXTRA_CIF_FIELDS
 
Ørch64_Êags
; 
Ørch64_nfixed¨gs


	)

54 
	#FFI_EXTRA_CIF_FIELDS
 
Ørch64_Êags


	)

57 
	#AARCH64_FFI_WITH_V_BIT
 0

	)

59 
	#AARCH64_N_XREG
 32

	)

60 
	#AARCH64_N_VREG
 32

	)

61 
	#AARCH64_CALL_CONTEXT_SIZE
 (
AARCH64_N_XREG
 * 8 + 
AARCH64_N_VREG
 * 16)

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/aarch64/sysv.S

22 
	#LIBFFI_ASM


	)

23 
	~<ffic⁄fig.h
>

24 
	~<ffi.h
>

26 #ifde‡
HAVE_MACHINE_ASM_H


27 
	~<machöe/asm.h
>

29 #ifde‡
__USER_LABEL_PREFIX__


30 
	#CONCAT1
(
a
, 
b
Ë
	`CONCAT2
◊, b)

	)

31 
	#CONCAT2
(
a
, 
b
Ë®## 
	)
b

34 
	#CNAME
(
x
Ë
	`CONCAT1
 (
__USER_LABEL_PREFIX__
, x)

	)

36 
	#CNAME
(
x
Ë
	)
x

40 
	#cfi_adju°_cÁ_off£t
(
off
Ë.
cfi_adju°_cÁ_off£t
 
	)
off

41 
	#cfi_ªl_off£t
(
ªg
, 
off
Ë.
cfi_ªl_off£t
Ñeg, 
	)
off

42 
	#cfi_ª°‹e
(
ªg
Ë.
cfi_ª°‹e
 
	)
reg

43 
	#cfi_def_cÁ_ªgi°î
(
ªg
Ë.
cfi_def_cÁ_ªgi°î
 
	)
reg

45 .
	gãxt


46 .
globl
 
	$CNAME
(
ffi_ˇŒ_SYSV
)

47 #ifde‡
__ELF__


48 .
ty≥
 
	`CNAME
(
ffi_ˇŒ_SYSV
), #function

50 #ifde‡
__APPLE__


51 .
Æign
 2

101 
	#ffi_ˇŒ_SYSV_FS
 (8 * 4)

	)

103 .
cfi_°¨çroc


104 
	$CNAME
(
ffi_ˇŒ_SYSV
):

105 
°p
 
x29
, 
x30
, [
•
, #-16]!

106 
	$cfi_adju°_cÁ_off£t
 (16)

107 
	$cfi_ªl_off£t
 (
x29
, 0)

108 
	$cfi_ªl_off£t
 (
x30
, 8)

110 
mov
 
x29
, 
•


111 
	$cfi_def_cÁ_ªgi°î
 (
x29
)

112 
sub
 
•
, sp, #ffi_call_SYSV_FS

114 
°p
 
x21
, 
x22
, [
•
, #0]

115 
	`cfi_ªl_off£t
 (
x21
, 0 - 
ffi_ˇŒ_SYSV_FS
)

116 
	`cfi_ªl_off£t
 (
x22
, 8 - 
ffi_ˇŒ_SYSV_FS
)

118 
°p
 
x23
, 
x24
, [
•
, #16]

119 
	`cfi_ªl_off£t
 (
x23
, 16 - 
ffi_ˇŒ_SYSV_FS
)

120 
	`cfi_ªl_off£t
 (
x24
, 24 - 
ffi_ˇŒ_SYSV_FS
)

122 
mov
 
x21
, 
x1


123 
mov
 
x22
, 
x2


124 
mov
 
x24
, 
x4


130 
sub
 
•
, sp, 
x3


135 
mov
 
x23
, 
x0


136 
mov
 
x0
, 
x1


137 
mov
 
x1
, 
•


139 
bÃ
 
x23


142 
mov
 
x23
, 
x0


145 
tbz
 
x23
, #AARCH64_FFI_WITH_V_BIT, 1f

148 
ldp
 
q0
, 
q1
, [
x21
, #8*32 + 0]

149 
ldp
 
q2
, 
q3
, [
x21
, #8*32 + 32]

150 
ldp
 
q4
, 
q5
, [
x21
, #8*32 + 64]

151 
ldp
 
q6
, 
q7
, [
x21
, #8*32 + 96]

154 
ldp
 
x0
, 
x1
, [
x21
, #0]

155 
ldp
 
x2
, 
x3
, [
x21
, #16]

156 
ldp
 
x4
, 
x5
, [
x21
, #32]

157 
ldp
 
x6
, 
x7
, [
x21
, #48]

161 
ldr
 
x8
, [
x21
, #8*8]

163 
bÃ
 
x24


166 
°p
 
x0
, 
x1
, [
x21
, #0]

167 
°p
 
x2
, 
x3
, [
x21
, #16]

168 
°p
 
x4
, 
x5
, [
x21
, #32]

169 
°p
 
x6
, 
x7
, [
x21
, #48]

174 
tbz
 
x23
, #AARCH64_FFI_WITH_V_BIT, 1f

177 
°p
 
q0
, 
q1
, [
x21
, #8*32 + 0]

178 
°p
 
q2
, 
q3
, [
x21
, #8*32 + 32]

179 
°p
 
q4
, 
q5
, [
x21
, #8*32 + 64]

180 
°p
 
q6
, 
q7
, [
x21
, #8*32 + 96]

183 
ldp
 
x21
, 
x22
, [
x29
, #- 
ffi_ˇŒ_SYSV_FS
]

184 
	$cfi_ª°‹e
 (
x21
)

185 
	$cfi_ª°‹e
 (
x22
)

187 
ldp
 
x23
, 
x24
, [
x29
, #- 
ffi_ˇŒ_SYSV_FS
 + 16]

188 
	$cfi_ª°‹e
 (
x23
)

189 
	$cfi_ª°‹e
 (
x24
)

191 
mov
 
•
, 
x29


192 
	$cfi_def_cÁ_ªgi°î
 (
•
)

194 
ldp
 
x29
, 
x30
, [
•
], #16

195 
	`cfi_adju°_cÁ_off£t
 (-16)

196 
	$cfi_ª°‹e
 (
x29
)

197 
	$cfi_ª°‹e
 (
x30
)

199 
ªt


201 .
cfi_íd¥oc


202 #ifde‡
__ELF__


203 .
size
 
	`CNAME
(
ffi_ˇŒ_SYSV
), .-
	$CNAME
(
ffi_ˇŒ_SYSV
)

206 
	#ffi_˛osuª_SYSV_FS
 (8 * 2 + 
AARCH64_CALL_CONTEXT_SIZE
)

	)

245 .
ãxt


246 .
globl
 
	$CNAME
(
ffi_˛osuª_SYSV
)

247 #ifde‡
__APPLE__


248 .
Æign
 2

250 .
cfi_°¨çroc


251 
	$CNAME
(
ffi_˛osuª_SYSV
):

252 
°p
 
x29
, 
x30
, [
•
, #-16]!

253 
	$cfi_adju°_cÁ_off£t
 (16)

254 
	$cfi_ªl_off£t
 (
x29
, 0)

255 
	$cfi_ªl_off£t
 (
x30
, 8)

257 
mov
 
x29
, 
•


258 
	$cfi_def_cÁ_ªgi°î
 (
x29
)

260 
sub
 
•
, sp, #ffi_closure_SYSV_FS

262 
°p
 
x21
, 
x22
, [
x29
, #-16]

263 
	`cfi_ªl_off£t
 (
x21
, -16)

264 
	`cfi_ªl_off£t
 (
x22
, -8)

267 
mov
 
x21
, 
•


269 
mov
 
x22
, 
x17


272 
°p
 
x0
, 
x1
, [
x21
, #0]

273 
°p
 
x2
, 
x3
, [
x21
, #16]

274 
°p
 
x4
, 
x5
, [
x21
, #32]

275 
°p
 
x6
, 
x7
, [
x21
, #48]

278 
°r
 
x8
, [
x21
, #64]

281 
ldr
 
x0
, [
x22
, #8]

282 
tbz
 
x0
, #AARCH64_FFI_WITH_V_BIT, 1f

285 
°p
 
q0
, 
q1
, [
x21
, #8*32 + 0]

286 
°p
 
q2
, 
q3
, [
x21
, #8*32 + 32]

287 
°p
 
q4
, 
q5
, [
x21
, #8*32 + 64]

288 
°p
 
q6
, 
q7
, [
x21
, #8*32 + 96]

291 
ldr
 
x0
, [
x22
, #0]

292 
mov
 
x1
, 
x21


295 
add
 
x2
, 
x29
, #16

297 
bl
 
	$CNAME
(
ffi_˛osuª_SYSV_ö√r
)

300 
ldr
 
x0
, [
x22
, #8]

301 
tbz
 
x0
, #AARCH64_FFI_WITH_V_BIT, 1f

304 
ldp
 
q0
, 
q1
, [
x21
, #8*32 + 0]

305 
ldp
 
q2
, 
q3
, [
x21
, #8*32 + 32]

306 
ldp
 
q4
, 
q5
, [
x21
, #8*32 + 64]

307 
ldp
 
q6
, 
q7
, [
x21
, #8*32 + 96]

310 
ldp
 
x0
, 
x1
, [
x21
, #0]

311 
ldp
 
x2
, 
x3
, [
x21
, #16]

312 
ldp
 
x4
, 
x5
, [
x21
, #32]

313 
ldp
 
x6
, 
x7
, [
x21
, #48]

317 
ldp
 
x21
, 
x22
, [
x29
, #-16]

318 
	$cfi_ª°‹e
 (
x21
)

319 
	$cfi_ª°‹e
 (
x22
)

321 
mov
 
•
, 
x29


322 
	$cfi_def_cÁ_ªgi°î
 (
•
)

324 
ldp
 
x29
, 
x30
, [
•
], #16

325 
	`cfi_adju°_cÁ_off£t
 (-16)

326 
	$cfi_ª°‹e
 (
x29
)

327 
	$cfi_ª°‹e
 (
x30
)

329 
ªt


330 .
cfi_íd¥oc


331 #ifde‡
__ELF__


332 .
size
 
	`CNAME
(
ffi_˛osuª_SYSV
), .-
	$CNAME
(
ffi_˛osuª_SYSV
)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/alpha/ffi.c

28 
	~<ffi.h
>

29 
	~<ffi_comm⁄.h
>

30 
	~<°dlib.h
>

34 #i‡
deföed
(
__LONG_DOUBLE_128__
)

35 #i‡
FFI_TYPE_LONGDOUBLE
 != 4

36 #îr‹ 
FFI_TYPE_LONGDOUBLE
 
out
 
of
 
d©e


39 #unde‡
FFI_TYPE_LONGDOUBLE


40 
	#FFI_TYPE_LONGDOUBLE
 4

	)

43 
ffi_ˇŒ_osf
(*, , , *, (*)())

44 
FFI_HIDDEN
;

45 
	$ffi_˛osuª_osf
(Ë
FFI_HIDDEN
;

48 
ffi_°©us


49 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

53 i‡(
cif
->
byãs
 < 6*
FFI_SIZEOF_ARG
)

54 
cif
->
byãs
 = 6*
FFI_SIZEOF_ARG
;

57 
cif
->
πy≥
->
ty≥
)

59 
FFI_TYPE_STRUCT
:

60 
FFI_TYPE_FLOAT
:

61 
FFI_TYPE_DOUBLE
:

62 
cif
->
Êags
 = cif->
πy≥
->
ty≥
;

65 
FFI_TYPE_LONGDOUBLE
:

67 
cif
->
Êags
 = 
FFI_TYPE_STRUCT
;

71 
cif
->
Êags
 = 
FFI_TYPE_INT
;

75  
FFI_OK
;

76 
	}
}

80 
ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

82 *
°ack
, *
¨gp
;

83 
i
, 
avn
;

84 
ffi_ty≥
 **
¨g_ty≥s
;

88 i‡(
rvÆue
 =
NULL
 && 
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

89 
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

93 
¨gp
 = 
°ack
 = 
	`Æloˇ
(
cif
->
byãs
 + 4*
FFI_SIZEOF_ARG
);

95 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

96 *(**Ë
¨gp
++ = 
rvÆue
;

98 
i
 = 0;

99 
avn
 = 
cif
->
«rgs
;

100 
¨g_ty≥s
 = 
cif
->arg_types;

102 
i
 < 
avn
)

104 
size_t
 
size
 = (*
¨g_ty≥s
)->size;

106 (*
¨g_ty≥s
)->
ty≥
)

108 
FFI_TYPE_SINT8
:

109 *(
SINT64
 *Ë
¨gp
 = *(
SINT8
 *)(* 
avÆue
);

112 
FFI_TYPE_UINT8
:

113 *(
SINT64
 *Ë
¨gp
 = *(
UINT8
 *)(* 
avÆue
);

116 
FFI_TYPE_SINT16
:

117 *(
SINT64
 *Ë
¨gp
 = *(
SINT16
 *)(* 
avÆue
);

120 
FFI_TYPE_UINT16
:

121 *(
SINT64
 *Ë
¨gp
 = *(
UINT16
 *)(* 
avÆue
);

124 
FFI_TYPE_SINT32
:

125 
FFI_TYPE_UINT32
:

127 *(
SINT64
 *Ë
¨gp
 = *(
SINT32
 *)(* 
avÆue
);

130 
FFI_TYPE_SINT64
:

131 
FFI_TYPE_UINT64
:

132 
FFI_TYPE_POINTER
:

133 *(
UINT64
 *Ë
¨gp
 = *(UINT64 *)(* 
avÆue
);

136 
FFI_TYPE_FLOAT
:

137 i‡(
¨gp
 - 
°ack
 < 6)

141 *(*Ë
¨gp
 = *(*)(* 
avÆue
);

144 *(*Ë
¨gp
 = *(*)(* 
avÆue
);

147 
FFI_TYPE_DOUBLE
:

148 *(*Ë
¨gp
 = *(*)(* 
avÆue
);

151 
FFI_TYPE_LONGDOUBLE
:

153 *(**Ë
¨gp
 = (*)(* 
avÆue
);

154 
size
 =  (*);

157 
FFI_TYPE_STRUCT
:

158 
	`mem˝y
(
¨gp
, *
avÆue
, (*
¨g_ty≥s
)->
size
);

162 
	`FFI_ASSERT
(0);

165 
¨gp
 +
	`ALIGN
(
size
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

166 
i
++, 
¨g_ty≥s
++, 
avÆue
++;

169 
	`ffi_ˇŒ_osf
(
°ack
, 
cif
->
byãs
, cif->
Êags
, 
rvÆue
, 
‚
);

170 
	}
}

173 
ffi_°©us


174 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

175 
ffi_cif
* 
cif
,

176 (*
fun
)(
ffi_cif
*, *, **, *),

177 *
u£r_d©a
,

178 *
codñoc
)

180 *
åamp
;

182 i‡(
cif
->
abi
 !
FFI_OSF
)

183  
FFI_BAD_ABI
;

185 
åamp
 = (*Ë&
˛osuª
->tramp[0];

186 
åamp
[0] = 0x47fb0401;

187 
åamp
[1] = 0xa77b0010;

188 
åamp
[2] = 0x6bfb0000;

189 
åamp
[3] = 0x47ff041f;

190 *(**Ë&
åamp
[4] = 
ffi_˛osuª_osf
;

192 
˛osuª
->
cif
 = cif;

193 
˛osuª
->
fun
 = fun;

194 
˛osuª
->
u£r_d©a
 = user_data;

202 
asm
 volatile ("call_pal 0x86" : : : "memory");

204  
FFI_OK
;

205 
	}
}

208 
FFI_HIDDEN


209 
	$ffi_˛osuª_osf_ö√r
(
ffi_˛osuª
 *
˛osuª
, *
rvÆue
, *
¨gp
)

211 
ffi_cif
 *
cif
;

212 **
avÆue
;

213 
ffi_ty≥
 **
¨g_ty≥s
;

214 
i
, 
avn
, 
¨gn
;

216 
cif
 = 
˛osuª
->cif;

217 
avÆue
 = 
	`Æloˇ
(
cif
->
«rgs
 * (*));

219 
¨gn
 = 0;

223 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

225 
rvÆue
 = (*Ë
¨gp
[0];

226 
¨gn
 = 1;

229 
i
 = 0;

230 
avn
 = 
cif
->
«rgs
;

231 
¨g_ty≥s
 = 
cif
->arg_types;

234 
i
 < 
avn
)

236 
size_t
 
size
 = 
¨g_ty≥s
[
i
]->size;

238 
¨g_ty≥s
[
i
]->
ty≥
)

240 
FFI_TYPE_SINT8
:

241 
FFI_TYPE_UINT8
:

242 
FFI_TYPE_SINT16
:

243 
FFI_TYPE_UINT16
:

244 
FFI_TYPE_SINT32
:

245 
FFI_TYPE_UINT32
:

246 
FFI_TYPE_SINT64
:

247 
FFI_TYPE_UINT64
:

248 
FFI_TYPE_POINTER
:

249 
FFI_TYPE_STRUCT
:

250 
avÆue
[
i
] = &
¨gp
[
¨gn
];

253 
FFI_TYPE_FLOAT
:

254 i‡(
¨gn
 < 6)

258 *(*)&
¨gp
[
¨gn
 - 6] = *(*)&argp[argn - 6];

259 
avÆue
[
i
] = &
¨gp
[
¨gn
 - 6];

262 
avÆue
[
i
] = &
¨gp
[
¨gn
];

265 
FFI_TYPE_DOUBLE
:

266 
avÆue
[
i
] = &
¨gp
[
¨gn
 - (argn < 6 ? 6 : 0)];

269 
FFI_TYPE_LONGDOUBLE
:

271 
avÆue
[
i
] = (*Ë
¨gp
[
¨gn
];

272 
size
 =  (*);

276 
	`ab‹t
 ();

279 
¨gn
 +
	`ALIGN
(
size
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

280 
i
++;

284 
˛osuª
->
	`fun
 (
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

287  
cif
->
πy≥
->
ty≥
;

288 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/alpha/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


35 #i‚de‡
LIBFFI_ASM


36 
	tffi_¨g
;

37 sig√d 
	tffi_ßrg
;

39 
	effi_abi
 {

40 
	mFFI_FIRST_ABI
 = 0,

41 
	mFFI_OSF
,

42 
	mFFI_LAST_ABI
,

43 
	mFFI_DEFAULT_ABI
 = 
FFI_OSF


44 } 
	tffi_abi
;

49 
	#FFI_CLOSURES
 1

	)

50 
	#FFI_TRAMPOLINE_SIZE
 24

	)

51 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/alpha/osf.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

31 .
¨ch
 
	gev6


32 .
	gãxt


41 .
	gÆign
 3

42 .
globl
 
	gffi_ˇŒ_osf


43 .
ít
 
ffi_ˇŒ_osf


44 
	$FFI_HIDDEN
(
ffi_ˇŒ_osf
)

46 
ffi_ˇŒ_osf
:

47 .
‰ame
 
$15
, 32, 
$26
, 0

48 .
mask
 0x4008000, -32

49 
$LFB1
:

50 
addq
 
$16
,
$17
,
$1


51 
mov
 
$16
, 
$30


52 
°q
 
$26
, 0(
$1
)

53 
°q
 
$15
, 8(
$1
)

54 
°q
 
$18
, 16(
$1
)

55 
mov
 
$1
, 
$15


56 
$LCFI1
:

57 .
¥ﬁogue
 0

59 
°q
 
$19
, 24(
$1
)

60 
mov
 
$20
, 
$27


62 #Lﬂd 
up
 
Æl
 
of
 
	`the
 (
pŸítül
Ë
¨gumít
 
ªgi°îs
.

63 
ldq
 
$16
, 0(
$30
)

64 
ldt
 
$f16
, 0(
$30
)

65 
ldt
 
$f17
, 8(
$30
)

66 
ldq
 
$17
, 8(
$30
)

67 
ldt
 
$f18
, 16(
$30
)

68 
ldq
 
$18
, 16(
$30
)

69 
ldt
 
$f19
, 24(
$30
)

70 
ldq
 
$19
, 24(
$30
)

71 
ldt
 
$f20
, 32(
$30
)

72 
ldq
 
$20
, 32(
$30
)

73 
ldt
 
$f21
, 40(
$30
)

74 
ldq
 
$21
, 40(
$30
)

76 #DóŒoˇã 
the
 
¨gumít
 
¨ó
.

77 
lda
 
$30
, 48($30)

79 
j§
 
$26
, (
$27
), 0

80 
ldgp
 
$29
, 0(
$26
)

82 #I‡
the
  
vÆue
 
poöãr
 
is
 
NULL
, 
assume
 
no
  value.

83 
ldq
 
$19
, 24(
$15
)

84 
ldq
 
$18
, 16(
$15
)

85 
ldq
 
$26
, 0(
$15
)

86 
$LCFI2
:

87 
beq
 
$19
, 
$n‹ëvÆ


89 #St‹ê
the
  
vÆue
 
out
 
ö
Åhê
¥›î
 
ty≥
.

90 
cm≥q
 
$18
, 
FFI_TYPE_INT
, 
$1


91 
b√
 
$1
, 
$ªtöt


92 
cm≥q
 
$18
, 
FFI_TYPE_FLOAT
, 
$2


93 
b√
 
$2
, 
$ªtÊﬂt


94 
cm≥q
 
$18
, 
FFI_TYPE_DOUBLE
, 
$3


95 
b√
 
$3
, 
$ªtdoubÀ


97 .
Æign
 3

98 
$n‹ëvÆ
:

99 
ldq
 
$15
, 8($15)

100 
ªt


102 .
Æign
 4

103 
$ªtöt
:

104 
°q
 
$0
, 0(
$19
)

105 
n›


106 
ldq
 
$15
, 8($15)

107 
ªt


109 .
Æign
 4

110 
$ªtÊﬂt
:

111 
°s
 
$f0
, 0(
$19
)

112 
n›


113 
ldq
 
$15
, 8($15)

114 
ªt


116 .
Æign
 4

117 
$ªtdoubÀ
:

118 
°t
 
$f0
, 0(
$19
)

119 
n›


120 
ldq
 
$15
, 8($15)

121 
ªt


122 
$LFE1
:

124 .
íd
 
ffi_ˇŒ_osf


130 .
Æign
 3

131 .
globl
 
ffi_˛osuª_osf


132 .
ít
 
ffi_˛osuª_osf


133 
	$FFI_HIDDEN
(
ffi_˛osuª_osf
)

135 
ffi_˛osuª_osf
:

136 .
‰ame
 
$30
, 16*8, 
$26
, 0

137 .
mask
 0x4000000, -16*8

138 
$LFB2
:

139 
ldgp
 
$29
, 0(
$27
)

140 
subq
 
$30
, 16*8, $30

141 
$LCFI5
:

142 
°q
 
$26
, 0(
$30
)

143 
$LCFI6
:

144 .
¥ﬁogue
 1

146 #St‹ê
Æl
 
of
 
the
 
pŸítül
 
¨gumít
 
ªgi°îs
 
ö
 
va_li°
 
f‹m©
.

147 
°t
 
$f16
, 4*8(
$30
)

148 
°t
 
$f17
, 5*8(
$30
)

149 
°t
 
$f18
, 6*8(
$30
)

150 
°t
 
$f19
, 7*8(
$30
)

151 
°t
 
$f20
, 8*8(
$30
)

152 
°t
 
$f21
, 9*8(
$30
)

153 
°q
 
$16
, 10*8(
$30
)

154 
°q
 
$17
, 11*8(
$30
)

155 
°q
 
$18
, 12*8(
$30
)

156 
°q
 
$19
, 13*8(
$30
)

157 
°q
 
$20
, 14*8(
$30
)

158 
°q
 
$21
, 15*8(
$30
)

160 #CÆ»
ffi_˛osuª_osf_ö√r
 
to
 dÿ
the
 
bulk
 
of
Åhê
w‹k
.

161 
mov
 
$1
, 
$16


162 
lda
 
$17
, 2*8(
$30
)

163 
lda
 
$18
, 10*8(
$30
)

164 
j§
 
$26
, 
ffi_˛osuª_osf_ö√r


165 
ldgp
 
$29
, 0(
$26
)

166 
ldq
 
$26
, 0(
$30
)

168 #Lﬂd 
up
 
the
  
vÆue
 
ö
Åhê
¥›î
 
ty≥
.

169 
lda
 
$1
, 
$lﬂd_èbÀ


170 
s4addq
 
$0
, 
$1
, $1

171 
ldl
 
$1
, 0($1)

172 
addq
 
$1
, 
$29
, $1

173 
jmp
 
$31
, (
$1
), 
$lﬂd_32


175 .
Æign
 4

176 
$lﬂd_n⁄e
:

177 
addq
 
$30
, 16*8, $30

178 
ªt


180 .
Æign
 4

181 
$lﬂd_Êﬂt
:

182 
lds
 
$f0
, 16(
$30
)

183 
n›


184 
addq
 
$30
, 16*8, $30

185 
ªt


187 .
Æign
 4

188 
$lﬂd_doubÀ
:

189 
ldt
 
$f0
, 16(
$30
)

190 
n›


191 
addq
 
$30
, 16*8, $30

192 
ªt


194 .
Æign
 4

195 
$lﬂd_u8
:

196 #ifde‡
__Æpha_bwx__


197 
ldbu
 
$0
, 16(
$30
)

198 
n›


200 
ldq
 
$0
, 16(
$30
)

201 
™d
 
$0
, 255, $0

203 
addq
 
$30
, 16*8, $30

204 
ªt


206 .
Æign
 4

207 
$lﬂd_s8
:

208 #ifde‡
__Æpha_bwx__


209 
ldbu
 
$0
, 16(
$30
)

210 
£xtb
 
$0
, $0

212 
ldq
 
$0
, 16(
$30
)

213 
¶l
 
$0
, 56, $0

214 
§a
 
$0
, 56, $0

216 
addq
 
$30
, 16*8, $30

217 
ªt


219 .
Æign
 4

220 
$lﬂd_u16
:

221 #ifde‡
__Æpha_bwx__


222 
ldwu
 
$0
, 16(
$30
)

223 
n›


225 
ldq
 
$0
, 16(
$30
)

226 
z≠nŸ
 
$0
, 3, $0

228 
addq
 
$30
, 16*8, $30

229 
ªt


231 .
Æign
 4

232 
$lﬂd_s16
:

233 #ifde‡
__Æpha_bwx__


234 
ldwu
 
$0
, 16(
$30
)

235 
£xtw
 
$0
, $0

237 
ldq
 
$0
, 16(
$30
)

238 
¶l
 
$0
, 48, $0

239 
§a
 
$0
, 48, $0

241 
addq
 
$30
, 16*8, $30

242 
ªt


244 .
Æign
 4

245 
$lﬂd_32
:

246 
ldl
 
$0
, 16(
$30
)

247 
n›


248 
addq
 
$30
, 16*8, $30

249 
ªt


251 .
Æign
 4

252 
$lﬂd_64
:

253 
ldq
 
$0
, 16(
$30
)

254 
n›


255 
addq
 
$30
, 16*8, $30

256 
ªt


257 
$LFE2
:

259 .
íd
 
ffi_˛osuª_osf


261 #ifde‡
__ELF__


262 .
£˘i⁄
 .
rod©a


264 .
rd©a


266 
$lﬂd_èbÀ
:

267 .
g¥ñ32
 
$lﬂd_n⁄e
 #FFI_TYPE_VOID

268 .
g¥ñ32
 
$lﬂd_32
 #FFI_TYPE_INT

269 .
g¥ñ32
 
$lﬂd_Êﬂt
 #FFI_TYPE_FLOAT

270 .
g¥ñ32
 
$lﬂd_doubÀ
 #FFI_TYPE_DOUBLE

271 .
g¥ñ32
 
$lﬂd_n⁄e
 #FFI_TYPE_LONGDOUBLE

272 .
g¥ñ32
 
$lﬂd_u8
 #FFI_TYPE_UINT8

273 .
g¥ñ32
 
$lﬂd_s8
 #FFI_TYPE_SINT8

274 .
g¥ñ32
 
$lﬂd_u16
 #FFI_TYPE_UINT16

275 .
g¥ñ32
 
$lﬂd_s16
 #FFI_TYPE_SINT16

276 .
g¥ñ32
 
$lﬂd_32
 #FFI_TYPE_UINT32

277 .
g¥ñ32
 
$lﬂd_32
 #FFI_TYPE_SINT32

278 .
g¥ñ32
 
$lﬂd_64
 #FFI_TYPE_UINT64

279 .
g¥ñ32
 
$lﬂd_64
 #FFI_TYPE_SINT64

280 .
g¥ñ32
 
$lﬂd_n⁄e
 #FFI_TYPE_STRUCT

281 .
g¥ñ32
 
$lﬂd_64
 #FFI_TYPE_POINTER

285 #if 
FFI_TYPE_FLOAT
 != 2 \

286 || 
FFI_TYPE_DOUBLE
 != 3 \

287 || 
FFI_TYPE_UINT8
 != 5 \

288 || 
FFI_TYPE_SINT8
 != 6 \

289 || 
FFI_TYPE_UINT16
 != 7 \

290 || 
FFI_TYPE_SINT16
 != 8 \

291 || 
FFI_TYPE_UINT32
 != 9 \

292 || 
FFI_TYPE_SINT32
 != 10 \

293 || 
FFI_TYPE_UINT64
 != 11 \

294 || 
FFI_TYPE_SINT64
 != 12 \

295 || 
FFI_TYPE_STRUCT
 != 13 \

296 || 
FFI_TYPE_POINTER
 != 14 \

297 || 
FFI_TYPE_LAST
 != 14

301 #ifde‡
__ELF__


302 
	#UA_SI
 .4b
yã


	)

303 
	#FDE_ENCODING
 0x1b

	)

304 
	#FDE_ENCODE
(
X
Ë.4b
yã
 X-.

	)

305 
	#FDE_ARANGE
(
X
Ë.4b
yã
 
	)
X

306 #ñi‡
deföed
 
__osf__


307 
	#UA_SI
 .
Æign
 0; .

	)

308 
	#FDE_ENCODING
 0x50

	)

309 
	#FDE_ENCODE
(
X
Ë.
Æign
 3; .
quad
 
	)
X

310 
	#FDE_ARANGE
(
X
Ë.
Æign
 0; .
quad
 
	)
X

313 #ifde‡
__ELF__


314 .
£˘i⁄
 .
eh_‰ame
,
EH_FRAME_FLAGS
,@
¥ogbôs


315 #ñi‡
deföed
 
__osf__


316 .
d©a


317 .
Æign
 3

318 .
globl
 
_GLOBAL__F_ffi_ˇŒ_osf


319 
_GLOBAL__F_ffi_ˇŒ_osf
:

321 
__FRAME_BEGIN__
:

322 
UA_SI
 
$LECIE1
-
$LSCIE1
 #Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


323 
$LSCIE1
:

324 
UA_SI
 0x0 #CIE 
Idítifõr
 
Tag


325 .
byã
 0x1 #CIE 
Vîsi⁄


326 .
ascii
 "zR\0" #CIE 
Augmíèti⁄


327 .
byã
 0x1 #uÀb128 0x1; 
CIE
 
Code
 
Alignmít
 
Fa˘‹


328 .
byã
 0x78 #¶eb128 -8; 
CIE
 
D©a
 
Alignmít
 
Fa˘‹


329 .
byã
 26 #CIE 
RA
 
Cﬁumn


330 .
byã
 0x1 #uÀb128 0x1; 
Augmíèti⁄
 
size


331 .
byã
 
FDE_ENCODING
 #FDE 
Encodög


332 .
byã
 0xc #DW_CFA_def_cfa

333 .
byã
 30 #uÀb128 
cﬁumn
 30

334 .
byã
 0 #uÀb128 
off£t
 0

335 .
Æign
 3

336 
$LECIE1
:

337 
$LSFDE1
:

338 
UA_SI
 
$LEFDE1
-
$LASFDE1
 #FDE 
Lígth


339 
$LASFDE1
:

340 
UA_SI
 
$LASFDE1
-
__FRAME_BEGIN__
 #FDE 
CIE
 
off£t


341 
	$FDE_ENCODE
(
$LFB1
Ë#FDE 
öôül
 
loˇti⁄


342 
	`FDE_ARANGE
(
$LFE1
-
$LFB1
Ë#FDE 
addªss
 
ønge


343 .
byã
 0x0 #uÀb128 0x0; 
Augmíèti⁄
 
size


345 .
byã
 0x4 #DW_CFA_advance_loc4

346 
UA_SI
 
$LCFI1
-
$LFB1


347 .
byã
 0x9®#DW_CFA_off£t, 
cﬁumn
 26

348 .
byã
 4 #uleb128 4*-8

349 .
byã
 0x8‡#DW_CFA_off£t, 
cﬁumn
 15

350 .
byã
 0x3 #uleb128 3*-8

351 .
byã
 0xc #DW_CFA_def_cfa

352 .
byã
 15 #uÀb128 
cﬁumn
 15

353 .
byã
 32 #uÀb128 
off£t
 32

355 .
byã
 0x4 #DW_CFA_advance_loc4

356 
UA_SI
 
$LCFI2
-
$LCFI1


357 .
byã
 0xd®#DW_CFA_ª°‹e, 
cﬁumn
 26

358 .
Æign
 3

359 
$LEFDE1
:

361 
$LSFDE3
:

362 
UA_SI
 
$LEFDE3
-
$LASFDE3
 #FDE 
Lígth


363 
$LASFDE3
:

364 
UA_SI
 
$LASFDE3
-
__FRAME_BEGIN__
 #FDE 
CIE
 
off£t


365 
	$FDE_ENCODE
(
$LFB2
Ë#FDE 
öôül
 
loˇti⁄


366 
	`FDE_ARANGE
(
$LFE2
-
$LFB2
Ë#FDE 
addªss
 
ønge


367 .
byã
 0x0 #uÀb128 0x0; 
Augmíèti⁄
 
size


369 .
byã
 0x4 #DW_CFA_advance_loc4

370 
UA_SI
 
$LCFI5
-
$LFB2


371 .
byã
 0xe #DW_CFA_def_cfa_offset

372 .
byã
 0x80,0x1 #uleb128 128

374 .
byã
 0x4 #DW_CFA_advance_loc4

375 
UA_SI
 
$LCFI6
-
$LCFI5


376 .
byã
 0x9®#DW_CFA_off£t, 
cﬁumn
 26

377 .
byã
 16 #uÀb128 
off£t
 16*-8

378 .
Æign
 3

379 
$LEFDE3
:

380 #i‡
deföed
 
__osf__


381 .
Æign
 0

382 .0 #End 
of
 
TabÀ


385 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


386 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arc/arcompact.S

26 
	#LIBFFI_ASM


	)

27 
	~<ffic⁄fig.h
>

28 
	~<ffi.h
>

29 #ifde‡
HAVE_MACHINE_ASM_H


30 
	~<machöe/asm.h
>

32 
	#CNAME
(
x
Ë
	)
x

33 
	#ENTRY
(
x
Ë.
globl
 
	`CNAME
(x)` .
ty≥
 CNAME(x),%
fun˘i⁄
` CNAME(x):

	)

36 .
ãxt


44 
	$ENTRY
(
ffi_ˇŒ_ARCom∑˘
)

46 
°
.
a
 
Â
, [
•
, -4]

47 
push_s
 
blök


48 
°
.
a
 
r4
, [
•
, -4]

49 
push_s
 
r3


50 
°
.
a
 
r5
, [
•
, -4]

51 
push_s
 
r2


52 
mov
 
Â
, 
•


55 
sub
 
•
, sp, 
r2


62 
jl_s
.
d
 [
r0
]

63 
mov_s
 
r0
, 
•


65 
ld
.
ab
 
r12
, [
Â
, 4]

66 
ld
.
ab
 
r11
, [
Â
, 4]

69 
ld_s
 
r0
, [
•
]

70 
ld_s
 
r1
, [
•
, 4]

71 
ld_s
 
r2
, [
•
, 8]

72 
ld_s
 
r3
, [
•
, 12]

73 
ld
 
r4
, [
•
, 16]

74 
ld
 
r5
, [
•
, 20]

75 
ld
 
r6
, [
•
, 24]

76 
ld
 
r7
, [
•
, 28]

79 
mö
 
r12
,Ñ12, 32

82 
jl
.
d
 [
r11
]

83 
add
 
•
, sp, 
r12


85 
mov
 
•
, 
Â


86 
p›_s
 
r3


87 
p›_s
 
r2


90 
bªq
.
d
 
r2
, 0, 
ïûogue


91 
p›_s
 
blök


94 
b∫e
 
r3
, 
FFI_TYPE_INT
, 
ªtu∫_doubÀ


95 
b
.
d
 
ïûogue


96 
°_s
 
r0
, [
r2
]

98 
ªtu∫_doubÀ
:

99 
b∫e
 
r3
, 
FFI_TYPE_DOUBLE
, 
ïûogue


100 
°_s
 
r0
, [
r2
]

101 
°_s
 
r1
, [
r2
,4]

103 
ïûogue
:

104 
j_s
.
d
 [
blök
]

105 
ld
.
ab
 
Â
, [
•
, 4]

107 
	$ENTRY
(
ffi_˛osuª_ARCom∑˘
)

108 
°
.
a
 
r0
, [
•
, -32]

109 
°_s
 
r1
, [
•
, 4]

110 
°_s
 
r2
, [
•
, 8]

111 
°_s
 
r3
, [
•
, 12]

112 
°
 
r4
, [
•
, 16]

113 
°
 
r5
, [
•
, 20]

114 
°
 
r6
, [
•
, 24]

115 
°
 
r7
, [
•
, 28]

118 
mov_s
 
r2
, 
•


121 
sub
 
•
, sp, 8

122 
mov_s
 
r1
, 
•


124 
push_s
 
blök


126 
bl
.
d
 
ffi_˛osuª_ö√r_ARCom∑˘


127 
mov_s
 
r0
, 
r8


129 
p›_s
 
blök


132 
p›_s
 
r0


133 
p›_s
 
r1


134 
j_s
.
d
 [
blök
]

135 
add_s
 
•
, sp, 32

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arc/ffi.c

26 
	~<ffi.h
>

27 
	~<ffi_comm⁄.h
>

29 
	~<°dlib.h
>

30 
	~<°döt.h
>

32 
	~<sys/ˇche˘l.h
>

36 #i‡
__BIG_ENDIAN__


37 
	#CODE_ENDIAN
(
x
Ë(x)

	)

39 
	#CODE_ENDIAN
(
x
Ë–(((
uöt32_t
Ë(x)Ë<< 16Ë| (((uöt32_tË(x)Ë>> 16))

	)

46 
	$ffi_¥ï_¨gs
 (*
°ack
, 
exãnded_cif
 * 
ecif
)

48 
i
;

49 
tmp
;

50 **
p_¨gv
;

51 *
¨gp
;

52 
ffi_ty≥
 **
p_¨g
;

54 
tmp
 = 0;

55 
¨gp
 = 
°ack
;

57 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

59 *(**Ë
¨gp
 = 
ecif
->
rvÆue
;

60 
¨gp
 += 4;

63 
p_¨gv
 = 
ecif
->
avÆue
;

65 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

66 (
i
 !0); i--, 
p_¨g
++)

68 
size_t
 
z
;

69 
Æignmít
;

72 
Æignmít
 = (((*
p_¨g
)->alignment - 1) | 3) + 1;

75 i‡((
Æignmít
 - 1Ë& (Ë
¨gp
)

76 
¨gp
 = (*Ë
	`ALIGN
 (¨gp, 
Æignmít
);

78 
z
 = (*
p_¨g
)->
size
;

79 i‡(
z
 <  ())

81 
z
 =  ();

83 (*
p_¨g
)->
ty≥
)

85 
FFI_TYPE_SINT8
:

86 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT8
 *Ë(*
p_¨gv
);

89 
FFI_TYPE_UINT8
:

90 *(*Ë
¨gp
 = (Ë*(
UINT8
 *Ë(*
p_¨gv
);

93 
FFI_TYPE_SINT16
:

94 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT16
 *Ë(*
p_¨gv
);

97 
FFI_TYPE_UINT16
:

98 *(*Ë
¨gp
 = (Ë*(
UINT16
 *Ë(*
p_¨gv
);

101 
FFI_TYPE_STRUCT
:

102 
	`mem˝y
 (
¨gp
, *
p_¨gv
, (*
p_¨g
)->
size
);

106 
	`FFI_ASSERT
 (0);

109 i‡(
z
 ==  ())

111 *(*Ë
¨gp
 = (Ë*(
UINT32
 *Ë(*
p_¨gv
);

115 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT
)

117 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

122 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

125 
p_¨gv
++;

126 
¨gp
 +
z
;

130 
	}
}

133 
ffi_°©us


134 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 * 
cif
)

137 
cif
->
πy≥
->
ty≥
)

139 
FFI_TYPE_VOID
:

140 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

143 
FFI_TYPE_STRUCT
:

144 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

147 
FFI_TYPE_SINT64
:

148 
FFI_TYPE_UINT64
:

149 
FFI_TYPE_DOUBLE
:

150 
cif
->
Êags
 = 
FFI_TYPE_DOUBLE
;

153 
FFI_TYPE_FLOAT
:

155 
cif
->
Êags
 = 
FFI_TYPE_INT
;

159  
FFI_OK
;

160 
	}
}

162 
ffi_ˇŒ_ARCom∑˘
 ((*)(*, 
exãnded_cif
 *),

163 
exãnded_cif
 *, , ,

164 *, (*
‚
) ());

167 
	`ffi_ˇŒ
 (
ffi_cif
 * 
cif
, (*
‚
Ë(), *
rvÆue
, **
avÆue
)

169 
exãnded_cif
 
ecif
;

171 
ecif
.
cif
 = cif;

172 
ecif
.
avÆue
 =ávalue;

176 i‡((
rvÆue
 =
NULL
Ë&& (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

178 
ecif
.
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

181 
ecif
.
rvÆue
 =Ñvalue;

183 
cif
->
abi
)

185 
FFI_ARCOMPACT
:

186 
	`ffi_ˇŒ_ARCom∑˘
 (
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
,

187 
cif
->
Êags
, 
ecif
.
rvÆue
, 
‚
);

191 
	`FFI_ASSERT
 (0);

194 
	}
}

197 
	$ffi_˛osuª_ö√r_ARCom∑˘
 (
ffi_˛osuª
 * 
˛osuª
, *
rvÆue
,

198 
ffi_¨g
 * 
¨gs
)

200 **
¨g_¨ó
, **
p_¨gv
;

201 
ffi_cif
 *
cif
 = 
˛osuª
->cif;

202 *
¨gp
 = (*Ë
¨gs
;

203 
ffi_ty≥
 **
p_¨gt
;

204 
i
;

206 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

209 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

211 
rvÆue
 = *(**Ë
¨gp
;

212 
¨gp
 += 4;

215 
p_¨gv
 = 
¨g_¨ó
;

217 
i
 = 0, 
p_¨gt
 = 
cif
->
¨g_ty≥s
; i < cif->
«rgs
;

218 
i
++, 
p_¨gt
++, 
p_¨gv
++)

220 
size_t
 
z
;

221 
Æignmít
;

224 
Æignmít
 = (((*
p_¨gt
)->alignment - 1) | 3) + 1;

227 i‡((
Æignmít
 - 1Ë& (Ë
¨gp
)

228 
¨gp
 = (*Ë
	`ALIGN
 (¨gp, 
Æignmít
);

230 
z
 = (*
p_¨gt
)->
size
;

231 *
p_¨gv
 = (*Ë
¨gp
;

232 
¨gp
 +
z
;

235 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
¨g_¨ó
, closuª->
u£r_d©a
);

237  
cif
->
Êags
;

238 
	}
}

240 
ffi_˛osuª_ARCom∑˘
 ();

242 
ffi_°©us


243 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
 * 
˛osuª
, 
ffi_cif
 * 
cif
,

244 (*
fun
Ë(
ffi_cif
 *, *, **, *),

245 *
u£r_d©a
, *
codñoc
)

247 
uöt32_t
 *
åamp
 = (uöt32_à*Ë& (
˛osuª
->tramp[0]);

249 
cif
->
abi
)

251 
FFI_ARCOMPACT
:

252 
	`FFI_ASSERT
 (
åamp
 =
codñoc
);

253 
åamp
[0] = 
	`CODE_ENDIAN
 (0x200a1fc0);

254 
åamp
[1] = 
	`CODE_ENDIAN
 (0x20200f80);

255 
åamp
[2] = 
	`CODE_ENDIAN
 (
ffi_˛osuª_ARCom∑˘
);

259  
FFI_BAD_ABI
;

262 
˛osuª
->
cif
 = cif;

263 
˛osuª
->
fun
 = fun;

264 
˛osuª
->
u£r_d©a
 = user_data;

265 
	`ˇcheÊush
 (
codñoc
, 
FFI_TRAMPOLINE_SIZE
, 
BCACHE
);

267  
FFI_OK
;

268 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arc/ffitarget.h

27 #i‚de‡
LIBFFI_TARGET_H


28 
	#LIBFFI_TARGET_H


	)

30 #i‚de‡
LIBFFI_H


36 #i‚de‡
LIBFFI_ASM


37 
	tffi_¨g
;

38 sig√d 
	tffi_ßrg
;

40 
	effi_abi


42 
	mFFI_FIRST_ABI
 = 0,

43 
	mFFI_ARCOMPACT
,

44 
	mFFI_LAST_ABI
,

45 
	mFFI_DEFAULT_ABI
 = 
FFI_ARCOMPACT


46 } 
	tffi_abi
;

49 
	#FFI_CLOSURES
 1

	)

50 
	#FFI_TRAMPOLINE_SIZE
 12

	)

51 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arm/ffi.c

31 
	~<ffi.h
>

32 
	~<ffi_comm⁄.h
>

34 
	~<°dlib.h
>

37 
vÂ_ty≥_p
 (
ffi_ty≥
 *);

38 
œyout_vÂ_¨gs
 (
ffi_cif
 *);

40 
ffi_¥ï_¨gs_SYSV
(*
°ack
, 
exãnded_cif
 *
ecif
, *
vÂ_•a˚
);

41 
ffi_¥ï_¨gs_VFP
(*
°ack
, 
exãnded_cif
 *
ecif
, *
vÂ_•a˚
);

43 * 
	$ffi_Æign
(
ffi_ty≥
 **
p_¨g
, *
¨gp
)

46 
size_t
 
Æignmít
 = (*
p_¨g
)->alignment;

47 i‡(
Æignmít
 < 4)

49 
Æignmít
 = 4;

51 #ifde‡
_WIN32_WCE


52 i‡(
Æignmít
 > 4)

54 
Æignmít
 = 4;

57 i‡((
Æignmít
 - 1Ë& (Ë
¨gp
)

59 
¨gp
 = (*Ë
	`ALIGN
◊rgp, 
Æignmít
);

62 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT
)

64 
¨gp
 = (*Ë
	`ALIGN
(argp, 4);

66  
¨gp
;

67 
	}
}

69 
size_t
 
	$ffi_put_¨g
(
ffi_ty≥
 **
¨g_ty≥
, **
¨g
, *
°ack
)

71 * 
¨gp
 = 
°ack
;

72 
ffi_ty≥
 **
p_¨g
 = 
¨g_ty≥
;

73 **
p_¨gv
 = 
¨g
;

74 
size_t
 
z
 = (*
p_¨g
)->
size
;

75 i‡(
z
 < ())

77 
z
 = ();

78 (*
p_¨g
)->
ty≥
)

80 
FFI_TYPE_SINT8
:

81 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT8
 *)(* 
p_¨gv
);

84 
FFI_TYPE_UINT8
:

85 *(*Ë
¨gp
 = ()*(
UINT8
 *)(* 
p_¨gv
);

88 
FFI_TYPE_SINT16
:

89 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT16
 *)(* 
p_¨gv
);

92 
FFI_TYPE_UINT16
:

93 *(*Ë
¨gp
 = ()*(
UINT16
 *)(* 
p_¨gv
);

96 
FFI_TYPE_STRUCT
:

97 
	`mem˝y
(
¨gp
, *
p_¨gv
, (*
p_¨g
)->
size
);

101 
	`FFI_ASSERT
(0);

104 i‡(
z
 == ())

106 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_FLOAT
)

107 *(*Ë
¨gp
 = *(*)(* 
p_¨gv
);

109 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

111 i‡(
z
 =(Ë&& (*
p_¨g
)->
ty≥
 =
FFI_TYPE_DOUBLE
)

113 *(*Ë
¨gp
 = *(*)(* 
p_¨gv
);

117 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

119  
z
;

120 
	}
}

128 
	$ffi_¥ï_¨gs_SYSV
(*
°ack
, 
exãnded_cif
 *
ecif
, *
vÂ_•a˚
)

130 
i
;

131 **
p_¨gv
;

132 *
¨gp
;

133 
ffi_ty≥
 **
p_¨g
;

134 
¨gp
 = 
°ack
;

137 i‡–
ecif
->
cif
->
Êags
 =
FFI_TYPE_STRUCT
 ) {

138 *(**Ë
¨gp
 = 
ecif
->
rvÆue
;

139 
¨gp
 += 4;

142 
p_¨gv
 = 
ecif
->
avÆue
;

144 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

145 (
i
 != 0);

146 
i
--, 
p_¨g
++, 
p_¨gv
++)

148 
¨gp
 = 
	`ffi_Æign
(
p_¨g
,árgp);

149 
¨gp
 +
	`ffi_put_¨g
(
p_¨g
, 
p_¨gv
,árgp);

153 
	}
}

155 
	$ffi_¥ï_¨gs_VFP
(*
°ack
, 
exãnded_cif
 *
ecif
, *
vÂ_•a˚
)

157 
i
, 
vi
 = 0;

158 **
p_¨gv
;

159 *
¨gp
, *
ªgp
, *
eo_ªgp
;

160 
ffi_ty≥
 **
p_¨g
;

161 
°ack_u£d
 = 0;

162 
d⁄e_wôh_ªgs
 = 0;

163 
is_vÂ_ty≥
;

166 
	`FFI_ASSERT
(
ecif
->
cif
->
abi
 =
FFI_VFP
);

170 
ªgp
 = 
°ack
;

171 
eo_ªgp
 = 
¨gp
 = 
ªgp
 + 16;

176 i‡–
ecif
->
cif
->
Êags
 =
FFI_TYPE_STRUCT
 ) {

177 *(**Ë
ªgp
 = 
ecif
->
rvÆue
;

178 
ªgp
 += 4;

181 
p_¨gv
 = 
ecif
->
avÆue
;

183 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

184 (
i
 != 0);

185 
i
--, 
p_¨g
++, 
p_¨gv
++)

187 
is_vÂ_ty≥
 = 
	`vÂ_ty≥_p
 (*
p_¨g
);

190 if(
vi
 < 
ecif
->
cif
->
vÂ_«rgs
 && 
is_vÂ_ty≥
)

192 *
vÂ_¶Ÿ
 = (*)(
vÂ_•a˚
 + 
ecif
->
cif
->
vÂ_¨gs
[
vi
++]);

193 
	`ffi_put_¨g
(
p_¨g
, 
p_¨gv
, 
vÂ_¶Ÿ
);

197 i‡(!
d⁄e_wôh_ªgs
 && !
is_vÂ_ty≥
)

199 *
åegp
 = 
	`ffi_Æign
(
p_¨g
, 
ªgp
);

200 
size_t
 
size
 = (*
p_¨g
)->size;

201 
size
 = (size < 4)? 4 : size;

204 if(
åegp
 + 
size
 <
eo_ªgp
)

206 
ªgp
 = 
åegp
 + 
	`ffi_put_¨g
(
p_¨g
, 
p_¨gv
,Åregp);

207 
d⁄e_wôh_ªgs
 = (
ªgp
 =
¨gp
);

209 
	`FFI_ASSERT
(
ªgp
 <
¨gp
);

215 i‡(!
°ack_u£d
)

217 
°ack_u£d
 = 1;

218 
d⁄e_wôh_ªgs
 = 1;

219 
¨gp
 = 
åegp
 + 
	`ffi_put_¨g
(
p_¨g
, 
p_¨gv
,Åregp);

220 
	`FFI_ASSERT
(
eo_ªgp
 < 
¨gp
);

225 
°ack_u£d
 = 1;

226 
¨gp
 = 
	`ffi_Æign
(
p_¨g
,árgp);

227 
¨gp
 +
	`ffi_put_¨g
(
p_¨g
, 
p_¨gv
,árgp);

230  
ecif
->
cif
->
vÂ_u£d
;

231 
	}
}

234 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

236 
ty≥_code
;

240 
cif
->
byãs
 = (cif->bytes + 7) & ~7;

243 
cif
->
πy≥
->
ty≥
)

245 
FFI_TYPE_VOID
:

246 
FFI_TYPE_FLOAT
:

247 
FFI_TYPE_DOUBLE
:

248 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

251 
FFI_TYPE_SINT64
:

252 
FFI_TYPE_UINT64
:

253 
cif
->
Êags
 = (Ë
FFI_TYPE_SINT64
;

256 
FFI_TYPE_STRUCT
:

257 i‡(
cif
->
abi
 =
FFI_VFP


258 && (
ty≥_code
 = 
	`vÂ_ty≥_p
 (
cif
->
πy≥
)) != 0)

262 
cif
->
Êags
 = (Ë
ty≥_code
;

264 i‡(
cif
->
πy≥
->
size
 <= 4)

266 
cif
->
Êags
 = ()
FFI_TYPE_INT
;

271 
cif
->
Êags
 = ()
FFI_TYPE_STRUCT
;

275 
cif
->
Êags
 = 
FFI_TYPE_INT
;

282 i‡(
cif
->
abi
 =
FFI_VFP
)

283 
	`œyout_vÂ_¨gs
 (
cif
);

285  
FFI_OK
;

286 
	}
}

289 
ffi_°©us
 
	$ffi_¥ï_cif_machdï_v¨
(
ffi_cif
 *
cif
,

290 
nfixed¨gs
,

291 
¡ŸÆ¨gs
)

294 i‡(
cif
->
abi
 =
FFI_VFP
)

295 
cif
->
abi
 = 
FFI_SYSV
;

297  
	`ffi_¥ï_cif_machdï
(
cif
);

298 
	}
}

301 
ffi_ˇŒ_SYSV
 ((*
‚
)(), 
exãnded_cif
 *, , , *);

302 
	`ffi_ˇŒ_VFP
 ((*
‚
)(), 
exãnded_cif
 *, , , *);

304 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

306 
exãnded_cif
 
ecif
;

308 
smÆl_°ru˘
 = (
cif
->
Êags
 =
FFI_TYPE_INT


309 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
);

310 
vÂ_°ru˘
 = (
cif
->
Êags
 =
FFI_TYPE_STRUCT_VFP_FLOAT


311 || 
cif
->
Êags
 =
FFI_TYPE_STRUCT_VFP_DOUBLE
);

313 
ãmp
;

315 
ecif
.
cif
 = cif;

316 
ecif
.
avÆue
 =ávalue;

321 i‡((
rvÆue
 =
NULL
) &&

322 (
cif
->
Êags
 =
FFI_TYPE_STRUCT
))

324 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

326 i‡(
smÆl_°ru˘
)

327 
ecif
.
rvÆue
 = &
ãmp
;

328 i‡(
vÂ_°ru˘
)

331 
ecif
.
rvÆue
 = 
	`Æloˇ
(32);

334 
ecif
.
rvÆue
 =Ñvalue;

336 
cif
->
abi
)

338 
FFI_SYSV
:

339 
	`ffi_ˇŒ_SYSV
 (
‚
, &
ecif
, 
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
);

342 
FFI_VFP
:

343 #ifde‡
__ARM_EABI__


344 
	`ffi_ˇŒ_VFP
 (
‚
, &
ecif
, 
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
);

349 
	`FFI_ASSERT
(0);

352 i‡(
smÆl_°ru˘
)

354 
	`FFI_ASSERT
(
rvÆue
 !
NULL
);

355 
	`mem˝y
 (
rvÆue
, &
ãmp
, 
cif
->
πy≥
->
size
);

358 i‡(
vÂ_°ru˘
)

360 
	`FFI_ASSERT
(
rvÆue
 !
NULL
);

361 
	`mem˝y
 (
rvÆue
, 
ecif
.rvÆue, 
cif
->
πy≥
->
size
);

364 
	}
}

368 
ffi_¥ï_öcomög_¨gs_SYSV
 (*
°ack
, **
ªt
,

369 ** 
¨gs
, 
ffi_cif
* 
cif
, *
vÂ_°ack
);

371 
ffi_¥ï_öcomög_¨gs_VFP
 (*
°ack
, **
ªt
,

372 ** 
¨gs
, 
ffi_cif
* 
cif
, *
vÂ_°ack
);

374 
ffi_˛osuª_SYSV
 (
ffi_˛osuª
 *);

376 
ffi_˛osuª_VFP
 (
ffi_˛osuª
 *);

380 
FFI_HIDDEN


381 
	$ffi_˛osuª_ö√r
 (
ffi_˛osuª
 *
˛osuª
,

382 **
ª•p
, *
¨gs
, *
vÂ_¨gs
)

385 
ffi_cif
 *
cif
;

386 **
¨g_¨ó
;

388 
cif
 = 
˛osuª
->cif;

389 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

396 i‡(
cif
->
abi
 =
FFI_VFP
)

397 
	`ffi_¥ï_öcomög_¨gs_VFP
(
¨gs
, 
ª•p
, 
¨g_¨ó
, 
cif
, 
vÂ_¨gs
);

399 
	`ffi_¥ï_öcomög_¨gs_SYSV
(
¨gs
, 
ª•p
, 
¨g_¨ó
, 
cif
, 
vÂ_¨gs
);

401 (
˛osuª
->
fun
Ë(
cif
, *
ª•p
, 
¨g_¨ó
, closuª->
u£r_d©a
);

403  
cif
->
Êags
;

404 
	}
}

408 
	$ffi_¥ï_öcomög_¨gs_SYSV
(*
°ack
, **
rvÆue
,

409 **
avÆue
, 
ffi_cif
 *
cif
,

411 *
vÂ_°ack
)

414 
i
;

415 **
p_¨gv
;

416 *
¨gp
;

417 
ffi_ty≥
 **
p_¨g
;

419 
¨gp
 = 
°ack
;

421 i‡–
cif
->
Êags
 =
FFI_TYPE_STRUCT
 ) {

422 *
rvÆue
 = *(**Ë
¨gp
;

423 
¨gp
 += 4;

426 
p_¨gv
 = 
avÆue
;

428 
i
 = 
cif
->
«rgs
, 
p_¨g
 = cif->
¨g_ty≥s
; (i != 0); i--,Ö_arg++)

430 
size_t
 
z
;

432 
¨gp
 = 
	`ffi_Æign
(
p_¨g
,árgp);

434 
z
 = (*
p_¨g
)->
size
;

438 *
p_¨gv
 = (*Ë
¨gp
;

440 
p_¨gv
++;

441 
¨gp
 +
z
;

445 
	}
}

449 
	$ffi_¥ï_öcomög_¨gs_VFP
(*
°ack
, **
rvÆue
,

450 **
avÆue
, 
ffi_cif
 *
cif
,

452 *
vÂ_°ack
)

455 
i
, 
vi
 = 0;

456 **
p_¨gv
;

457 *
¨gp
, *
ªgp
, *
eo_ªgp
;

458 
ffi_ty≥
 **
p_¨g
;

459 
d⁄e_wôh_ªgs
 = 0;

460 
°ack_u£d
 = 0;

461 
is_vÂ_ty≥
;

463 
	`FFI_ASSERT
(
cif
->
abi
 =
FFI_VFP
);

464 
ªgp
 = 
°ack
;

465 
eo_ªgp
 = 
¨gp
 = 
ªgp
 + 16;

467 i‡–
cif
->
Êags
 =
FFI_TYPE_STRUCT
 ) {

468 *
rvÆue
 = *(**Ë
ªgp
;

469 
ªgp
 += 4;

472 
p_¨gv
 = 
avÆue
;

474 
i
 = 
cif
->
«rgs
, 
p_¨g
 = cif->
¨g_ty≥s
; (i != 0); i--,Ö_arg++)

476 
size_t
 
z
;

477 
is_vÂ_ty≥
 = 
	`vÂ_ty≥_p
 (*
p_¨g
);

479 if(
vi
 < 
cif
->
vÂ_«rgs
 && 
is_vÂ_ty≥
)

481 *
p_¨gv
++ = (*)(
vÂ_°ack
 + 
cif
->
vÂ_¨gs
[
vi
++]);

484 i‡(!
d⁄e_wôh_ªgs
 && !
is_vÂ_ty≥
)

486 * 
åegp
 = 
	`ffi_Æign
(
p_¨g
, 
ªgp
);

488 
z
 = (*
p_¨g
)->
size
;

489 
z
 = (z < 4)? 4 : z;

493 if(
åegp
 + 
z
 <
eo_ªgp
 || !
°ack_u£d
)

496 *
p_¨gv
 = (*Ë
åegp
;

498 
p_¨gv
++;

499 
ªgp
 = 
åegp
 + 
z
;

502 if(
ªgp
 > 
eo_ªgp
)

504 if(
°ack_u£d
)

506 
	`ab‹t
();

509 
¨gp
 = 
ªgp
;

511 if(
ªgp
 >
eo_ªgp
)

513 
d⁄e_wôh_ªgs
 = 1;

514 
°ack_u£d
 = 1;

519 
°ack_u£d
 = 1;

521 
¨gp
 = 
	`ffi_Æign
(
p_¨g
,árgp);

523 
z
 = (*
p_¨g
)->
size
;

527 *
p_¨gv
 = (*Ë
¨gp
;

529 
p_¨gv
++;

530 
¨gp
 +
z
;

534 
	}
}

538 
ffi_¨m_åampﬁöe
[3];

540 #i‡
FFI_EXEC_TRAMPOLINE_TABLE


542 
	~<mach/mach.h
>

543 
	~<±hªad.h
>

544 
	~<°dio.h
>

545 
	~<°dlib.h
>

547 *
ffi_˛osuª_åampﬁöe_èbÀ_∑ge
;

549 
ffi_åampﬁöe_èbÀ
 
	tffi_åampﬁöe_èbÀ
;

550 
ffi_åampﬁöe_èbÀ_íåy
 
	tffi_åampﬁöe_èbÀ_íåy
;

552 
	sffi_åampﬁöe_èbÀ
 {

554 
vm_addªss_t
 
	mc⁄fig_∑ge
;

555 
vm_addªss_t
 
	måampﬁöe_∑ge
;

558 
uöt16_t
 
	m‰ì_cou¡
;

559 
ffi_åampﬁöe_èbÀ_íåy
 *
	m‰ì_li°
;

560 
ffi_åampﬁöe_èbÀ_íåy
 *
	m‰ì_li°_poﬁ
;

562 
ffi_åampﬁöe_èbÀ
 *
	m¥ev
;

563 
ffi_åampﬁöe_èbÀ
 *
	m√xt
;

566 
	sffi_åampﬁöe_èbÀ_íåy
 {

567 *(*
	måampﬁöe
)();

568 
ffi_åampﬁöe_èbÀ_íåy
 *
	m√xt
;

573 #unde‡
FFI_TRAMPOLINE_SIZE


574 
	#FFI_TRAMPOLINE_SIZE
 12

	)

577 
	#FFI_TRAMPOLINE_CODELOC_CONFIG
(
codñoc
Ë((**Ë(((
uöt8_t
 *ËcodñocË- 4080));

	)

580 
	#FFI_TRAMPOLINE_CONFIG_PAGE_OFFSET
 16

	)

583 
	#FFI_TRAMPOLINE_COUNT
 ((
PAGE_SIZE
 - 
FFI_TRAMPOLINE_CONFIG_PAGE_OFFSET
Ë/ 
FFI_TRAMPOLINE_SIZE
)

	)

585 
±hªad_muãx_t
 
	gffi_åampﬁöe_lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

586 
ffi_åampﬁöe_èbÀ
 *
	gffi_åampﬁöe_èbÀs
 = 
NULL
;

588 
ffi_åampﬁöe_èbÀ
 *

589 
	$ffi_åampﬁöe_èbÀ_Æloc
 ()

591 
ffi_åampﬁöe_èbÀ
 *
èbÀ
 = 
NULL
;

594 
èbÀ
 =
NULL
) {

595 
vm_addªss_t
 
c⁄fig_∑ge
 = 0x0;

596 
kîn_ªtu∫_t
 
kt
;

599 
kt
 = 
	`vm_Æloˇã
 (
	`mach_èsk_£lf
 (), &
c⁄fig_∑ge
, 
PAGE_SIZE
*2, 
VM_FLAGS_ANYWHERE
);

600 i‡(
kt
 !
KERN_SUCCESS
) {

601 
	`Ârötf
(
°dîr
, "vm_Æloˇã(ËÁûuª: %dáà%s:%d\n", 
kt
, 
__FILE__
, 
__LINE__
);

606 
vm_addªss_t
 
åampﬁöe_∑ge
 = 
c⁄fig_∑ge
+
PAGE_SIZE
;

607 
kt
 = 
	`vm_dóŒoˇã
 (
	`mach_èsk_£lf
 (), 
åampﬁöe_∑ge
, 
PAGE_SIZE
);

608 i‡(
kt
 !
KERN_SUCCESS
) {

609 
	`Ârötf
(
°dîr
, "vm_dóŒoˇã(ËÁûuª: %dáà%s:%d\n", 
kt
, 
__FILE__
, 
__LINE__
);

614 
vm_¥Ÿ_t
 
cur_¥Ÿ
;

615 
vm_¥Ÿ_t
 
max_¥Ÿ
;

617 
kt
 = 
	`vm_ªm≠
 (
	`mach_èsk_£lf
 (), &
åampﬁöe_∑ge
, 
PAGE_SIZE
, 0x0, 
FALSE
, mach_èsk_£l‡(), (
vm_addªss_t
Ë&
ffi_˛osuª_åampﬁöe_èbÀ_∑ge
, FALSE, &
cur_¥Ÿ
, &
max_¥Ÿ
, 
VM_INHERIT_SHARE
);

620 i‡(
kt
 !
KERN_SUCCESS
) {

622 i‡(
kt
 !
KERN_NO_SPACE
) {

623 
	`Ârötf
(
°dîr
, "vm_ªm≠(ËÁûuª: %dáà%s:%d\n", 
kt
, 
__FILE__
, 
__LINE__
);

626 
	`vm_dóŒoˇã
 (
	`mach_èsk_£lf
 (), 
c⁄fig_∑ge
, 
PAGE_SIZE
);

631 
èbÀ
 = 
	`ˇŒoc
 (1, (
ffi_åampﬁöe_èbÀ
));

632 
èbÀ
->
‰ì_cou¡
 = 
FFI_TRAMPOLINE_COUNT
;

633 
èbÀ
->
c⁄fig_∑ge
 = config_page;

634 
èbÀ
->
åampﬁöe_∑ge
 =Årampoline_page;

637 
èbÀ
->
‰ì_li°_poﬁ
 = 
	`ˇŒoc
(
FFI_TRAMPOLINE_COUNT
, (
ffi_åampﬁöe_èbÀ_íåy
));

639 
uöt16_t
 
i
;

640 
i
 = 0; i < 
èbÀ
->
‰ì_cou¡
; i++) {

641 
ffi_åampﬁöe_èbÀ_íåy
 *
íåy
 = &
èbÀ
->
‰ì_li°_poﬁ
[
i
];

642 
íåy
->
åampﬁöe
 = (*Ë(
èbÀ
->
åampﬁöe_∑ge
 + (
i
 * 
FFI_TRAMPOLINE_SIZE
));

644 i‡(
i
 < 
èbÀ
->
‰ì_cou¡
 - 1)

645 
íåy
->
√xt
 = &
èbÀ
->
‰ì_li°_poﬁ
[
i
+1];

648 
èbÀ
->
‰ì_li°
 =ÅabÀ->
‰ì_li°_poﬁ
;

651  
èbÀ
;

652 
	}
}

655 
	$ffi_˛osuª_Æloc
 (
size_t
 
size
, **
code
)

658 
ffi_˛osuª
 *
˛osuª
 = 
	`mÆloc
(
size
);

659 i‡(
˛osuª
 =
NULL
)

660  
NULL
;

662 
	`±hªad_muãx_lock
(&
ffi_åampﬁöe_lock
);

665 
ffi_åampﬁöe_èbÀ
 *
èbÀ
 = 
ffi_åampﬁöe_èbÀs
;

666 i‡(
èbÀ
 =
NULL
 ||ÅabÀ->
‰ì_li°
 == NULL) {

667 
èbÀ
 = 
	`ffi_åampﬁöe_èbÀ_Æloc
 ();

668 i‡(
èbÀ
 =
NULL
) {

669 
	`‰ì
(
˛osuª
);

670  
NULL
;

674 
èbÀ
->
√xt
 = 
ffi_åampﬁöe_èbÀs
;

675 i‡(
èbÀ
->
√xt
 !
NULL
)

676 
èbÀ
->
√xt
->
¥ev
 =Åable;

678 
ffi_åampﬁöe_èbÀs
 = 
èbÀ
;

682 
ffi_åampﬁöe_èbÀ_íåy
 *
íåy
 = 
ffi_åampﬁöe_èbÀs
->
‰ì_li°
;

683 
ffi_åampﬁöe_èbÀs
->
‰ì_li°
 = 
íåy
->
√xt
;

684 
ffi_åampﬁöe_èbÀs
->
‰ì_cou¡
--;

685 
íåy
->
√xt
 = 
NULL
;

687 
	`±hªad_muãx_u∆ock
(&
ffi_åampﬁöe_lock
);

690 *
code
 = 
íåy
->
åampﬁöe
;

691 
˛osuª
->
åampﬁöe_èbÀ
 = 
èbÀ
;

692 
˛osuª
->
åampﬁöe_èbÀ_íåy
 = 
íåy
;

694  
˛osuª
;

695 
	}
}

698 
	$ffi_˛osuª_‰ì
 (*
±r
)

700 
ffi_˛osuª
 *
˛osuª
 = 
±r
;

702 
	`±hªad_muãx_lock
(&
ffi_åampﬁöe_lock
);

705 
ffi_åampﬁöe_èbÀ
 *
èbÀ
 = 
˛osuª
->
åampﬁöe_èbÀ
;

706 
ffi_åampﬁöe_èbÀ_íåy
 *
íåy
 = 
˛osuª
->
åampﬁöe_èbÀ_íåy
;

709 
íåy
->
√xt
 = 
èbÀ
->
‰ì_li°
;

710 
èbÀ
->
‰ì_li°
 = 
íåy
;

711 
èbÀ
->
‰ì_cou¡
++;

715 i‡(
èbÀ
->
‰ì_cou¡
 =
FFI_TRAMPOLINE_COUNT
 && 
ffi_åampﬁöe_èbÀs
 !=Åable) {

717 i‡(
èbÀ
->
¥ev
 !
NULL
)

718 
èbÀ
->
¥ev
->
√xt
 =Åable->next;

720 i‡(
èbÀ
->
√xt
 !
NULL
)

721 
èbÀ
->
√xt
->
¥ev
 =Åable->prev;

724 
kîn_ªtu∫_t
 
kt
;

725 
kt
 = 
	`vm_dóŒoˇã
 (
	`mach_èsk_£lf
 (), 
èbÀ
->
c⁄fig_∑ge
, 
PAGE_SIZE
);

726 i‡(
kt
 !
KERN_SUCCESS
)

727 
	`Ârötf
(
°dîr
, "vm_dóŒoˇã(ËÁûuª: %dáà%s:%d\n", 
kt
, 
__FILE__
, 
__LINE__
);

729 
kt
 = 
	`vm_dóŒoˇã
 (
	`mach_èsk_£lf
 (), 
èbÀ
->
åampﬁöe_∑ge
, 
PAGE_SIZE
);

730 i‡(
kt
 !
KERN_SUCCESS
)

731 
	`Ârötf
(
°dîr
, "vm_dóŒoˇã(ËÁûuª: %dáà%s:%d\n", 
kt
, 
__FILE__
, 
__LINE__
);

734 
	`‰ì
 (
èbÀ
->
‰ì_li°_poﬁ
);

735 
	`‰ì
 (
èbÀ
);

736 } i‡(
ffi_åampﬁöe_èbÀs
 !
èbÀ
) {

738 
èbÀ
->
¥ev
 = 
NULL
;

739 
èbÀ
->
√xt
 = 
ffi_åampﬁöe_èbÀs
;

740 i‡(
ffi_åampﬁöe_èbÀs
 !
NULL
)

741 
ffi_åampﬁöe_èbÀs
->
¥ev
 = 
èbÀ
;

743 
ffi_åampﬁöe_èbÀs
 = 
èbÀ
;

746 
	`±hªad_muãx_u∆ock
 (&
ffi_åampﬁöe_lock
);

749 
	`‰ì
 (
˛osuª
);

750 
	}
}

754 
	#FFI_INIT_TRAMPOLINE
(
TRAMP
,
FUN
,
CTX
) \

755 ({ *
__åamp
 = (*)(
TRAMP
); \

756 
__fun
 = ()(
FUN
); \

757 
__˘x
 = ()(
CTX
); \

758 *
ö¢s
 = (*)(
CTX
); \

759 
	`mem˝y
 (
__åamp
, 
ffi_¨m_åampﬁöe
,  ffi_arm_trampoline); \

760 *(*Ë&
__åamp
[12] = 
__˘x
; \

761 *(*Ë&
__åamp
[16] = 
__fun
; \

762 
	`__˛ór_ˇche
((&
__åamp
[0]), (&__tramp[19])); \

763 
	`__˛ór_ˇche
(
ö¢s
, insns + 3 *  ()); \

766 })

	)

772 
ffi_°©us


773 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

774 
ffi_cif
* 
cif
,

775 (*
fun
)(
ffi_cif
*,*,**,*),

776 *
u£r_d©a
,

777 *
codñoc
)

779 (*
˛osuª_func
)(
ffi_˛osuª
*Ë
NULL
;

781 i‡(
cif
->
abi
 =
FFI_SYSV
)

782 
˛osuª_func
 = &
ffi_˛osuª_SYSV
;

783 #ifde‡
__ARM_EABI__


784 i‡(
cif
->
abi
 =
FFI_VFP
)

785 
˛osuª_func
 = &
ffi_˛osuª_VFP
;

788  
FFI_BAD_ABI
;

790 #i‡
FFI_EXEC_TRAMPOLINE_TABLE


791 **
c⁄fig
 = 
	`FFI_TRAMPOLINE_CODELOC_CONFIG
(
codñoc
);

792 
c⁄fig
[0] = 
˛osuª
;

793 
c⁄fig
[1] = 
˛osuª_func
;

795 
	`FFI_INIT_TRAMPOLINE
 (&
˛osuª
->
åamp
[0], \

796 
˛osuª_func
, \

797 
codñoc
);

800 
˛osuª
->
cif
 = cif;

801 
˛osuª
->
u£r_d©a
 = user_data;

802 
˛osuª
->
fun
 = fun;

804  
FFI_OK
;

805 
	}
}

809 
	$ªc_vÂ_ty≥_p
 (
ffi_ty≥
 *
t
, *
ñt
, *
ñnum
)

811 
t
->
ty≥
)

813 
FFI_TYPE_FLOAT
:

814 
FFI_TYPE_DOUBLE
:

815 *
ñt
 = (Ë
t
->
ty≥
;

816 *
ñnum
 = 1;

819 
FFI_TYPE_STRUCT_VFP_FLOAT
:

820 *
ñt
 = 
FFI_TYPE_FLOAT
;

821 *
ñnum
 = 
t
->
size
 /  ();

824 
FFI_TYPE_STRUCT_VFP_DOUBLE
:

825 *
ñt
 = 
FFI_TYPE_DOUBLE
;

826 *
ñnum
 = 
t
->
size
 /  ();

829 
FFI_TYPE_STRUCT
:;

831 
ba£_ñt
 = 0, 
tŸÆ_ñnum
 = 0;

832 
ffi_ty≥
 **
ñ
 = 
t
->
ñemíts
;

833 *
ñ
)

835 
ñ_ñt
 = 0, 
ñ_ñnum
 = 0;

836 i‡(! 
	`ªc_vÂ_ty≥_p
 (*
ñ
, &
ñ_ñt
, &
ñ_ñnum
)

837 || (
ba£_ñt
 && ba£_ñà!
ñ_ñt
)

838 || 
tŸÆ_ñnum
 + 
ñ_ñnum
 > 4)

840 
ba£_ñt
 = 
ñ_ñt
;

841 
tŸÆ_ñnum
 +
ñ_ñnum
;

842 
ñ
++;

844 *
ñnum
 = 
tŸÆ_ñnum
;

845 *
ñt
 = 
ba£_ñt
;

851 
	}
}

853 
	$vÂ_ty≥_p
 (
ffi_ty≥
 *
t
)

855 
ñt
, 
ñnum
;

856 i‡(
	`ªc_vÂ_ty≥_p
 (
t
, &
ñt
, &
ñnum
))

858 i‡(
t
->
ty≥
 =
FFI_TYPE_STRUCT
)

860 i‡(
ñnum
 == 1)

861 
t
->
ty≥
 = 
ñt
;

863 
t
->
ty≥
 = (
ñt
 =
FFI_TYPE_FLOAT


864 ? 
FFI_TYPE_STRUCT_VFP_FLOAT


865 : 
FFI_TYPE_STRUCT_VFP_DOUBLE
);

867  (Ë
t
->
ty≥
;

870 
	}
}

872 
	$∂a˚_vÂ_¨g
 (
ffi_cif
 *
cif
, 
ffi_ty≥
 *
t
)

874 
ªg
 = 
cif
->
vÂ_ªg_‰ì
;

875 
ƒegs
 = 
t
->
size
 /  ();

876 
Æign
 = ((
t
->
ty≥
 =
FFI_TYPE_STRUCT_VFP_FLOAT


877 || 
t
->
ty≥
 =
FFI_TYPE_FLOAT
) ? 1 : 2);

879 i‡((
ªg
 & 1Ë&& 
Æign
 == 2)

880 
ªg
++;

881 
ªg
 + 
ƒegs
 <= 16)

883 
s
, 
√w_u£d
 = 0;

884 
s
 = 
ªg
; s <Ñeg + 
ƒegs
; s++)

886 
√w_u£d
 |(1 << 
s
);

887 i‡(
cif
->
vÂ_u£d
 & (1 << 
s
))

889 
ªg
 +
Æign
;

890 
√xt_ªg
;

894 
cif
->
vÂ_u£d
 |
√w_u£d
;

895 
cif
->
vÂ_¨gs
[cif->
vÂ_«rgs
++] = 
ªg
;

898 i‡(
cif
->
vÂ_u£d
 & (1 << cif->
vÂ_ªg_‰ì
))

900 
ªg
 +
ƒegs
;

901 
cif
->
vÂ_u£d
 & (1 << 
ªg
))

902 
ªg
 += 1;

903 
cif
->
vÂ_ªg_‰ì
 = 
ªg
;

906 
√xt_ªg
: ;

909 
cif
->
vÂ_ªg_‰ì
 = 16;

910 
cif
->
vÂ_u£d
 = 0xFFFF;

912 
	}
}

914 
	$œyout_vÂ_¨gs
 (
ffi_cif
 *
cif
)

916 
i
;

918 
cif
->
vÂ_u£d
 = 0;

919 
cif
->
vÂ_«rgs
 = 0;

920 
cif
->
vÂ_ªg_‰ì
 = 0;

921 
	`mem£t
 (
cif
->
vÂ_¨gs
, -1, 16);

923 
i
 = 0; i < 
cif
->
«rgs
; i++)

925 
ffi_ty≥
 *
t
 = 
cif
->
¨g_ty≥s
[
i
];

926 i‡(
	`vÂ_ty≥_p
 (
t
Ë&& 
	`∂a˚_vÂ_¨g
 (
cif
,Å) == 1)

931 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arm/ffitarget.h

30 #i‚de‡
LIBFFI_TARGET_H


31 
	#LIBFFI_TARGET_H


	)

33 #i‚de‡
LIBFFI_H


37 #i‚de‡
LIBFFI_ASM


38 
	tffi_¨g
;

39 sig√d 
	tffi_ßrg
;

41 
	effi_abi
 {

42 
	mFFI_FIRST_ABI
 = 0,

43 
	mFFI_SYSV
,

44 
	mFFI_VFP
,

45 
	mFFI_LAST_ABI
,

46 #ifde‡
__ARM_PCS_VFP


47 
	mFFI_DEFAULT_ABI
 = 
FFI_VFP
,

49 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV
,

51 } 
	tffi_abi
;

54 
	#FFI_EXTRA_CIF_FIELDS
 \

55 
vÂ_u£d
; \

56 
vÂ_ªg_‰ì
, 
vÂ_«rgs
; \

57 sig√d 
vÂ_¨gs
[16] \

58 

	)

60 
	#FFI_TYPE_STRUCT_VFP_FLOAT
 (
FFI_TYPE_LAST
 + 1)

	)

61 
	#FFI_TYPE_STRUCT_VFP_DOUBLE
 (
FFI_TYPE_LAST
 + 2)

	)

63 
	#FFI_TARGET_SPECIFIC_VARIADIC


	)

67 
	#FFI_CLOSURES
 1

	)

68 
	#FFI_TRAMPOLINE_SIZE
 20

	)

69 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arm/sysv.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

31 #ifde‡
HAVE_MACHINE_ASM_H


32 
	~<machöe/asm.h
>

34 #ifde‡
__USER_LABEL_PREFIX__


35 
	#CONCAT1
(
a
, 
b
Ë
	`CONCAT2
◊, b)

	)

36 
	#CONCAT2
(
a
, 
b
Ë®## 
	)
b

39 
	#CNAME
(
x
Ë
	`CONCAT1
 (
__USER_LABEL_PREFIX__
, x)

	)

41 
	#CNAME
(
x
Ë
	)
x

43 #ifde‡
__APPLE__


44 
	#ENTRY
(
x
Ë.
globl
 
_
##x; _##x:

	)

46 
	#ENTRY
(
x
Ë.
globl
 
	`CNAME
(x); .
ty≥
 CNAME(x),%
fun˘i⁄
; CNAME(x):

	)

50 #ifde‡
__ELF__


51 
	#LSYM
(
x
Ë.
	)
x

53 
	#LSYM
(
x
Ë
	)
x

58 #ifde‡
__APPLE__


59 
	#__SOFTFP__


	)

64 @ 
This
 
£À˘s
 
the
 
möimum
 
¨chôe˘uª
 
Àvñ
 
	gªquúed
.

65 
	#__ARM_ARCH__
 3

	)

67 #i‡
deföed
(
__ARM_ARCH_4__
Ë|| deföed(
__ARM_ARCH_4T__
)

68 #unde‡
__ARM_ARCH__


69 
	#__ARM_ARCH__
 4

	)

72 #i‡
deföed
(
__ARM_ARCH_5__
Ë|| deföed(
__ARM_ARCH_5T__
) \

73 || 
deföed
(
__ARM_ARCH_5E__
Ë|| deföed(
__ARM_ARCH_5TE__
) \

74 || 
	$deföed
(
__ARM_ARCH_5TEJ__
)

75 #unde‡
__ARM_ARCH__


76 
	#__ARM_ARCH__
 5

	)

79 #i‡
	`deföed
(
__ARM_ARCH_6__
Ë|| deföed(
__ARM_ARCH_6J__
) \

80 || 
	`deföed
(
__ARM_ARCH_6K__
Ë|| deföed(
__ARM_ARCH_6Z__
) \

81 || 
	`deföed
(
__ARM_ARCH_6ZK__
Ë|| deföed(
__ARM_ARCH_6T2__
) \

82 || 
	$deföed
(
__ARM_ARCH_6M__
)

83 #unde‡
__ARM_ARCH__


84 
	#__ARM_ARCH__
 6

	)

87 #i‡
	`deföed
(
__ARM_ARCH_7__
Ë|| deföed(
__ARM_ARCH_7A__
) \

88 || 
	`deföed
(
__ARM_ARCH_7R__
Ë|| deföed(
__ARM_ARCH_7M__
) \

89 || 
	$deföed
(
__ARM_ARCH_7EM__
)

90 #unde‡
__ARM_ARCH__


91 
	#__ARM_ARCH__
 7

	)

94 #i‡
__ARM_ARCH__
 >= 5

95 
	#ˇŒ_ªg
(
x
Ë
blx
 
	)
x

96 #ñi‡
	`deföed
 (
__ARM_ARCH_4T__
)

97 
	#ˇŒ_ªg
(
x
Ë
mov
 
Ã
, 
pc
 ; 
bx
 
	)
x

98 #i‡
	`deföed
(
__thumb__
Ë|| deföed(
__THUMB_INTERWORK__
)

99 
	#__INTERWORKING__


	)

102 
	#ˇŒ_ªg
(
x
Ë
mov
 
Ã
, 
pc
 ; movÖc, 
	)
x

106 #ifde‡
__ARM_EABI__


107 
	#UNWIND


	)

109 
	#UNWIND
 @

	)

112 .
sy¡ax
 
unifõd


114 #i‡
	`deföed
(
__thumb__
Ë&& !deföed(
__THUMB_INTERWORK__
)

115 
	#ARM_FUNC_START
(
«me
) \

116 .
ãxt
; \

117 .
Æign
 2; \

118 .
thumb
; \

119 .
thumb_func
; \

120 
	`ENTRY
(
«me
); \

121 
bx
 
pc
; \

122 
n›
; \

123 .
¨m
; \

124 
UNWIND
 .
‚°¨t
; \

125 
_L__
##
«me
:

	)

127 
	#ARM_FUNC_START
(
«me
) \

128 .
ãxt
; \

129 .
Æign
 2; \

130 .
¨m
; \

131 
	`ENTRY
(
«me
); \

132 
UNWIND
 .
‚°¨t


	)

135 .
ma¸o
 
RETLDM
 
ªgs
=, 
c⁄d
=, 
dún
=
ü


136 #i‡
	`deföed
 (
__INTERWORKING__
)

137 .
ifc
 "\regs",""

138 
ldr
\
c⁄d
 
Ã
, [
•
], #4

140 
ldm
\
c⁄d
\
dún
 
•
!, {\
ªgs
, 
Ã
}

141 .
ídif


142 
	gbx
\
c⁄d
 
	gÃ


144 .
	gifc
 "\regs",""

145 
	gldr
\
c⁄d
 
	gpc
, [
•
], #4

147 
	gldm
\
	gc⁄d
\
dún
 
	g•
!, {\
	gªgs
, 
	gpc
}

148 .
	gídif


150 .
	gídm


152 @ 
	gr0
: 
ffi_¥ï_¨gs


153 @ 
r1
: &
ecif


154 @ 
r2
: 
cif
->
byãs


155 @ 
r3
: 
fig
->
Êags


156 @ 
•
+0: 
ecif
.
rvÆue


158 @ 
This
 
assumes
 
we
 
¨e
 
usög
 
gas
.

159 
ARM_FUNC_START
(
ffi_ˇŒ_SYSV
)

160 @ 
Save
 
ªgi°îs


161 
°mfd
 
•
!, {
	gr0
-
	gr3
, 
	gÂ
, 
	gÃ
}

162 
	gUNWIND
 .
	gßve
 {
	gr0
-
	gr3
, 
	gÂ
, 
	gÃ
}

163 
mov
 
	gÂ
, 
•


165 
	gUNWIND
 .
£tÂ
 
	gÂ
, 
	g•


167 @ 
Make
 
room
 
Æl
 
of
 
the
 
√w
 
	g¨gs
.

168 
sub
 
	g•
, 
	gÂ
, 
	gr2


170 @ 
Pœ˚
 
Æl
 
of
 
the
 
ffi_¥ï_¨gs
 
ö
 
posôi⁄


171 
mov
 
	gr0
, 
	g•


172 @ 
r1
 
Æªady
 
	g£t


174 @ 
CÆl
 
	$ffi_¥ï_¨gs
(
°ack
, &
ecif
)

175 
bl
 
	`CNAME
(
ffi_¥ï_¨gs_SYSV
)

177 @ 
move
 
fú°
 4 
∑ømëîs
 
ö
 
ªgi°îs


178 
ldmü
 
•
, {
r0
-
r3
}

180 @ 
™d
 
adju°
 
°ack


181 
sub
 
	gÃ
, 
	gÂ
, 
	g•
 @ 
	gcif
->
	gbyãs
 =
Â
 - 
•


182 
ldr
 
ù
, [
Â
] @ 
lﬂd
 
	$‚
(Ë
ö
 
adv™˚


183 
cmp
 
Ã
, #16

184 
movhs
 
Ã
, #16

185 
add
 
•
, sp, 
Ã


187 @ 
	`ˇŒ
 (
‚
) (...)

188 
	`ˇŒ_ªg
(
ù
)

190 @ 
Remove
 
the
 
•a˚
 
we
 
pushed
 thê
¨gs


191 
mov
 
•
, 
Â


193 @ 
Lﬂd
 
r2
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


194 
ldr
 
r2
, [
•
, #24]

196 @ 
Lﬂd
 
r3
 
wôh
 
the
  
ty≥
 
code


197 
ldr
 
r3
, [
•
, #12]

199 @ 
If
 
the
  
vÆue
 
poöãr
 
is
 
NULL
, 
assume
 
no
  value.

200 
cmp
 
r2
, #0

201 
beq
 
	`LSYM
(
Lïûogue
)

203 @  
INT


204 
cmp
 
r3
, #FFI_TYPE_INT

205 #i‡
	`deföed
(
__SOFTFP__
Ë|| deföed(
__ARM_EABI__
)

206 
cm≤e
 
r3
, #FFI_TYPE_FLOAT

208 
°ªq
 
r0
, [
r2
]

209 
beq
 
	`LSYM
(
Lïûogue
)

211 @  
INT64


212 
cmp
 
r3
, #FFI_TYPE_SINT64

213 #i‡
	`deföed
(
__SOFTFP__
Ë|| deföed(
__ARM_EABI__
)

214 
cm≤e
 
r3
, #FFI_TYPE_DOUBLE

216 
°müeq
 
r2
, {
r0
, 
r1
}

218 #i‡!
deföed
(
__SOFTFP__
Ë&& !deföed(
__ARM_EABI__
)

219 
beq
 
LSYM
(
Lïûogue
)

221 @  
FLOAT


222 
cmp
 
	gr3
, #FFI_TYPE_FLOAT

223 
°„qs
 
	gf0
, [
r2
]

224 
beq
 
LSYM
(
Lïûogue
)

226 @  
DOUBLE
 
‹
 
LONGDOUBLE


227 
cmp
 
	gr3
, #FFI_TYPE_DOUBLE

228 
°„qd
 
	gf0
, [
r2
]

231 
	$LSYM
(
Lïûogue
):

232 #i‡
	`deföed
 (
__INTERWORKING__
)

233 
ldmü
 
•
!, {
r0
-
r3
,
Â
, 
Ã
}

234 
bx
 
	gÃ


236 
ldmü
 
	g•
!, {
	gr0
-
	gr3
,
	gÂ
, 
	gpc
}

239 .
	gffi_ˇŒ_SYSV_íd
:

240 
UNWIND
 .
‚íd


241 #ifde‡
__ELF__


242 .
size
 
CNAME
(
ffi_ˇŒ_SYSV
),.
	gffi_ˇŒ_SYSV_íd
-
	$CNAME
(
ffi_ˇŒ_SYSV
)

254 
	$ARM_FUNC_START
(
ffi_˛osuª_SYSV
)

255 
UNWIND
 .
∑d
 #16

256 
add
 
ù
, 
•
, #16

257 
°mfd
 
•
!, {
ù
, 
Ã
}

258 
	gUNWIND
 .
	gßve
 {
	gr0
, 
	gÃ
}

259 
add
 
	gr2
, 
	g•
, #8

260 
	gUNWIND
 .
	g∑d
 #16

261 
sub
 
	g•
, sp, #16

262 
°r
 
	g•
, [
•
, #8]

263 
add
 
	gr1
, 
	g•
, #8

264 
bl
 
	$CNAME
(
ffi_˛osuª_ö√r
)

265 
cmp
 
r0
, #FFI_TYPE_INT

266 
beq
 .
Lªtöt


268 
cmp
 
r0
, #FFI_TYPE_FLOAT

269 #i‡
	`deföed
(
__SOFTFP__
Ë|| deföed(
__ARM_EABI__
)

270 
beq
 .
Lªtöt


272 
beq
 .
LªtÊﬂt


275 
cmp
 
r0
, #FFI_TYPE_DOUBLE

276 #i‡
	`deföed
(
__SOFTFP__
Ë|| deföed(
__ARM_EABI__
)

277 
beq
 .
Lªé⁄gl⁄g


279 
beq
 .
LªtdoubÀ


282 
cmp
 
r0
, #FFI_TYPE_LONGDOUBLE

283 #i‡
	`deföed
(
__SOFTFP__
Ë|| deföed(
__ARM_EABI__
)

284 
beq
 .
Lªé⁄gl⁄g


286 
beq
 .
Lªé⁄gdoubÀ


289 
cmp
 
r0
, #FFI_TYPE_SINT64

290 
beq
 .
Lªé⁄gl⁄g


291 .
L˛osuª_ïûogue
:

292 
add
 
•
, sp, #16

293 
ldmfd
 
•
, {•, 
pc
}

294 .
	gLªtöt
:

295 
ldr
 
r0
, [
•
]

296 
	gb
 .
	gL˛osuª_ïûogue


297 .
	gLªé⁄gl⁄g
:

298 
ldr
 
r0
, [
•
]

299 
ldr
 
	gr1
, [
•
, #4]

300 
	gb
 .
	gL˛osuª_ïûogue


302 #i‡!
deföed
(
__SOFTFP__
Ë&& !deföed(
__ARM_EABI__
)

303 .
	gLªtÊﬂt
:

304 
ldfs
 
f0
, [
•
]

305 
	gb
 .
	gL˛osuª_ïûogue


306 .
	gLªtdoubÀ
:

307 
ldfd
 
f0
, [
•
]

308 
	gb
 .
	gL˛osuª_ïûogue


309 .
	gLªé⁄gdoubÀ
:

310 
ldfd
 
f0
, [
•
]

311 
	gb
 .
	gL˛osuª_ïûogue


314 .
	gffi_˛osuª_SYSV_íd
:

315 
UNWIND
 .
‚íd


316 #ifde‡
__ELF__


317 .
size
 
CNAME
(
ffi_˛osuª_SYSV
),.
	gffi_˛osuª_SYSV_íd
-
	$CNAME
(
ffi_˛osuª_SYSV
)

324 #ifde‡
__ARM_EABI__


325 .
Âu
 
vÂ


327 @ 
r0
: 
‚


328 @ 
r1
: &
ecif


329 @ 
r2
: 
cif
->
byãs


330 @ 
r3
: 
fig
->
Êags


331 @ 
•
+0: 
ecif
.
rvÆue


333 
	`ARM_FUNC_START
(
ffi_ˇŒ_VFP
)

334 @ 
Save
 
ªgi°îs


335 
°mfd
 
•
!, {
r0
-
r3
, 
Â
, 
Ã
}

336 
	gUNWIND
 .
	gßve
 {
	gr0
-
	gr3
, 
	gÂ
, 
	gÃ
}

337 
mov
 
	gÂ
, 
•


338 
	gUNWIND
 .
£tÂ
 
	gÂ
, 
	g•


340 @ 
Make
 
room
 
Æl
 
of
 
the
 
√w
 
	g¨gs
.

341 
sub
 
	g•
, sp, 
	gr2


343 @ 
Make
 
room
 
lﬂdög
 
VFP
 
¨gs


344 
sub
 
	g•
, sp, #64

346 @ 
Pœ˚
 
Æl
 
of
 
the
 
ffi_¥ï_¨gs
 
ö
 
posôi⁄


347 
mov
 
	gr0
, 
	g•


348 @ 
r1
 
Æªady
 
£t


349 
sub
 
	gr2
, 
	gÂ
, #64 @ 
VFP
 
s¸©ch
 
	g•a˚


351 @ 
CÆl
 
	$ffi_¥ï_¨gs
(
°ack
, &
ecif
, 
vÂ_•a˚
)

352 
bl
 
	`CNAME
(
ffi_¥ï_¨gs_VFP
)

354 @ 
Lﬂd
 
VFP
 
¨gs
 
√eded


355 
cmp
 
r0
, #0

356 
mov
 
ù
, 
Â


357 
beq
 
	`LSYM
(
Lba£_¨gs
)

359 @ 
Lﬂd
 
⁄ly
 
d0
 
possibÀ


360 
cmp
 
r0
, #3

361 
sub
 
ù
, 
Â
, #64

362 
ÊddÀ
 
d0
, [
ù
]

363 
Êdmüdgt
 
ù
, {
d0
-
d7
}

365 
	$LSYM
(
Lba£_¨gs
):

366 @ 
move
 
fú°
 4 
∑ømëîs
 
ö
 
ªgi°îs


367 
ldmü
 
•
, {
r0
-
r3
}

369 @ 
™d
 
adju°
 
°ack


370 
sub
 
	gÃ
, 
	gù
, 
	g•
 @ 
	gcif
->
	gbyãs
 =(
Â
 - 64Ë- 
•


371 
ldr
 
ù
, [
Â
] @ 
lﬂd
 
	$‚
(Ë
ö
 
adv™˚


372 
cmp
 
Ã
, #16

373 
movhs
 
Ã
, #16

374 
add
 
•
, sp, 
Ã


376 @ 
	`ˇŒ
 (
‚
) (...)

377 
	`ˇŒ_ªg
(
ù
)

379 @ 
Remove
 
the
 
•a˚
 
we
 
pushed
 thê
¨gs


380 
mov
 
•
, 
Â


382 @ 
Lﬂd
 
r2
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 

383 @ 
the
  
vÆue


384 
ldr
 
r2
, [
•
, #24]

386 @ 
Lﬂd
 
r3
 
wôh
 
the
  
ty≥
 
code


387 
ldr
 
r3
, [
•
, #12]

389 @ 
If
 
the
  
vÆue
 
poöãr
 
is
 
NULL
,

390 @ 
assume
 
no
  
vÆue
.

391 
cmp
 
r2
, #0

392 
beq
 
	$LSYM
(
Lïûogue_vÂ
)

394 
cmp
 
r3
, #FFI_TYPE_INT

395 
°ªq
 
r0
, [
r2
]

396 
beq
 
	$LSYM
(
Lïûogue_vÂ
)

398 
cmp
 
r3
, #FFI_TYPE_SINT64

399 
°meqü
 
r2
, {
r0
, 
r1
}

400 
beq
 
	$LSYM
(
Lïûogue_vÂ
)

402 
cmp
 
r3
, #FFI_TYPE_FLOAT

403 
f°£q
 
s0
, [
r2
]

404 
beq
 
	$LSYM
(
Lïûogue_vÂ
)

406 
cmp
 
r3
, #FFI_TYPE_DOUBLE

407 
f°deq
 
d0
, [
r2
]

408 
beq
 
	$LSYM
(
Lïûogue_vÂ
)

410 
cmp
 
r3
, #FFI_TYPE_STRUCT_VFP_FLOAT

411 
cm≤e
 
r3
, #FFI_TYPE_STRUCT_VFP_DOUBLE

412 
f°müdeq
 
r2
, {
d0
-
d3
}

414 
	$LSYM
(
Lïûogue_vÂ
):

415 
RETLDM
 "r0-r3,fp"

417 .
ffi_ˇŒ_VFP_íd
:

418 
UNWIND
 .
‚íd


419 .
size
 
	`CNAME
(
ffi_ˇŒ_VFP
),.
ffi_ˇŒ_VFP_íd
-
	$CNAME
(
ffi_ˇŒ_VFP
)

422 
	$ARM_FUNC_START
(
ffi_˛osuª_VFP
)

423 
f°mfdd
 
•
!, {
d0
-
d7
}

424 @ 
	gr0
-
	gr3
, 
thí
 
	gd0
-
d7


425 
	gUNWIND
 .
	g∑d
 #80

426 
add
 
	gù
, 
	g•
, #80

427 
°mfd
 
	g•
!, {
	gù
, 
	gÃ
}

428 
	gUNWIND
 .
	gßve
 {
	gr0
, 
	gÃ
}

429 
add
 
	gr2
, 
	g•
, #72

430 
add
 
	gr3
, 
	g•
, #8

431 
	gUNWIND
 .
	g∑d
 #72

432 
sub
 
	g•
, sp, #72

433 
°r
 
	g•
, [
•
, #64]

434 
add
 
	gr1
, 
	g•
, #64

435 
bl
 
	$CNAME
(
ffi_˛osuª_ö√r
)

437 
cmp
 
r0
, #FFI_TYPE_INT

438 
beq
 .
Lªtöt_vÂ


440 
cmp
 
r0
, #FFI_TYPE_FLOAT

441 
beq
 .
LªtÊﬂt_vÂ


443 
cmp
 
r0
, #FFI_TYPE_DOUBLE

444 
cm≤e
 
r0
, #FFI_TYPE_LONGDOUBLE

445 
beq
 .
LªtdoubÀ_vÂ


447 
cmp
 
r0
, #FFI_TYPE_SINT64

448 
beq
 .
Lªé⁄gl⁄g_vÂ


450 
cmp
 
r0
, #FFI_TYPE_STRUCT_VFP_FLOAT

451 
beq
 .
LªtÊﬂt_°ru˘_vÂ


453 
cmp
 
r0
, #FFI_TYPE_STRUCT_VFP_DOUBLE

454 
beq
 .
LªtdoubÀ_°ru˘_vÂ


456 .
L˛osuª_ïûogue_vÂ
:

457 
add
 
•
, sp, #72

458 
ldmfd
 
•
, {•, 
pc
}

460 .
	gLªtÊﬂt_vÂ
:

461 
Êds
 
s0
, [
•
]

462 
	gb
 .
	gL˛osuª_ïûogue_vÂ


463 .
	gLªtdoubÀ_vÂ
:

464 
Êdd
 
d0
, [
•
]

465 
	gb
 .
	gL˛osuª_ïûogue_vÂ


466 .
	gLªtöt_vÂ
:

467 
ldr
 
r0
, [
•
]

468 
	gb
 .
	gL˛osuª_ïûogue_vÂ


469 .
	gLªé⁄gl⁄g_vÂ
:

470 
ldmü
 
•
, {
	gr0
, 
	gr1
}

471 
	gb
 .
	gL˛osuª_ïûogue_vÂ


472 .
	gLªtÊﬂt_°ru˘_vÂ
:

473 
Êdmüd
 
•
, {
	gd0
-
	gd1
}

474 
	gb
 .
	gL˛osuª_ïûogue_vÂ


475 .
	gLªtdoubÀ_°ru˘_vÂ
:

476 
Êdmüd
 
•
, {
	gd0
-
	gd3
}

477 
	gb
 .
	gL˛osuª_ïûogue_vÂ


479 .
	gffi_˛osuª_VFP_íd
:

480 
UNWIND
 .
‚íd


481 .
size
 
CNAME
(
ffi_˛osuª_VFP
),.
	gffi_˛osuª_VFP_íd
-
	$CNAME
(
ffi_˛osuª_VFP
)

484 
	$ENTRY
(
ffi_¨m_åampﬁöe
)

485 
°mfd
 
•
!, {
r0
-
r3
}

486 
ldr
 
	gr0
, [
pc
]

487 
ldr
 
	gpc
, [
pc
]

489 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


490 .
	g£˘i⁄
 .
	gnŸe
.
	gGNU
-
	g°ack
,"",%
	g¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arm/trampoline.S

1 #GENERATED 
CODE
 - 
DO
 
NOT
 
EDIT


2 #Thi†
fûe
 
was
 
gíî©ed
 
by
 
§c
/
¨m
/
gíåamp
.
sh


4 #C›yrighà(
c
Ë2010, 
PœusibÀ
 
Labs
 
Co›î©ive
, 
Inc
.

5 #
#Pîmissi⁄ 
is
 
hîeby
 
gø¡ed
, 
‰ì
 
of
 
ch¨ge
, 
to
 
™y
 
≥rs⁄
 
obèöög


7 #®
c›y
 
of
 
this
 
so·w¨e
 
™d
 
assocüãd
 
documíèti⁄
 
fûes
 (
the


8 #So·w¨e''), 
to
 
dól
 
ö
 
the
 
So·w¨e
 
wôhout
 
ª°ri˘i⁄
, 
ö˛udög


9 #wôhouà
limô©i⁄
 
the
 
rights
 
to
 
u£
, 
c›y
, 
modify
, 
mîge
, 
publish
,

10 #di°ribuã, 
subli˚n£
, 
™d
/
‹
 
£Œ
 
c›õs
 
of
 
the
 
So·w¨e
,ánd 
to


11 #≥rmô 
≥rs⁄s
 
to
 
whom
 
the
 
So·w¨e
 
is
 
fu∫ished
Åÿdÿ
so
, 
subje˘
Åo

12 #thê
fﬁlowög
 
c⁄dôi⁄s
:

13 #
#Thê
above
 
c›yright
 
nŸi˚
 
™d
 
this
 
≥rmissi⁄
ÇŸi˚ 
shÆl
 
be
 
ö˛uded


15 #ö 
Æl
 
c›õs
 
‹
 
sub°™tül
 
p‹ti⁄s
 
of
 
the
 
So·w¨e
.

16 #
#THE 
SOFTWARE
 
IS
 
PROVIDED
 
AS
 IS'', 
WITHOUT
 
WARRANTY
 
OF
 
ANY
 
KIND
,

18 #EXPRESS 
OR
 
IMPLIED
, 
INCLUDING
 
BUT
 
NOT
 
LIMITED
 
TO
 
THE
 
WARRANTIES
 
OF


19 #MERCHANTABILITY, 
FITNESS
 
FOR
 
A
 
PARTICULAR
 
PURPOSE
 
AND


20 #NONINFRINGEMENT. 
IN
 
NO
 
EVENT
 
SHALL
 
THE
 
AUTHORS
 
OR
 
COPYRIGHT


21 #HOLDERS 
BE
 
LIABLE
 
FOR
 
ANY
 
CLAIM
, 
DAMAGES
 
OR
 
OTHER
 
LIABILITY
,

22 #WHETHER 
IN
 
AN
 
ACTION
 
OF
 
CONTRACT
, 
TORT
 
OR
 
OTHERWISE
, 
ARISING
 
FROM
,

23 #OUT 
OF
 
OR
 
IN
 
CONNECTION
 
WITH
 
THE
 
SOFTWARE
 OR THE 
USE
 OR 
OTHER


24 #DEALINGS 
IN
 
THE
 
SOFTWARE
.

27 .
	gãxt


28 .
	gÆign
 12

29 .
globl
 
_ffi_˛osuª_åampﬁöe_èbÀ_∑ge


30 
	g_ffi_˛osuª_åampﬁöe_èbÀ_∑ge
:

34 
°mfd
 
•
!, {
	gr0
-
	gr3
}

39 
ldr
 
	gr0
, [
pc
, #-4092]

42 
ldr
 
	gpc
, [
pc
, #-4092]

47 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

52 
ldr
 
	gr0
, [
pc
, #-4092]

55 
ldr
 
	gpc
, [
pc
, #-4092]

60 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

65 
ldr
 
	gr0
, [
pc
, #-4092]

68 
ldr
 
	gpc
, [
pc
, #-4092]

73 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

78 
ldr
 
	gr0
, [
pc
, #-4092]

81 
ldr
 
	gpc
, [
pc
, #-4092]

86 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

91 
ldr
 
	gr0
, [
pc
, #-4092]

94 
ldr
 
	gpc
, [
pc
, #-4092]

99 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

104 
ldr
 
	gr0
, [
pc
, #-4092]

107 
ldr
 
	gpc
, [
pc
, #-4092]

112 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

117 
ldr
 
	gr0
, [
pc
, #-4092]

120 
ldr
 
	gpc
, [
pc
, #-4092]

125 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

130 
ldr
 
	gr0
, [
pc
, #-4092]

133 
ldr
 
	gpc
, [
pc
, #-4092]

138 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

143 
ldr
 
	gr0
, [
pc
, #-4092]

146 
ldr
 
	gpc
, [
pc
, #-4092]

151 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

156 
ldr
 
	gr0
, [
pc
, #-4092]

159 
ldr
 
	gpc
, [
pc
, #-4092]

164 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

169 
ldr
 
	gr0
, [
pc
, #-4092]

172 
ldr
 
	gpc
, [
pc
, #-4092]

177 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

182 
ldr
 
	gr0
, [
pc
, #-4092]

185 
ldr
 
	gpc
, [
pc
, #-4092]

190 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

195 
ldr
 
	gr0
, [
pc
, #-4092]

198 
ldr
 
	gpc
, [
pc
, #-4092]

203 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

208 
ldr
 
	gr0
, [
pc
, #-4092]

211 
ldr
 
	gpc
, [
pc
, #-4092]

216 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

221 
ldr
 
	gr0
, [
pc
, #-4092]

224 
ldr
 
	gpc
, [
pc
, #-4092]

229 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

234 
ldr
 
	gr0
, [
pc
, #-4092]

237 
ldr
 
	gpc
, [
pc
, #-4092]

242 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

247 
ldr
 
	gr0
, [
pc
, #-4092]

250 
ldr
 
	gpc
, [
pc
, #-4092]

255 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

260 
ldr
 
	gr0
, [
pc
, #-4092]

263 
ldr
 
	gpc
, [
pc
, #-4092]

268 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

273 
ldr
 
	gr0
, [
pc
, #-4092]

276 
ldr
 
	gpc
, [
pc
, #-4092]

281 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

286 
ldr
 
	gr0
, [
pc
, #-4092]

289 
ldr
 
	gpc
, [
pc
, #-4092]

294 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

299 
ldr
 
	gr0
, [
pc
, #-4092]

302 
ldr
 
	gpc
, [
pc
, #-4092]

307 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

312 
ldr
 
	gr0
, [
pc
, #-4092]

315 
ldr
 
	gpc
, [
pc
, #-4092]

320 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

325 
ldr
 
	gr0
, [
pc
, #-4092]

328 
ldr
 
	gpc
, [
pc
, #-4092]

333 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

338 
ldr
 
	gr0
, [
pc
, #-4092]

341 
ldr
 
	gpc
, [
pc
, #-4092]

346 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

351 
ldr
 
	gr0
, [
pc
, #-4092]

354 
ldr
 
	gpc
, [
pc
, #-4092]

359 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

364 
ldr
 
	gr0
, [
pc
, #-4092]

367 
ldr
 
	gpc
, [
pc
, #-4092]

372 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

377 
ldr
 
	gr0
, [
pc
, #-4092]

380 
ldr
 
	gpc
, [
pc
, #-4092]

385 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

390 
ldr
 
	gr0
, [
pc
, #-4092]

393 
ldr
 
	gpc
, [
pc
, #-4092]

398 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

403 
ldr
 
	gr0
, [
pc
, #-4092]

406 
ldr
 
	gpc
, [
pc
, #-4092]

411 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

416 
ldr
 
	gr0
, [
pc
, #-4092]

419 
ldr
 
	gpc
, [
pc
, #-4092]

424 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

429 
ldr
 
	gr0
, [
pc
, #-4092]

432 
ldr
 
	gpc
, [
pc
, #-4092]

437 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

442 
ldr
 
	gr0
, [
pc
, #-4092]

445 
ldr
 
	gpc
, [
pc
, #-4092]

450 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

455 
ldr
 
	gr0
, [
pc
, #-4092]

458 
ldr
 
	gpc
, [
pc
, #-4092]

463 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

468 
ldr
 
	gr0
, [
pc
, #-4092]

471 
ldr
 
	gpc
, [
pc
, #-4092]

476 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

481 
ldr
 
	gr0
, [
pc
, #-4092]

484 
ldr
 
	gpc
, [
pc
, #-4092]

489 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

494 
ldr
 
	gr0
, [
pc
, #-4092]

497 
ldr
 
	gpc
, [
pc
, #-4092]

502 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

507 
ldr
 
	gr0
, [
pc
, #-4092]

510 
ldr
 
	gpc
, [
pc
, #-4092]

515 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

520 
ldr
 
	gr0
, [
pc
, #-4092]

523 
ldr
 
	gpc
, [
pc
, #-4092]

528 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

533 
ldr
 
	gr0
, [
pc
, #-4092]

536 
ldr
 
	gpc
, [
pc
, #-4092]

541 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

546 
ldr
 
	gr0
, [
pc
, #-4092]

549 
ldr
 
	gpc
, [
pc
, #-4092]

554 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

559 
ldr
 
	gr0
, [
pc
, #-4092]

562 
ldr
 
	gpc
, [
pc
, #-4092]

567 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

572 
ldr
 
	gr0
, [
pc
, #-4092]

575 
ldr
 
	gpc
, [
pc
, #-4092]

580 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

585 
ldr
 
	gr0
, [
pc
, #-4092]

588 
ldr
 
	gpc
, [
pc
, #-4092]

593 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

598 
ldr
 
	gr0
, [
pc
, #-4092]

601 
ldr
 
	gpc
, [
pc
, #-4092]

606 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

611 
ldr
 
	gr0
, [
pc
, #-4092]

614 
ldr
 
	gpc
, [
pc
, #-4092]

619 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

624 
ldr
 
	gr0
, [
pc
, #-4092]

627 
ldr
 
	gpc
, [
pc
, #-4092]

632 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

637 
ldr
 
	gr0
, [
pc
, #-4092]

640 
ldr
 
	gpc
, [
pc
, #-4092]

645 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

650 
ldr
 
	gr0
, [
pc
, #-4092]

653 
ldr
 
	gpc
, [
pc
, #-4092]

658 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

663 
ldr
 
	gr0
, [
pc
, #-4092]

666 
ldr
 
	gpc
, [
pc
, #-4092]

671 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

676 
ldr
 
	gr0
, [
pc
, #-4092]

679 
ldr
 
	gpc
, [
pc
, #-4092]

684 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

689 
ldr
 
	gr0
, [
pc
, #-4092]

692 
ldr
 
	gpc
, [
pc
, #-4092]

697 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

702 
ldr
 
	gr0
, [
pc
, #-4092]

705 
ldr
 
	gpc
, [
pc
, #-4092]

710 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

715 
ldr
 
	gr0
, [
pc
, #-4092]

718 
ldr
 
	gpc
, [
pc
, #-4092]

723 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

728 
ldr
 
	gr0
, [
pc
, #-4092]

731 
ldr
 
	gpc
, [
pc
, #-4092]

736 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

741 
ldr
 
	gr0
, [
pc
, #-4092]

744 
ldr
 
	gpc
, [
pc
, #-4092]

749 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

754 
ldr
 
	gr0
, [
pc
, #-4092]

757 
ldr
 
	gpc
, [
pc
, #-4092]

762 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

767 
ldr
 
	gr0
, [
pc
, #-4092]

770 
ldr
 
	gpc
, [
pc
, #-4092]

775 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

780 
ldr
 
	gr0
, [
pc
, #-4092]

783 
ldr
 
	gpc
, [
pc
, #-4092]

788 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

793 
ldr
 
	gr0
, [
pc
, #-4092]

796 
ldr
 
	gpc
, [
pc
, #-4092]

801 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

806 
ldr
 
	gr0
, [
pc
, #-4092]

809 
ldr
 
	gpc
, [
pc
, #-4092]

814 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

819 
ldr
 
	gr0
, [
pc
, #-4092]

822 
ldr
 
	gpc
, [
pc
, #-4092]

827 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

832 
ldr
 
	gr0
, [
pc
, #-4092]

835 
ldr
 
	gpc
, [
pc
, #-4092]

840 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

845 
ldr
 
	gr0
, [
pc
, #-4092]

848 
ldr
 
	gpc
, [
pc
, #-4092]

853 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

858 
ldr
 
	gr0
, [
pc
, #-4092]

861 
ldr
 
	gpc
, [
pc
, #-4092]

866 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

871 
ldr
 
	gr0
, [
pc
, #-4092]

874 
ldr
 
	gpc
, [
pc
, #-4092]

879 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

884 
ldr
 
	gr0
, [
pc
, #-4092]

887 
ldr
 
	gpc
, [
pc
, #-4092]

892 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

897 
ldr
 
	gr0
, [
pc
, #-4092]

900 
ldr
 
	gpc
, [
pc
, #-4092]

905 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

910 
ldr
 
	gr0
, [
pc
, #-4092]

913 
ldr
 
	gpc
, [
pc
, #-4092]

918 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

923 
ldr
 
	gr0
, [
pc
, #-4092]

926 
ldr
 
	gpc
, [
pc
, #-4092]

931 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

936 
ldr
 
	gr0
, [
pc
, #-4092]

939 
ldr
 
	gpc
, [
pc
, #-4092]

944 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

949 
ldr
 
	gr0
, [
pc
, #-4092]

952 
ldr
 
	gpc
, [
pc
, #-4092]

957 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

962 
ldr
 
	gr0
, [
pc
, #-4092]

965 
ldr
 
	gpc
, [
pc
, #-4092]

970 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

975 
ldr
 
	gr0
, [
pc
, #-4092]

978 
ldr
 
	gpc
, [
pc
, #-4092]

983 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

988 
ldr
 
	gr0
, [
pc
, #-4092]

991 
ldr
 
	gpc
, [
pc
, #-4092]

996 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1001 
ldr
 
	gr0
, [
pc
, #-4092]

1004 
ldr
 
	gpc
, [
pc
, #-4092]

1009 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1014 
ldr
 
	gr0
, [
pc
, #-4092]

1017 
ldr
 
	gpc
, [
pc
, #-4092]

1022 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1027 
ldr
 
	gr0
, [
pc
, #-4092]

1030 
ldr
 
	gpc
, [
pc
, #-4092]

1035 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1040 
ldr
 
	gr0
, [
pc
, #-4092]

1043 
ldr
 
	gpc
, [
pc
, #-4092]

1048 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1053 
ldr
 
	gr0
, [
pc
, #-4092]

1056 
ldr
 
	gpc
, [
pc
, #-4092]

1061 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1066 
ldr
 
	gr0
, [
pc
, #-4092]

1069 
ldr
 
	gpc
, [
pc
, #-4092]

1074 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1079 
ldr
 
	gr0
, [
pc
, #-4092]

1082 
ldr
 
	gpc
, [
pc
, #-4092]

1087 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1092 
ldr
 
	gr0
, [
pc
, #-4092]

1095 
ldr
 
	gpc
, [
pc
, #-4092]

1100 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1105 
ldr
 
	gr0
, [
pc
, #-4092]

1108 
ldr
 
	gpc
, [
pc
, #-4092]

1113 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1118 
ldr
 
	gr0
, [
pc
, #-4092]

1121 
ldr
 
	gpc
, [
pc
, #-4092]

1126 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1131 
ldr
 
	gr0
, [
pc
, #-4092]

1134 
ldr
 
	gpc
, [
pc
, #-4092]

1139 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1144 
ldr
 
	gr0
, [
pc
, #-4092]

1147 
ldr
 
	gpc
, [
pc
, #-4092]

1152 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1157 
ldr
 
	gr0
, [
pc
, #-4092]

1160 
ldr
 
	gpc
, [
pc
, #-4092]

1165 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1170 
ldr
 
	gr0
, [
pc
, #-4092]

1173 
ldr
 
	gpc
, [
pc
, #-4092]

1178 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1183 
ldr
 
	gr0
, [
pc
, #-4092]

1186 
ldr
 
	gpc
, [
pc
, #-4092]

1191 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1196 
ldr
 
	gr0
, [
pc
, #-4092]

1199 
ldr
 
	gpc
, [
pc
, #-4092]

1204 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1209 
ldr
 
	gr0
, [
pc
, #-4092]

1212 
ldr
 
	gpc
, [
pc
, #-4092]

1217 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1222 
ldr
 
	gr0
, [
pc
, #-4092]

1225 
ldr
 
	gpc
, [
pc
, #-4092]

1230 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1235 
ldr
 
	gr0
, [
pc
, #-4092]

1238 
ldr
 
	gpc
, [
pc
, #-4092]

1243 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1248 
ldr
 
	gr0
, [
pc
, #-4092]

1251 
ldr
 
	gpc
, [
pc
, #-4092]

1256 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1261 
ldr
 
	gr0
, [
pc
, #-4092]

1264 
ldr
 
	gpc
, [
pc
, #-4092]

1269 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1274 
ldr
 
	gr0
, [
pc
, #-4092]

1277 
ldr
 
	gpc
, [
pc
, #-4092]

1282 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1287 
ldr
 
	gr0
, [
pc
, #-4092]

1290 
ldr
 
	gpc
, [
pc
, #-4092]

1295 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1300 
ldr
 
	gr0
, [
pc
, #-4092]

1303 
ldr
 
	gpc
, [
pc
, #-4092]

1308 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1313 
ldr
 
	gr0
, [
pc
, #-4092]

1316 
ldr
 
	gpc
, [
pc
, #-4092]

1321 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1326 
ldr
 
	gr0
, [
pc
, #-4092]

1329 
ldr
 
	gpc
, [
pc
, #-4092]

1334 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1339 
ldr
 
	gr0
, [
pc
, #-4092]

1342 
ldr
 
	gpc
, [
pc
, #-4092]

1347 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1352 
ldr
 
	gr0
, [
pc
, #-4092]

1355 
ldr
 
	gpc
, [
pc
, #-4092]

1360 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1365 
ldr
 
	gr0
, [
pc
, #-4092]

1368 
ldr
 
	gpc
, [
pc
, #-4092]

1373 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1378 
ldr
 
	gr0
, [
pc
, #-4092]

1381 
ldr
 
	gpc
, [
pc
, #-4092]

1386 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1391 
ldr
 
	gr0
, [
pc
, #-4092]

1394 
ldr
 
	gpc
, [
pc
, #-4092]

1399 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1404 
ldr
 
	gr0
, [
pc
, #-4092]

1407 
ldr
 
	gpc
, [
pc
, #-4092]

1412 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1417 
ldr
 
	gr0
, [
pc
, #-4092]

1420 
ldr
 
	gpc
, [
pc
, #-4092]

1425 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1430 
ldr
 
	gr0
, [
pc
, #-4092]

1433 
ldr
 
	gpc
, [
pc
, #-4092]

1438 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1443 
ldr
 
	gr0
, [
pc
, #-4092]

1446 
ldr
 
	gpc
, [
pc
, #-4092]

1451 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1456 
ldr
 
	gr0
, [
pc
, #-4092]

1459 
ldr
 
	gpc
, [
pc
, #-4092]

1464 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1469 
ldr
 
	gr0
, [
pc
, #-4092]

1472 
ldr
 
	gpc
, [
pc
, #-4092]

1477 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1482 
ldr
 
	gr0
, [
pc
, #-4092]

1485 
ldr
 
	gpc
, [
pc
, #-4092]

1490 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1495 
ldr
 
	gr0
, [
pc
, #-4092]

1498 
ldr
 
	gpc
, [
pc
, #-4092]

1503 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1508 
ldr
 
	gr0
, [
pc
, #-4092]

1511 
ldr
 
	gpc
, [
pc
, #-4092]

1516 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1521 
ldr
 
	gr0
, [
pc
, #-4092]

1524 
ldr
 
	gpc
, [
pc
, #-4092]

1529 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1534 
ldr
 
	gr0
, [
pc
, #-4092]

1537 
ldr
 
	gpc
, [
pc
, #-4092]

1542 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1547 
ldr
 
	gr0
, [
pc
, #-4092]

1550 
ldr
 
	gpc
, [
pc
, #-4092]

1555 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1560 
ldr
 
	gr0
, [
pc
, #-4092]

1563 
ldr
 
	gpc
, [
pc
, #-4092]

1568 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1573 
ldr
 
	gr0
, [
pc
, #-4092]

1576 
ldr
 
	gpc
, [
pc
, #-4092]

1581 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1586 
ldr
 
	gr0
, [
pc
, #-4092]

1589 
ldr
 
	gpc
, [
pc
, #-4092]

1594 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1599 
ldr
 
	gr0
, [
pc
, #-4092]

1602 
ldr
 
	gpc
, [
pc
, #-4092]

1607 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1612 
ldr
 
	gr0
, [
pc
, #-4092]

1615 
ldr
 
	gpc
, [
pc
, #-4092]

1620 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1625 
ldr
 
	gr0
, [
pc
, #-4092]

1628 
ldr
 
	gpc
, [
pc
, #-4092]

1633 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1638 
ldr
 
	gr0
, [
pc
, #-4092]

1641 
ldr
 
	gpc
, [
pc
, #-4092]

1646 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1651 
ldr
 
	gr0
, [
pc
, #-4092]

1654 
ldr
 
	gpc
, [
pc
, #-4092]

1659 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1664 
ldr
 
	gr0
, [
pc
, #-4092]

1667 
ldr
 
	gpc
, [
pc
, #-4092]

1672 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1677 
ldr
 
	gr0
, [
pc
, #-4092]

1680 
ldr
 
	gpc
, [
pc
, #-4092]

1685 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1690 
ldr
 
	gr0
, [
pc
, #-4092]

1693 
ldr
 
	gpc
, [
pc
, #-4092]

1698 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1703 
ldr
 
	gr0
, [
pc
, #-4092]

1706 
ldr
 
	gpc
, [
pc
, #-4092]

1711 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1716 
ldr
 
	gr0
, [
pc
, #-4092]

1719 
ldr
 
	gpc
, [
pc
, #-4092]

1724 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1729 
ldr
 
	gr0
, [
pc
, #-4092]

1732 
ldr
 
	gpc
, [
pc
, #-4092]

1737 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1742 
ldr
 
	gr0
, [
pc
, #-4092]

1745 
ldr
 
	gpc
, [
pc
, #-4092]

1750 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1755 
ldr
 
	gr0
, [
pc
, #-4092]

1758 
ldr
 
	gpc
, [
pc
, #-4092]

1763 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1768 
ldr
 
	gr0
, [
pc
, #-4092]

1771 
ldr
 
	gpc
, [
pc
, #-4092]

1776 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1781 
ldr
 
	gr0
, [
pc
, #-4092]

1784 
ldr
 
	gpc
, [
pc
, #-4092]

1789 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1794 
ldr
 
	gr0
, [
pc
, #-4092]

1797 
ldr
 
	gpc
, [
pc
, #-4092]

1802 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1807 
ldr
 
	gr0
, [
pc
, #-4092]

1810 
ldr
 
	gpc
, [
pc
, #-4092]

1815 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1820 
ldr
 
	gr0
, [
pc
, #-4092]

1823 
ldr
 
	gpc
, [
pc
, #-4092]

1828 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1833 
ldr
 
	gr0
, [
pc
, #-4092]

1836 
ldr
 
	gpc
, [
pc
, #-4092]

1841 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1846 
ldr
 
	gr0
, [
pc
, #-4092]

1849 
ldr
 
	gpc
, [
pc
, #-4092]

1854 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1859 
ldr
 
	gr0
, [
pc
, #-4092]

1862 
ldr
 
	gpc
, [
pc
, #-4092]

1867 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1872 
ldr
 
	gr0
, [
pc
, #-4092]

1875 
ldr
 
	gpc
, [
pc
, #-4092]

1880 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1885 
ldr
 
	gr0
, [
pc
, #-4092]

1888 
ldr
 
	gpc
, [
pc
, #-4092]

1893 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1898 
ldr
 
	gr0
, [
pc
, #-4092]

1901 
ldr
 
	gpc
, [
pc
, #-4092]

1906 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1911 
ldr
 
	gr0
, [
pc
, #-4092]

1914 
ldr
 
	gpc
, [
pc
, #-4092]

1919 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1924 
ldr
 
	gr0
, [
pc
, #-4092]

1927 
ldr
 
	gpc
, [
pc
, #-4092]

1932 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1937 
ldr
 
	gr0
, [
pc
, #-4092]

1940 
ldr
 
	gpc
, [
pc
, #-4092]

1945 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1950 
ldr
 
	gr0
, [
pc
, #-4092]

1953 
ldr
 
	gpc
, [
pc
, #-4092]

1958 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1963 
ldr
 
	gr0
, [
pc
, #-4092]

1966 
ldr
 
	gpc
, [
pc
, #-4092]

1971 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1976 
ldr
 
	gr0
, [
pc
, #-4092]

1979 
ldr
 
	gpc
, [
pc
, #-4092]

1984 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

1989 
ldr
 
	gr0
, [
pc
, #-4092]

1992 
ldr
 
	gpc
, [
pc
, #-4092]

1997 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2002 
ldr
 
	gr0
, [
pc
, #-4092]

2005 
ldr
 
	gpc
, [
pc
, #-4092]

2010 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2015 
ldr
 
	gr0
, [
pc
, #-4092]

2018 
ldr
 
	gpc
, [
pc
, #-4092]

2023 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2028 
ldr
 
	gr0
, [
pc
, #-4092]

2031 
ldr
 
	gpc
, [
pc
, #-4092]

2036 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2041 
ldr
 
	gr0
, [
pc
, #-4092]

2044 
ldr
 
	gpc
, [
pc
, #-4092]

2049 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2054 
ldr
 
	gr0
, [
pc
, #-4092]

2057 
ldr
 
	gpc
, [
pc
, #-4092]

2062 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2067 
ldr
 
	gr0
, [
pc
, #-4092]

2070 
ldr
 
	gpc
, [
pc
, #-4092]

2075 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2080 
ldr
 
	gr0
, [
pc
, #-4092]

2083 
ldr
 
	gpc
, [
pc
, #-4092]

2088 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2093 
ldr
 
	gr0
, [
pc
, #-4092]

2096 
ldr
 
	gpc
, [
pc
, #-4092]

2101 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2106 
ldr
 
	gr0
, [
pc
, #-4092]

2109 
ldr
 
	gpc
, [
pc
, #-4092]

2114 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2119 
ldr
 
	gr0
, [
pc
, #-4092]

2122 
ldr
 
	gpc
, [
pc
, #-4092]

2127 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2132 
ldr
 
	gr0
, [
pc
, #-4092]

2135 
ldr
 
	gpc
, [
pc
, #-4092]

2140 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2145 
ldr
 
	gr0
, [
pc
, #-4092]

2148 
ldr
 
	gpc
, [
pc
, #-4092]

2153 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2158 
ldr
 
	gr0
, [
pc
, #-4092]

2161 
ldr
 
	gpc
, [
pc
, #-4092]

2166 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2171 
ldr
 
	gr0
, [
pc
, #-4092]

2174 
ldr
 
	gpc
, [
pc
, #-4092]

2179 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2184 
ldr
 
	gr0
, [
pc
, #-4092]

2187 
ldr
 
	gpc
, [
pc
, #-4092]

2192 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2197 
ldr
 
	gr0
, [
pc
, #-4092]

2200 
ldr
 
	gpc
, [
pc
, #-4092]

2205 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2210 
ldr
 
	gr0
, [
pc
, #-4092]

2213 
ldr
 
	gpc
, [
pc
, #-4092]

2218 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2223 
ldr
 
	gr0
, [
pc
, #-4092]

2226 
ldr
 
	gpc
, [
pc
, #-4092]

2231 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2236 
ldr
 
	gr0
, [
pc
, #-4092]

2239 
ldr
 
	gpc
, [
pc
, #-4092]

2244 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2249 
ldr
 
	gr0
, [
pc
, #-4092]

2252 
ldr
 
	gpc
, [
pc
, #-4092]

2257 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2262 
ldr
 
	gr0
, [
pc
, #-4092]

2265 
ldr
 
	gpc
, [
pc
, #-4092]

2270 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2275 
ldr
 
	gr0
, [
pc
, #-4092]

2278 
ldr
 
	gpc
, [
pc
, #-4092]

2283 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2288 
ldr
 
	gr0
, [
pc
, #-4092]

2291 
ldr
 
	gpc
, [
pc
, #-4092]

2296 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2301 
ldr
 
	gr0
, [
pc
, #-4092]

2304 
ldr
 
	gpc
, [
pc
, #-4092]

2309 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2314 
ldr
 
	gr0
, [
pc
, #-4092]

2317 
ldr
 
	gpc
, [
pc
, #-4092]

2322 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2327 
ldr
 
	gr0
, [
pc
, #-4092]

2330 
ldr
 
	gpc
, [
pc
, #-4092]

2335 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2340 
ldr
 
	gr0
, [
pc
, #-4092]

2343 
ldr
 
	gpc
, [
pc
, #-4092]

2348 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2353 
ldr
 
	gr0
, [
pc
, #-4092]

2356 
ldr
 
	gpc
, [
pc
, #-4092]

2361 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2366 
ldr
 
	gr0
, [
pc
, #-4092]

2369 
ldr
 
	gpc
, [
pc
, #-4092]

2374 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2379 
ldr
 
	gr0
, [
pc
, #-4092]

2382 
ldr
 
	gpc
, [
pc
, #-4092]

2387 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2392 
ldr
 
	gr0
, [
pc
, #-4092]

2395 
ldr
 
	gpc
, [
pc
, #-4092]

2400 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2405 
ldr
 
	gr0
, [
pc
, #-4092]

2408 
ldr
 
	gpc
, [
pc
, #-4092]

2413 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2418 
ldr
 
	gr0
, [
pc
, #-4092]

2421 
ldr
 
	gpc
, [
pc
, #-4092]

2426 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2431 
ldr
 
	gr0
, [
pc
, #-4092]

2434 
ldr
 
	gpc
, [
pc
, #-4092]

2439 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2444 
ldr
 
	gr0
, [
pc
, #-4092]

2447 
ldr
 
	gpc
, [
pc
, #-4092]

2452 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2457 
ldr
 
	gr0
, [
pc
, #-4092]

2460 
ldr
 
	gpc
, [
pc
, #-4092]

2465 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2470 
ldr
 
	gr0
, [
pc
, #-4092]

2473 
ldr
 
	gpc
, [
pc
, #-4092]

2478 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2483 
ldr
 
	gr0
, [
pc
, #-4092]

2486 
ldr
 
	gpc
, [
pc
, #-4092]

2491 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2496 
ldr
 
	gr0
, [
pc
, #-4092]

2499 
ldr
 
	gpc
, [
pc
, #-4092]

2504 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2509 
ldr
 
	gr0
, [
pc
, #-4092]

2512 
ldr
 
	gpc
, [
pc
, #-4092]

2517 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2522 
ldr
 
	gr0
, [
pc
, #-4092]

2525 
ldr
 
	gpc
, [
pc
, #-4092]

2530 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2535 
ldr
 
	gr0
, [
pc
, #-4092]

2538 
ldr
 
	gpc
, [
pc
, #-4092]

2543 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2548 
ldr
 
	gr0
, [
pc
, #-4092]

2551 
ldr
 
	gpc
, [
pc
, #-4092]

2556 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2561 
ldr
 
	gr0
, [
pc
, #-4092]

2564 
ldr
 
	gpc
, [
pc
, #-4092]

2569 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2574 
ldr
 
	gr0
, [
pc
, #-4092]

2577 
ldr
 
	gpc
, [
pc
, #-4092]

2582 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2587 
ldr
 
	gr0
, [
pc
, #-4092]

2590 
ldr
 
	gpc
, [
pc
, #-4092]

2595 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2600 
ldr
 
	gr0
, [
pc
, #-4092]

2603 
ldr
 
	gpc
, [
pc
, #-4092]

2608 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2613 
ldr
 
	gr0
, [
pc
, #-4092]

2616 
ldr
 
	gpc
, [
pc
, #-4092]

2621 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2626 
ldr
 
	gr0
, [
pc
, #-4092]

2629 
ldr
 
	gpc
, [
pc
, #-4092]

2634 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2639 
ldr
 
	gr0
, [
pc
, #-4092]

2642 
ldr
 
	gpc
, [
pc
, #-4092]

2647 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2652 
ldr
 
	gr0
, [
pc
, #-4092]

2655 
ldr
 
	gpc
, [
pc
, #-4092]

2660 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2665 
ldr
 
	gr0
, [
pc
, #-4092]

2668 
ldr
 
	gpc
, [
pc
, #-4092]

2673 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2678 
ldr
 
	gr0
, [
pc
, #-4092]

2681 
ldr
 
	gpc
, [
pc
, #-4092]

2686 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2691 
ldr
 
	gr0
, [
pc
, #-4092]

2694 
ldr
 
	gpc
, [
pc
, #-4092]

2699 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2704 
ldr
 
	gr0
, [
pc
, #-4092]

2707 
ldr
 
	gpc
, [
pc
, #-4092]

2712 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2717 
ldr
 
	gr0
, [
pc
, #-4092]

2720 
ldr
 
	gpc
, [
pc
, #-4092]

2725 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2730 
ldr
 
	gr0
, [
pc
, #-4092]

2733 
ldr
 
	gpc
, [
pc
, #-4092]

2738 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2743 
ldr
 
	gr0
, [
pc
, #-4092]

2746 
ldr
 
	gpc
, [
pc
, #-4092]

2751 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2756 
ldr
 
	gr0
, [
pc
, #-4092]

2759 
ldr
 
	gpc
, [
pc
, #-4092]

2764 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2769 
ldr
 
	gr0
, [
pc
, #-4092]

2772 
ldr
 
	gpc
, [
pc
, #-4092]

2777 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2782 
ldr
 
	gr0
, [
pc
, #-4092]

2785 
ldr
 
	gpc
, [
pc
, #-4092]

2790 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2795 
ldr
 
	gr0
, [
pc
, #-4092]

2798 
ldr
 
	gpc
, [
pc
, #-4092]

2803 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2808 
ldr
 
	gr0
, [
pc
, #-4092]

2811 
ldr
 
	gpc
, [
pc
, #-4092]

2816 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2821 
ldr
 
	gr0
, [
pc
, #-4092]

2824 
ldr
 
	gpc
, [
pc
, #-4092]

2829 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2834 
ldr
 
	gr0
, [
pc
, #-4092]

2837 
ldr
 
	gpc
, [
pc
, #-4092]

2842 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2847 
ldr
 
	gr0
, [
pc
, #-4092]

2850 
ldr
 
	gpc
, [
pc
, #-4092]

2855 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2860 
ldr
 
	gr0
, [
pc
, #-4092]

2863 
ldr
 
	gpc
, [
pc
, #-4092]

2868 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2873 
ldr
 
	gr0
, [
pc
, #-4092]

2876 
ldr
 
	gpc
, [
pc
, #-4092]

2881 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2886 
ldr
 
	gr0
, [
pc
, #-4092]

2889 
ldr
 
	gpc
, [
pc
, #-4092]

2894 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2899 
ldr
 
	gr0
, [
pc
, #-4092]

2902 
ldr
 
	gpc
, [
pc
, #-4092]

2907 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2912 
ldr
 
	gr0
, [
pc
, #-4092]

2915 
ldr
 
	gpc
, [
pc
, #-4092]

2920 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2925 
ldr
 
	gr0
, [
pc
, #-4092]

2928 
ldr
 
	gpc
, [
pc
, #-4092]

2933 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2938 
ldr
 
	gr0
, [
pc
, #-4092]

2941 
ldr
 
	gpc
, [
pc
, #-4092]

2946 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2951 
ldr
 
	gr0
, [
pc
, #-4092]

2954 
ldr
 
	gpc
, [
pc
, #-4092]

2959 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2964 
ldr
 
	gr0
, [
pc
, #-4092]

2967 
ldr
 
	gpc
, [
pc
, #-4092]

2972 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2977 
ldr
 
	gr0
, [
pc
, #-4092]

2980 
ldr
 
	gpc
, [
pc
, #-4092]

2985 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

2990 
ldr
 
	gr0
, [
pc
, #-4092]

2993 
ldr
 
	gpc
, [
pc
, #-4092]

2998 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3003 
ldr
 
	gr0
, [
pc
, #-4092]

3006 
ldr
 
	gpc
, [
pc
, #-4092]

3011 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3016 
ldr
 
	gr0
, [
pc
, #-4092]

3019 
ldr
 
	gpc
, [
pc
, #-4092]

3024 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3029 
ldr
 
	gr0
, [
pc
, #-4092]

3032 
ldr
 
	gpc
, [
pc
, #-4092]

3037 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3042 
ldr
 
	gr0
, [
pc
, #-4092]

3045 
ldr
 
	gpc
, [
pc
, #-4092]

3050 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3055 
ldr
 
	gr0
, [
pc
, #-4092]

3058 
ldr
 
	gpc
, [
pc
, #-4092]

3063 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3068 
ldr
 
	gr0
, [
pc
, #-4092]

3071 
ldr
 
	gpc
, [
pc
, #-4092]

3076 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3081 
ldr
 
	gr0
, [
pc
, #-4092]

3084 
ldr
 
	gpc
, [
pc
, #-4092]

3089 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3094 
ldr
 
	gr0
, [
pc
, #-4092]

3097 
ldr
 
	gpc
, [
pc
, #-4092]

3102 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3107 
ldr
 
	gr0
, [
pc
, #-4092]

3110 
ldr
 
	gpc
, [
pc
, #-4092]

3115 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3120 
ldr
 
	gr0
, [
pc
, #-4092]

3123 
ldr
 
	gpc
, [
pc
, #-4092]

3128 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3133 
ldr
 
	gr0
, [
pc
, #-4092]

3136 
ldr
 
	gpc
, [
pc
, #-4092]

3141 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3146 
ldr
 
	gr0
, [
pc
, #-4092]

3149 
ldr
 
	gpc
, [
pc
, #-4092]

3154 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3159 
ldr
 
	gr0
, [
pc
, #-4092]

3162 
ldr
 
	gpc
, [
pc
, #-4092]

3167 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3172 
ldr
 
	gr0
, [
pc
, #-4092]

3175 
ldr
 
	gpc
, [
pc
, #-4092]

3180 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3185 
ldr
 
	gr0
, [
pc
, #-4092]

3188 
ldr
 
	gpc
, [
pc
, #-4092]

3193 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3198 
ldr
 
	gr0
, [
pc
, #-4092]

3201 
ldr
 
	gpc
, [
pc
, #-4092]

3206 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3211 
ldr
 
	gr0
, [
pc
, #-4092]

3214 
ldr
 
	gpc
, [
pc
, #-4092]

3219 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3224 
ldr
 
	gr0
, [
pc
, #-4092]

3227 
ldr
 
	gpc
, [
pc
, #-4092]

3232 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3237 
ldr
 
	gr0
, [
pc
, #-4092]

3240 
ldr
 
	gpc
, [
pc
, #-4092]

3245 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3250 
ldr
 
	gr0
, [
pc
, #-4092]

3253 
ldr
 
	gpc
, [
pc
, #-4092]

3258 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3263 
ldr
 
	gr0
, [
pc
, #-4092]

3266 
ldr
 
	gpc
, [
pc
, #-4092]

3271 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3276 
ldr
 
	gr0
, [
pc
, #-4092]

3279 
ldr
 
	gpc
, [
pc
, #-4092]

3284 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3289 
ldr
 
	gr0
, [
pc
, #-4092]

3292 
ldr
 
	gpc
, [
pc
, #-4092]

3297 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3302 
ldr
 
	gr0
, [
pc
, #-4092]

3305 
ldr
 
	gpc
, [
pc
, #-4092]

3310 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3315 
ldr
 
	gr0
, [
pc
, #-4092]

3318 
ldr
 
	gpc
, [
pc
, #-4092]

3323 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3328 
ldr
 
	gr0
, [
pc
, #-4092]

3331 
ldr
 
	gpc
, [
pc
, #-4092]

3336 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3341 
ldr
 
	gr0
, [
pc
, #-4092]

3344 
ldr
 
	gpc
, [
pc
, #-4092]

3349 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3354 
ldr
 
	gr0
, [
pc
, #-4092]

3357 
ldr
 
	gpc
, [
pc
, #-4092]

3362 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3367 
ldr
 
	gr0
, [
pc
, #-4092]

3370 
ldr
 
	gpc
, [
pc
, #-4092]

3375 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3380 
ldr
 
	gr0
, [
pc
, #-4092]

3383 
ldr
 
	gpc
, [
pc
, #-4092]

3388 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3393 
ldr
 
	gr0
, [
pc
, #-4092]

3396 
ldr
 
	gpc
, [
pc
, #-4092]

3401 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3406 
ldr
 
	gr0
, [
pc
, #-4092]

3409 
ldr
 
	gpc
, [
pc
, #-4092]

3414 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3419 
ldr
 
	gr0
, [
pc
, #-4092]

3422 
ldr
 
	gpc
, [
pc
, #-4092]

3427 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3432 
ldr
 
	gr0
, [
pc
, #-4092]

3435 
ldr
 
	gpc
, [
pc
, #-4092]

3440 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3445 
ldr
 
	gr0
, [
pc
, #-4092]

3448 
ldr
 
	gpc
, [
pc
, #-4092]

3453 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3458 
ldr
 
	gr0
, [
pc
, #-4092]

3461 
ldr
 
	gpc
, [
pc
, #-4092]

3466 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3471 
ldr
 
	gr0
, [
pc
, #-4092]

3474 
ldr
 
	gpc
, [
pc
, #-4092]

3479 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3484 
ldr
 
	gr0
, [
pc
, #-4092]

3487 
ldr
 
	gpc
, [
pc
, #-4092]

3492 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3497 
ldr
 
	gr0
, [
pc
, #-4092]

3500 
ldr
 
	gpc
, [
pc
, #-4092]

3505 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3510 
ldr
 
	gr0
, [
pc
, #-4092]

3513 
ldr
 
	gpc
, [
pc
, #-4092]

3518 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3523 
ldr
 
	gr0
, [
pc
, #-4092]

3526 
ldr
 
	gpc
, [
pc
, #-4092]

3531 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3536 
ldr
 
	gr0
, [
pc
, #-4092]

3539 
ldr
 
	gpc
, [
pc
, #-4092]

3544 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3549 
ldr
 
	gr0
, [
pc
, #-4092]

3552 
ldr
 
	gpc
, [
pc
, #-4092]

3557 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3562 
ldr
 
	gr0
, [
pc
, #-4092]

3565 
ldr
 
	gpc
, [
pc
, #-4092]

3570 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3575 
ldr
 
	gr0
, [
pc
, #-4092]

3578 
ldr
 
	gpc
, [
pc
, #-4092]

3583 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3588 
ldr
 
	gr0
, [
pc
, #-4092]

3591 
ldr
 
	gpc
, [
pc
, #-4092]

3596 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3601 
ldr
 
	gr0
, [
pc
, #-4092]

3604 
ldr
 
	gpc
, [
pc
, #-4092]

3609 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3614 
ldr
 
	gr0
, [
pc
, #-4092]

3617 
ldr
 
	gpc
, [
pc
, #-4092]

3622 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3627 
ldr
 
	gr0
, [
pc
, #-4092]

3630 
ldr
 
	gpc
, [
pc
, #-4092]

3635 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3640 
ldr
 
	gr0
, [
pc
, #-4092]

3643 
ldr
 
	gpc
, [
pc
, #-4092]

3648 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3653 
ldr
 
	gr0
, [
pc
, #-4092]

3656 
ldr
 
	gpc
, [
pc
, #-4092]

3661 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3666 
ldr
 
	gr0
, [
pc
, #-4092]

3669 
ldr
 
	gpc
, [
pc
, #-4092]

3674 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3679 
ldr
 
	gr0
, [
pc
, #-4092]

3682 
ldr
 
	gpc
, [
pc
, #-4092]

3687 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3692 
ldr
 
	gr0
, [
pc
, #-4092]

3695 
ldr
 
	gpc
, [
pc
, #-4092]

3700 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3705 
ldr
 
	gr0
, [
pc
, #-4092]

3708 
ldr
 
	gpc
, [
pc
, #-4092]

3713 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3718 
ldr
 
	gr0
, [
pc
, #-4092]

3721 
ldr
 
	gpc
, [
pc
, #-4092]

3726 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3731 
ldr
 
	gr0
, [
pc
, #-4092]

3734 
ldr
 
	gpc
, [
pc
, #-4092]

3739 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3744 
ldr
 
	gr0
, [
pc
, #-4092]

3747 
ldr
 
	gpc
, [
pc
, #-4092]

3752 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3757 
ldr
 
	gr0
, [
pc
, #-4092]

3760 
ldr
 
	gpc
, [
pc
, #-4092]

3765 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3770 
ldr
 
	gr0
, [
pc
, #-4092]

3773 
ldr
 
	gpc
, [
pc
, #-4092]

3778 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3783 
ldr
 
	gr0
, [
pc
, #-4092]

3786 
ldr
 
	gpc
, [
pc
, #-4092]

3791 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3796 
ldr
 
	gr0
, [
pc
, #-4092]

3799 
ldr
 
	gpc
, [
pc
, #-4092]

3804 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3809 
ldr
 
	gr0
, [
pc
, #-4092]

3812 
ldr
 
	gpc
, [
pc
, #-4092]

3817 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3822 
ldr
 
	gr0
, [
pc
, #-4092]

3825 
ldr
 
	gpc
, [
pc
, #-4092]

3830 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3835 
ldr
 
	gr0
, [
pc
, #-4092]

3838 
ldr
 
	gpc
, [
pc
, #-4092]

3843 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3848 
ldr
 
	gr0
, [
pc
, #-4092]

3851 
ldr
 
	gpc
, [
pc
, #-4092]

3856 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3861 
ldr
 
	gr0
, [
pc
, #-4092]

3864 
ldr
 
	gpc
, [
pc
, #-4092]

3869 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3874 
ldr
 
	gr0
, [
pc
, #-4092]

3877 
ldr
 
	gpc
, [
pc
, #-4092]

3882 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3887 
ldr
 
	gr0
, [
pc
, #-4092]

3890 
ldr
 
	gpc
, [
pc
, #-4092]

3895 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3900 
ldr
 
	gr0
, [
pc
, #-4092]

3903 
ldr
 
	gpc
, [
pc
, #-4092]

3908 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3913 
ldr
 
	gr0
, [
pc
, #-4092]

3916 
ldr
 
	gpc
, [
pc
, #-4092]

3921 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3926 
ldr
 
	gr0
, [
pc
, #-4092]

3929 
ldr
 
	gpc
, [
pc
, #-4092]

3934 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3939 
ldr
 
	gr0
, [
pc
, #-4092]

3942 
ldr
 
	gpc
, [
pc
, #-4092]

3947 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3952 
ldr
 
	gr0
, [
pc
, #-4092]

3955 
ldr
 
	gpc
, [
pc
, #-4092]

3960 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3965 
ldr
 
	gr0
, [
pc
, #-4092]

3968 
ldr
 
	gpc
, [
pc
, #-4092]

3973 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3978 
ldr
 
	gr0
, [
pc
, #-4092]

3981 
ldr
 
	gpc
, [
pc
, #-4092]

3986 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

3991 
ldr
 
	gr0
, [
pc
, #-4092]

3994 
ldr
 
	gpc
, [
pc
, #-4092]

3999 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4004 
ldr
 
	gr0
, [
pc
, #-4092]

4007 
ldr
 
	gpc
, [
pc
, #-4092]

4012 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4017 
ldr
 
	gr0
, [
pc
, #-4092]

4020 
ldr
 
	gpc
, [
pc
, #-4092]

4025 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4030 
ldr
 
	gr0
, [
pc
, #-4092]

4033 
ldr
 
	gpc
, [
pc
, #-4092]

4038 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4043 
ldr
 
	gr0
, [
pc
, #-4092]

4046 
ldr
 
	gpc
, [
pc
, #-4092]

4051 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4056 
ldr
 
	gr0
, [
pc
, #-4092]

4059 
ldr
 
	gpc
, [
pc
, #-4092]

4064 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4069 
ldr
 
	gr0
, [
pc
, #-4092]

4072 
ldr
 
	gpc
, [
pc
, #-4092]

4077 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4082 
ldr
 
	gr0
, [
pc
, #-4092]

4085 
ldr
 
	gpc
, [
pc
, #-4092]

4090 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4095 
ldr
 
	gr0
, [
pc
, #-4092]

4098 
ldr
 
	gpc
, [
pc
, #-4092]

4103 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4108 
ldr
 
	gr0
, [
pc
, #-4092]

4111 
ldr
 
	gpc
, [
pc
, #-4092]

4116 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4121 
ldr
 
	gr0
, [
pc
, #-4092]

4124 
ldr
 
	gpc
, [
pc
, #-4092]

4129 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4134 
ldr
 
	gr0
, [
pc
, #-4092]

4137 
ldr
 
	gpc
, [
pc
, #-4092]

4142 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4147 
ldr
 
	gr0
, [
pc
, #-4092]

4150 
ldr
 
	gpc
, [
pc
, #-4092]

4155 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4160 
ldr
 
	gr0
, [
pc
, #-4092]

4163 
ldr
 
	gpc
, [
pc
, #-4092]

4168 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4173 
ldr
 
	gr0
, [
pc
, #-4092]

4176 
ldr
 
	gpc
, [
pc
, #-4092]

4181 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4186 
ldr
 
	gr0
, [
pc
, #-4092]

4189 
ldr
 
	gpc
, [
pc
, #-4092]

4194 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4199 
ldr
 
	gr0
, [
pc
, #-4092]

4202 
ldr
 
	gpc
, [
pc
, #-4092]

4207 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4212 
ldr
 
	gr0
, [
pc
, #-4092]

4215 
ldr
 
	gpc
, [
pc
, #-4092]

4220 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4225 
ldr
 
	gr0
, [
pc
, #-4092]

4228 
ldr
 
	gpc
, [
pc
, #-4092]

4233 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4238 
ldr
 
	gr0
, [
pc
, #-4092]

4241 
ldr
 
	gpc
, [
pc
, #-4092]

4246 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4251 
ldr
 
	gr0
, [
pc
, #-4092]

4254 
ldr
 
	gpc
, [
pc
, #-4092]

4259 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4264 
ldr
 
	gr0
, [
pc
, #-4092]

4267 
ldr
 
	gpc
, [
pc
, #-4092]

4272 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4277 
ldr
 
	gr0
, [
pc
, #-4092]

4280 
ldr
 
	gpc
, [
pc
, #-4092]

4285 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4290 
ldr
 
	gr0
, [
pc
, #-4092]

4293 
ldr
 
	gpc
, [
pc
, #-4092]

4298 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4303 
ldr
 
	gr0
, [
pc
, #-4092]

4306 
ldr
 
	gpc
, [
pc
, #-4092]

4311 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4316 
ldr
 
	gr0
, [
pc
, #-4092]

4319 
ldr
 
	gpc
, [
pc
, #-4092]

4324 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4329 
ldr
 
	gr0
, [
pc
, #-4092]

4332 
ldr
 
	gpc
, [
pc
, #-4092]

4337 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4342 
ldr
 
	gr0
, [
pc
, #-4092]

4345 
ldr
 
	gpc
, [
pc
, #-4092]

4350 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4355 
ldr
 
	gr0
, [
pc
, #-4092]

4358 
ldr
 
	gpc
, [
pc
, #-4092]

4363 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4368 
ldr
 
	gr0
, [
pc
, #-4092]

4371 
ldr
 
	gpc
, [
pc
, #-4092]

4376 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4381 
ldr
 
	gr0
, [
pc
, #-4092]

4384 
ldr
 
	gpc
, [
pc
, #-4092]

4389 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4394 
ldr
 
	gr0
, [
pc
, #-4092]

4397 
ldr
 
	gpc
, [
pc
, #-4092]

4402 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4407 
ldr
 
	gr0
, [
pc
, #-4092]

4410 
ldr
 
	gpc
, [
pc
, #-4092]

4415 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4420 
ldr
 
	gr0
, [
pc
, #-4092]

4423 
ldr
 
	gpc
, [
pc
, #-4092]

4428 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4433 
ldr
 
	gr0
, [
pc
, #-4092]

4436 
ldr
 
	gpc
, [
pc
, #-4092]

4441 
°mfd
 
	g•
!, {
	gr0
-
	gr3
}

4446 
ldr
 
	gr0
, [
pc
, #-4092]

4449 
ldr
 
	gpc
, [
pc
, #-4092]

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/avr32/ffi.c

28 
	~<ffi.h
>

29 
	~<ffi_comm⁄.h
>

31 
	~<°dlib.h
>

32 
	~<°dio.h
>

33 
	~<uni°d.h
>

34 
	~<asm/uni°d.h
>

38 
ffi_ˇŒ_SYSV
((*)(*, 
exãnded_cif
 *),Éxtended_cif *,

40 (*
‚
)());

41 
	`ffi_˛osuª_SYSV
 (
ffi_˛osuª
 *);

43 
	$∑ss_°ru˘_⁄_°ack
(
ffi_ty≥
 *
ty≥
)

45 if(
ty≥
->ty≥ !
FFI_TYPE_STRUCT
)

48 if(
ty≥
->
Æignmít
 <Åy≥->
size
 &&

49 !(
ty≥
->
size
 == 4 ||Åype->size == 8) &&

50 !(
ty≥
->
size
 =8 &&Åy≥->
Æignmít
 >= 4))

53 if(
ty≥
->
size
 == 3 ||Åype->size == 5 ||Åype->size == 6 ||

54 
ty≥
->
size
 == 7)

58 
	}
}

67 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

69 
i
;

70 **
p_¨gv
;

71 
ffi_ty≥
 **
p_¨g
;

72 *
ªg_ba£
 = 
°ack
;

73 *
°ack_ba£
 = 
°ack
 + 20;

74 
°ack_off£t
 = 0;

75 
ªg_mask
 = 0;

77 
p_¨gv
 = 
ecif
->
avÆue
;

80 if(
ecif
->
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

82 *(**)
ªg_ba£
 = 
ecif
->
rvÆue
;

83 
ªg_mask
 |= 1;

86 
i
 = 0, 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
; i <Écif->cif->
«rgs
;

87 
i
++, 
p_¨g
++)

89 
size_t
 
z
 = (*
p_¨g
)->
size
;

90 
Æignmít
 = (*
p_¨g
)->alignment;

91 
ty≥
 = (*
p_¨g
)->type;

92 *
addr
 = 0;

94 if(
z
 % 4 != 0)

95 
z
 += (4 - z % 4);

97 if(
ªg_mask
 != 0x1f)

99 if(
	`∑ss_°ru˘_⁄_°ack
(*
p_¨g
))

101 
addr
 = 
°ack_ba£
 + 
°ack_off£t
;

102 
°ack_off£t
 +
z
;

104 if(
z
 == ())

106 
ödex
 = 0;

108 (
ªg_mask
 >> 
ödex
) & 1)

109 
ödex
++;

111 
addr
 = 
ªg_ba£
 + (
ödex
 * 4);

112 
ªg_mask
 |(1 << 
ödex
);

114 if(
z
 == 2 * ())

116 if(!((
ªg_mask
 >> 1) & 1))

118 
addr
 = 
ªg_ba£
 + 4;

119 
ªg_mask
 |= (3 << 1);

121 if(!((
ªg_mask
 >> 3) & 1))

123 
addr
 = 
ªg_ba£
 + 12;

124 
ªg_mask
 |= (3 << 3);

129 if(!
addr
)

131 
addr
 = 
°ack_ba£
 + 
°ack_off£t
;

132 
°ack_off£t
 +
z
;

135 if(
ty≥
 =
FFI_TYPE_STRUCT
 && (*
p_¨g
)->
ñemíts
[1] =
NULL
)

136 
ty≥
 = (*
p_¨g
)->
ñemíts
[0]->type;

138 
ty≥
)

140 
FFI_TYPE_UINT8
:

141 *(*)
addr
 = ()*(
UINT8
 *)(*
p_¨gv
);

143 
FFI_TYPE_SINT8
:

144 *(sig√d *)
addr
 = (sig√d )*(
SINT8
 *)(*
p_¨gv
);

146 
FFI_TYPE_UINT16
:

147 *(*)
addr
 = ()*(
UINT16
 *)(*
p_¨gv
);

149 
FFI_TYPE_SINT16
:

150 *(sig√d *)
addr
 = (sig√d )*(
SINT16
 *)(*
p_¨gv
);

153 
	`mem˝y
(
addr
, *
p_¨gv
, 
z
);

156 
p_¨gv
++;

159 #ifde‡
DEBUG


161 
i
 = 0; i < 5; i++)

163 if((
ªg_mask
 & (1 << 
i
)) == 0)

164 
	`¥ötf
("r%d: (unu£d)\n", 12 - 
i
);

166 
	`¥ötf
("r%d: 0x%08x\n", 12 - 
i
, ((*)
ªg_ba£
)[i]);

169 
i
 = 0; i < 
°ack_off£t
 / 4; i++)

171 
	`¥ötf
("•+%d: 0x%08x\n", 
i
*4, ((*)
°ack_ba£
)[i]);

174 
	}
}

177 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

182 
cif
->
byãs
 = (cif->bytes + 7) & ~7;

185 
cif
->
r°ru˘_Êag
 = 0;

188 
cif
->
πy≥
->
ty≥
)

190 
FFI_TYPE_SINT8
:

191 
FFI_TYPE_UINT8
:

192 
cif
->
Êags
 = ()
FFI_TYPE_UINT8
;

194 
FFI_TYPE_SINT16
:

195 
FFI_TYPE_UINT16
:

196 
cif
->
Êags
 = ()
FFI_TYPE_UINT16
;

198 
FFI_TYPE_FLOAT
:

199 
FFI_TYPE_SINT32
:

200 
FFI_TYPE_UINT32
:

201 
FFI_TYPE_POINTER
:

202 
cif
->
Êags
 = ()
FFI_TYPE_UINT32
;

204 
FFI_TYPE_DOUBLE
:

205 
FFI_TYPE_SINT64
:

206 
FFI_TYPE_UINT64
:

207 
cif
->
Êags
 = ()
FFI_TYPE_UINT64
;

209 
FFI_TYPE_STRUCT
:

210 
cif
->
r°ru˘_Êag
 = 1;

211 if(!
	`∑ss_°ru˘_⁄_°ack
(
cif
->
πy≥
))

213 if(
cif
->
πy≥
->
size
 <= 1)

214 
cif
->
Êags
 = ()
FFI_TYPE_UINT8
;

215 if(
cif
->
πy≥
->
size
 <= 2)

216 
cif
->
Êags
 = ()
FFI_TYPE_UINT16
;

217 if(
cif
->
πy≥
->
size
 <= 4)

218 
cif
->
Êags
 = ()
FFI_TYPE_UINT32
;

219 if(
cif
->
πy≥
->
size
 <= 8)

220 
cif
->
Êags
 = ()
FFI_TYPE_UINT64
;

222 
cif
->
Êags
 = ()cif->
πy≥
->
ty≥
;

225 
cif
->
Êags
 = ()cif->
πy≥
->
ty≥
;

228 
cif
->
Êags
 = ()cif->
πy≥
->
ty≥
;

232  
FFI_OK
;

233 
	}
}

235 
ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

237 
exãnded_cif
 
ecif
;

239 
size
 = 0, 
i
 = 0;

240 
ffi_ty≥
 **
p_¨g
;

242 
ecif
.
cif
 = cif;

243 
ecif
.
avÆue
 =ávalue;

245 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
; i < cif->
«rgs
; i++,Ö_arg++)

246 
size
 +(*
p_¨g
)->size + (4 - (*p_arg)->size % 4);

252 if((
rvÆue
 =
NULL
Ë&& (
cif
->
Êags
 =
FFI_TYPE_STRUCT
))

253 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

255 
ecif
.
rvÆue
 =Ñvalue;

257 
cif
->
abi
)

259 
FFI_SYSV
:

260 
	`ffi_ˇŒ_SYSV
(
ffi_¥ï_¨gs
, &
ecif
, 
size
, 
cif
->
Êags
,

261 
ecif
.
rvÆue
, 
cif
->
r°ru˘_Êag
, 
‚
);

264 
	`FFI_ASSERT
(0);

267 
	}
}

269 
	$ffi_¥ï_öcomög_¨gs_SYSV
(*
°ack
, **
rvÆue
,

270 **
avÆue
, 
ffi_cif
 *
cif
)

272 
i
, 
ªg_mask
 = 0;

273 **
p_¨gv
;

274 
ffi_ty≥
 **
p_¨g
;

275 *
ªg_ba£
 = 
°ack
;

276 *
°ack_ba£
 = 
°ack
 + 20;

277 
°ack_off£t
 = 0;

279 #ifde‡
DEBUG


281 
i
 = 0; i < 
cif
->
«rgs
 + 7; i++)

283 
	`¥ötf
("•+%d: 0x%08x\n", 
i
*4, ((*)
°ack
)[i]);

288 if(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

290 *
rvÆue
 = *(**)
ªg_ba£
;

291 
ªg_mask
 |= 1;

294 
p_¨gv
 = 
avÆue
;

296 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
; i < cif->
«rgs
; i++,Ö_arg++)

298 
size_t
 
z
 = (*
p_¨g
)->
size
;

299 
Æignmít
 = (*
p_¨g
)->alignment;

301 *
p_¨gv
 = 0;

303 if(
z
 % 4 != 0)

304 
z
 += (4 - z % 4);

306 if(
ªg_mask
 != 0x1f)

308 if(
	`∑ss_°ru˘_⁄_°ack
(*
p_¨g
))

310 *
p_¨gv
 = (*)
°ack_ba£
 + 
°ack_off£t
;

311 
°ack_off£t
 +
z
;

313 if(
z
 <= ())

315 
ödex
 = 0;

317 (
ªg_mask
 >> 
ödex
) & 1)

318 
ödex
++;

320 *
p_¨gv
 = (*)
ªg_ba£
 + (
ödex
 * 4);

321 
ªg_mask
 |(1 << 
ödex
);

323 if(
z
 == 2 * ())

325 if(!((
ªg_mask
 >> 1) & 1))

327 *
p_¨gv
 = (*)
ªg_ba£
 + 4;

328 
ªg_mask
 |= (3 << 1);

330 if(!((
ªg_mask
 >> 3) & 1))

332 *
p_¨gv
 = (*)
ªg_ba£
 + 12;

333 
ªg_mask
 |= (3 << 3);

338 if(!*
p_¨gv
)

340 *
p_¨gv
 = (*)
°ack_ba£
 + 
°ack_off£t
;

341 
°ack_off£t
 +
z
;

344 if((*
p_¨g
)->
ty≥
 !
FFI_TYPE_STRUCT
 ||

345 (*
p_¨g
)->
ñemíts
[1] =
NULL
)

347 if(
Æignmít
 == 1)

348 **(**)
p_¨gv
 <<= 24;

349 if(
Æignmít
 == 2)

350 **(**)
p_¨gv
 <<= 16;

353 
p_¨gv
++;

356 #ifde‡
DEBUG


358 
i
 = 0; i < 
cif
->
«rgs
; i++)

360 
	`¥ötf
("•+%d: 0x%08x\n", 
i
*4, *(((**)
avÆue
)[i]));

363 
	}
}

367 
	$ffi_˛osuª_SYSV_ö√r
(
ffi_˛osuª
 *
˛osuª
, **
ª•p
,

368 *
¨gs
)

370 
ffi_cif
 *
cif
;

371 **
¨g_¨ó
;

372 
i
, 
size
 = 0;

373 
ffi_ty≥
 **
p_¨g
;

375 
cif
 = 
˛osuª
->cif;

377 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
; i < cif->
«rgs
; i++,Ö_arg++)

378 
size
 +(*
p_¨g
)->size + (4 - (*p_arg)->size % 4);

380 
¨g_¨ó
 = (**)
	`Æloˇ
(
size
);

387 
	`ffi_¥ï_öcomög_¨gs_SYSV
(
¨gs
, 
ª•p
, 
¨g_¨ó
, 
cif
);

389 (
˛osuª
->
fun
)(
cif
, *
ª•p
, 
¨g_¨ó
, closuª->
u£r_d©a
);

391  
cif
->
Êags
;

392 
	}
}

394 
ffi_°©us
 
ffi_¥ï_˛osuª_loc
(
ffi_˛osuª
* 
˛osuª
, 
ffi_cif
* 
cif
,

395 (*
fun
)(
ffi_cif
*, *, **, *), *
u£r_d©a
,

396 *
codñoc
)

398 i‡(
cif
->
abi
 !
FFI_SYSV
)

399  
FFI_BAD_ABI
;

401 *
__åamp
 = (*)(&
˛osuª
->
åamp
[0]);

402 
__fun
 = ()(&
ffi_˛osuª_SYSV
);

403 
__˘x
 = ()(
codñoc
);

404 
__r°ru˘_Êag
 = ()(
cif
->
r°ru˘_Êag
);

405 
__ö√r
 = ()(&
ffi_˛osuª_SYSV_ö√r
);

406 *(*Ë&
__åamp
[0] = 0xebcd1f00;

407 *(*Ë&
__åamp
[4] = 0xfefc0010;

408 *(*Ë&
__åamp
[8] = 0xfefb0010;

409 *(*Ë&
__åamp
[12] = 0xfefa0010;

410 *(*Ë&
__åamp
[16] = 0xfeff0010;

411 *(*Ë&
__åamp
[20] = 
__˘x
;

412 *(*Ë&
__åamp
[24] = 
__r°ru˘_Êag
;

413 *(*Ë&
__åamp
[28] = 
__ö√r
;

414 *(*Ë&
__åamp
[32] = 
__fun
;

415 
	`sysˇŒ
(
__NR_ˇcheÊush
, 0, (&
__åamp
[0]), 36);

417 
˛osuª
->
cif
 = cif;

418 
˛osuª
->
u£r_d©a
 = user_data;

419 
˛osuª
->
fun
 = fun;

421  
FFI_OK
;

422 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/avr32/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


35 #i‚de‡
LIBFFI_ASM


36 
	tffi_¨g
;

37 sig√d 
	tffi_ßrg
;

39 
	effi_abi
 {

40 
	mFFI_FIRST_ABI
 = 0,

41 
	mFFI_SYSV
,

42 
	mFFI_LAST_ABI
,

43 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


44 } 
	tffi_abi
;

47 
	#FFI_EXTRA_CIF_FIELDS
 
r°ru˘_Êag


	)

51 
	#FFI_CLOSURES
 1

	)

52 
	#FFI_TRAMPOLINE_SIZE
 36

	)

53 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/avr32/sysv.S

26 
	#LIBFFI_ASM


	)

27 
	~<ffic⁄fig.h
>

28 
	~<ffi.h
>

38 .
	gãxt


39 .
	gÆign
 1

40 .
globl
 
	gffi_ˇŒ_SYSV


41 .
ty≥
 
	gffi_ˇŒ_SYSV
, @
fun˘i⁄


42 
	gffi_ˇŒ_SYSV
:

43 
°m
 --
•
, 
	gr0
,
	gr1
,
Ã


44 
	g°m
 --
	g•
, 
	gr8
-
r12


45 
mov
 
	gr0
, 
•


48 
sub
 
	g•
, 
r10


50 
sub
 
	g•
, 20

54 
mov
 
	gr1
, 
r12


55 
mov
 
	gr12
, 
•


56 
iˇŒ
 
r1


59 
mov
 
	gr1
, 
r12


62 
ldm
 
	g•
++, 
	gr8
-
r12


65 
	gld
.
w
 
	gr1
, 
	gr0
[36]

66 
iˇŒ
 
r1


69 
mov
 
	g•
, 
r0


72 
	gld
.
w
 
	gr1
, 
	g•
[32]

75 
	gld
.
w
 
	gr9
, 
	g•
[12]

78 
	gld
.
w
 
	gr8
, 
	g•
[16]

81 
	g˝
.
w
 
	gr8
, 0

82 
	gbªq
 .
Líd


85 
	g˝
.
w
 
	gr1
, 0

86 
	gbªq
 1f

89 
	g˝
.
w
 
	gr9
, 
FFI_TYPE_UINT8


90 
	gbªq
 .
L°‹e8


93 
	g˝
.
w
 
	gr9
, 
FFI_TYPE_UINT16


94 
	gbªq
 .
	gL°‹e16


98 
˝
.
w
 
r9
, 
FFI_TYPE_UINT32


99 
	gbªq
 .
L°‹e32


100 
	g˝
.
w
 
	gr9
, 
FFI_TYPE_UINT16


101 
	gbªq
 .
L°‹e32


102 
	g˝
.
w
 
	gr9
, 
FFI_TYPE_UINT8


103 
	gbªq
 .
L°‹e32


106 
	g˝
.
w
 
	gr9
, 
FFI_TYPE_UINT64


107 
	gbªq
 .
L°‹e64


110 
	gbøl
 .
	gLíd


112 .
	gL°‹e64
:

113 
°
.
w
 
r8
[0], 
r11


114 
	g°
.
w
 
	gr8
[4], 
r10


115 
	gbøl
 .
	gLíd


117 .
	gL°‹e32
:

118 
°
.
w
 
r8
[0], 
r12


119 
	gbøl
 .
	gLíd


121 .
	gL°‹e16
:

122 
°
.
h
 
r8
[0], 
r12


123 
	gbøl
 .
	gLíd


125 .
	gL°‹e8
:

126 
°
.
b
 
r8
[0], 
r12


127 
	gbøl
 .
	gLíd


129 .
	gLíd
:

130 
sub
 
•
, -20

131 
ldm
 
	g•
++, 
	gr0
,
	gr1
,
	gpc


133 .
size
 
	gffi_ˇŒ_SYSV
, . - ffi_call_SYSV

140 .
	gÆign
 1

141 .
globl
 
	gffi_˛osuª_SYSV


142 .
ty≥
 
	gffi_˛osuª_SYSV
, @
fun˘i⁄


143 
	gffi_˛osuª_SYSV
:

144 
°m
 --
•
, 
	gr0
,
Ã


145 
mov
 
	gr0
, 
r11


146 
mov
 
	gr8
, 
r10


147 
sub
 
	gr10
, 
	g•
, -8

148 
sub
 
	g•
, 12

149 
	g°
.
w
 
	g•
[8], 
•


150 
sub
 
	gr11
, 
	g•
, -8

151 
iˇŒ
 
r8


154 
	g˝
.
w
 
	gr0
, 0

155 
	gbªq
 1f

158 
	g˝
.
w
 
	gr12
, 
FFI_TYPE_UINT8


159 
	gbªq
 .
Lgë8


162 
	g˝
.
w
 
	gr12
, 
FFI_TYPE_UINT16


163 
	gbªq
 .
	gLgë16


167 
˝
.
w
 
r12
, 
FFI_TYPE_UINT32


168 
	gbªq
 .
Lgë32


169 
	g˝
.
w
 
	gr12
, 
FFI_TYPE_UINT16


170 
	gbªq
 .
Lgë32


171 
	g˝
.
w
 
	gr12
, 
FFI_TYPE_UINT8


172 
	gbªq
 .
Lgë32


175 
	g˝
.
w
 
	gr12
, 
FFI_TYPE_UINT64


176 
	gbªq
 .
Lgë64


179 
	gbøl
 .
	gL˛íd


181 .
	gLgë64
:

182 
ld
.
w
 
r11
, 
	g•
[0]

183 
	gld
.
w
 
	gr10
, 
	g•
[4]

184 
	gbøl
 .
	gL˛íd


186 .
	gLgë32
:

187 
ld
.
w
 
r12
, 
	g•
[0]

188 
	gbøl
 .
	gL˛íd


190 .
	gLgë16
:

191 
ld
.
uh
 
r12
, 
	g•
[0]

192 
	gbøl
 .
	gL˛íd


194 .
	gLgë8
:

195 
ld
.
ub
 
r12
, 
	g•
[0]

196 
	gbøl
 .
	gL˛íd


198 .
	gL˛íd
:

199 
sub
 
•
, -12

200 
ldm
 
	g•
++, 
	gr0
,
Ã


201 
sub
 
	g•
, -20

202 
mov
 
	gpc
, 
	gÃ


204 .
size
 
	gffi_˛osuª_SYSV
, . - ffi_closure_SYSV

206 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


207 .
	g£˘i⁄
 .
	gnŸe
.
	gGNU
-
	g°ack
,"",@
	g¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/bfin/ffi.c

27 
	~<ffi.h
>

28 
	~<ffi_comm⁄.h
>

30 
	~<°dlib.h
>

31 
	~<°dio.h
>

34 
	#MAX_GPRARGS
 3

	)

39 
	#FFIBFIN_RET_VOID
 0

	)

40 
	#FFIBFIN_RET_BYTE
 1

	)

41 
	#FFIBFIN_RET_HALFWORD
 2

	)

42 
	#FFIBFIN_RET_INT64
 3

	)

43 
	#FFIBFIN_RET_INT32
 4

	)

48 
ffi_¥ï_¨gs
(*, 
exãnded_cif
 *);

55 
ffi_ˇŒ_SYSV
(, 
exãnded_cif
 *, (*)(*,Éxãnded_ci‡*), , *, (*
‚
)());

67 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

72 
cif
->
πy≥
->
ty≥
) {

73 
FFI_TYPE_VOID
:

74 
cif
->
Êags
 = 
FFIBFIN_RET_VOID
;

76 
FFI_TYPE_UINT16
:

77 
FFI_TYPE_SINT16
:

78 
cif
->
Êags
 = 
FFIBFIN_RET_HALFWORD
;

80 
FFI_TYPE_UINT8
:

81 
cif
->
Êags
 = 
FFIBFIN_RET_BYTE
;

83 
FFI_TYPE_INT
:

84 
FFI_TYPE_UINT32
:

85 
FFI_TYPE_SINT32
:

86 
FFI_TYPE_FLOAT
:

87 
FFI_TYPE_POINTER
:

88 
FFI_TYPE_SINT8
:

89 
cif
->
Êags
 = 
FFIBFIN_RET_INT32
;

91 
FFI_TYPE_SINT64
:

92 
FFI_TYPE_UINT64
:

93 
FFI_TYPE_DOUBLE
:

94 
cif
->
Êags
 = 
FFIBFIN_RET_INT64
;

96 
FFI_TYPE_STRUCT
:

97 i‡(
cif
->
πy≥
->
size
 <= 4){

98 
cif
->
Êags
 = 
FFIBFIN_RET_INT32
;

99 }i‡(
cif
->
πy≥
->
size
 == 8){

100 
cif
->
Êags
 = 
FFIBFIN_RET_INT64
;

103 
cif
->
Êags
 = 
FFIBFIN_RET_VOID
;

107 
	`FFI_ASSERT
(0);

110  
FFI_OK
;

111 
	}
}

120 
ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

122 
ªt_ty≥
 = 
cif
->
Êags
;

123 
exãnded_cif
 
ecif
;

124 
ecif
.
cif
 = cif;

125 
ecif
.
avÆue
 =ávalue;

126 
ecif
.
rvÆue
 =Ñvalue;

128 
cif
->
abi
) {

129 
FFI_SYSV
:

130 
	`ffi_ˇŒ_SYSV
(
cif
->
byãs
, &
ecif
, 
ffi_¥ï_¨gs
, 
ªt_ty≥
,Écif.
rvÆue
, 
‚
);

133 
	`FFI_ASSERT
(0);

136 
	}
}

144 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

146 
i
 = 0;

147 **
p_¨gv
;

148 *
¨gp
;

149 
ffi_ty≥
 **
p_¨g
;

150 
¨gp
 = 
°ack
;

151 
p_¨gv
 = 
ecif
->
avÆue
;

152 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

153 (
i
 != 0);

154 
i
--, 
p_¨g
++) {

155 
size_t
 
z
;

156 
z
 = (*
p_¨g
)->
size
;

157 i‡(
z
 < ()) {

158 
z
 = ();

159 (*
p_¨g
)->
ty≥
) {

160 
FFI_TYPE_SINT8
: {

161 sig√d 
v
 = *(
SINT8
 *)(* 
p_¨gv
);

162 sig√d 
t
 = 
v
;

163 *(sig√d *Ë
¨gp
 = 
t
;

166 
FFI_TYPE_UINT8
: {

167 
v
 = *(
UINT8
 *)(* 
p_¨gv
);

168 
t
 = 
v
;

169 *(*Ë
¨gp
 = 
t
;

172 
FFI_TYPE_SINT16
:

173 *(sig√d *Ë
¨gp
 = (sig√d Ë* (
SINT16
 *)(* 
p_¨gv
);

175 
FFI_TYPE_UINT16
:

176 *(*Ë
¨gp
 = (Ë* (
UINT16
 *)(* 
p_¨gv
);

178 
FFI_TYPE_STRUCT
:

179 
	`mem˝y
(
¨gp
, *
p_¨gv
, (*
p_¨g
)->
size
);

182 
	`FFI_ASSERT
(0);

185 } i‡(
z
 == ()) {

186 *(*Ë
¨gp
 = (Ë* (
UINT32
 *)(* 
p_¨gv
);

188 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

190 
p_¨gv
++;

191 
¨gp
 +
z
;

193 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/bfin/ffitarget.h

27 #i‚de‡
LIBFFI_TARGET_H


28 
	#LIBFFI_TARGET_H


	)

30 #i‚de‡
LIBFFI_ASM


31 
	tffi_¨g
;

32 sig√d 
	tffi_ßrg
;

34 
	effi_abi
 {

35 
	mFFI_FIRST_ABI
 = 0,

36 
	mFFI_SYSV
,

37 
	mFFI_LAST_ABI
,

38 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


39 } 
	tffi_abi
;

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/bfin/sysv.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

32 .
	gãxt


33 .
	gÆign
 4

39 .
globÆ
 
	g_ffi_ˇŒ_SYSV
;

40 .
ty≥
 
	g_ffi_ˇŒ_SYSV
, 
	gSTT_FUNC
;

41 .
func
 
ffi_ˇŒ_SYSV


66 
	g_ffi_ˇŒ_SYSV
:

67 .
¥ﬁogue
:

68 
LINK
 20;

69 [
FP
-20] = 
P3
;

70 [
FP
+8] = 
R0
;

71 [
FP
+12] = 
R1
;

72 [
FP
+16] = 
R2
;

74 .
	gÆloˇã_°ack
:

76 
R1
 = [
FP
+8];

77 
	gR0
 = 
SP
;

78 
	gR0
 = 
R0
 - 
R1
;

79 
	gR1
 = 4;

80 
	gR0
 = 
R0
 - 
R1
;

81 [
FP
-12] = 
SP
;

82 
	gSP
 = 
R0
;

83 [
FP
-16] = 
SP
;

85 .
	gˇŒ_¥ï_¨gs
:

87 
P0
 = [
P3
 + 
_ffi_¥ï_¨gs
@
FUNCDESC_GOT17M4
];

88 
	gP1
 = [
P0
];

89 
	gP3
 = [
P0
+4];

90 
	gR0
 = [
FP
-16];

91 
	gR1
 = [
FP
+12];

92 
ˇŒ
 (
P1
);

94 .
	gˇŒ_u£r_fun˘i⁄
:

96 
SP
 = [
FP
-16];

97 
	gR0
 = [
SP
];

98 
	gR1
 = [
SP
+4];

99 
	gR2
 = [
SP
+8];

101 
	gP0
 = 
FP
;

102 
	gP0
 +=28;

103 
	gP1
 = [
P0
];

104 
	gP1
 = [
P1
];

105 
	gP3
 = [
P0
+4];

111 
	gP0
 = [
FP
+24];

113 
ˇŒ
 (
P1
);

114 
	gSP
 = [
FP
-12];

115 .
	gcompuã_ªtu∫
:

116 
P2
 = [
FP
-20];

117 [
FP
-8] = 
R0
;

118 [
FP
-4] = 
R1
;

120 
	gR0
 = [
FP
+20];

121 
	gR1
 = 
R0
 << 2;

123 
	gR0
 = [
P2
+.
ªâabÀ
@
GOT17M4
];

124 
	gR0
 = 
R1
 + 
R0
;

125 
	gP2
 = 
R0
;

126 
	gR1
 = [
P2
];

128 
	gP2
 = [
FP
+-20];

129 
	gR0
 = [
P2
+.
ªâabÀ
@
GOT17M4
];

130 
	gR0
 = 
R1
 + 
R0
;

131 
	gP2
 = 
R0
;

132 
	gR0
 = [
FP
-8];

133 
	gR1
 = [
FP
-4];

134 
jump
 (
P2
);

143 .
	gÆign
 4

144 .
	gÆign
 4

145 .
	gªâabÀ
:

146 .
dd
 .
ïûogue
 - .
ªâabÀ


147 .
dd
 .
rbyã
 - .
ªâabÀ
;

148 .
	gdd
 .
	grhÆfw‹d
 - .
	gªâabÀ
;

149 .
	gdd
 .
	gröt64
 - .
	gªâabÀ
;

150 .
	gdd
 .
	gröt32
 - .
	gªâabÀ
;

152 .
	grbyã
:

153 
P0
 = [
FP
+24];

154 
	gR0
 = 
R0
.
B
 (
Z
);

155 [
P0
] = 
R0
;

156 
	gJUMP
 .
	gïûogue


157 .
	grhÆfw‹d
:

158 
P0
 = [
FP
+24];

159 
	gR0
 = 
R0
.
L
;

160 [
P0
] = 
R0
;

161 
	gJUMP
 .
	gïûogue


162 .
	gröt64
:

163 
P0
 = [
FP
+24];

164 [
P0
] = 
R0
;

165 [
P0
+4] = 
R1
;

166 
	gJUMP
 .
	gïûogue


167 .
	gröt32
:

168 
P0
 = [
FP
+24];

169 [
P0
] = 
R0
;

170 .
	gïûogue
:

171 
R0
 = [
FP
+8];

172 
	gR1
 = [
FP
+12];

173 
	gR2
 = [
FP
+16];

174 
	gP3
 = [
FP
-20];

175 
	gUNLINK
;

176 
	gRTS
;

178 .
size
 
	g_ffi_ˇŒ_SYSV
,.-_ffi_call_SYSV;

179 .
	gídfunc


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/closures.c

29 #i‡
deföed
 
__löux__
 && !deföed 
_GNU_SOURCE


30 
	#_GNU_SOURCE
 1

	)

33 
	~<ffi.h
>

34 
	~<ffi_comm⁄.h
>

36 #i‡!
FFI_MMAP_EXEC_WRIT
 && !
FFI_EXEC_TRAMPOLINE_TABLE


37 #i‡
__gnu_löux__
 && !
deföed
(
__ANDROID__
)

45 
	#FFI_MMAP_EXEC_WRIT
 1

	)

46 
	#HAVE_MNTENT
 1

	)

48 #i‡
deföed
(
X86_WIN32
Ë|| deföed(
X86_WIN64
Ë|| deföed(
__OS2__
)

52 
	#FFI_MMAP_EXEC_WRIT
 1

	)

56 #i‡
FFI_MMAP_EXEC_WRIT
 && !
deföed
 
FFI_MMAP_EXEC_SELINUX


57 #ifde‡
__löux__


61 
	#FFI_MMAP_EXEC_SELINUX
 1

	)

65 #i‡
FFI_CLOSURES


67 #i‡
FFI_EXEC_TRAMPOLINE_TABLE


71 #ñi‡
FFI_MMAP_EXEC_WRIT


73 
	#USE_LOCKS
 1

	)

74 
	#USE_DL_PREFIX
 1

	)

75 #ifde‡
__GNUC__


76 #i‚de‡
USE_BUILTIN_FFS


77 
	#USE_BUILTIN_FFS
 1

	)

82 
	#HAVE_MORECORE
 0

	)

85 
	#HAVE_MREMAP
 0

	)

88 
	#NO_MALLINFO
 1

	)

92 
	#DEFAULT_MMAP_THRESHOLD
 
MAX_SIZE_T


	)

95 
	#DEFAULT_GRANULARITY
 ((
size_t
)
mÆloc_gë∑gesize
)

	)

97 #i‡
FFI_CLOSURE_TEST


102 
	#DEFAULT_TRIM_THRESHOLD
 ((
size_t
)
mÆloc_gë∑gesize
)

	)

105 
	~<sys/ty≥s.h
>

106 
	~<sys/°©.h
>

107 
	~<f˙é.h
>

108 
	~<î∫o.h
>

109 #i‚de‡
_MSC_VER


110 
	~<uni°d.h
>

112 
	~<°rög.h
>

113 
	~<°dio.h
>

114 #i‡!
deföed
(
X86_WIN32
Ë&& !deföed(
X86_WIN64
)

115 #ifde‡
HAVE_MNTENT


116 
	~<m¡ít.h
>

118 
	~<sys/∑øm.h
>

119 
	~<±hªad.h
>

123 
	~<sys/mm™.h
>

124 
	#LACKS_SYS_MMAN_H
 1

	)

126 #i‡
FFI_MMAP_EXEC_SELINUX


127 
	~<sys/°©fs.h
>

128 
	~<°dlib.h
>

130 
	g£löux_íabÀd
 = -1;

133 
	$£löux_íabÀd_check
 ()

135 
°©fs
 
sfs
;

136 
FILE
 *
f
;

137 *
buf
 = 
NULL
;

138 
size_t
 
Àn
 = 0;

140 i‡(
	`°©fs
 ("/£löux", &
sfs
) >= 0

141 && (Ë
sfs
.
f_ty≥
 == 0xf97cff8cU)

143 
f
 = 
	`f›í
 ("/proc/mounts", "r");

144 i‡(
f
 =
NULL
)

146 
	`gëlöe
 (&
buf
, &
Àn
, 
f
) >= 0)

148 *
p
 = 
	`°rchr
 (
buf
, ' ');

149 i‡(
p
 =
NULL
)

151 
p
 = 
	`°rchr
 (p + 1, ' ');

152 i‡(
p
 =
NULL
)

154 i‡(
	`°∫cmp
 (
p
 + 1, "selinuxfs ", 10) == 0)

156 
	`‰ì
 (
buf
);

157 
	`f˛o£
 (
f
);

161 
	`‰ì
 (
buf
);

162 
	`f˛o£
 (
f
);

164 
	}
}

166 
	#is_£löux_íabÀd
(Ë(
£löux_íabÀd
 >= 0 ? selinux_enabled \

167 : (
£löux_íabÀd
 = 
	`£löux_íabÀd_check
 ()))

	)

171 
	#is_£löux_íabÀd
(Ë0

	)

176 #ifde‡
FFI_MMAP_EXEC_EMUTRAMP_PAX


177 
	~<°dlib.h
>

179 
	gemuåamp_íabÀd
 = -1;

182 
	$emuåamp_íabÀd_check
 ()

184 *
buf
 = 
NULL
;

185 
size_t
 
Àn
 = 0;

186 
FILE
 *
f
;

187 
ªt
;

188 
f
 = 
	`f›í
 ("/proc/self/status", "r");

189 i‡(
f
 =
NULL
)

191 
ªt
 = 0;

193 
	`gëlöe
 (&
buf
, &
Àn
, 
f
) != -1)

194 i‡(!
	`°∫cmp
 (
buf
, "PaX:", 4))

196 
emuåamp
;

197 i‡(
	`ssˇnf
 (
buf
, "%*†%*c%c", &
emuåamp
) == 1)

198 
ªt
 = (
emuåamp
 == 'E');

201 
	`‰ì
 (
buf
);

202 
	`f˛o£
 (
f
);

203  
ªt
;

204 
	}
}

206 
	#is_emuåamp_íabÀd
(Ë(
emuåamp_íabÀd
 >= 0 ?Émutramp_enabled \

207 : (
emuåamp_íabÀd
 = 
	`emuåamp_íabÀd_check
 ()))

	)

210 #ñi‡
deföed
 (
__CYGWIN__
Ë|| deföed(
__INTERIX
)

212 
	~<sys/mm™.h
>

215 
	#is_£löux_íabÀd
(Ë0

	)

219 #i‚de‡
FFI_MMAP_EXEC_EMUTRAMP_PAX


220 
	#is_emuåamp_íabÀd
(Ë0

	)

224 *
dlmÆloc
(
size_t
);

225 
dl‰ì
(*);

226 *
	$dlˇŒoc
(
size_t
, size_tË
MAYBE_UNUSED
;

227 *
	$dÃóŒoc
(*, 
size_t
Ë
MAYBE_UNUSED
;

228 *
	$dlmemÆign
(
size_t
, size_tË
MAYBE_UNUSED
;

229 *
	$dlvÆloc
(
size_t
Ë
MAYBE_UNUSED
;

230 
	$dlmÆl›t
(, Ë
MAYBE_UNUSED
;

231 
size_t
 
	$dlmÆloc_foŸ¥öt
(Ë
MAYBE_UNUSED
;

232 
size_t
 
	$dlmÆloc_max_foŸ¥öt
(Ë
MAYBE_UNUSED
;

233 ** 
	$dlödïídít_ˇŒoc
(
size_t
, size_t, **Ë
MAYBE_UNUSED
;

234 ** 
	$dlödïídít_comÆloc
(
size_t
, size_t*, **Ë
MAYBE_UNUSED
;

235 *
	$dÕvÆloc
(
size_t
Ë
MAYBE_UNUSED
;

236 
	$dlmÆloc_åim
(
size_t
Ë
MAYBE_UNUSED
;

237 
size_t
 
	$dlmÆloc_ußbÀ_size
(*Ë
MAYBE_UNUSED
;

238 
	$dlmÆloc_°©s
(Ë
MAYBE_UNUSED
;

240 #i‡!(
	`deföed
(
X86_WIN32
Ë|| deföed(
X86_WIN64
Ë|| deföed(
__OS2__
)Ë|| deföed (
__CYGWIN__
Ë|| deföed(
__INTERIX
)

242 *
	`dlmm≠
(*, 
size_t
, , , , 
off_t
);

243 
	`dlmunm≠
(*, 
size_t
);

246 
	#mm≠
 
dlmm≠


	)

247 
	#munm≠
 
dlmunm≠


	)

249 
	~"dlmÆloc.c
"

251 #unde‡
mm≠


252 #unde‡
munm≠


254 #i‡!(
	`deföed
(
X86_WIN32
Ë|| deföed(
X86_WIN64
Ë|| deföed(
__OS2__
)Ë|| deföed (
__CYGWIN__
Ë|| deföed(
__INTERIX
)

257 
±hªad_muãx_t
 
›í_ãmp_exec_fûe_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

261 
execfd
 = -1;

264 
size_t
 
execsize
 = 0;

268 
	$›í_ãmp_exec_fûe_«me
 (*
«me
, 
Êags
)

270 
fd
;

272 #ifde‡
HAVE_MKOSTEMP


273 
fd
 = 
	`mko°emp
 (
«me
, 
Êags
);

275 
fd
 = 
	`mk°emp
 (
«me
);

278 i‡(
fd
 != -1)

279 
	`u∆ök
 (
«me
);

281  
fd
;

282 
	}
}

286 
	$›í_ãmp_exec_fûe_dú
 (c⁄° *
dú
)

288 c⁄° 
suffix
[] = "/ffiXXXXXX";

289 
Àndú
, 
Êags
;

290 *
ãm≤ame
;

291 #ifde‡
O_TMPFILE


292 
fd
;

295 #ifde‡
O_CLOEXEC


296 
Êags
 = 
O_CLOEXEC
;

298 
Êags
 = 0;

301 #ifde‡
O_TMPFILE


302 
fd
 = 
	`›í
 (
dú
, 
Êags
 | 
O_RDWR
 | 
O_EXCL
 | 
O_TMPFILE
, 0700);

304 i‡(
fd
 !-1 || (
î∫o
 !
EINVAL
 &&Éºnÿ!
EISDIR
 &&Éºnÿ!
EOPNOTSUPP
)) {

305  
fd
;

307 
î∫o
 = 0;

311 
Àndú
 = 
	`°æí
 (
dú
);

312 
ãm≤ame
 = 
	`__buûtö_Æloˇ
 (
Àndú
 +  (
suffix
));

314 i‡(!
ãm≤ame
)

317 
	`mem˝y
 (
ãm≤ame
, 
dú
, 
Àndú
);

318 
	`mem˝y
 (
ãm≤ame
 + 
Àndú
, 
suffix
,  (suffix));

320  
	`›í_ãmp_exec_fûe_«me
 (
ãm≤ame
, 
Êags
);

321 
	}
}

326 
	$›í_ãmp_exec_fûe_ív
 (c⁄° *
ívv¨
)

328 c⁄° *
vÆue
 = 
	`gëív
 (
ívv¨
);

330 i‡(!
vÆue
)

333  
	`›í_ãmp_exec_fûe_dú
 (
vÆue
);

334 
	}
}

336 #ifde‡
HAVE_MNTENT


342 
	$›í_ãmp_exec_fûe_m¡
 (c⁄° *
mou¡s
)

344 c⁄° *
œ°_mou¡s
;

345 
FILE
 *
œ°_m¡ít
;

347 i‡(
mou¡s
 !
œ°_mou¡s
)

349 i‡(
œ°_m¡ít
)

350 
	`ídm¡ít
 (
œ°_m¡ít
);

352 
œ°_mou¡s
 = 
mou¡s
;

354 i‡(
mou¡s
)

355 
œ°_m¡ít
 = 
	`£tm¡ít
 (
mou¡s
, "r");

357 
œ°_m¡ít
 = 
NULL
;

360 i‡(!
œ°_m¡ít
)

365 
fd
;

366 
m¡ít
 
m¡
;

367 
buf
[
MAXPATHLEN
 * 3];

369 i‡(
	`gëm¡ít_r
 (
œ°_m¡ít
, &
m¡
, 
buf
,  (buf)Ë=
NULL
)

372 i‡(
	`hasm¡›t
 (&
m¡
, "ro")

373 || 
	`hasm¡›t
 (&
m¡
, "noexec")

374 || 
	`ac˚ss
 (
m¡
.
m¡_dú
, 
W_OK
))

377 
fd
 = 
	`›í_ãmp_exec_fûe_dú
 (
m¡
.
m¡_dú
);

379 i‡(
fd
 != -1)

380  
fd
;

382 
	}
}

389 (*
	mfunc
)(const *);

390 c⁄° *
	m¨g
;

391 
	mª≥©
;

392 } 
	g›í_ãmp_exec_fûe_›ts
[] = {

393 { 
›í_ãmp_exec_fûe_ív
, "TMPDIR", 0 },

394 { 
›í_ãmp_exec_fûe_dú
, "/tmp", 0 },

395 { 
›í_ãmp_exec_fûe_dú
, "/var/tmp", 0 },

396 { 
›í_ãmp_exec_fûe_dú
, "/dev/shm", 0 },

397 { 
›í_ãmp_exec_fûe_ív
, "HOME", 0 },

398 #ifde‡
HAVE_MNTENT


399 { 
›í_ãmp_exec_fûe_m¡
, "/etc/mtab", 1 },

400 { 
›í_ãmp_exec_fûe_m¡
, "/proc/mounts", 1 },

405 
	g›í_ãmp_exec_fûe_›ts_idx
 = 0;

411 
	$›í_ãmp_exec_fûe_›ts_√xt
 ()

413 i‡(
›í_ãmp_exec_fûe_›ts
[
›í_ãmp_exec_fûe_›ts_idx
].
ª≥©
)

414 
›í_ãmp_exec_fûe_›ts
[
›í_ãmp_exec_fûe_›ts_idx
].
	`func
 (
NULL
);

416 
›í_ãmp_exec_fûe_›ts_idx
++;

417 i‡(
›í_ãmp_exec_fûe_›ts_idx


418 =( (
›í_ãmp_exec_fûe_›ts
)

419 /  (*
›í_ãmp_exec_fûe_›ts
)))

421 
›í_ãmp_exec_fûe_›ts_idx
 = 0;

426 
	}
}

431 
	$›í_ãmp_exec_fûe
 ()

433 
fd
;

437 
fd
 = 
›í_ãmp_exec_fûe_›ts
[
›í_ãmp_exec_fûe_›ts_idx
].
func


438 (
›í_ãmp_exec_fûe_›ts
[
›í_ãmp_exec_fûe_›ts_idx
].
¨g
);

440 i‡(!
›í_ãmp_exec_fûe_›ts
[
›í_ãmp_exec_fûe_›ts_idx
].
ª≥©


441 || 
fd
 == -1)

443 i‡(
	`›í_ãmp_exec_fûe_›ts_√xt
 ())

447 
fd
 == -1);

449  
fd
;

450 
	}
}

458 
	$dlmm≠_locked
 (*
°¨t
, 
size_t
 
Àngth
, 
¥Ÿ
, 
Êags
, 
off_t
 
off£t
)

460 *
±r
;

462 i‡(
execfd
 == -1)

464 
›í_ãmp_exec_fûe_›ts_idx
 = 0;

465 
ªåy_›í
:

466 
execfd
 = 
	`›í_ãmp_exec_fûe
 ();

467 i‡(
execfd
 == -1)

468  
MFAIL
;

471 
off£t
 = 
execsize
;

473 i‡(
	`·runˇã
 (
execfd
, 
off£t
 + 
Àngth
))

474  
MFAIL
;

476 
Êags
 &~(
MAP_PRIVATE
 | 
MAP_ANONYMOUS
);

477 
Êags
 |
MAP_SHARED
;

479 
±r
 = 
	`mm≠
 (
NULL
, 
Àngth
, (
¥Ÿ
 & ~
PROT_WRITE
Ë| 
PROT_EXEC
,

480 
Êags
, 
execfd
, 
off£t
);

481 i‡(
±r
 =
MFAIL
)

483 i‡(!
off£t
)

485 
	`˛o£
 (
execfd
);

486 
ªåy_›í
;

488 
	`·runˇã
 (
execfd
, 
off£t
);

489  
MFAIL
;

491 i‡(!
off£t


492 && 
›í_ãmp_exec_fûe_›ts
[
›í_ãmp_exec_fûe_›ts_idx
].
ª≥©
)

493 
	`›í_ãmp_exec_fûe_›ts_√xt
 ();

495 
°¨t
 = 
	`mm≠
 (°¨t, 
Àngth
, 
¥Ÿ
, 
Êags
, 
execfd
, 
off£t
);

497 i‡(
°¨t
 =
MFAIL
)

499 
	`munm≠
 (
±r
, 
Àngth
);

500 
	`·runˇã
 (
execfd
, 
off£t
);

501  
°¨t
;

504 
	`mm≠_exec_off£t
 ((*)
°¨t
, 
Àngth
Ë(*)
±r
 - (*)start;

506 
execsize
 +
Àngth
;

508  
°¨t
;

509 
	}
}

514 
	$dlmm≠
 (*
°¨t
, 
size_t
 
Àngth
, 
¥Ÿ
,

515 
Êags
, 
fd
, 
off_t
 
off£t
)

517 *
±r
;

519 
	`as£π
 (
°¨t
 =
NULL
 && 
Àngth
 % 
mÆloc_gë∑gesize
 == 0

520 && 
¥Ÿ
 =(
PROT_READ
 | 
PROT_WRITE
)

521 && 
Êags
 =(
MAP_PRIVATE
 | 
MAP_ANONYMOUS
)

522 && 
fd
 =-1 && 
off£t
 == 0);

524 #i‡
FFI_CLOSURE_TEST


525 
	`¥ötf
 ("m≠pög i¿%zi\n", 
Àngth
);

528 i‡(
execfd
 =-1 && 
	`is_emuåamp_íabÀd
 ())

530 
±r
 = 
	`mm≠
 (
°¨t
, 
Àngth
, 
¥Ÿ
 & ~
PROT_EXEC
, 
Êags
, 
fd
, 
off£t
);

531  
±r
;

534 i‡(
execfd
 =-1 && !
	`is_£löux_íabÀd
 ())

536 
±r
 = 
	`mm≠
 (
°¨t
, 
Àngth
, 
¥Ÿ
 | 
PROT_EXEC
, 
Êags
, 
fd
, 
off£t
);

538 i‡(
±r
 !
MFAIL
 || (
î∫o
 !
EPERM
 &&Éºnÿ!
EACCES
))

540  
±r
;

547 i‡(
execsize
 =0 || 
execfd
 == -1)

549 
	`±hªad_muãx_lock
 (&
›í_ãmp_exec_fûe_muãx
);

550 
±r
 = 
	`dlmm≠_locked
 (
°¨t
, 
Àngth
, 
¥Ÿ
, 
Êags
, 
off£t
);

551 
	`±hªad_muãx_u∆ock
 (&
›í_ãmp_exec_fûe_muãx
);

553  
±r
;

556  
	`dlmm≠_locked
 (
°¨t
, 
Àngth
, 
¥Ÿ
, 
Êags
, 
off£t
);

557 
	}
}

562 
	$dlmunm≠
 (*
°¨t
, 
size_t
 
Àngth
)

570 
m£gmíçå
 
£g
 = 
	`£gmít_hﬁdög
 (
gm
, 
°¨t
);

571 *
code
;

573 #i‡
FFI_CLOSURE_TEST


574 
	`¥ötf
 ("unm≠pög %zi\n", 
Àngth
);

577 i‡(
£g
 && (
code
 = 
	`add_£gmít_exec_off£t
 (
°¨t
, seg)) != start)

579 
ªt
 = 
	`munm≠
 (
code
, 
Àngth
);

580 i‡(
ªt
)

581  
ªt
;

584  
	`munm≠
 (
°¨t
, 
Àngth
);

585 
	}
}

587 #i‡
FFI_CLOSURE_FREE_CODE


589 
m£gmíçå


590 
	$£gmít_hﬁdög_code
 (
m°©e
 
m
, * 
addr
)

592 
m£gmíçå
 
•
 = &
m
->
£g
;

594 i‡(
addr
 >
	`add_£gmít_exec_off£t
 (
•
->
ba£
, sp)

595 && 
addr
 < 
	`add_£gmít_exec_off£t
 (
•
->
ba£
, spË+ sp->
size
)

596  
•
;

597 i‡((
•
 = sp->
√xt
) == 0)

600 
	}
}

609 
	$ffi_˛osuª_Æloc
 (
size_t
 
size
, **
code
)

611 *
±r
;

613 i‡(!
code
)

614  
NULL
;

616 
±r
 = 
	`dlmÆloc
 (
size
);

618 i‡(
±r
)

620 
m£gmíçå
 
£g
 = 
	`£gmít_hﬁdög
 (
gm
, 
±r
);

622 *
code
 = 
	`add_£gmít_exec_off£t
 (
±r
, 
£g
);

625  
±r
;

626 
	}
}

633 
	$ffi_˛osuª_‰ì
 (*
±r
)

635 #i‡
FFI_CLOSURE_FREE_CODE


636 
m£gmíçå
 
£g
 = 
	`£gmít_hﬁdög_code
 (
gm
, 
±r
);

638 i‡(
£g
)

639 
±r
 = 
	`sub_£gmít_exec_off£t
 (±r, 
£g
);

642 
	`dl‰ì
 (
±r
);

643 
	}
}

646 #i‡
FFI_CLOSURE_TEST


649 
	$maö
 ()

651 *
p
[3];

652 
	#GET
(
idx
, 
Àn
Ëdÿ{ 
p
[idx] = 
	`dlmÆloc
 (Àn); 
	`¥ötf
 ("Æloˇãd %zòf‹Ö[%i]\n", (Àn), (idx)); } 0)

	)

653 
	#PUT
(
idx
Ëdÿ{ 
	`¥ötf
 ("‰ìögÖ[%i]\n", (idx)); 
	`dl‰ì
 (
p
[idx]); } 0)

	)

654 
	`GET
 (0, 
mÆloc_gë∑gesize
 / 2);

655 
	`GET
 (1, 2 * 
mÆloc_gë∑gesize
 - 64 *  (*));

656 
	`PUT
 (1);

657 
	`GET
 (1, 2 * 
mÆloc_gë∑gesize
);

658 
	`GET
 (2, 
mÆloc_gë∑gesize
 / 2);

659 
	`PUT
 (1);

660 
	`PUT
 (0);

661 
	`PUT
 (2);

663 
	}
}

670 
	~<°dlib.h
>

673 
	$ffi_˛osuª_Æloc
 (
size_t
 
size
, **
code
)

675 i‡(!
code
)

676  
NULL
;

678  *
code
 = 
	`mÆloc
 (
size
);

679 
	}
}

682 
	$ffi_˛osuª_‰ì
 (*
±r
)

684 
	`‰ì
 (
±r
);

685 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/cris/ffi.c

29 
	~<ffi.h
>

30 
	~<ffi_comm⁄.h
>

32 
	#STACK_ARG_SIZE
(
x
Ë
	`ALIGN
(x, 
FFI_SIZEOF_ARG
)

	)

34 
ffi_°©us


35 
	$öôülize_aggªg©e_∑cked_°ru˘
 (
ffi_ty≥
 * 
¨g
)

37 
ffi_ty≥
 **
±r
;

39 
	`FFI_ASSERT
 (
¨g
 !
NULL
);

41 
	`FFI_ASSERT
 (
¨g
->
ñemíts
 !
NULL
);

42 
	`FFI_ASSERT
 (
¨g
->
size
 == 0);

43 
	`FFI_ASSERT
 (
¨g
->
Æignmít
 == 0);

45 
±r
 = &(
¨g
->
ñemíts
[0]);

47 (*
±r
Ë!
NULL
)

49 i‡(((*
±r
)->
size
 == 0)

50 && (
	`öôülize_aggªg©e_∑cked_°ru˘
 ((*
±r
)Ë!
FFI_OK
))

51  
FFI_BAD_TYPEDEF
;

53 
	`FFI_ASSERT
 (
	`ffi_ty≥_ã°
 ((*
±r
)));

55 
¨g
->
size
 +(*
±r
)->size;

57 
¨g
->
Æignmít
 = (¨g->Æignmíà> (*
±r
)->alignment) ?

58 
¨g
->
Æignmít
 : (*
±r
)->alignment;

60 
±r
++;

63 i‡(
¨g
->
size
 == 0)

64  
FFI_BAD_TYPEDEF
;

66  
FFI_OK
;

67 
	}
}

70 
	$ffi_¥ï_¨gs
 (*
°ack
, 
exãnded_cif
 * 
ecif
)

72 
i
;

73 
°ru˘_cou¡
 = 0;

74 **
p_¨gv
;

75 *
¨gp
;

76 
ffi_ty≥
 **
p_¨g
;

78 
¨gp
 = 
°ack
;

80 
p_¨gv
 = 
ecif
->
avÆue
;

82 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

83 (
i
 !0); i--, 
p_¨g
++)

85 
size_t
 
z
;

87 (*
p_¨g
)->
ty≥
)

89 
FFI_TYPE_STRUCT
:

91 
z
 = (*
p_¨g
)->
size
;

92 i‡(
z
 <= 4)

94 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

95 
z
 = 4;

97 i‡(
z
 <= 8)

99 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

100 
z
 = 8;

104 
uiLocOnSèck
;

105 
z
 =  (*);

106 
uiLocOnSèck
 = 4 * 
ecif
->
cif
->
«rgs
 + 
°ru˘_cou¡
;

107 
°ru˘_cou¡
 = såu˘_cou¡ + (*
p_¨g
)->
size
;

108 *(*Ë
¨gp
 =

109 (Ë(
UINT32
 *Ë(
°ack
 + 
uiLocOnSèck
);

110 
	`mem˝y
 ((
°ack
 + 
uiLocOnSèck
), *
p_¨gv
, (*
p_¨g
)->
size
);

115 
z
 = (*
p_¨g
)->
size
;

116 i‡(
z
 <  ())

118 (*
p_¨g
)->
ty≥
)

120 
FFI_TYPE_SINT8
:

121 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT8
 *Ë(*
p_¨gv
);

124 
FFI_TYPE_UINT8
:

125 *(*Ë
¨gp
 =

126 (Ë*(
UINT8
 *Ë(*
p_¨gv
);

129 
FFI_TYPE_SINT16
:

130 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT16
 *Ë(*
p_¨gv
);

133 
FFI_TYPE_UINT16
:

134 *(*Ë
¨gp
 =

135 (Ë*(
UINT16
 *Ë(*
p_¨gv
);

139 
	`FFI_ASSERT
 (0);

141 
z
 =  ();

143 i‡(
z
 ==  ())

144 *(*Ë
¨gp
 = (Ë*(
UINT32
 *Ë(*
p_¨gv
);

146 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

149 
p_¨gv
++;

150 
¨gp
 +
z
;

153  (
°ru˘_cou¡
);

154 
	}
}

156 
ffi_°©us
 
FFI_HIDDEN


157 
	$ffi_¥ï_cif_c‹e
 (
ffi_cif
 * 
cif
,

158 
ffi_abi
 
abi
, 
isv¨üdic
,

159 
nfixed¨gs
, 
¡ŸÆ¨gs
,

160 
ffi_ty≥
 * 
πy≥
, ffi_ty≥ ** 
©y≥s
)

162 
byãs
 = 0;

163 
i
;

164 
ffi_ty≥
 **
±r
;

166 
	`FFI_ASSERT
 (
cif
 !
NULL
);

167 
	`FFI_ASSERT
((!
isv¨üdic
Ë|| (
nfixed¨gs
 >= 1));

168 
	`FFI_ASSERT
(
nfixed¨gs
 <
¡ŸÆ¨gs
);

169 
	`FFI_ASSERT
 (
abi
 > 
FFI_FIRST_ABI
 &&ábò< 
FFI_LAST_ABI
);

171 
cif
->
abi
 =ábi;

172 
cif
->
¨g_ty≥s
 = 
©y≥s
;

173 
cif
->
«rgs
 = 
¡ŸÆ¨gs
;

174 
cif
->
πy≥
 =Ñtype;

176 
cif
->
Êags
 = 0;

178 i‡((
cif
->
πy≥
->
size
 == 0)

179 && (
	`öôülize_aggªg©e_∑cked_°ru˘
 (
cif
->
πy≥
Ë!
FFI_OK
))

180  
FFI_BAD_TYPEDEF
;

182 
	`FFI_ASSERT_VALID_TYPE
 (
cif
->
πy≥
);

184 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = cif->
«rgs
; i > 0; i--,Ötr++)

186 i‡(((*
±r
)->
size
 == 0)

187 && (
	`öôülize_aggªg©e_∑cked_°ru˘
 ((*
±r
)Ë!
FFI_OK
))

188  
FFI_BAD_TYPEDEF
;

190 
	`FFI_ASSERT_VALID_TYPE
 (*
±r
);

192 i‡(((*
±r
)->
Æignmít
 - 1Ë& 
byãs
)

193 
byãs
 = 
	`ALIGN
 (byãs, (*
±r
)->
Æignmít
);

194 i‡((*
±r
)->
ty≥
 =
FFI_TYPE_STRUCT
)

196 i‡((*
±r
)->
size
 > 8)

198 
byãs
 +(*
±r
)->
size
;

199 
byãs
 +=  (*);

203 i‡((*
±r
)->
size
 > 4)

204 
byãs
 += 8;

206 
byãs
 += 4;

210 
byãs
 +
	`STACK_ARG_SIZE
 ((*
±r
)->
size
);

213 
cif
->
byãs
 = bytes;

215  
	`ffi_¥ï_cif_machdï
 (
cif
);

216 
	}
}

218 
ffi_°©us


219 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 * 
cif
)

221 
cif
->
πy≥
->
ty≥
)

223 
FFI_TYPE_VOID
:

224 
FFI_TYPE_STRUCT
:

225 
FFI_TYPE_FLOAT
:

226 
FFI_TYPE_DOUBLE
:

227 
FFI_TYPE_SINT64
:

228 
FFI_TYPE_UINT64
:

229 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

233 
cif
->
Êags
 = 
FFI_TYPE_INT
;

237  
FFI_OK
;

238 
	}
}

240 
ffi_ˇŒ_SYSV
 ((*)(*, 
exãnded_cif
 *),

241 
exãnded_cif
 *,

242 , , *, (*
‚
) ())

243 
	`__©åibuã__
 ((
	`__visibûôy__
 ("hidden")));

246 
	`ffi_ˇŒ
 (
ffi_cif
 * 
cif
, (*
‚
Ë(), *
rvÆue
, **
avÆue
)

248 
exãnded_cif
 
ecif
;

250 
ecif
.
cif
 = cif;

251 
ecif
.
avÆue
 =ávalue;

253 i‡((
rvÆue
 =
NULL
Ë&& (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

255 
ecif
.
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

258 
ecif
.
rvÆue
 =Ñvalue;

260 
cif
->
abi
)

262 
FFI_SYSV
:

263 
	`ffi_ˇŒ_SYSV
 (
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
,

264 
cif
->
Êags
, 
ecif
.
rvÆue
, 
‚
);

267 
	`FFI_ASSERT
 (0);

270 
	}
}

276 c⁄° 
ffi_¸is_åampﬁöe_ãm∂©e
[]

277 
__©åibuã__
 ((
__visibûôy__
 ("hidden")));

281 c⁄° 
ffi_¸is_åampﬁöe_‚_off£t


282 
__©åibuã__
 ((
__visibûôy__
 ("hidden")));

286 c⁄° 
ffi_¸is_åampﬁöe_˛osuª_off£t


287 
__©åibuã__
 ((
__visibûôy__
 ("hidden")));

297 
	$ffi_¥ï_˛osuª_ö√r
 (**
∑øms
, 
ffi_˛osuª
* 
˛osuª
)

299 *
ªgi°î_¨gs
 = (*Ë
∑øms
;

300 *
°ru˘_ªt
 = 
∑øms
[5];

301 *
°ack_¨gs
 = 
∑øms
[6];

302 *
±r
 = 
ªgi°î_¨gs
;

303 
ffi_cif
 *
cif
 = 
˛osuª
->cif;

304 
ffi_ty≥
 **
¨g_ty≥s
 = 
cif
->arg_types;

307 **
avÆue
 = 
	`Æloˇ
 (
˛osuª
->
cif
->
«rgs
 * (*));

308 
i
;

309 
doög_ªgs
;

310 
Œªt
 = 0;

313 
i
 = 0, 
doög_ªgs
 = 1; i < 
cif
->
«rgs
; i++)

316 i‡(
¨g_ty≥s
[
i
]->
size
 <= 4)

318 
avÆue
[
i
] = 
±r
;

319 
±r
 += 4;

321 i‡(
¨g_ty≥s
[
i
]->
size
 <= 8)

323 
avÆue
[
i
] = 
±r
;

324 
±r
 += 8;

328 
	`FFI_ASSERT
 (
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_STRUCT
);

331 
avÆue
[
i
] = *(**Ë
±r
;

332 
±r
 += 4;

338 i‡(
doög_ªgs
 && 
±r
 >
ªgi°î_¨gs
 + 4*4)

340 
±r
 = 
°ack_¨gs
 + (’å > 
ªgi°î_¨gs
 + 4*4) ? 4 : 0);

341 
doög_ªgs
 = 0;

346 (
˛osuª
->
fun
Ë(
cif
,

348 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


352 ? 
°ru˘_ªt


357 : (*Ë&
Œªt
,

359 
avÆue
, 
˛osuª
->
u£r_d©a
);

361  
Œªt
;

362 
	}
}

366 
ffi_°©us


367 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

368 
ffi_cif
* 
cif
,

369 (*
fun
)(
ffi_cif
 *, *, **, *),

370 *
u£r_d©a
,

371 *
codñoc
)

373 *
ö√r‚
 = 
ffi_¥ï_˛osuª_ö√r
;

374 
	`FFI_ASSERT
 (
cif
->
abi
 =
FFI_SYSV
);

375 
˛osuª
->
cif
 = cif;

376 
˛osuª
->
u£r_d©a
 = user_data;

377 
˛osuª
->
fun
 = fun;

378 
	`mem˝y
 (
˛osuª
->
åamp
, 
ffi_¸is_åampﬁöe_ãm∂©e
,

379 
FFI_CRIS_TRAMPOLINE_CODE_PART_SIZE
);

380 
	`mem˝y
 (
˛osuª
->
åamp
 + 
ffi_¸is_åampﬁöe_‚_off£t
,

381 &
ö√r‚
,  (*));

382 
	`mem˝y
 (
˛osuª
->
åamp
 + 
ffi_¸is_åampﬁöe_˛osuª_off£t
,

383 &
codñoc
,  (*));

385  
FFI_OK
;

386 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/cris/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


35 #i‚de‡
LIBFFI_ASM


36 
	tffi_¨g
;

37 sig√d 
	tffi_ßrg
;

39 
	effi_abi
 {

40 
	mFFI_FIRST_ABI
 = 0,

41 
	mFFI_SYSV
,

42 
	mFFI_LAST_ABI
,

43 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


44 } 
	tffi_abi
;

49 
	#FFI_CLOSURES
 1

	)

50 
	#FFI_CRIS_TRAMPOLINE_CODE_PART_SIZE
 36

	)

51 
	#FFI_CRIS_TRAMPOLINE_DATA_PART_SIZE
 (7*4)

	)

52 
	#FFI_TRAMPOLINE_SIZE
 \

53 (
FFI_CRIS_TRAMPOLINE_CODE_PART_SIZE
 + 
FFI_CRIS_TRAMPOLINE_DATA_PART_SIZE
)

	)

54 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/cris/sysv.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffi.h
>

29 
	#CONCAT
(
x
,
y
Ëx ## 
	)
y

30 
	#XCONCAT
(
x
,
y
Ë
	`CONCAT
 (x, y)

	)

31 
	#L
(
x
Ë
	`XCONCAT
 (
__USER_LABEL_PREFIX__
, x)

	)

33 .
	gãxt


35 ;; 
	gOK
, 
whí
 
we
 
gë
 
ˇŒed
 wê
should
 
have
 
this
 (
acc‹dög
 
to


36 ;; 
AXIS
 
ETRAX
 100LX 
Progømmî
's Manual chapter 6.3).

38 ;; 
R10
: 
ffi_¥ï_¨gs
 (
func
. 
poöãr
)

39 ;; 
R11
: &
ecif


40 ;; 
R12
: 
cif
->
byãs


41 ;; 
R13
: 
fig
->
Êags


42 ;; 
•
+0: 
ecif
.
rvÆue


43 ;; 
•
+4: 
‚
 (
fun˘i⁄
 
poöãr
 
to
 
the
 fun˘i⁄ 
th©
 
we
 
√ed
Åÿ
ˇŒ
)

45 .
globl
 
L
(
ffi_ˇŒ_SYSV
)

46 .
ty≥
 
L
(
ffi_ˇŒ_SYSV
),@
fun˘i⁄


47 .
hiddí
 
	$L
(
ffi_ˇŒ_SYSV
)

49 
	$L
(
ffi_ˇŒ_SYSV
):

50 ;; 
Save
 
the
 
ªgs
 
to
Åhê
°ack
.

51 
push
 
$§p


52 ;; 
U£d
 
°ack
 
poöãr
 
ßvög
.

53 
push
 
$r6


54 ;; 
U£d
 
fun˘i⁄
 
addªss
 
poöãr
.

55 
push
 
$r7


56 ;; 
U£d
 
°ack
 
poöãr
 
ßvög
.

57 
push
 
$r8


58 ;; 
We
 
ßve
 
fig
->
Êags
 
to
 
°ack
 
we
 
wûl
 
√ed
 
them
 
a·î
 we

59 ;; 
ˇŒ
 
The
 
Fun˘i⁄
.

60 
push
 
$r13


62 ;; 
Savög
 
cuºít
 
°ack
 
poöãr
.

63 
move
.
d
 
$•
,
$r8


64 
move
.
d
 
$•
,
$r6


66 ;; 
Move
 
addªss
 
of
 
ffi_¥ï_¨gs
 
to
 
r13
.

67 
move
.
d
 
$r10
,
$r13


69 ;; 
Make
 
room
 
⁄
 
the
 
°ack
 thê
¨gs
 
of
 
‚
.

70 
sub
.
d
 
$r12
,
$•


72 ;; 
Fun˘i⁄
 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
Ë
∑ømëîs
 
¨e
:

73 ;; 
r10
 <-- 
°ack
 
poöãr


74 ;; 
r11
 <-- &
	$ecif
 (
Æªady
 
thîe
)

75 
move
.
d
 
$•
,
$r10


77 ;; 
CÆl
 
the
 
fun˘i⁄
.

78 
j§
 
$r13


80 ;; 
Save
 
the
 
size
 
of
Åhê
°ru˘uªs
 
which
 
¨e
 
∑s£d
 
⁄
 
°ack
.

81 
move
.
d
 
$r10
,
$r7


83 ;; 
Move
 
fú°
 
four
 
¨gs
 
ö
 
to
 
r10
..
r13
.

84 
move
.
d
 [
$•
+0],
$r10


85 
move
.
d
 [
$•
+4],
$r11


86 
move
.
d
 [
$•
+8],
$r12


87 
move
.
d
 [
$•
+12],
$r13


89 ;; 
Adju°
 
the
 
°ack
 
™d
 
check
 
™y
 
∑ømëîs
 
¨e
 
giví
 
⁄
 stack.

90 
addq
 16,
$•


91 
sub
.
d
 
$r7
,
$r6


92 
cmp
.
d
 
$•
,
$r6


94 
b∂
 
go_⁄


95 
n›


97 
go_⁄_no_∑øms_⁄_°ack
:

98 
move
.
d
 
$r6
,
$•


100 
go_⁄
:

101 ;; 
Discovî
 
we
 
√ed
 
to
 
put
 
rvÆ
 
addªss
 
ö
Åÿ
r9
.

102 
move
.
d
 [
$r8
+0],
$r7


103 
cmpq
 
FFI_TYPE_STRUCT
,
$r7


104 
b√
 
ˇŒ_now


105 
n›


107 ;; 
Move
 
rvÆ
 
addªss
 
to
 
$r9
.

108 
move
.
d
 [
$r8
+20],
$r9


110 
ˇŒ_now
:

111 ;; 
Move
 
addªss
 
of
 
The
 
Fun˘i⁄
 
ö
 
to
 
r7
.

112 
move
.
d
 [
$r8
+24],
$r7


114 ;; 
CÆl
 
The
 
Fun˘i⁄
.

115 
j§
 
$r7


117 ;; 
Re£t
 
°ack
.

118 
move
.
d
 
$r8
,
$•


120 ;; 
Lﬂd
 
rvÆ
 
	`ty≥
 (
fig
->
Êags
Ë
ö
 
to
 
r13
.

121 
p›
 
$r13


123 ;; 
Dëe˘
 
rvÆ
 
ty≥
.

124 
cmpq
 
FFI_TYPE_VOID
,
$r13


125 
beq
 
ïûogue


127 
cmpq
 
FFI_TYPE_STRUCT
,
$r13


128 
beq
 
ïûogue


130 
cmpq
 
FFI_TYPE_DOUBLE
,
$r13


131 
beq
 
ªtu∫_doubÀ_‹_l⁄gl⁄g


133 
cmpq
 
FFI_TYPE_UINT64
,
$r13


134 
beq
 
ªtu∫_doubÀ_‹_l⁄gl⁄g


136 
cmpq
 
FFI_TYPE_SINT64
,
$r13


137 
beq
 
ªtu∫_doubÀ_‹_l⁄gl⁄g


138 
n›


140 ;; 
Ju°
  
the
 32 
bô
 
vÆue
.

141 
ba
 

142 
n›


144 
ªtu∫_doubÀ_‹_l⁄gl⁄g
:

145 ;; 
Lﬂd
 
hÆf
 
of
 
the
 
rvÆ
 
to
 
r10
 
™d
Åhê
Ÿhî
 hÆ‡tÿ
r11
.

146 
move
.
d
 [
$•
+16],
$r13


147 
move
.
d
 
$r10
,[
$r13
]

148 
addq
 4,
$r13


149 
move
.
d
 
$r11
,[
$r13
]

150 
ba
 
ïûogue


151 
n›


154 ;; 
Lﬂd
 
the
 
rvÆ
 
to
 
r10
.

155 
move
.
d
 [
$•
+16],
$r13


156 
move
.
d
 
$r10
,[
$r13
]

158 
ïûogue
:

159 
p›
 
$r8


160 
p›
 
$r7


161 
p›
 
$r6


162 
Jump
 [
$•
+]

164 .
size
 
ffi_ˇŒ_SYSV
,.-ffi_call_SYSV

172 .
globl
 
	`L
(
ffi_¸is_åampﬁöe_ãm∂©e
)

173 .
ty≥
 
	`L
(
ffi_¸is_åampﬁöe_ãm∂©e
),@
fun˘i⁄


174 .
hiddí
 
	$L
(
ffi_¸is_åampﬁöe_ãm∂©e
)

176 
	$L
(
ffi_¸is_åampﬁöe_ãm∂©e
):

180 
move
.
d
 
$r10
,[
$pc
+2f-(0b+2)]

181 
move
.
d
 
$pc
,
$r10


183 
addq
 2f-1b+4,
$r10


184 
move
.
d
 
$r11
,[
$r10
+]

185 
move
.
d
 
$r12
,[
$r10
+]

186 
move
.
d
 
$r13
,[
$r10
+]

187 
move
.
d
 [
$•
],
$r11


188 
move
.
d
 
$r11
,[
$r10
+]

189 
move
.
d
 
$r9
,[
$r10
+]

190 
move
.
d
 
$•
,[
$r10
+]

191 
subq
 
FFI_CRIS_TRAMPOLINE_DATA_PART_SIZE
,
$r10


192 
move
.
d
 0,
$r11


194 
jump
 0

196 .
size
 
ffi_¸is_åampﬁöe_ãm∂©e
,.-0b

201 .
ma¸o
 c⁄° 
«me
,
vÆue


202 .
globl
 \
«me


203 .
ty≥
 \
«me
,@
obje˘


204 .
hiddí
 \
«me


205 \
«me
:

206 .
dw‹d
 \
vÆue


207 .
size
 \
«me
,4

208 .
ídm


214 c⁄° 
	`L
(
ffi_¸is_åampﬁöe_‚_off£t
),2b-4-0b

215 c⁄° 
	`L
(
ffi_¸is_åampﬁöe_˛osuª_off£t
),3b-4-0b

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/debug.c

25 
	~<ffi.h
>

26 
	~<ffi_comm⁄.h
>

27 
	~<°dlib.h
>

28 
	~<°dio.h
>

32 
	$ffi_°›_hîe
()

37 
	}
}

41 
	$ffi_as£π
(*
ex¥
, *
fûe
, 
löe
)

43 
	`Ârötf
(
°dîr
, "ASSERTION FAILURE: %†© %s:%d\n", 
ex¥
, 
fûe
, 
löe
);

44 
	`ffi_°›_hîe
();

45 
	`ab‹t
();

46 
	}
}

50 
	$ffi_ty≥_ã°
(
ffi_ty≥
 *
a
, *
fûe
, 
löe
)

52 
	`FFI_ASSERT_AT
(
a
 !
NULL
, 
fûe
, 
löe
);

54 
	`FFI_ASSERT_AT
(
a
->
ty≥
 <
FFI_TYPE_LAST
, 
fûe
, 
löe
);

55 
	`FFI_ASSERT_AT
(
a
->
ty≥
 =
FFI_TYPE_VOID
 ||á->
size
 > 0, 
fûe
, 
löe
);

56 
	`FFI_ASSERT_AT
(
a
->
ty≥
 =
FFI_TYPE_VOID
 ||á->
Æignmít
 > 0, 
fûe
, 
löe
);

57 
	`FFI_ASSERT_AT
((
a
->
ty≥
 !
FFI_TYPE_STRUCT
 &&á->ty≥ !
FFI_TYPE_COMPLEX
)

58 || 
a
->
ñemíts
 !
NULL
, 
fûe
, 
löe
);

59 
	`FFI_ASSERT_AT
(
a
->
ty≥
 !
FFI_TYPE_COMPLEX


60 || (
a
->
ñemíts
 !
NULL


61 && 
a
->
ñemíts
[0] !
NULL
 &&á->elements[1] == NULL),

62 
fûe
, 
löe
);

64 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/dlmalloc.c

441 #i‚de‡
WIN32


442 #ifde‡
_WIN32


443 
	#WIN32
 1

	)

446 #ifde‡
WIN32


447 
	#WIN32_LEAN_AND_MEAN


	)

448 
	~<wödows.h
>

449 
	#HAVE_MMAP
 1

	)

450 
	#HAVE_MORECORE
 0

	)

451 
	#LACKS_UNISTD_H


	)

452 
	#LACKS_SYS_PARAM_H


	)

453 
	#LACKS_SYS_MMAN_H


	)

454 
	#LACKS_STRING_H


	)

455 
	#LACKS_STRINGS_H


	)

456 
	#LACKS_SYS_TYPES_H


	)

457 
	#LACKS_ERRNO_H


	)

458 
	#MALLOC_FAILURE_ACTION


	)

459 
	#MMAP_CLEARS
 0

	)

462 #ifde‡
__OS2__


463 
	#INCL_DOS


	)

464 
	~<os2.h
>

465 
	#HAVE_MMAP
 1

	)

466 
	#HAVE_MORECORE
 0

	)

467 
	#LACKS_SYS_MMAN_H


	)

470 #i‡
deföed
(
DARWIN
Ë|| deföed(
_DARWIN
)

472 #i‚de‡
HAVE_MORECORE


473 
	#HAVE_MORECORE
 0

	)

474 
	#HAVE_MMAP
 1

	)

478 #i‚de‡
LACKS_SYS_TYPES_H


479 
	~<sys/ty≥s.h
>

483 
	#MAX_SIZE_T
 (~(
size_t
)0)

	)

485 #i‚de‡
ONLY_MSPACES


486 
	#ONLY_MSPACES
 0

	)

488 #i‚de‡
MSPACES


489 #i‡
ONLY_MSPACES


490 
	#MSPACES
 1

	)

492 
	#MSPACES
 0

	)

495 #i‚de‡
MALLOC_ALIGNMENT


496 
	#MALLOC_ALIGNMENT
 ((
size_t
)8U)

	)

498 #i‚de‡
FOOTERS


499 
	#FOOTERS
 0

	)

501 #i‚de‡
ABORT


502 
	#ABORT
 
	`ab‹t
()

	)

504 #i‚de‡
ABORT_ON_ASSERT_FAILURE


505 
	#ABORT_ON_ASSERT_FAILURE
 1

	)

507 #i‚de‡
PROCEED_ON_ERROR


508 
	#PROCEED_ON_ERROR
 0

	)

510 #i‚de‡
USE_LOCKS


511 
	#USE_LOCKS
 0

	)

513 #i‚de‡
INSECURE


514 
	#INSECURE
 0

	)

516 #i‚de‡
HAVE_MMAP


517 
	#HAVE_MMAP
 1

	)

519 #i‚de‡
MMAP_CLEARS


520 
	#MMAP_CLEARS
 1

	)

522 #i‚de‡
HAVE_MREMAP


523 #ifde‡
löux


524 
	#HAVE_MREMAP
 1

	)

526 
	#HAVE_MREMAP
 0

	)

529 #i‚de‡
MALLOC_FAILURE_ACTION


530 
	#MALLOC_FAILURE_ACTION
 
î∫o
 = 
ENOMEM
;

	)

532 #i‚de‡
HAVE_MORECORE


533 #i‡
ONLY_MSPACES


534 
	#HAVE_MORECORE
 0

	)

536 
	#HAVE_MORECORE
 1

	)

539 #i‡!
HAVE_MORECORE


540 
	#MORECORE_CONTIGUOUS
 0

	)

542 #i‚de‡
MORECORE


543 
	#MORECORE
 
sbrk


	)

545 #i‚de‡
MORECORE_CONTIGUOUS


546 
	#MORECORE_CONTIGUOUS
 1

	)

549 #i‚de‡
DEFAULT_GRANULARITY


550 #i‡
MORECORE_CONTIGUOUS


551 
	#DEFAULT_GRANULARITY
 (0Ë

	)

553 
	#DEFAULT_GRANULARITY
 ((
size_t
)64U * (size_t)1024U)

	)

556 #i‚de‡
DEFAULT_TRIM_THRESHOLD


557 #i‚de‡
MORECORE_CANNOT_TRIM


558 
	#DEFAULT_TRIM_THRESHOLD
 ((
size_t
)2U * (size_t)1024U * (size_t)1024U)

	)

560 
	#DEFAULT_TRIM_THRESHOLD
 
MAX_SIZE_T


	)

563 #i‚de‡
DEFAULT_MMAP_THRESHOLD


564 #i‡
HAVE_MMAP


565 
	#DEFAULT_MMAP_THRESHOLD
 ((
size_t
)256U * (size_t)1024U)

	)

567 
	#DEFAULT_MMAP_THRESHOLD
 
MAX_SIZE_T


	)

570 #i‚de‡
USE_BUILTIN_FFS


571 
	#USE_BUILTIN_FFS
 0

	)

573 #i‚de‡
USE_DEV_RANDOM


574 
	#USE_DEV_RANDOM
 0

	)

576 #i‚de‡
NO_MALLINFO


577 
	#NO_MALLINFO
 0

	)

579 #i‚de‡
MALLINFO_FIELD_TYPE


580 
	#MALLINFO_FIELD_TYPE
 
size_t


	)

590 
	#M_TRIM_THRESHOLD
 (-1)

	)

591 
	#M_GRANULARITY
 (-2)

	)

592 
	#M_MMAP_THRESHOLD
 (-3)

	)

596 #i‡!
NO_MALLINFO


621 #ifde‡
HAVE_USR_INCLUDE_MALLOC_H


622 
	~"/u§/ö˛ude/mÆloc.h
"

626 
	#_STRUCT_MALLINFO


	)

628 
	smÆlöfo
 {

629 
MALLINFO_FIELD_TYPE
 
	m¨ía
;

630 
MALLINFO_FIELD_TYPE
 
	m‹dblks
;

631 
MALLINFO_FIELD_TYPE
 
	msmblks
;

632 
MALLINFO_FIELD_TYPE
 
	mhblks
;

633 
MALLINFO_FIELD_TYPE
 
	mhblkhd
;

634 
MALLINFO_FIELD_TYPE
 
	musmblks
;

635 
MALLINFO_FIELD_TYPE
 
	mfsmblks
;

636 
MALLINFO_FIELD_TYPE
 
	mu‹dblks
;

637 
MALLINFO_FIELD_TYPE
 
	mf‹dblks
;

638 
MALLINFO_FIELD_TYPE
 
	mkìpco°
;

644 #ifde‡
__˝lu•lus


648 #i‡!
ONLY_MSPACES


652 #i‚de‡
USE_DL_PREFIX


653 
	#dlˇŒoc
 
ˇŒoc


	)

654 
	#dl‰ì
 
‰ì


	)

655 
	#dlmÆloc
 
mÆloc


	)

656 
	#dlmemÆign
 
memÆign


	)

657 
	#dÃóŒoc
 
ªÆloc


	)

658 
	#dlvÆloc
 
vÆloc


	)

659 
	#dÕvÆloc
 
pvÆloc


	)

660 
	#dlmÆlöfo
 
mÆlöfo


	)

661 
	#dlmÆl›t
 
mÆl›t


	)

662 
	#dlmÆloc_åim
 
mÆloc_åim


	)

663 
	#dlmÆloc_°©s
 
mÆloc_°©s


	)

664 
	#dlmÆloc_ußbÀ_size
 
mÆloc_ußbÀ_size


	)

665 
	#dlmÆloc_foŸ¥öt
 
mÆloc_foŸ¥öt


	)

666 
	#dlmÆloc_max_foŸ¥öt
 
mÆloc_max_foŸ¥öt


	)

667 
	#dlödïídít_ˇŒoc
 
ödïídít_ˇŒoc


	)

668 
	#dlödïídít_comÆloc
 
ödïídít_comÆloc


	)

686 * 
dlmÆloc
(
size_t
);

695 
dl‰ì
(*);

702 * 
dlˇŒoc
(
size_t
, size_t);

727 * 
dÃóŒoc
(*, 
size_t
);

741 * 
dlmemÆign
(
size_t
, size_t);

748 * 
dlvÆloc
(
size_t
);

768 
dlmÆl›t
(, );

779 
size_t
 
dlmÆloc_foŸ¥öt
();

792 
size_t
 
dlmÆloc_max_foŸ¥öt
();

794 #i‡!
NO_MALLINFO


817 
mÆlöfo
 
dlmÆlöfo
();

872 ** 
dlödïídít_ˇŒoc
(
size_t
, size_t, **);

933 ** 
dlödïídít_comÆloc
(
size_t
, size_t*, **);

941 * 
dÕvÆloc
(
size_t
);

964 
dlmÆloc_åim
(
size_t
);

980 
size_t
 
dlmÆloc_ußbÀ_size
(*);

1001 
dlmÆloc_°©s
();

1005 #i‡
MSPACES


1011 * 
	tm•a˚
;

1024 
m•a˚
 
¸óã_m•a˚
(
size_t
 
ˇ∑côy
, 
locked
);

1032 
size_t
 
de°roy_m•a˚
(
m•a˚
 
m•
);

1043 
m•a˚
 
¸óã_m•a˚_wôh_ba£
(* 
ba£
, 
size_t
 
ˇ∑côy
, 
locked
);

1049 * 
m•a˚_mÆloc
(
m•a˚
 
m•
, 
size_t
 
byãs
);

1059 
m•a˚_‰ì
(
m•a˚
 
m•
, * 
mem
);

1070 * 
m•a˚_ªÆloc
(
m•a˚
 
m•
, * 
mem
, 
size_t
 
√wsize
);

1076 * 
m•a˚_ˇŒoc
(
m•a˚
 
m•
, 
size_t
 
n_ñemíts
, size_à
ñem_size
);

1082 * 
m•a˚_memÆign
(
m•a˚
 
m•
, 
size_t
 
Æignmít
, size_à
byãs
);

1088 ** 
m•a˚_ödïídít_ˇŒoc
(
m•a˚
 
m•
, 
size_t
 
n_ñemíts
,

1089 
size_t
 
ñem_size
, * 
chunks
[]);

1095 ** 
m•a˚_ödïídít_comÆloc
(
m•a˚
 
m•
, 
size_t
 
n_ñemíts
,

1096 
size_t
 
sizes
[], * 
chunks
[]);

1102 
size_t
 
m•a˚_foŸ¥öt
(
m•a˚
 
m•
);

1108 
size_t
 
m•a˚_max_foŸ¥öt
(
m•a˚
 
m•
);

1111 #i‡!
NO_MALLINFO


1116 
mÆlöfo
 
m•a˚_mÆlöfo
(
m•a˚
 
m•
);

1123 
m•a˚_mÆloc_°©s
(
m•a˚
 
m•
);

1129 
m•a˚_åim
(
m•a˚
 
m•
, 
size_t
 
∑d
);

1134 
m•a˚_mÆl›t
(, );

1138 #ifde‡
__˝lu•lus


1154 #ifde‡
_MSC_VER


1155 #¥agm®
w¨nög
–
dißbÀ
 : 4146 )

1158 
	~<°dio.h
>

1160 #i‚de‡
LACKS_ERRNO_H


1161 
	~<î∫o.h
>

1163 #i‡
FOOTERS


1164 
	~<time.h
>

1166 #i‚de‡
LACKS_STDLIB_H


1167 
	~<°dlib.h
>

1169 #ifde‡
DEBUG


1170 #i‡
ABORT_ON_ASSERT_FAILURE


1171 
	#as£π
(
x
Ëif(!(x)Ë
ABORT


	)

1173 
	~<as£π.h
>

1176 
	#as£π
(
x
)

	)

1178 #i‚de‡
LACKS_STRING_H


1179 
	~<°rög.h
>

1181 #i‡
USE_BUILTIN_FFS


1182 #i‚de‡
LACKS_STRINGS_H


1183 
	~<°rögs.h
>

1186 #i‡
HAVE_MMAP


1187 #i‚de‡
LACKS_SYS_MMAN_H


1188 
	~<sys/mm™.h
>

1190 #i‚de‡
LACKS_FCNTL_H


1191 
	~<f˙é.h
>

1194 #i‡
HAVE_MORECORE


1195 #i‚de‡
LACKS_UNISTD_H


1196 
	~<uni°d.h
>

1198 #i‡!
deföed
(
__FªeBSD__
Ë&& !deföed(
__O≥nBSD__
Ë&& !deföed(
__NëBSD__
)

1199 * 
sbrk
(
±rdiff_t
);

1204 #i‚de‡
WIN32


1205 #i‚de‡
mÆloc_gë∑gesize


1206 #ifde‡
_SC_PAGESIZE


1207 #i‚de‡
_SC_PAGE_SIZE


1208 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

1211 #ifde‡
_SC_PAGE_SIZE


1212 
	#mÆloc_gë∑gesize
 
	`sysc⁄f
(
_SC_PAGE_SIZE
)

	)

1214 #i‡
deföed
(
BSD
Ë|| deföed(
DGUX
Ë|| deföed(
HAVE_GETPAGESIZE
)

1215 
size_t
 
gë∑gesize
();

1216 
	#mÆloc_gë∑gesize
 
	`gë∑gesize
()

	)

1218 #ifde‡
WIN32


1219 
	#mÆloc_gë∑gesize
 
	`gë∑gesize
()

	)

1221 #i‚de‡
LACKS_SYS_PARAM_H


1222 
	~<sys/∑øm.h
>

1224 #ifde‡
EXEC_PAGESIZE


1225 
	#mÆloc_gë∑gesize
 
EXEC_PAGESIZE


	)

1227 #ifde‡
NBPG


1228 #i‚de‡
CLSIZE


1229 
	#mÆloc_gë∑gesize
 
NBPG


	)

1231 
	#mÆloc_gë∑gesize
 (
NBPG
 * 
CLSIZE
)

	)

1234 #ifde‡
NBPC


1235 
	#mÆloc_gë∑gesize
 
NBPC


	)

1237 #ifde‡
PAGESIZE


1238 
	#mÆloc_gë∑gesize
 
PAGESIZE


	)

1240 
	#mÆloc_gë∑gesize
 ((
size_t
)4096U)

	)

1254 
	#SIZE_T_SIZE
 ((
size_t
))

	)

1255 
	#SIZE_T_BITSIZE
 ((
size_t
Ë<< 3)

	)

1259 
	#SIZE_T_ZERO
 ((
size_t
)0)

	)

1260 
	#SIZE_T_ONE
 ((
size_t
)1)

	)

1261 
	#SIZE_T_TWO
 ((
size_t
)2)

	)

1262 
	#TWO_SIZE_T_SIZES
 (
SIZE_T_SIZE
<<1)

	)

1263 
	#FOUR_SIZE_T_SIZES
 (
SIZE_T_SIZE
<<2)

	)

1264 
	#SIX_SIZE_T_SIZES
 (
FOUR_SIZE_T_SIZES
+
TWO_SIZE_T_SIZES
)

	)

1265 
	#HALF_MAX_SIZE_T
 (
MAX_SIZE_T
 / 2U)

	)

1268 
	#CHUNK_ALIGN_MASK
 (
MALLOC_ALIGNMENT
 - 
SIZE_T_ONE
)

	)

1271 
	#is_Æig√d
(
A
Ë(((
size_t
)((A)Ë& (
CHUNK_ALIGN_MASK
)Ë=0)

	)

1274 
	#Æign_off£t
(
A
)\

1275 ((((
size_t
)(
A
Ë& 
CHUNK_ALIGN_MASK
) == 0)? 0 :\

1276 ((
MALLOC_ALIGNMENT
 - ((
size_t
)(
A
Ë& 
CHUNK_ALIGN_MASK
)Ë& CHUNK_ALIGN_MASK))

	)

1288 
	#MFAIL
 ((*)(
MAX_SIZE_T
))

	)

1289 
	#CMFAIL
 ((*)(
MFAIL
)Ë

	)

1291 #i‡!
HAVE_MMAP


1292 
	#IS_MMAPPED_BIT
 (
SIZE_T_ZERO
)

	)

1293 
	#USE_MMAP_BIT
 (
SIZE_T_ZERO
)

	)

1294 
	#CALL_MMAP
(
s
Ë
MFAIL


	)

1295 
	#CALL_MUNMAP
(
a
, 
s
Ë(-1)

	)

1296 
	#DIRECT_MMAP
(
s
Ë
MFAIL


	)

1299 
	#IS_MMAPPED_BIT
 (
SIZE_T_ONE
)

	)

1300 
	#USE_MMAP_BIT
 (
SIZE_T_ONE
)

	)

1302 #i‡!
deföed
(
WIN32
Ë&& !deföed (
__OS2__
)

1303 
	#CALL_MUNMAP
(
a
, 
s
Ë
	`munm≠
(◊), (s))

	)

1304 
	#MMAP_PROT
 (
PROT_READ
|
PROT_WRITE
)

	)

1305 #i‡!
deföed
(
MAP_ANONYMOUS
Ë&& deföed(
MAP_ANON
)

1306 
	#MAP_ANONYMOUS
 
MAP_ANON


	)

1308 #ifde‡
MAP_ANONYMOUS


1309 
	#MMAP_FLAGS
 (
MAP_PRIVATE
|
MAP_ANONYMOUS
)

	)

1310 
	#CALL_MMAP
(
s
Ë
	`mm≠
(0, (s), 
MMAP_PROT
, 
MMAP_FLAGS
, -1, 0)

	)

1316 
	#MMAP_FLAGS
 (
MAP_PRIVATE
)

	)

1317 
	gdev_zîo_fd
 = -1;

1318 
	#CALL_MMAP
(
s
Ë((
dev_zîo_fd
 < 0) ? \

1319 (
dev_zîo_fd
 = 
	`›í
("/dev/zîo", 
O_RDWR
), \

1320 
	`mm≠
(0, (
s
), 
MMAP_PROT
, 
MMAP_FLAGS
, 
dev_zîo_fd
, 0)) : \

1321 
	`mm≠
(0, (
s
), 
MMAP_PROT
, 
MMAP_FLAGS
, 
dev_zîo_fd
, 0))

	)

1324 
	#DIRECT_MMAP
(
s
Ë
	`CALL_MMAP
(s)

	)

1326 #ñi‡
deföed
(
__OS2__
)

1329 * 
os2mm≠
(
size_t
 
size
) {

1330 * 
	g±r
;

1331 i‡(
DosAŒocMem
(&
±r
, 
size
, 
OBJ_ANY
|
PAG_COMMIT
|
PAG_READ
|
PAG_WRITE
) &&

1332 
DosAŒocMem
(&
±r
, 
size
, 
PAG_COMMIT
|
PAG_READ
|
PAG_WRITE
))

1333  
	gMFAIL
;

1334  
	g±r
;

1337 
	#os2dúe˘_mm≠
(
n
Ë
	`os2mm≠
“)

	)

1340 
os2munm≠
(* 
±r
, 
size_t
 
size
) {

1341 
	gsize
) {

1342 
ULONG
 
	gulSize
 = 
size
;

1343 
ULONG
 
	gulFœgs
 = 0;

1344 i‡(
DosQuîyMem
(
±r
, &
ulSize
, &
ulFœgs
) != 0)

1346 i‡((
	gulFœgs
 & 
	gPAG_BASE
Ë=0 ||(
ulFœgs
 & 
PAG_COMMIT
) == 0 ||

1347 
ulSize
 > 
size
)

1349 i‡(
DosFªeMem
(
±r
) != 0)

1351 
	g±r
 = ( * ) ( ( * ) 
±r
 + 
ulSize
 );

1352 
	gsize
 -
ulSize
;

1357 
	#CALL_MMAP
(
s
Ë
	`os2mm≠
(s)

	)

1358 
	#CALL_MUNMAP
(
a
, 
s
Ë
	`os2munm≠
(◊), (s))

	)

1359 
	#DIRECT_MMAP
(
s
Ë
	`os2dúe˘_mm≠
(s)

	)

1364 * 
wö32mm≠
(
size_t
 
size
) {

1365 * 
	g±r
 = 
VútuÆAŒoc
(0, 
size
, 
MEM_RESERVE
|
MEM_COMMIT
, 
PAGE_EXECUTE_READWRITE
);

1366  (
	g±r
 !0)? 
±r
: 
MFAIL
;

1370 * 
wö32dúe˘_mm≠
(
size_t
 
size
) {

1371 * 
	g±r
 = 
VútuÆAŒoc
(0, 
size
, 
MEM_RESERVE
|
MEM_COMMIT
|
MEM_TOP_DOWN
,

1372 
PAGE_EXECUTE_READWRITE
);

1373  (
	g±r
 !0)? 
±r
: 
MFAIL
;

1377 
wö32munm≠
(* 
±r
, 
size_t
 
size
) {

1378 
MEMORY_BASIC_INFORMATION
 
	gmöfo
;

1379 * 
	g˝å
 = 
±r
;

1380 
	gsize
) {

1381 i‡(
VútuÆQuîy
(
˝å
, &
möfo
, (minfo)) == 0)

1383 i‡(
	gmöfo
.
	gBa£Addªss
 !
˝å
 || 
möfo
.
AŒoˇti⁄Ba£
 != cptr ||

1384 
möfo
.
Sèã
 !
MEM_COMMIT
 || möfo.
Regi⁄Size
 > 
size
)

1386 i‡(
VútuÆFªe
(
˝å
, 0, 
MEM_RELEASE
) == 0)

1388 
	g˝å
 +
möfo
.
Regi⁄Size
;

1389 
	gsize
 -
möfo
.
Regi⁄Size
;

1394 
	#CALL_MMAP
(
s
Ë
	`wö32mm≠
(s)

	)

1395 
	#CALL_MUNMAP
(
a
, 
s
Ë
	`wö32munm≠
(◊), (s))

	)

1396 
	#DIRECT_MMAP
(
s
Ë
	`wö32dúe˘_mm≠
(s)

	)

1400 #i‡
HAVE_MMAP
 && 
HAVE_MREMAP


1401 
	#CALL_MREMAP
(
addr
, 
osz
, 
nsz
, 
mv
Ë
	`mªm≠
(◊ddr), (osz), (nsz), (mv))

	)

1403 
	#CALL_MREMAP
(
addr
, 
osz
, 
nsz
, 
mv
Ë
MFAIL


	)

1406 #i‡
HAVE_MORECORE


1407 
	#CALL_MORECORE
(
S
Ë
	`MORECORE
(S)

	)

1409 
	#CALL_MORECORE
(
S
Ë
MFAIL


	)

1413 
	#USE_NONCONTIGUOUS_BIT
 (4U)

	)

1416 
	#EXTERN_BIT
 (8U)

	)

1421 #i‡
USE_LOCKS


1437 #i‡!
deföed
(
WIN32
Ë&& !deföed(
__OS2__
)

1439 
	~<±hªad.h
>

1440 
	#MLOCK_T
 
±hªad_muãx_t


	)

1441 
	#INITIAL_LOCK
(
l
Ë
	`±hªad_muãx_öô
÷, 
NULL
)

	)

1442 
	#ACQUIRE_LOCK
(
l
Ë
	`±hªad_muãx_lock
÷)

	)

1443 
	#RELEASE_LOCK
(
l
Ë
	`±hªad_muãx_u∆ock
÷)

	)

1445 #i‡
HAVE_MORECORE


1446 
MLOCK_T
 
	gm‹ec‹e_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

1449 
MLOCK_T
 
	gmagic_öô_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

1451 #ñi‡
deföed
(
__OS2__
)

1452 
	#MLOCK_T
 
HMTX


	)

1453 
	#INITIAL_LOCK
(
l
Ë
	`DosCª©eMuãxSem
(0,Ü, 0, 
FALSE
)

	)

1454 
	#ACQUIRE_LOCK
(
l
Ë
	`DosReque°MuãxSem
(*l, 
SEM_INDEFINITE_WAIT
)

	)

1455 
	#RELEASE_LOCK
(
l
Ë
	`DosRñó£MuãxSem
(*l)

	)

1456 #i‡
HAVE_MORECORE


1457 
MLOCK_T
 
	gm‹ec‹e_muãx
;

1459 
MLOCK_T
 
	gmagic_öô_muãx
;

1467 
	#MLOCK_T
 

	)

1468 
wö32_acquúe_lock
 (
MLOCK_T
 *
¶
) {

1470 #ifde‡
I¡îlockedCom∑ªExch™gePoöãr


1471 i‡(!
I¡îlockedCom∑ªExch™ge
(
¶
, 1, 0))

1474 i‡(!
I¡îlockedCom∑ªExch™ge
((**)
¶
, (*)1, (*)0))

1477 
SÀï
 (0);

1481 
wö32_ªÀa£_lock
 (
MLOCK_T
 *
¶
) {

1482 
I¡îlockedExch™ge
 (
¶
, 0);

1485 
	#INITIAL_LOCK
(
l
Ë*÷)=0

	)

1486 
	#ACQUIRE_LOCK
(
l
Ë
	`wö32_acquúe_lock
÷)

	)

1487 
	#RELEASE_LOCK
(
l
Ë
	`wö32_ªÀa£_lock
÷)

	)

1488 #i‡
HAVE_MORECORE


1489 
MLOCK_T
 
	gm‹ec‹e_muãx
;

1491 
MLOCK_T
 
	gmagic_öô_muãx
;

1494 
	#USE_LOCK_BIT
 (2U)

	)

1496 
	#USE_LOCK_BIT
 (0U)

	)

1497 
	#INITIAL_LOCK
(
l
)

	)

1500 #i‡
USE_LOCKS
 && 
HAVE_MORECORE


1501 
	#ACQUIRE_MORECORE_LOCK
(Ë
	`ACQUIRE_LOCK
(&
m‹ec‹e_muãx
);

	)

1502 
	#RELEASE_MORECORE_LOCK
(Ë
	`RELEASE_LOCK
(&
m‹ec‹e_muãx
);

	)

1504 
	#ACQUIRE_MORECORE_LOCK
()

	)

1505 
	#RELEASE_MORECORE_LOCK
()

	)

1508 #i‡
USE_LOCKS


1509 
	#ACQUIRE_MAGIC_INIT_LOCK
(Ë
	`ACQUIRE_LOCK
(&
magic_öô_muãx
);

	)

1510 
	#RELEASE_MAGIC_INIT_LOCK
(Ë
	`RELEASE_LOCK
(&
magic_öô_muãx
);

	)

1512 
	#ACQUIRE_MAGIC_INIT_LOCK
()

	)

1513 
	#RELEASE_MAGIC_INIT_LOCK
()

	)

1654 
	smÆloc_chunk
 {

1655 
size_t
 
	g¥ev_foŸ
;

1656 
size_t
 
	ghód
;

1657 
mÆloc_chunk
* 
	gfd
;

1658 
mÆloc_chunk
* 
	gbk
;

1661 
mÆloc_chunk
 
	tmchunk
;

1662 
mÆloc_chunk
* 
	tmchunk±r
;

1663 
mÆloc_chunk
* 
	tsbö±r
;

1664 
size_t
 
	tbödex_t
;

1665 
	tböm≠_t
;

1666 
	tÊag_t
;

1670 
	#MCHUNK_SIZE
 ((
mchunk
))

	)

1672 #i‡
FOOTERS


1673 
	#CHUNK_OVERHEAD
 (
TWO_SIZE_T_SIZES
)

	)

1675 
	#CHUNK_OVERHEAD
 (
SIZE_T_SIZE
)

	)

1679 
	#MMAP_CHUNK_OVERHEAD
 (
TWO_SIZE_T_SIZES
)

	)

1681 
	#MMAP_FOOT_PAD
 (
FOUR_SIZE_T_SIZES
)

	)

1684 
	#MIN_CHUNK_SIZE
\

1685 ((
MCHUNK_SIZE
 + 
CHUNK_ALIGN_MASK
Ë& ~CHUNK_ALIGN_MASK)

	)

1688 
	#chunk2mem
(
p
Ë((*)((*)’Ë+ 
TWO_SIZE_T_SIZES
))

	)

1689 
	#mem2chunk
(
mem
Ë((
mchunk±r
)((*)(memË- 
TWO_SIZE_T_SIZES
))

	)

1691 
	#Æign_as_chunk
(
A
Ë(
mchunk±r
)((AË+ 
	`Æign_off£t
(
	`chunk2mem
(A)))

	)

1694 
	#MAX_REQUEST
 ((-
MIN_CHUNK_SIZE
Ë<< 2)

	)

1695 
	#MIN_REQUEST
 (
MIN_CHUNK_SIZE
 - 
CHUNK_OVERHEAD
 - 
SIZE_T_ONE
)

	)

1698 
	#∑d_ªque°
(
ªq
) \

1699 (((
ªq
Ë+ 
CHUNK_OVERHEAD
 + 
CHUNK_ALIGN_MASK
Ë& ~CHUNK_ALIGN_MASK)

	)

1702 
	#ªque°2size
(
ªq
) \

1703 (((
ªq
Ë< 
MIN_REQUEST
)? 
MIN_CHUNK_SIZE
 : 
	`∑d_ªque°
‘eq))

	)

1716 
	#PINUSE_BIT
 (
SIZE_T_ONE
)

	)

1717 
	#CINUSE_BIT
 (
SIZE_T_TWO
)

	)

1718 
	#INUSE_BITS
 (
PINUSE_BIT
|
CINUSE_BIT
)

	)

1721 
	#FENCEPOST_HEAD
 (
INUSE_BITS
|
SIZE_T_SIZE
)

	)

1724 
	#cöu£
(
p
Ë(’)->
hód
 & 
CINUSE_BIT
)

	)

1725 
	#pöu£
(
p
Ë(’)->
hód
 & 
PINUSE_BIT
)

	)

1726 
	#chunksize
(
p
Ë(’)->
hód
 & ~(
INUSE_BITS
))

	)

1728 
	#˛ór_pöu£
(
p
Ë(’)->
hód
 &~
PINUSE_BIT
)

	)

1729 
	#˛ór_cöu£
(
p
Ë(’)->
hód
 &~
CINUSE_BIT
)

	)

1732 
	#chunk_∂us_off£t
(
p
, 
s
Ë((
mchunk±r
)(((*)’)Ë+ (s)))

	)

1733 
	#chunk_möus_off£t
(
p
, 
s
Ë((
mchunk±r
)(((*)’)Ë- (s)))

	)

1736 
	#√xt_chunk
(
p
Ë((
mchunk±r
)–((*)’)Ë+ (’)->
hód
 & ~
INUSE_BITS
)))

	)

1737 
	#¥ev_chunk
(
p
Ë((
mchunk±r
)–((*)’)Ë- (’)->
¥ev_foŸ
Ë))

	)

1740 
	#√xt_pöu£
(
p
Ë((
	`√xt_chunk
’)->
hód
Ë& 
PINUSE_BIT
)

	)

1743 
	#gë_foŸ
(
p
, 
s
Ë(((
mchunk±r
)((*)’Ë+ (s)))->
¥ev_foŸ
)

	)

1744 
	#£t_foŸ
(
p
, 
s
Ë(((
mchunk±r
)((*)’Ë+ (s)))->
¥ev_foŸ
 = (s))

	)

1747 
	#£t_size_™d_pöu£_of_‰ì_chunk
(
p
, 
s
)\

1748 ((
p
)->
hód
 = (
s
|
PINUSE_BIT
), 
	`£t_foŸ
’, s))

	)

1751 
	#£t_‰ì_wôh_pöu£
(
p
, 
s
, 
n
)\

1752 (
	`˛ór_pöu£
(
n
), 
	`£t_size_™d_pöu£_of_‰ì_chunk
(
p
, 
s
))

	)

1754 
	#is_mm≠≥d
(
p
)\

1755 (!((
p
)->
hód
 & 
PINUSE_BIT
Ë&& (’)->
¥ev_foŸ
 & 
IS_MMAPPED_BIT
))

	)

1758 
	#ovîhód_f‹
(
p
)\

1759 (
	`is_mm≠≥d
(
p
)? 
MMAP_CHUNK_OVERHEAD
 : 
CHUNK_OVERHEAD
)

	)

1762 #i‡
MMAP_CLEARS


1763 
	#ˇŒoc_mu°_˛ór
(
p
Ë(!
	`is_mm≠≥d
’))

	)

1765 
	#ˇŒoc_mu°_˛ór
(
p
Ë(1)

	)

1859 
	smÆloc_åì_chunk
 {

1861 
size_t
 
	g¥ev_foŸ
;

1862 
size_t
 
	ghód
;

1863 
mÆloc_åì_chunk
* 
	gfd
;

1864 
mÆloc_åì_chunk
* 
	gbk
;

1866 
mÆloc_åì_chunk
* 
	gchûd
[2];

1867 
mÆloc_åì_chunk
* 
	g∑ª¡
;

1868 
bödex_t
 
	gödex
;

1871 
mÆloc_åì_chunk
 
	ttchunk
;

1872 
mÆloc_åì_chunk
* 
	ttchunk±r
;

1873 
mÆloc_åì_chunk
* 
	ttbö±r
;

1876 
	#À·mo°_chûd
(
t
Ë(—)->
chûd
[0] !0? (t)->chûd[0] : (t)->chûd[1])

	)

1935 
	smÆloc_£gmít
 {

1936 * 
	gba£
;

1937 
size_t
 
	gsize
;

1938 
mÆloc_£gmít
* 
	g√xt
;

1939 #i‡
FFI_MMAP_EXEC_WRIT


1943 
	#mm≠_exec_off£t
(
b
,
s
Ë(*(
±rdiff_t
*)((b)+(s)-’ådiff_t)))

	)

1947 
	#check_£gmít_mîge
(
S
,
b
,
s
) \

1948 (
	`mm≠_exec_off£t
((
b
),(
s
)Ë=(
S
)->
exec_off£t
)

	)

1950 
	#add_£gmít_exec_off£t
(
p
,
S
Ë((*)’Ë+ (S)->
exec_off£t
)

	)

1951 
	#sub_£gmít_exec_off£t
(
p
,
S
Ë((*)’Ë- (S)->
exec_off£t
)

	)

1955 
	#gë_£gmít_Êags
(
S
Ë(
IS_MMAPPED_BIT
)

	)

1956 
	#£t_£gmít_Êags
(
S
,
v
) \

1957 (((
v
Ë!
IS_MMAPPED_BIT
Ë? (
ABORT
, (v)) : \

1958 (((
S
)->
exec_off£t
 = \

1959 
	`mm≠_exec_off£t
((
S
)->
ba£
, (S)->
size
)), \

1960 (
	`mm≠_exec_off£t
((
S
)->
ba£
 + (S)->
exec_off£t
, (S)->
size
) != \

1961 (
S
)->
exec_off£t
Ë? (
ABORT
, (
v
)) : \

1962 (
	`mm≠_exec_off£t
((
S
)->
ba£
, (S)->
size
Ë0), (
v
)))

	)

1967 
±rdiff_t
 
	gexec_off£t
;

1970 
	#gë_£gmít_Êags
(
S
Ë((S)->
sÊags
)

	)

1971 
	#£t_£gmít_Êags
(
S
,
v
Ë((S)->
sÊags
 = (v))

	)

1972 
	#check_£gmít_mîge
(
S
,
b
,
s
Ë(1)

	)

1974 
Êag_t
 
	gsÊags
;

1978 
	#is_mm≠≥d_£gmít
(
S
Ë(
	`gë_£gmít_Êags
(SË& 
IS_MMAPPED_BIT
)

	)

1979 
	#is_exã∫_£gmít
(
S
Ë(
	`gë_£gmít_Êags
(SË& 
EXTERN_BIT
)

	)

1981 
mÆloc_£gmít
 
	tm£gmít
;

1982 
mÆloc_£gmít
* 
	tm£gmíçå
;

2060 
	#NSMALLBINS
 (32U)

	)

2061 
	#NTREEBINS
 (32U)

	)

2062 
	#SMALLBIN_SHIFT
 (3U)

	)

2063 
	#SMALLBIN_WIDTH
 (
SIZE_T_ONE
 << 
SMALLBIN_SHIFT
)

	)

2064 
	#TREEBIN_SHIFT
 (8U)

	)

2065 
	#MIN_LARGE_SIZE
 (
SIZE_T_ONE
 << 
TREEBIN_SHIFT
)

	)

2066 
	#MAX_SMALL_SIZE
 (
MIN_LARGE_SIZE
 - 
SIZE_T_ONE
)

	)

2067 
	#MAX_SMALL_REQUEST
 (
MAX_SMALL_SIZE
 - 
CHUNK_ALIGN_MASK
 - 
CHUNK_OVERHEAD
)

	)

2069 
	smÆloc_°©e
 {

2070 
böm≠_t
 
	gsmÆlm≠
;

2071 
böm≠_t
 
	gåìm≠
;

2072 
size_t
 
	gdvsize
;

2073 
size_t
 
	gt›size
;

2074 * 
	gÀa°_addr
;

2075 
mchunk±r
 
	gdv
;

2076 
mchunk±r
 
	gt›
;

2077 
size_t
 
	gåim_check
;

2078 
size_t
 
	gmagic
;

2079 
mchunk±r
 
	gsmÆlbös
[(
NSMALLBINS
+1)*2];

2080 
tbö±r
 
	gåìbös
[
NTREEBINS
];

2081 
size_t
 
	gfoŸ¥öt
;

2082 
size_t
 
	gmax_foŸ¥öt
;

2083 
Êag_t
 
	gmÊags
;

2084 #i‡
USE_LOCKS


2085 
MLOCK_T
 
	gmuãx
;

2087 
m£gmít
 
	g£g
;

2090 
mÆloc_°©e
* 
	tm°©e
;

2100 
	smÆloc_∑øms
 {

2101 
size_t
 
	gmagic
;

2102 
size_t
 
	g∑ge_size
;

2103 
size_t
 
	ggønuœrôy
;

2104 
size_t
 
	gmm≠_thªshﬁd
;

2105 
size_t
 
	gåim_thªshﬁd
;

2106 
Êag_t
 
	gdeÁu…_mÊags
;

2109 
mÆloc_∑øms
 
	gm∑øms
;

2112 
mÆloc_°©e
 
	g_gm_
;

2113 
	#gm
 (&
_gm_
)

	)

2114 
	#is_globÆ
(
M
Ë((MË=&
_gm_
)

	)

2115 
	#is_öôülized
(
M
Ë((M)->
t›
 !0)

	)

2121 
	#u£_lock
(
M
Ë((M)->
mÊags
 & 
USE_LOCK_BIT
)

	)

2122 
	#íabÀ_lock
(
M
Ë((M)->
mÊags
 |
USE_LOCK_BIT
)

	)

2123 
	#dißbÀ_lock
(
M
Ë((M)->
mÊags
 &~
USE_LOCK_BIT
)

	)

2125 
	#u£_mm≠
(
M
Ë((M)->
mÊags
 & 
USE_MMAP_BIT
)

	)

2126 
	#íabÀ_mm≠
(
M
Ë((M)->
mÊags
 |
USE_MMAP_BIT
)

	)

2127 
	#dißbÀ_mm≠
(
M
Ë((M)->
mÊags
 &~
USE_MMAP_BIT
)

	)

2129 
	#u£_n⁄c⁄tiguous
(
M
Ë((M)->
mÊags
 & 
USE_NONCONTIGUOUS_BIT
)

	)

2130 
	#dißbÀ_c⁄tiguous
(
M
Ë((M)->
mÊags
 |
USE_NONCONTIGUOUS_BIT
)

	)

2132 
	#£t_lock
(
M
,
L
)\

2133 ((
M
)->
mÊags
 = (
L
)?\

2134 ((
M
)->
mÊags
 | 
USE_LOCK_BIT
) :\

2135 ((
M
)->
mÊags
 & ~
USE_LOCK_BIT
))

	)

2138 
	#∑ge_Æign
(
S
)\

2139 (((
S
Ë+ (
m∑øms
.
∑ge_size
)Ë& ~(m∑øms.∑ge_sizê- 
SIZE_T_ONE
))

	)

2142 
	#gønuœrôy_Æign
(
S
)\

2143 (((
S
Ë+ (
m∑øms
.
gønuœrôy
)Ë& ~(m∑øms.gønuœrôy - 
SIZE_T_ONE
))

	)

2145 
	#is_∑ge_Æig√d
(
S
)\

2146 (((
size_t
)(
S
Ë& (
m∑øms
.
∑ge_size
 - 
SIZE_T_ONE
)Ë=0)

	)

2147 
	#is_gønuœrôy_Æig√d
(
S
)\

2148 (((
size_t
)(
S
Ë& (
m∑øms
.
gønuœrôy
 - 
SIZE_T_ONE
)Ë=0)

	)

2151 
	#£gmít_hﬁds
(
S
, 
A
)\

2152 ((*)(
A
Ë>
S
->
ba£
 && (*)(AË< S->ba£ + S->
size
)

	)

2155 
m£gmíçå
 
£gmít_hﬁdög
(
m°©e
 
m
, * 
addr
) {

2156 
m£gmíçå
 
	g•
 = &
m
->
£g
;

2158 i‡(
	gaddr
 >
•
->
ba£
 && 
addr
 < sp->ba£ + sp->
size
)

2159  
•
;

2160 i‡((
	g•
 = 
•
->
√xt
) == 0)

2166 
has_£gmít_lök
(
m°©e
 
m
, 
m£gmíçå
 
ss
) {

2167 
m£gmíçå
 
	g•
 = &
m
->
£g
;

2169 i‡((*)
	g•
 >
ss
->
ba£
 && (*)
•
 < ss->ba£ + ss->
size
)

2171 i‡((
	g•
 = 
•
->
√xt
) == 0)

2176 #i‚de‡
MORECORE_CANNOT_TRIM


2177 
	#should_åim
(
M
,
s
Ë((sË> (M)->
åim_check
)

	)

2179 
	#should_åim
(
M
,
s
Ë(0)

	)

2187 
	#TOP_FOOT_SIZE
\

2188 (
	`Æign_off£t
(
	`chunk2mem
(0))+
	`∑d_ªque°
((
mÆloc_£gmít
))+
MIN_CHUNK_SIZE
)

	)

2199 #i‡
USE_LOCKS


2202 
	#GLOBALLY_INITIALIZE
(Ë(
m∑øms
.
∑ge_size
 =0 && 
	`öô_m∑øms
())

	)

2204 
	#PREACTION
(
M
Ë((
	`GLOBALLY_INITIALIZE
(Ë|| 
	`u£_lock
(M))? 
	`ACQUIRE_LOCK
(&(M)->
muãx
Ë: 0)

	)

2205 
	#POSTACTION
(
M
Ë{ i‡(
	`u£_lock
(M)Ë
	`RELEASE_LOCK
(&(M)->
muãx
); }

	)

2208 #i‚de‡
PREACTION


2209 
	#PREACTION
(
M
Ë(0)

	)

2212 #i‚de‡
POSTACTION


2213 
	#POSTACTION
(
M
)

	)

2226 #i‡
PROCEED_ON_ERROR


2229 
	gmÆloc_c‹ru±i⁄_îr‹_cou¡
;

2232 
ª£t_⁄_îr‹
(
m°©e
 
m
);

2234 
	#CORRUPTION_ERROR_ACTION
(
m
Ë
	`ª£t_⁄_îr‹
(m)

	)

2235 
	#USAGE_ERROR_ACTION
(
m
, 
p
)

	)

2239 #i‚de‡
CORRUPTION_ERROR_ACTION


2240 
	#CORRUPTION_ERROR_ACTION
(
m
Ë
ABORT


	)

2243 #i‚de‡
USAGE_ERROR_ACTION


2244 
	#USAGE_ERROR_ACTION
(
m
,
p
Ë
ABORT


	)

2251 #i‡! 
DEBUG


2253 
	#check_‰ì_chunk
(
M
,
P
)

	)

2254 
	#check_öu£_chunk
(
M
,
P
)

	)

2255 
	#check_mÆlo˚d_chunk
(
M
,
P
,
N
)

	)

2256 
	#check_mm≠≥d_chunk
(
M
,
P
)

	)

2257 
	#check_mÆloc_°©e
(
M
)

	)

2258 
	#check_t›_chunk
(
M
,
P
)

	)

2261 
	#check_‰ì_chunk
(
M
,
P
Ë
	`do_check_‰ì_chunk
(M,P)

	)

2262 
	#check_öu£_chunk
(
M
,
P
Ë
	`do_check_öu£_chunk
(M,P)

	)

2263 
	#check_t›_chunk
(
M
,
P
Ë
	`do_check_t›_chunk
(M,P)

	)

2264 
	#check_mÆlo˚d_chunk
(
M
,
P
,
N
Ë
	`do_check_mÆlo˚d_chunk
(M,P,N)

	)

2265 
	#check_mm≠≥d_chunk
(
M
,
P
Ë
	`do_check_mm≠≥d_chunk
(M,P)

	)

2266 
	#check_mÆloc_°©e
(
M
Ë
	`do_check_mÆloc_°©e
(M)

	)

2268 
do_check_™y_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
);

2269 
do_check_t›_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
);

2270 
do_check_mm≠≥d_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
);

2271 
do_check_öu£_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
);

2272 
do_check_‰ì_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
);

2273 
do_check_mÆlo˚d_chunk
(
m°©e
 
m
, * 
mem
, 
size_t
 
s
);

2274 
do_check_åì
(
m°©e
 
m
, 
tchunk±r
 
t
);

2275 
do_check_åìbö
(
m°©e
 
m
, 
bödex_t
 
i
);

2276 
do_check_smÆlbö
(
m°©e
 
m
, 
bödex_t
 
i
);

2277 
do_check_mÆloc_°©e
(
m°©e
 
m
);

2278 
bö_föd
(
m°©e
 
m
, 
mchunk±r
 
x
);

2279 
size_t
 
åavî£_™d_check
(
m°©e
 
m
);

2284 
	#is_smÆl
(
s
Ë(((sË>> 
SMALLBIN_SHIFT
Ë< 
NSMALLBINS
)

	)

2285 
	#smÆl_ödex
(
s
Ë((sË>> 
SMALLBIN_SHIFT
)

	)

2286 
	#smÆl_ödex2size
(
i
Ë((iË<< 
SMALLBIN_SHIFT
)

	)

2287 
	#MIN_SMALL_INDEX
 (
	`smÆl_ödex
(
MIN_CHUNK_SIZE
))

	)

2290 
	#smÆlbö_©
(
M
, 
i
Ë((
sbö±r
)((*)&((M)->
smÆlbös
[(i)<<1])))

	)

2291 
	#åìbö_©
(
M
,
i
Ë(&((M)->
åìbös
[i]))

	)

2294 #i‡
deföed
(
__GNUC__
Ë&& deföed(
i386
)

2295 
	#compuã_åì_ödex
(
S
, 
I
)\

2297 
size_t
 
X
 = 
S
 >> 
TREEBIN_SHIFT
;\

2298 i‡(
X
 == 0)\

2299 
I
 = 0;\

2300 i‡(
X
 > 0xFFFF)\

2301 
I
 = 
NTREEBINS
-1;\

2303 
K
;\

2304 
	`__asm__
("b§»%1,%0\n\t" : "Ù" (
K
Ë: "rm" (
X
));\

2305 
I
 = (
bödex_t
)((
K
 << 1Ë+ ((
S
 >> (K + (
TREEBIN_SHIFT
-1)) & 1)));\

2307 }

	)

2309 
	#compuã_åì_ödex
(
S
, 
I
)\

2311 
size_t
 
X
 = 
S
 >> 
TREEBIN_SHIFT
;\

2312 i‡(
X
 == 0)\

2313 
I
 = 0;\

2314 i‡(
X
 > 0xFFFF)\

2315 
I
 = 
NTREEBINS
-1;\

2317 
Y
 = ()
X
;\

2318 
N
 = ((
Y
 - 0x100) >> 16) & 8;\

2319 
K
 = (((
Y
 <<
N
) - 0x1000) >> 16) & 4;\

2320 
N
 +
K
;\

2321 
N
 +
K
 = (((
Y
 <<= K) - 0x4000) >> 16) & 2;\

2322 
K
 = 14 - 
N
 + ((
Y
 <<= K) >> 15);\

2323 
I
 = (
K
 << 1Ë+ ((
S
 >> (K + (
TREEBIN_SHIFT
-1)) & 1));\

2325 }

	)

2329 
	#bô_f‹_åì_ödex
(
i
) \

2330 (
i
 =
NTREEBINS
-1)? (
SIZE_T_BITSIZE
-1Ë: (((iË>> 1Ë+ 
TREEBIN_SHIFT
 - 2)

	)

2333 
	#À·shi·_f‹_åì_ödex
(
i
) \

2334 ((
i
 =
NTREEBINS
-1)? 0 : \

2335 ((
SIZE_T_BITSIZE
-
SIZE_T_ONE
Ë- (((
i
Ë>> 1Ë+ 
TREEBIN_SHIFT
 - 2)))

	)

2338 
	#mösize_f‹_åì_ödex
(
i
) \

2339 ((
SIZE_T_ONE
 << (((
i
Ë>> 1Ë+ 
TREEBIN_SHIFT
)) | \

2340 (((
size_t
)((
i
Ë& 
SIZE_T_ONE
)Ë<< (((iË>> 1Ë+ 
TREEBIN_SHIFT
 - 1)))

	)

2346 
	#idx2bô
(
i
Ë((
böm≠_t
)(1Ë<< (i))

	)

2349 
	#m¨k_smÆlm≠
(
M
,
i
Ë((M)->
smÆlm≠
 |
	`idx2bô
(i))

	)

2350 
	#˛ór_smÆlm≠
(
M
,
i
Ë((M)->
smÆlm≠
 &~
	`idx2bô
(i))

	)

2351 
	#smÆlm≠_is_m¨ked
(
M
,
i
Ë((M)->
smÆlm≠
 & 
	`idx2bô
(i))

	)

2353 
	#m¨k_åìm≠
(
M
,
i
Ë((M)->
åìm≠
 |
	`idx2bô
(i))

	)

2354 
	#˛ór_åìm≠
(
M
,
i
Ë((M)->
åìm≠
 &~
	`idx2bô
(i))

	)

2355 
	#åìm≠_is_m¨ked
(
M
,
i
Ë((M)->
åìm≠
 & 
	`idx2bô
(i))

	)

2359 #i‡
deföed
(
__GNUC__
Ë&& deföed(
i386
)

2360 
	#compuã_bô2idx
(
X
, 
I
)\

2362 
J
;\

2363 
	`__asm__
("bsÊ %1,%0\n\t" : "Ù" (
J
Ë: "rm" (
X
));\

2364 
I
 = (
bödex_t
)
J
;\

2365 }

	)

2368 #i‡ 
USE_BUILTIN_FFS


2369 
	#compuã_bô2idx
(
X
, 
I
ËI = 
	`ffs
(X)-1

	)

2372 
	#compuã_bô2idx
(
X
, 
I
)\

2374 
Y
 = 
X
 - 1;\

2375 
K
 = 
Y
 >> (16-4) & 16;\

2376 
N
 = 
K
; 
Y
 >>= K;\

2377 
N
 +
K
 = 
Y
 >> (8-3) & 8; Y >>= K;\

2378 
N
 +
K
 = 
Y
 >> (4-2) & 4; Y >>= K;\

2379 
N
 +
K
 = 
Y
 >> (2-1) & 2; Y >>= K;\

2380 
N
 +
K
 = 
Y
 >> (1-0) & 1; Y >>= K;\

2381 
I
 = (
bödex_t
)(
N
 + 
Y
);\

2382 }

	)

2387 
	#Àa°_bô
(
x
Ë((xË& -(x))

	)

2390 
	#À·_bôs
(
x
Ë((x<<1Ë| -(x<<1))

	)

2393 
	#ßme_‹_À·_bôs
(
x
Ë((xË| -(x))

	)

2424 #i‡!
INSECURE


2426 
	#ok_addªss
(
M
, 
a
Ë((*)◊Ë>(M)->
Àa°_addr
)

	)

2428 
	#ok_√xt
(
p
, 
n
Ë((*)’Ë< (*)“))

	)

2430 
	#ok_cöu£
(
p
Ë
	`cöu£
’)

	)

2432 
	#ok_pöu£
(
p
Ë
	`pöu£
’)

	)

2435 
	#ok_addªss
(
M
, 
a
Ë(1)

	)

2436 
	#ok_√xt
(
b
, 
n
Ë(1)

	)

2437 
	#ok_cöu£
(
p
Ë(1)

	)

2438 
	#ok_pöu£
(
p
Ë(1)

	)

2441 #i‡(
FOOTERS
 && !
INSECURE
)

2443 
	#ok_magic
(
M
Ë((M)->
magic
 =
m∑øms
.magic)

	)

2445 
	#ok_magic
(
M
Ë(1)

	)

2450 #i‡!
INSECURE


2451 #i‡
deföed
(
__GNUC__
) && __GNUC__ >= 3

2452 
	#RTCHECK
(
e
Ë
	`__buûtö_ex≥˘
”, 1)

	)

2454 
	#RTCHECK
(
e
Ë”)

	)

2457 
	#RTCHECK
(
e
Ë(1)

	)

2462 #i‡!
FOOTERS


2464 
	#m¨k_öu£_foŸ
(
M
,
p
,
s
)

	)

2467 
	#£t_öu£
(
M
,
p
,
s
)\

2468 ((
p
)->
hód
 = ((’)->hód & 
PINUSE_BIT
)|
s
|
CINUSE_BIT
),\

2469 ((
mchunk±r
)(((*)(
p
)Ë+ (
s
)))->
hód
 |
PINUSE_BIT
)

	)

2472 
	#£t_öu£_™d_pöu£
(
M
,
p
,
s
)\

2473 ((
p
)->
hód
 = (
s
|
PINUSE_BIT
|
CINUSE_BIT
),\

2474 ((
mchunk±r
)(((*)(
p
)Ë+ (
s
)))->
hód
 |
PINUSE_BIT
)

	)

2477 
	#£t_size_™d_pöu£_of_öu£_chunk
(
M
, 
p
, 
s
)\

2478 ((
p
)->
hód
 = (
s
|
PINUSE_BIT
|
CINUSE_BIT
))

	)

2483 
	#m¨k_öu£_foŸ
(
M
,
p
,
s
)\

2484 (((
mchunk±r
)((*)(
p
Ë+ (
s
)))->
¥ev_foŸ
 = ((
size_t
)(
M
Ë^ 
m∑øms
.
magic
))

	)

2486 
	#gë_m°©e_f‹
(
p
)\

2487 ((
m°©e
)(((
mchunk±r
)((*)(
p
) +\

2488 (
	`chunksize
(
p
))))->
¥ev_foŸ
 ^ 
m∑øms
.
magic
))

	)

2490 
	#£t_öu£
(
M
,
p
,
s
)\

2491 ((
p
)->
hód
 = ((’)->hód & 
PINUSE_BIT
)|
s
|
CINUSE_BIT
),\

2492 (((
mchunk±r
)(((*)(
p
)Ë+ (
s
)))->
hód
 |
PINUSE_BIT
), \

2493 
	`m¨k_öu£_foŸ
(
M
,
p
,
s
))

	)

2495 
	#£t_öu£_™d_pöu£
(
M
,
p
,
s
)\

2496 ((
p
)->
hód
 = (
s
|
PINUSE_BIT
|
CINUSE_BIT
),\

2497 (((
mchunk±r
)(((*)(
p
)Ë+ (
s
)))->
hód
 |
PINUSE_BIT
),\

2498 
	`m¨k_öu£_foŸ
(
M
,
p
,
s
))

	)

2500 
	#£t_size_™d_pöu£_of_öu£_chunk
(
M
, 
p
, 
s
)\

2501 ((
p
)->
hód
 = (
s
|
PINUSE_BIT
|
CINUSE_BIT
),\

2502 
	`m¨k_öu£_foŸ
(
M
, 
p
, 
s
))

	)

2509 
öô_m∑øms
() {

2510 i‡(
	gm∑øms
.
	g∑ge_size
 == 0) {

2511 
size_t
 
s
;

2513 
	gm∑øms
.
	gmm≠_thªshﬁd
 = 
DEFAULT_MMAP_THRESHOLD
;

2514 
	gm∑øms
.
	gåim_thªshﬁd
 = 
DEFAULT_TRIM_THRESHOLD
;

2515 #i‡
MORECORE_CONTIGUOUS


2516 
	gm∑øms
.
	gdeÁu…_mÊags
 = 
USE_LOCK_BIT
|
USE_MMAP_BIT
;

2518 
	gm∑øms
.
	gdeÁu…_mÊags
 = 
USE_LOCK_BIT
|
USE_MMAP_BIT
|
USE_NONCONTIGUOUS_BIT
;

2521 #i‡(
FOOTERS
 && !
INSECURE
)

2523 #i‡
USE_DEV_RANDOM


2524 
	gfd
;

2525 
	gbuf
[(
size_t
)];

2527 i‡((
	gfd
 = 
›í
("/dev/uøndom", 
O_RDONLY
)) >= 0 &&

2528 
ªad
(
fd
, 
buf
, (buf)) == (buf)) {

2529 
s
 = *((
size_t
 *Ë
buf
);

2530 
˛o£
(
fd
);

2534 
	gs
 = (
size_t
)(
time
(0) ^ (size_t)0x55555555U);

2536 
	gs
 |(
size_t
)8U;

2537 
	gs
 &~(
size_t
)7U;

2541 
	gs
 = (
size_t
)0x58585858U;

2543 
ACQUIRE_MAGIC_INIT_LOCK
();

2544 i‡(
	gm∑øms
.
	gmagic
 == 0) {

2545 
m∑øms
.
magic
 = 
s
;

2547 
INITIAL_LOCK
(&
gm
->
muãx
);

2548 
	ggm
->
	gmÊags
 = 
m∑øms
.
deÁu…_mÊags
;

2550 
RELEASE_MAGIC_INIT_LOCK
();

2552 #i‡!
deföed
(
WIN32
Ë&& !deföed(
__OS2__
)

2553 
	gm∑øms
.
	g∑ge_size
 = 
mÆloc_gë∑gesize
;

2554 
	gm∑øms
.
	ggønuœrôy
 = ((
DEFAULT_GRANULARITY
 != 0)?

2555 
DEFAULT_GRANULARITY
 : 
m∑øms
.
∑ge_size
);

2556 #ñi‡
deföed
 (
__OS2__
)

2559 
	gm∑øms
.
	g∑ge_size
 = 4096u;

2560 
	gm∑øms
.
	ggønuœrôy
 = 65536u;

2563 
SYSTEM_INFO
 
	gsy°em_öfo
;

2564 
GëSy°emInfo
(&
sy°em_öfo
);

2565 
	gm∑øms
.
	g∑ge_size
 = 
sy°em_öfo
.
dwPageSize
;

2566 
	gm∑øms
.
	ggønuœrôy
 = 
sy°em_öfo
.
dwAŒoˇti⁄Gønuœrôy
;

2576 i‡(((
	gsize_t
) != (*)) ||

2577 (
MAX_SIZE_T
 < 
MIN_CHUNK_SIZE
) ||

2579 (
MALLOC_ALIGNMENT
 < (
size_t
)8U) ||

2580 ((
MALLOC_ALIGNMENT
 & (MALLOC_ALIGNMENT-
SIZE_T_ONE
)) != 0) ||

2581 ((
MCHUNK_SIZE
 & (MCHUNK_SIZE-
SIZE_T_ONE
)) != 0) ||

2582 ((
m∑øms
.
gønuœrôy
 & (m∑øms.gønuœrôy-
SIZE_T_ONE
)) != 0) ||

2583 ((
m∑øms
.
∑ge_size
 & (m∑øms.∑ge_size-
SIZE_T_ONE
)) != 0))

2584 
ABORT
;

2590 
ch™ge_m∑øm
(
∑øm_numbî
, 
vÆue
) {

2591 
size_t
 
	gvÆ
 = (size_t)
vÆue
;

2592 
öô_m∑øms
();

2593 
	g∑øm_numbî
) {

2594 
	gM_TRIM_THRESHOLD
:

2595 
m∑øms
.
åim_thªshﬁd
 = 
vÆ
;

2597 
	gM_GRANULARITY
:

2598 i‡(
vÆ
 >
m∑øms
.
∑ge_size
 && ((val & (val-1)) == 0)) {

2599 
m∑øms
.
gønuœrôy
 = 
vÆ
;

2604 
	gM_MMAP_THRESHOLD
:

2605 
m∑øms
.
mm≠_thªshﬁd
 = 
vÆ
;

2612 #i‡
DEBUG


2616 
do_check_™y_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
) {

2617 
as£π
((
is_Æig√d
(
chunk2mem
(
p
))Ë|| (p->
hód
 =
FENCEPOST_HEAD
));

2618 
as£π
(
ok_addªss
(
m
, 
p
));

2622 
do_check_t›_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
) {

2623 
m£gmíçå
 
	g•
 = 
£gmít_hﬁdög
(
m
, (*)
p
);

2624 
size_t
 
	gsz
 = 
chunksize
(
p
);

2625 
as£π
(
•
 != 0);

2626 
as£π
((
is_Æig√d
(
chunk2mem
(
p
))Ë|| (p->
hód
 =
FENCEPOST_HEAD
));

2627 
as£π
(
ok_addªss
(
m
, 
p
));

2628 
as£π
(
sz
 =
m
->
t›size
);

2629 
as£π
(
sz
 > 0);

2630 
as£π
(
sz
 =((
•
->
ba£
 + sp->
size
Ë- (*)
p
Ë- 
TOP_FOOT_SIZE
);

2631 
as£π
(
pöu£
(
p
));

2632 
as£π
(!
√xt_pöu£
(
p
));

2636 
do_check_mm≠≥d_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
) {

2637 
size_t
 
	gsz
 = 
chunksize
(
p
);

2638 
size_t
 
	gÀn
 = (
sz
 + (
p
->
¥ev_foŸ
 & ~
IS_MMAPPED_BIT
Ë+ 
MMAP_FOOT_PAD
);

2639 
as£π
(
is_mm≠≥d
(
p
));

2640 
as£π
(
u£_mm≠
(
m
));

2641 
as£π
((
is_Æig√d
(
chunk2mem
(
p
))Ë|| (p->
hód
 =
FENCEPOST_HEAD
));

2642 
as£π
(
ok_addªss
(
m
, 
p
));

2643 
as£π
(!
is_smÆl
(
sz
));

2644 
as£π
((
Àn
 & (
m∑øms
.
∑ge_size
-
SIZE_T_ONE
)) == 0);

2645 
as£π
(
chunk_∂us_off£t
(
p
, 
sz
)->
hód
 =
FENCEPOST_HEAD
);

2646 
as£π
(
chunk_∂us_off£t
(
p
, 
sz
+
SIZE_T_SIZE
)->
hód
 == 0);

2650 
do_check_öu£_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
) {

2651 
do_check_™y_chunk
(
m
, 
p
);

2652 
as£π
(
cöu£
(
p
));

2653 
as£π
(
√xt_pöu£
(
p
));

2655 
as£π
(
is_mm≠≥d
(
p
Ë|| 
pöu£
’Ë|| 
√xt_chunk
(
¥ev_chunk
(p)) ==Ö);

2656 i‡(
is_mm≠≥d
(
p
))

2657 
do_check_mm≠≥d_chunk
(
m
, 
p
);

2661 
do_check_‰ì_chunk
(
m°©e
 
m
, 
mchunk±r
 
p
) {

2662 
size_t
 
	gsz
 = 
p
->
hód
 & ~(
PINUSE_BIT
|
CINUSE_BIT
);

2663 
mchunk±r
 
	g√xt
 = 
chunk_∂us_off£t
(
p
, 
sz
);

2664 
do_check_™y_chunk
(
m
, 
p
);

2665 
as£π
(!
cöu£
(
p
));

2666 
as£π
(!
√xt_pöu£
(
p
));

2667 
as£π
 (!
is_mm≠≥d
(
p
));

2668 i‡(
	gp
 !
m
->
dv
 && 
p
 !m->
t›
) {

2669 i‡(
sz
 >
MIN_CHUNK_SIZE
) {

2670 
as£π
((
sz
 & 
CHUNK_ALIGN_MASK
) == 0);

2671 
as£π
(
is_Æig√d
(
chunk2mem
(
p
)));

2672 
as£π
(
√xt
->
¥ev_foŸ
 =
sz
);

2673 
as£π
(
pöu£
(
p
));

2674 
as£π
 (
√xt
 =
m
->
t›
 || 
cöu£
(next));

2675 
as£π
(
p
->
fd
->
bk
 ==Ö);

2676 
as£π
(
p
->
bk
->
fd
 ==Ö);

2679 
as£π
(
sz
 =
SIZE_T_SIZE
);

2684 
do_check_mÆlo˚d_chunk
(
m°©e
 
m
, * 
mem
, 
size_t
 
s
) {

2685 i‡(
	gmem
 != 0) {

2686 
mchunk±r
 
p
 = 
mem2chunk
(
mem
);

2687 
size_t
 
	gsz
 = 
p
->
hód
 & ~(
PINUSE_BIT
|
CINUSE_BIT
);

2688 
do_check_öu£_chunk
(
m
, 
p
);

2689 
as£π
((
sz
 & 
CHUNK_ALIGN_MASK
) == 0);

2690 
as£π
(
sz
 >
MIN_CHUNK_SIZE
);

2691 
as£π
(
sz
 >
s
);

2693 
as£π
(
is_mm≠≥d
(
p
Ë|| 
sz
 < (
s
 + 
MIN_CHUNK_SIZE
));

2698 
do_check_åì
(
m°©e
 
m
, 
tchunk±r
 
t
) {

2699 
tchunk±r
 
	ghód
 = 0;

2700 
tchunk±r
 
	gu
 = 
t
;

2701 
bödex_t
 
	gtödex
 = 
t
->
ödex
;

2702 
size_t
 
	gtsize
 = 
chunksize
(
t
);

2703 
bödex_t
 
	gidx
;

2704 
compuã_åì_ödex
(
tsize
, 
idx
);

2705 
as£π
(
tödex
 =
idx
);

2706 
as£π
(
tsize
 >
MIN_LARGE_SIZE
);

2707 
as£π
(
tsize
 >
mösize_f‹_åì_ödex
(
idx
));

2708 
as£π
((
idx
 =
NTREEBINS
-1Ë|| (
tsize
 < 
mösize_f‹_åì_ödex
((idx+1))));

2711 
do_check_™y_chunk
(
m
, ((
mchunk±r
)
u
));

2712 
as£π
(
u
->
ödex
 =
tödex
);

2713 
as£π
(
chunksize
(
u
Ë=
tsize
);

2714 
as£π
(!
cöu£
(
u
));

2715 
as£π
(!
√xt_pöu£
(
u
));

2716 
as£π
(
u
->
fd
->
bk
 == u);

2717 
as£π
(
u
->
bk
->
fd
 == u);

2718 i‡(
	gu
->
	g∑ª¡
 == 0) {

2719 
as£π
(
u
->
chûd
[0] == 0);

2720 
as£π
(
u
->
chûd
[1] == 0);

2723 
as£π
(
hód
 == 0);

2724 
	ghód
 = 
u
;

2725 
as£π
(
u
->
∑ª¡
 != u);

2726 
as£π
 (
u
->
∑ª¡
->
chûd
[0] == u ||

2727 
u
->
∑ª¡
->
chûd
[1] == u ||

2728 *((
tbö±r
*)(
u
->
∑ª¡
)) == u);

2729 i‡(
	gu
->
	gchûd
[0] != 0) {

2730 
as£π
(
u
->
chûd
[0]->
∑ª¡
 == u);

2731 
as£π
(
u
->
chûd
[0] != u);

2732 
do_check_åì
(
m
, 
u
->
chûd
[0]);

2734 i‡(
	gu
->
	gchûd
[1] != 0) {

2735 
as£π
(
u
->
chûd
[1]->
∑ª¡
 == u);

2736 
as£π
(
u
->
chûd
[1] != u);

2737 
do_check_åì
(
m
, 
u
->
chûd
[1]);

2739 i‡(
	gu
->
	gchûd
[0] !0 && 
u
->
chûd
[1] != 0) {

2740 
as£π
(
chunksize
(
u
->
chûd
[0]) < chunksize(u->child[1]));

2743 
	gu
 = 
u
->
fd
;

2744 } 
	gu
 !
t
);

2745 
as£π
(
hód
 != 0);

2749 
do_check_åìbö
(
m°©e
 
m
, 
bödex_t
 
i
) {

2750 
tbö±r
* 
	gtb
 = 
åìbö_©
(
m
, 
i
);

2751 
tchunk±r
 
	gt
 = *
tb
;

2752 
	gem±y
 = (
m
->
åìm≠
 & (1U << 
i
)) == 0;

2753 i‡(
	gt
 == 0)

2754 
as£π
(
em±y
);

2755 i‡(!
	gem±y
)

2756 
do_check_åì
(
m
, 
t
);

2760 
do_check_smÆlbö
(
m°©e
 
m
, 
bödex_t
 
i
) {

2761 
sbö±r
 
	gb
 = 
smÆlbö_©
(
m
, 
i
);

2762 
mchunk±r
 
	gp
 = 
b
->
bk
;

2763 
	gem±y
 = (
m
->
smÆlm≠
 & (1U << 
i
)) == 0;

2764 i‡(
	gp
 =
b
)

2765 
as£π
(
em±y
);

2766 i‡(!
	gem±y
) {

2767 ; 
	gp
 !
b
;Ö = 
p
->
bk
) {

2768 
size_t
 
size
 = 
chunksize
(
p
);

2769 
mchunk±r
 
	gq
;

2771 
do_check_‰ì_chunk
(
m
, 
p
);

2773 
as£π
(
smÆl_ödex
(
size
Ë=
i
);

2774 
as£π
(
p
->
bk
 =
b
 || 
chunksize
(p->bk) == chunksize(p));

2776 
	gq
 = 
√xt_chunk
(
p
);

2777 i‡(
	gq
->
	ghód
 !
FENCEPOST_HEAD
)

2778 
do_check_öu£_chunk
(
m
, 
q
);

2784 
bö_föd
(
m°©e
 
m
, 
mchunk±r
 
x
) {

2785 
size_t
 
	gsize
 = 
chunksize
(
x
);

2786 i‡(
is_smÆl
(
size
)) {

2787 
bödex_t
 
	gsidx
 = 
smÆl_ödex
(
size
);

2788 
sbö±r
 
	gb
 = 
smÆlbö_©
(
m
, 
sidx
);

2789 i‡(
smÆlm≠_is_m¨ked
(
m
, 
sidx
)) {

2790 
mchunk±r
 
	gp
 = 
b
;

2792 i‡(
	gp
 =
x
)

2794 } (
	gp
 = 
p
->
fd
Ë!
b
);

2798 
bödex_t
 
	gtidx
;

2799 
compuã_åì_ödex
(
size
, 
tidx
);

2800 i‡(
åìm≠_is_m¨ked
(
m
, 
tidx
)) {

2801 
tchunk±r
 
	gt
 = *
åìbö_©
(
m
, 
tidx
);

2802 
size_t
 
	gsizebôs
 = 
size
 << 
À·shi·_f‹_åì_ödex
(
tidx
);

2803 
	gt
 !0 && 
chunksize
(
t
Ë!
size
) {

2804 
t
 =Å->
chûd
[(
sizebôs
 >> (
SIZE_T_BITSIZE
-
SIZE_T_ONE
)) & 1];

2805 
	gsizebôs
 <<= 1;

2807 i‡(
	gt
 != 0) {

2808 
tchunk±r
 
u
 = 
t
;

2810 i‡(
	gu
 =(
tchunk±r
)
x
)

2812 } (
	gu
 = 
u
->
fd
Ë!
t
);

2820 
size_t
 
åavî£_™d_check
(
m°©e
 
m
) {

2821 
size_t
 
	gsum
 = 0;

2822 i‡(
is_öôülized
(
m
)) {

2823 
m£gmíçå
 
	gs
 = &
m
->
£g
;

2824 
	gsum
 +
m
->
t›size
 + 
TOP_FOOT_SIZE
;

2825 
	gs
 != 0) {

2826 
mchunk±r
 
q
 = 
Æign_as_chunk
(
s
->
ba£
);

2827 
mchunk±r
 
	gœ°q
 = 0;

2828 
as£π
(
pöu£
(
q
));

2829 
£gmít_hﬁds
(
s
, 
q
) &&

2830 
	gq
 !
m
->
t›
 && 
q
->
hód
 !
FENCEPOST_HEAD
) {

2831 
sum
 +
chunksize
(
q
);

2832 i‡(
cöu£
(
q
)) {

2833 
as£π
(!
bö_föd
(
m
, 
q
));

2834 
do_check_öu£_chunk
(
m
, 
q
);

2837 
as£π
(
q
 =
m
->
dv
 || 
bö_föd
(m, q));

2838 
as£π
(
œ°q
 =0 || 
cöu£
(lastq));

2839 
do_check_‰ì_chunk
(
m
, 
q
);

2841 
	gœ°q
 = 
q
;

2842 
	gq
 = 
√xt_chunk
(
q
);

2844 
	gs
 = 
s
->
√xt
;

2847  
	gsum
;

2851 
do_check_mÆloc_°©e
(
m°©e
 
m
) {

2852 
bödex_t
 
	gi
;

2853 
size_t
 
	gtŸÆ
;

2855 
	gi
 = 0; i < 
	gNSMALLBINS
; ++i)

2856 
do_check_smÆlbö
(
m
, 
i
);

2857 
	gi
 = 0; i < 
	gNTREEBINS
; ++i)

2858 
do_check_åìbö
(
m
, 
i
);

2860 i‡(
	gm
->
	gdvsize
 != 0) {

2861 
do_check_™y_chunk
(
m
, m->
dv
);

2862 
as£π
(
m
->
dvsize
 =
chunksize
(m->
dv
));

2863 
as£π
(
m
->
dvsize
 >
MIN_CHUNK_SIZE
);

2864 
as£π
(
bö_föd
(
m
, m->
dv
) == 0);

2867 i‡(
	gm
->
	gt›
 != 0) {

2868 
do_check_t›_chunk
(
m
, m->
t›
);

2869 
as£π
(
m
->
t›size
 =
chunksize
(m->
t›
));

2870 
as£π
(
m
->
t›size
 > 0);

2871 
as£π
(
bö_föd
(
m
, m->
t›
) == 0);

2874 
	gtŸÆ
 = 
åavî£_™d_check
(
m
);

2875 
as£π
(
tŸÆ
 <
m
->
foŸ¥öt
);

2876 
as£π
(
m
->
foŸ¥öt
 <m->
max_foŸ¥öt
);

2882 #i‡!
NO_MALLINFO


2883 
mÆlöfo
 
öã∫Æ_mÆlöfo
(
m°©e
 
m
) {

2884 
mÆlöfo
 
	gnm
 = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };

2885 i‡(!
PREACTION
(
m
)) {

2886 
check_mÆloc_°©e
(
m
);

2887 i‡(
is_öôülized
(
m
)) {

2888 
size_t
 
	gn‰ì
 = 
SIZE_T_ONE
;

2889 
size_t
 
	gm‰ì
 = 
m
->
t›size
 + 
TOP_FOOT_SIZE
;

2890 
size_t
 
	gsum
 = 
m‰ì
;

2891 
m£gmíçå
 
	gs
 = &
m
->
£g
;

2892 
	gs
 != 0) {

2893 
mchunk±r
 
q
 = 
Æign_as_chunk
(
s
->
ba£
);

2894 
£gmít_hﬁds
(
s
, 
q
) &&

2895 
	gq
 !
m
->
t›
 && 
q
->
hód
 !
FENCEPOST_HEAD
) {

2896 
size_t
 
sz
 = 
chunksize
(
q
);

2897 
	gsum
 +
sz
;

2898 i‡(!
cöu£
(
q
)) {

2899 
	gm‰ì
 +
sz
;

2900 ++
	gn‰ì
;

2902 
	gq
 = 
√xt_chunk
(
q
);

2904 
	gs
 = 
s
->
√xt
;

2907 
	gnm
.
	g¨ía
 = 
sum
;

2908 
	gnm
.
	g‹dblks
 = 
n‰ì
;

2909 
	gnm
.
	ghblkhd
 = 
m
->
foŸ¥öt
 - 
sum
;

2910 
	gnm
.
	gusmblks
 = 
m
->
max_foŸ¥öt
;

2911 
	gnm
.
	gu‹dblks
 = 
m
->
foŸ¥öt
 - 
m‰ì
;

2912 
	gnm
.
	gf‹dblks
 = 
m‰ì
;

2913 
	gnm
.
	gkìpco°
 = 
m
->
t›size
;

2916 
POSTACTION
(
m
);

2918  
	gnm
;

2922 
öã∫Æ_mÆloc_°©s
(
m°©e
 
m
) {

2923 i‡(!
PREACTION
(
m
)) {

2924 
size_t
 
	gmaxÂ
 = 0;

2925 
size_t
 
	gÂ
 = 0;

2926 
size_t
 
	gu£d
 = 0;

2927 
check_mÆloc_°©e
(
m
);

2928 i‡(
is_öôülized
(
m
)) {

2929 
m£gmíçå
 
	gs
 = &
m
->
£g
;

2930 
	gmaxÂ
 = 
m
->
max_foŸ¥öt
;

2931 
	gÂ
 = 
m
->
foŸ¥öt
;

2932 
	gu£d
 = 
Â
 - (
m
->
t›size
 + 
TOP_FOOT_SIZE
);

2934 
	gs
 != 0) {

2935 
mchunk±r
 
q
 = 
Æign_as_chunk
(
s
->
ba£
);

2936 
£gmít_hﬁds
(
s
, 
q
) &&

2937 
	gq
 !
m
->
t›
 && 
q
->
hód
 !
FENCEPOST_HEAD
) {

2938 i‡(!
cöu£
(
q
))

2939 
u£d
 -
chunksize
(
q
);

2940 
	gq
 = 
√xt_chunk
(
q
);

2942 
	gs
 = 
s
->
√xt
;

2946 
Ârötf
(
°dîr
, "max sy°em byã†%10lu\n", ()(
maxÂ
));

2947 
Ârötf
(
°dîr
, "sy°em byã† = %10lu\n", ()(
Â
));

2948 
Ârötf
(
°dîr
, "ö u£ byã† = %10lu\n", ()(
u£d
));

2950 
POSTACTION
(
m
);

2964 
	#ö£π_smÆl_chunk
(
M
, 
P
, 
S
) {\

2965 
bödex_t
 
I
 = 
	`smÆl_ödex
(
S
);\

2966 
mchunk±r
 
B
 = 
	`smÆlbö_©
(
M
, 
I
);\

2967 
mchunk±r
 
F
 = 
B
;\

2968 
	`as£π
(
S
 >
MIN_CHUNK_SIZE
);\

2969 i‡(!
	`smÆlm≠_is_m¨ked
(
M
, 
I
))\

2970 
	`m¨k_smÆlm≠
(
M
, 
I
);\

2971 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
B
->
fd
)))\

2972 
F
 = 
B
->
fd
;\

2974 
	`CORRUPTION_ERROR_ACTION
(
M
);\

2976 
B
->
fd
 = 
P
;\

2977 
F
->
bk
 = 
P
;\

2978 
P
->
fd
 = 
F
;\

2979 
P
->
bk
 = 
B
;\

2980 }

	)

2983 
	#u∆ök_smÆl_chunk
(
M
, 
P
, 
S
) {\

2984 
mchunk±r
 
F
 = 
P
->
fd
;\

2985 
mchunk±r
 
B
 = 
P
->
bk
;\

2986 
bödex_t
 
I
 = 
	`smÆl_ödex
(
S
);\

2987 
	`as£π
(
P
 !
B
);\

2988 
	`as£π
(
P
 !
F
);\

2989 
	`as£π
(
	`chunksize
(
P
Ë=
	`smÆl_ödex2size
(
I
));\

2990 i‡(
F
 =
B
)\

2991 
	`˛ór_smÆlm≠
(
M
, 
I
);\

2992 i‡(
	`RTCHECK
((
F
 =
	`smÆlbö_©
(
M
,
I
Ë|| 
	`ok_addªss
(M, F)) &&\

2993 (
B
 =
	`smÆlbö_©
(
M
,
I
Ë|| 
	`ok_addªss
(M, B)))) {\

2994 
F
->
bk
 = 
B
;\

2995 
B
->
fd
 = 
F
;\

2998 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3000 }

	)

3003 
	#u∆ök_fú°_smÆl_chunk
(
M
, 
B
, 
P
, 
I
) {\

3004 
mchunk±r
 
F
 = 
P
->
fd
;\

3005 
	`as£π
(
P
 !
B
);\

3006 
	`as£π
(
P
 !
F
);\

3007 
	`as£π
(
	`chunksize
(
P
Ë=
	`smÆl_ödex2size
(
I
));\

3008 i‡(
B
 =
F
)\

3009 
	`˛ór_smÆlm≠
(
M
, 
I
);\

3010 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
F
))) {\

3011 
B
->
fd
 = 
F
;\

3012 
F
->
bk
 = 
B
;\

3015 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3017 }

	)

3021 
	#ª∂a˚_dv
(
M
, 
P
, 
S
) {\

3022 
size_t
 
DVS
 = 
M
->
dvsize
;\

3023 i‡(
DVS
 != 0) {\

3024 
mchunk±r
 
DV
 = 
M
->
dv
;\

3025 
	`as£π
(
	`is_smÆl
(
DVS
));\

3026 
	`ö£π_smÆl_chunk
(
M
, 
DV
, 
DVS
);\

3028 
M
->
dvsize
 = 
S
;\

3029 
M
->
dv
 = 
P
;\

3030 }

	)

3035 
	#ö£π_œrge_chunk
(
M
, 
X
, 
S
) {\

3036 
tbö±r
* 
H
;\

3037 
bödex_t
 
I
;\

3038 
	`compuã_åì_ödex
(
S
, 
I
);\

3039 
H
 = 
	`åìbö_©
(
M
, 
I
);\

3040 
X
->
ödex
 = 
I
;\

3041 
X
->
chûd
[0] = X->child[1] = 0;\

3042 i‡(!
	`åìm≠_is_m¨ked
(
M
, 
I
)) {\

3043 
	`m¨k_åìm≠
(
M
, 
I
);\

3044 *
H
 = 
X
;\

3045 
X
->
∑ª¡
 = (
tchunk±r
)
H
;\

3046 
X
->
fd
 = X->
bk
 = X;\

3049 
tchunk±r
 
T
 = *
H
;\

3050 
size_t
 
K
 = 
S
 << 
	`À·shi·_f‹_åì_ödex
(
I
);\

3052 i‡(
	`chunksize
(
T
Ë!
S
) {\

3053 
tchunk±r
* 
C
 = &(
T
->
chûd
[(
K
 >> (
SIZE_T_BITSIZE
-
SIZE_T_ONE
)) & 1]);\

3054 
K
 <<= 1;\

3055 i‡(*
C
 != 0)\

3056 
T
 = *
C
;\

3057 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
C
))) {\

3058 *
C
 = 
X
;\

3059 
X
->
∑ª¡
 = 
T
;\

3060 
X
->
fd
 = X->
bk
 = X;\

3064 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3069 
tchunk±r
 
F
 = 
T
->
fd
;\

3070 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
T
Ë&& ok_addªss(M, 
F
))) {\

3071 
T
->
fd
 = 
F
->
bk
 = 
X
;\

3072 
X
->
fd
 = 
F
;\

3073 
X
->
bk
 = 
T
;\

3074 
X
->
∑ª¡
 = 0;\

3078 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3084 }

	)

3103 
	#u∆ök_œrge_chunk
(
M
, 
X
) {\

3104 
tchunk±r
 
XP
 = 
X
->
∑ª¡
;\

3105 
tchunk±r
 
R
;\

3106 i‡(
X
->
bk
 != X) {\

3107 
tchunk±r
 
F
 = 
X
->
fd
;\

3108 
R
 = 
X
->
bk
;\

3109 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
F
))) {\

3110 
F
->
bk
 = 
R
;\

3111 
R
->
fd
 = 
F
;\

3114 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3118 
tchunk±r
* 
RP
;\

3119 i‡(((
R
 = *(
RP
 = &(
X
->
chûd
[1]))) != 0) ||\

3120 ((
R
 = *(
RP
 = &(
X
->
chûd
[0]))) != 0)) {\

3121 
tchunk±r
* 
CP
;\

3122 (*(
CP
 = &(
R
->
chûd
[1])) != 0) ||\

3123 (*(
CP
 = &(
R
->
chûd
[0])) != 0)) {\

3124 
R
 = *(
RP
 = 
CP
);\

3126 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
RP
)))\

3127 *
RP
 = 0;\

3129 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3133 i‡(
XP
 != 0) {\

3134 
tbö±r
* 
H
 = 
	`åìbö_©
(
M
, 
X
->
ödex
);\

3135 i‡(
X
 =*
H
) {\

3136 i‡((*
H
 = 
R
) == 0) \

3137 
	`˛ór_åìm≠
(
M
, 
X
->
ödex
);\

3139 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
XP
))) {\

3140 i‡(
XP
->
chûd
[0] =
X
) \

3141 
XP
->
chûd
[0] = 
R
;\

3143 
XP
->
chûd
[1] = 
R
;\

3146 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3147 i‡(
R
 != 0) {\

3148 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
R
))) {\

3149 
tchunk±r
 
C0
, 
C1
;\

3150 
R
->
∑ª¡
 = 
XP
;\

3151 i‡((
C0
 = 
X
->
chûd
[0]) != 0) {\

3152 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
C0
))) {\

3153 
R
->
chûd
[0] = 
C0
;\

3154 
C0
->
∑ª¡
 = 
R
;\

3157 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3159 i‡((
C1
 = 
X
->
chûd
[1]) != 0) {\

3160 i‡(
	`RTCHECK
(
	`ok_addªss
(
M
, 
C1
))) {\

3161 
R
->
chûd
[1] = 
C1
;\

3162 
C1
->
∑ª¡
 = 
R
;\

3165 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3169 
	`CORRUPTION_ERROR_ACTION
(
M
);\

3172 }

	)

3176 
	#ö£π_chunk
(
M
, 
P
, 
S
)\

3177 i‡(
	`is_smÆl
(
S
)Ë
	`ö£π_smÆl_chunk
(
M
, 
P
, S)\

3178 { 
tchunk±r
 
TP
 = (tchunk±r)(
P
); 
	`ö£π_œrge_chunk
(
M
, TP, 
S
); }

	)

3180 
	#u∆ök_chunk
(
M
, 
P
, 
S
)\

3181 i‡(
	`is_smÆl
(
S
)Ë
	`u∆ök_smÆl_chunk
(
M
, 
P
, S)\

3182 { 
tchunk±r
 
TP
 = (tchunk±r)(
P
); 
	`u∆ök_œrge_chunk
(
M
, TP); }

	)

3187 #i‡
ONLY_MSPACES


3188 
	#öã∫Æ_mÆloc
(
m
, 
b
Ë
	`m•a˚_mÆloc
(m, b)

	)

3189 
	#öã∫Æ_‰ì
(
m
, 
mem
Ë
	`m•a˚_‰ì
(m,mem);

	)

3191 #i‡
MSPACES


3192 
	#öã∫Æ_mÆloc
(
m
, 
b
)\

3193 (
m
 =
gm
)? 
	`dlmÆloc
(
b
Ë: 
	`m•a˚_mÆloc
(m, b)

	)

3194 
	#öã∫Æ_‰ì
(
m
, 
mem
)\

3195 i‡(
m
 =
gm
Ë
	`dl‰ì
(
mem
); 
	`m•a˚_‰ì
(m,mem);

	)

3197 
	#öã∫Æ_mÆloc
(
m
, 
b
Ë
	`dlmÆloc
(b)

	)

3198 
	#öã∫Æ_‰ì
(
m
, 
mem
Ë
	`dl‰ì
(mem)

	)

3215 * 
mm≠_Æloc
(
m°©e
 
m
, 
size_t
 
nb
) {

3216 
size_t
 
	gmmsize
 = 
gønuœrôy_Æign
(
nb
 + 
SIX_SIZE_T_SIZES
 + 
CHUNK_ALIGN_MASK
);

3217 i‡(
	gmmsize
 > 
	gnb
) {

3218 * 
	gmm
 = (*)(
DIRECT_MMAP
(
mmsize
));

3219 i‡(
	gmm
 !
CMFAIL
) {

3220 
size_t
 
off£t
 = 
Æign_off£t
(
chunk2mem
(
mm
));

3221 
size_t
 
	gpsize
 = 
mmsize
 - 
off£t
 - 
MMAP_FOOT_PAD
;

3222 
mchunk±r
 
	gp
 = (mchunk±r)(
mm
 + 
off£t
);

3223 
	gp
->
	g¥ev_foŸ
 = 
off£t
 | 
IS_MMAPPED_BIT
;

3224 (
	gp
)->
	ghód
 = (
psize
|
CINUSE_BIT
);

3225 
m¨k_öu£_foŸ
(
m
, 
p
, 
psize
);

3226 
chunk_∂us_off£t
(
p
, 
psize
)->
	ghód
 = 
FENCEPOST_HEAD
;

3227 
chunk_∂us_off£t
(
p
, 
psize
+
SIZE_T_SIZE
)->
	ghód
 = 0;

3229 i‡(
	gmm
 < 
	gm
->
	gÀa°_addr
)

3230 
	gm
->
	gÀa°_addr
 = 
mm
;

3231 i‡((
	gm
->
	gfoŸ¥öt
 +
mmsize
Ë> 
m
->
max_foŸ¥öt
)

3232 
m
->
max_foŸ¥öt
 = m->
foŸ¥öt
;

3233 
as£π
(
is_Æig√d
(
chunk2mem
(
p
)));

3234 
check_mm≠≥d_chunk
(
m
, 
p
);

3235  
chunk2mem
(
p
);

3242 
mchunk±r
 
mm≠_ªsize
(
m°©e
 
m
, mchunk±∏
ﬁdp
, 
size_t
 
nb
) {

3243 
size_t
 
	gﬁdsize
 = 
chunksize
(
ﬁdp
);

3244 i‡(
is_smÆl
(
nb
))

3247 i‡(
	gﬁdsize
 >
nb
 + 
SIZE_T_SIZE
 &&

3248 (
ﬁdsize
 - 
nb
Ë<(
m∑øms
.
gønuœrôy
 << 1))

3249  
ﬁdp
;

3251 
size_t
 
	goff£t
 = 
ﬁdp
->
¥ev_foŸ
 & ~
IS_MMAPPED_BIT
;

3252 
size_t
 
	gﬁdmmsize
 = 
ﬁdsize
 + 
off£t
 + 
MMAP_FOOT_PAD
;

3253 
size_t
 
	g√wmmsize
 = 
gønuœrôy_Æign
(
nb
 + 
SIX_SIZE_T_SIZES
 +

3254 
CHUNK_ALIGN_MASK
);

3255 * 
	g˝
 = (*)
CALL_MREMAP
((*)
ﬁdp
 - 
off£t
,

3256 
ﬁdmmsize
, 
√wmmsize
, 1);

3257 i‡(
	g˝
 !
CMFAIL
) {

3258 
mchunk±r
 
√wp
 = (mchunk±r)(
˝
 + 
off£t
);

3259 
size_t
 
	gpsize
 = 
√wmmsize
 - 
off£t
 - 
MMAP_FOOT_PAD
;

3260 
	g√wp
->
	ghód
 = (
psize
|
CINUSE_BIT
);

3261 
m¨k_öu£_foŸ
(
m
, 
√wp
, 
psize
);

3262 
chunk_∂us_off£t
(
√wp
, 
psize
)->
	ghód
 = 
FENCEPOST_HEAD
;

3263 
chunk_∂us_off£t
(
√wp
, 
psize
+
SIZE_T_SIZE
)->
	ghód
 = 0;

3265 i‡(
	g˝
 < 
	gm
->
	gÀa°_addr
)

3266 
	gm
->
	gÀa°_addr
 = 
˝
;

3267 i‡((
	gm
->
	gfoŸ¥öt
 +
√wmmsize
 - 
ﬁdmmsize
Ë> 
m
->
max_foŸ¥öt
)

3268 
m
->
max_foŸ¥öt
 = m->
foŸ¥öt
;

3269 
check_mm≠≥d_chunk
(
m
, 
√wp
);

3270  
	g√wp
;

3279 
öô_t›
(
m°©e
 
m
, 
mchunk±r
 
p
, 
size_t
 
psize
) {

3281 
size_t
 
	goff£t
 = 
Æign_off£t
(
chunk2mem
(
p
));

3282 
	gp
 = (
mchunk±r
)((*)
p
 + 
off£t
);

3283 
	gpsize
 -
off£t
;

3285 
	gm
->
	gt›
 = 
p
;

3286 
	gm
->
	gt›size
 = 
psize
;

3287 
	gp
->
	ghód
 = 
psize
 | 
PINUSE_BIT
;

3289 
chunk_∂us_off£t
(
p
, 
psize
)->
	ghód
 = 
TOP_FOOT_SIZE
;

3290 
	gm
->
	gåim_check
 = 
m∑øms
.
åim_thªshﬁd
;

3294 
öô_bös
(
m°©e
 
m
) {

3296 
bödex_t
 
	gi
;

3297 
	gi
 = 0; i < 
	gNSMALLBINS
; ++i) {

3298 
sbö±r
 
	gbö
 = 
smÆlbö_©
(
m
,
i
);

3299 
	gbö
->
	gfd
 = 
bö
->
bk
 = bin;

3303 #i‡
PROCEED_ON_ERROR


3306 
ª£t_⁄_îr‹
(
m°©e
 
m
) {

3307 
	gi
;

3308 ++
	gmÆloc_c‹ru±i⁄_îr‹_cou¡
;

3310 
	gm
->
	gsmÆlbös
 = 
m
->
åìbös
 = 0;

3311 
	gm
->
	gdvsize
 = 
m
->
t›size
 = 0;

3312 
	gm
->
	g£g
.
	gba£
 = 0;

3313 
	gm
->
	g£g
.
	gsize
 = 0;

3314 
	gm
->
	g£g
.
	g√xt
 = 0;

3315 
	gm
->
	gt›
 = 
m
->
dv
 = 0;

3316 
	gi
 = 0; i < 
	gNTREEBINS
; ++i)

3317 *
åìbö_©
(
m
, 
i
) = 0;

3318 
öô_bös
(
m
);

3323 * 
¥ïíd_Æloc
(
m°©e
 
m
, * 
√wba£
, * 
ﬁdba£
,

3324 
size_t
 
nb
) {

3325 
mchunk±r
 
	gp
 = 
Æign_as_chunk
(
√wba£
);

3326 
mchunk±r
 
	gﬁdfú°
 = 
Æign_as_chunk
(
ﬁdba£
);

3327 
size_t
 
	gpsize
 = (*)
ﬁdfú°
 - (*)
p
;

3328 
mchunk±r
 
	gq
 = 
chunk_∂us_off£t
(
p
, 
nb
);

3329 
size_t
 
	gqsize
 = 
psize
 - 
nb
;

3330 
£t_size_™d_pöu£_of_öu£_chunk
(
m
, 
p
, 
nb
);

3332 
as£π
((*)
ﬁdfú°
 > (*)
q
);

3333 
as£π
(
pöu£
(
ﬁdfú°
));

3334 
as£π
(
qsize
 >
MIN_CHUNK_SIZE
);

3337 i‡(
	gﬁdfú°
 =
m
->
t›
) {

3338 
size_t
 
tsize
 = 
m
->
t›size
 +
qsize
;

3339 
	gm
->
	gt›
 = 
q
;

3340 
	gq
->
	ghód
 = 
tsize
 | 
PINUSE_BIT
;

3341 
check_t›_chunk
(
m
, 
q
);

3343 i‡(
	gﬁdfú°
 =
m
->
dv
) {

3344 
size_t
 
dsize
 = 
m
->
dvsize
 +
qsize
;

3345 
	gm
->
	gdv
 = 
q
;

3346 
£t_size_™d_pöu£_of_‰ì_chunk
(
q
, 
dsize
);

3349 i‡(!
cöu£
(
ﬁdfú°
)) {

3350 
size_t
 
	gnsize
 = 
chunksize
(
ﬁdfú°
);

3351 
u∆ök_chunk
(
m
, 
ﬁdfú°
, 
nsize
);

3352 
	gﬁdfú°
 = 
chunk_∂us_off£t
(
ﬁdfú°
, 
nsize
);

3353 
	gqsize
 +
nsize
;

3355 
£t_‰ì_wôh_pöu£
(
q
, 
qsize
, 
ﬁdfú°
);

3356 
ö£π_chunk
(
m
, 
q
, 
qsize
);

3357 
check_‰ì_chunk
(
m
, 
q
);

3360 
check_mÆlo˚d_chunk
(
m
, 
chunk2mem
(
p
), 
nb
);

3361  
chunk2mem
(
p
);

3366 
add_£gmít
(
m°©e
 
m
, * 
tba£
, 
size_t
 
tsize
, 
Êag_t
 
mm≠≥d
) {

3368 * 
	gﬁd_t›
 = (*)
m
->
t›
;

3369 
m£gmíçå
 
	gﬁd•
 = 
£gmít_hﬁdög
(
m
, 
ﬁd_t›
);

3370 * 
	gﬁd_íd
 = 
ﬁd•
->
ba£
 + old•->
size
;

3371 
size_t
 
	gssize
 = 
∑d_ªque°
((
mÆloc_£gmít
));

3372 * 
	gøw•
 = 
ﬁd_íd
 - (
ssize
 + 
FOUR_SIZE_T_SIZES
 + 
CHUNK_ALIGN_MASK
);

3373 
size_t
 
	goff£t
 = 
Æign_off£t
(
chunk2mem
(
øw•
));

3374 * 
	ga•
 = 
øw•
 + 
off£t
;

3375 * 
	gc•
 = (
a•
 < (
ﬁd_t›
 + 
MIN_CHUNK_SIZE
))? old_top :ásp;

3376 
mchunk±r
 
	g•
 = (mchunk±r)
c•
;

3377 
m£gmíçå
 
	gss
 = (m£gmíçå)(
chunk2mem
(
•
));

3378 
mchunk±r
 
	gäext
 = 
chunk_∂us_off£t
(
•
, 
ssize
);

3379 
mchunk±r
 
	gp
 = 
äext
;

3380 
	gn„n˚s
 = 0;

3383 
öô_t›
(
m
, (
mchunk±r
)
tba£
, 
tsize
 - 
TOP_FOOT_SIZE
);

3386 
as£π
(
is_Æig√d
(
ss
));

3387 
£t_size_™d_pöu£_of_öu£_chunk
(
m
, 
•
, 
ssize
);

3388 *
	gss
 = 
m
->
£g
;

3389 
	gm
->
	g£g
.
	gba£
 = 
tba£
;

3390 
	gm
->
	g£g
.
	gsize
 = 
tsize
;

3391 ()
£t_£gmít_Êags
(&
m
->
£g
, 
mm≠≥d
);

3392 
	gm
->
	g£g
.
	g√xt
 = 
ss
;

3396 
mchunk±r
 
	g√xç
 = 
chunk_∂us_off£t
(
p
, 
SIZE_T_SIZE
);

3397 
	gp
->
	ghód
 = 
FENCEPOST_HEAD
;

3398 ++
	gn„n˚s
;

3399 i‡((*)(&(
	g√xç
->
	ghód
)Ë< 
	gﬁd_íd
)

3400 
	gp
 = 
√xç
;

3404 
as£π
(
n„n˚s
 >= 2);

3407 i‡(
	gc•
 !
ﬁd_t›
) {

3408 
mchunk±r
 
q
 = (mchunk±r)
ﬁd_t›
;

3409 
size_t
 
	gpsize
 = 
c•
 - 
ﬁd_t›
;

3410 
mchunk±r
 
	gä
 = 
chunk_∂us_off£t
(
q
, 
psize
);

3411 
£t_‰ì_wôh_pöu£
(
q
, 
psize
, 
ä
);

3412 
ö£π_chunk
(
m
, 
q
, 
psize
);

3415 
check_t›_chunk
(
m
, m->
t›
);

3421 * 
sys_Æloc
(
m°©e
 
m
, 
size_t
 
nb
) {

3422 * 
	gtba£
 = 
CMFAIL
;

3423 
size_t
 
	gtsize
 = 0;

3424 
Êag_t
 
	gmm≠_Êag
 = 0;

3426 
öô_m∑øms
();

3429 i‡(
u£_mm≠
(
m
Ë&& 
	gnb
 >
m∑øms
.
mm≠_thªshﬁd
) {

3430 * 
mem
 = 
mm≠_Æloc
(
m
, 
nb
);

3431 i‡(
	gmem
 != 0)

3432  
mem
;

3452 i‡(
	gMORECORE_CONTIGUOUS
 && !
u£_n⁄c⁄tiguous
(
m
)) {

3453 * 
	gbr
 = 
CMFAIL
;

3454 
m£gmíçå
 
	gss
 = (
m
->
t›
 =0)? 0 : 
£gmít_hﬁdög
(m, (*)m->top);

3455 
size_t
 
	gasize
 = 0;

3456 
ACQUIRE_MORECORE_LOCK
();

3458 i‡(
	gss
 == 0) {

3459 * 
ba£
 = (*)
CALL_MORECORE
(0);

3460 i‡(
	gba£
 !
CMFAIL
) {

3461 
asize
 = 
gønuœrôy_Æign
(
nb
 + 
TOP_FOOT_SIZE
 + 
SIZE_T_ONE
);

3463 i‡(!
is_∑ge_Æig√d
(
ba£
))

3464 
	gasize
 +(
∑ge_Æign
((
size_t
)
ba£
) - (size_t)base);

3466 i‡(
	gasize
 < 
	gHALF_MAX_SIZE_T
 &&

3467 (
	gbr
 = (*)(
CALL_MORECORE
(
asize
))Ë=
ba£
) {

3468 
tba£
 = 
ba£
;

3469 
	gtsize
 = 
asize
;

3475 
	gasize
 = 
gønuœrôy_Æign
(
nb
 - 
m
->
t›size
 + 
TOP_FOOT_SIZE
 + 
SIZE_T_ONE
);

3477 i‡(
	gasize
 < 
	gHALF_MAX_SIZE_T
 &&

3478 (
	gbr
 = (*)(
CALL_MORECORE
(
asize
))Ë=
ss
->
ba£
+ss->
size
) {

3479 
tba£
 = 
br
;

3480 
	gtsize
 = 
asize
;

3484 i‡(
	gtba£
 =
CMFAIL
) {

3485 i‡(
br
 !
CMFAIL
) {

3486 i‡(
asize
 < 
HALF_MAX_SIZE_T
 &&

3487 
asize
 < 
nb
 + 
TOP_FOOT_SIZE
 + 
SIZE_T_ONE
) {

3488 
size_t
 
esize
 = 
gønuœrôy_Æign
(
nb
 + 
TOP_FOOT_SIZE
 + 
SIZE_T_ONE
 - 
asize
);

3489 i‡(
	gesize
 < 
	gHALF_MAX_SIZE_T
) {

3490 * 
	gíd
 = (*)
CALL_MORECORE
(
esize
);

3491 i‡(
	gíd
 !
CMFAIL
)

3492 
asize
 +
esize
;

3494 ()
CALL_MORECORE
(-
asize
);

3495 
	gbr
 = 
CMFAIL
;

3500 i‡(
	gbr
 !
CMFAIL
) {

3501 
tba£
 = 
br
;

3502 
	gtsize
 = 
asize
;

3505 
dißbÀ_c⁄tiguous
(
m
);

3508 
RELEASE_MORECORE_LOCK
();

3511 i‡(
	gHAVE_MMAP
 && 
	gtba£
 =
CMFAIL
) {

3512 
size_t
 
ªq
 = 
nb
 + 
TOP_FOOT_SIZE
 + 
SIZE_T_ONE
;

3513 
size_t
 
	grsize
 = 
gønuœrôy_Æign
(
ªq
);

3514 i‡(
	grsize
 > 
	gnb
) {

3515 * 
	gmp
 = (*)(
CALL_MMAP
(
rsize
));

3516 i‡(
	gmp
 !
CMFAIL
) {

3517 
tba£
 = 
mp
;

3518 
	gtsize
 = 
rsize
;

3519 
	gmm≠_Êag
 = 
IS_MMAPPED_BIT
;

3524 i‡(
	gHAVE_MORECORE
 && 
	gtba£
 =
CMFAIL
) {

3525 
size_t
 
asize
 = 
gønuœrôy_Æign
(
nb
 + 
TOP_FOOT_SIZE
 + 
SIZE_T_ONE
);

3526 i‡(
	gasize
 < 
	gHALF_MAX_SIZE_T
) {

3527 * 
	gbr
 = 
CMFAIL
;

3528 * 
	gíd
 = 
CMFAIL
;

3529 
ACQUIRE_MORECORE_LOCK
();

3530 
	gbr
 = (*)(
CALL_MORECORE
(
asize
));

3531 
	gíd
 = (*)(
CALL_MORECORE
(0));

3532 
RELEASE_MORECORE_LOCK
();

3533 i‡(
	gbr
 !
CMFAIL
 && 
íd
 !CMFAIL && 
br
 <Énd) {

3534 
size_t
 
ssize
 = 
íd
 - 
br
;

3535 i‡(
	gssize
 > 
	gnb
 + 
	gTOP_FOOT_SIZE
) {

3536 
	gtba£
 = 
br
;

3537 
	gtsize
 = 
ssize
;

3543 i‡(
	gtba£
 !
CMFAIL
) {

3545 i‡((
m
->
foŸ¥öt
 +
tsize
Ë> m->
max_foŸ¥öt
)

3546 
m
->
max_foŸ¥öt
 = m->
foŸ¥öt
;

3548 i‡(!
is_öôülized
(
m
)) {

3549 
	gm
->
	g£g
.
	gba£
 = 
m
->
Àa°_addr
 = 
tba£
;

3550 
	gm
->
	g£g
.
	gsize
 = 
tsize
;

3551 ()
£t_£gmít_Êags
(&
m
->
£g
, 
mm≠_Êag
);

3552 
	gm
->
	gmagic
 = 
m∑øms
.
magic
;

3553 
öô_bös
(
m
);

3554 i‡(
is_globÆ
(
m
))

3555 
öô_t›
(
m
, (
mchunk±r
)
tba£
, 
tsize
 - 
TOP_FOOT_SIZE
);

3558 
mchunk±r
 
	gmn
 = 
√xt_chunk
(
mem2chunk
(
m
));

3559 
öô_t›
(
m
, 
mn
, (
size_t
)((
tba£
 + 
tsize
Ë- (*)mnË-
TOP_FOOT_SIZE
);

3565 
m£gmíçå
 
	g•
 = &
m
->
£g
;

3566 
	g•
 !0 && 
tba£
 !
•
->
ba£
 + sp->
size
)

3567 
•
 = sp->
√xt
;

3568 i‡(
	g•
 != 0 &&

3569 !
is_exã∫_£gmít
(
•
) &&

3570 
check_£gmít_mîge
(
•
, 
tba£
, 
tsize
) &&

3571 (
gë_£gmít_Êags
(
•
Ë& 
	gIS_MMAPPED_BIT
Ë=
mm≠_Êag
 &&

3572 
£gmít_hﬁds
(
•
, 
m
->
t›
)) {

3573 
	g•
->
	gsize
 +
tsize
;

3574 
öô_t›
(
m
, m->
t›
, m->
t›size
 + 
tsize
);

3577 i‡(
	gtba£
 < 
	gm
->
	gÀa°_addr
)

3578 
	gm
->
	gÀa°_addr
 = 
tba£
;

3579 
	g•
 = &
m
->
£g
;

3580 
	g•
 !0 && 
•
->
ba£
 !
tba£
 + 
tsize
)

3581 
•
 = sp->
√xt
;

3582 i‡(
	g•
 != 0 &&

3583 !
is_exã∫_£gmít
(
•
) &&

3584 
check_£gmít_mîge
(
•
, 
tba£
, 
tsize
) &&

3585 (
gë_£gmít_Êags
(
•
Ë& 
	gIS_MMAPPED_BIT
Ë=
mm≠_Êag
) {

3586 * 
ﬁdba£
 = 
•
->
ba£
;

3587 
	g•
->
	gba£
 = 
tba£
;

3588 
	g•
->
	gsize
 +
tsize
;

3589  
¥ïíd_Æloc
(
m
, 
tba£
, 
ﬁdba£
, 
nb
);

3592 
add_£gmít
(
m
, 
tba£
, 
tsize
, 
mm≠_Êag
);

3596 i‡(
	gnb
 < 
	gm
->
	gt›size
) {

3597 
size_t
 
	grsize
 = 
m
->
t›size
 -
nb
;

3598 
mchunk±r
 
	gp
 = 
m
->
t›
;

3599 
mchunk±r
 
	gr
 = 
m
->
t›
 = 
chunk_∂us_off£t
(
p
, 
nb
);

3600 
	gr
->
	ghód
 = 
rsize
 | 
PINUSE_BIT
;

3601 
£t_size_™d_pöu£_of_öu£_chunk
(
m
, 
p
, 
nb
);

3602 
check_t›_chunk
(
m
, m->
t›
);

3603 
check_mÆlo˚d_chunk
(
m
, 
chunk2mem
(
p
), 
nb
);

3604  
chunk2mem
(
p
);

3608 
	gMALLOC_FAILURE_ACTION
;

3615 
size_t
 
ªÀa£_unu£d_£gmíts
(
m°©e
 
m
) {

3616 
size_t
 
	gªÀa£d
 = 0;

3617 
m£gmíçå
 
	g¥ed
 = &
m
->
£g
;

3618 
m£gmíçå
 
	g•
 = 
¥ed
->
√xt
;

3619 
	g•
 != 0) {

3620 * 
ba£
 = 
•
->base;

3621 
size_t
 
	gsize
 = 
•
->
size
;

3622 
m£gmíçå
 
	g√xt
 = 
•
->
√xt
;

3623 i‡(
is_mm≠≥d_£gmít
(
•
Ë&& !
is_exã∫_£gmít
(sp)) {

3624 
mchunk±r
 
	gp
 = 
Æign_as_chunk
(
ba£
);

3625 
size_t
 
	gpsize
 = 
chunksize
(
p
);

3627 i‡(!
cöu£
(
p
Ë&& (*)
	gp
 + 
	gpsize
 >
ba£
 + 
size
 - 
TOP_FOOT_SIZE
) {

3628 
tchunk±r
 
ç
 = (tchunk±r)
p
;

3629 
as£π
(
£gmít_hﬁds
(
•
, (*)sp));

3630 i‡(
	gp
 =
m
->
dv
) {

3631 
m
->
dv
 = 0;

3632 
	gm
->
	gdvsize
 = 0;

3635 
u∆ök_œrge_chunk
(
m
, 
ç
);

3637 i‡(
CALL_MUNMAP
(
ba£
, 
size
) == 0) {

3638 
ªÀa£d
 +
size
;

3639 
	gm
->
	gfoŸ¥öt
 -
size
;

3641 
	g•
 = 
¥ed
;

3642 
	g•
->
	g√xt
 = 
√xt
;

3645 
ö£π_œrge_chunk
(
m
, 
ç
, 
psize
);

3649 
	g¥ed
 = 
•
;

3650 
	g•
 = 
√xt
;

3652  
	gªÀa£d
;

3655 
sys_åim
(
m°©e
 
m
, 
size_t
 
∑d
) {

3656 
size_t
 
	gªÀa£d
 = 0;

3657 i‡(
	g∑d
 < 
	gMAX_REQUEST
 && 
is_öôülized
(
m
)) {

3658 
	g∑d
 +
TOP_FOOT_SIZE
;

3660 i‡(
	gm
->
	gt›size
 > 
	g∑d
) {

3662 
size_t
 
	gunô
 = 
m∑øms
.
gønuœrôy
;

3663 
size_t
 
	gexåa
 = ((
m
->
t›size
 - 
∑d
 + (
unô
 - 
SIZE_T_ONE
)) / unit -

3664 
SIZE_T_ONE
Ë* 
unô
;

3665 
m£gmíçå
 
	g•
 = 
£gmít_hﬁdög
(
m
, (*)m->
t›
);

3667 i‡(!
is_exã∫_£gmít
(
•
)) {

3668 i‡(
is_mm≠≥d_£gmít
(
•
)) {

3669 i‡(
	gHAVE_MMAP
 &&

3670 
	g•
->
	gsize
 >
exåa
 &&

3671 !
has_£gmít_lök
(
m
, 
•
)) {

3672 
size_t
 
	g√wsize
 = 
•
->
size
 - 
exåa
;

3674 i‡((
CALL_MREMAP
(
•
->
ba£
, sp->
size
, 
√wsize
, 0Ë!
MFAIL
) ||

3675 (
CALL_MUNMAP
(
•
->
ba£
 + 
√wsize
, 
exåa
) == 0)) {

3676 
ªÀa£d
 = 
exåa
;

3680 i‡(
	gHAVE_MORECORE
) {

3681 i‡(
	gexåa
 >
HALF_MAX_SIZE_T
)

3682 
exåa
 = (
HALF_MAX_SIZE_T
Ë+ 
SIZE_T_ONE
 - 
unô
;

3683 
ACQUIRE_MORECORE_LOCK
();

3686 * 
	gﬁd_br
 = (*)(
CALL_MORECORE
(0));

3687 i‡(
	gﬁd_br
 =
•
->
ba£
 + sp->
size
) {

3688 * 
ªl_br
 = (*)(
CALL_MORECORE
(-
exåa
));

3689 * 
	g√w_br
 = (*)(
CALL_MORECORE
(0));

3690 i‡(
	gªl_br
 !
CMFAIL
 && 
√w_br
 < 
ﬁd_br
)

3691 
ªÀa£d
 = 
ﬁd_br
 - 
√w_br
;

3694 
RELEASE_MORECORE_LOCK
();

3698 i‡(
	gªÀa£d
 != 0) {

3699 
•
->
size
 -
ªÀa£d
;

3700 
	gm
->
	gfoŸ¥öt
 -
ªÀa£d
;

3701 
öô_t›
(
m
, m->
t›
, m->
t›size
 - 
ªÀa£d
);

3702 
check_t›_chunk
(
m
, m->
t›
);

3707 i‡(
	gHAVE_MMAP
)

3708 
	gªÀa£d
 +
ªÀa£_unu£d_£gmíts
(
m
);

3711 i‡(
	gªÀa£d
 == 0)

3712 
m
->
åim_check
 = 
MAX_SIZE_T
;

3715  (
	gªÀa£d
 != 0)? 1 : 0;

3721 * 
tmÆloc_œrge
(
m°©e
 
m
, 
size_t
 
nb
) {

3722 
tchunk±r
 
	gv
 = 0;

3723 
size_t
 
	grsize
 = -
nb
;

3724 
tchunk±r
 
	gt
;

3725 
bödex_t
 
	gidx
;

3726 
compuã_åì_ödex
(
nb
, 
idx
);

3728 i‡((
	gt
 = *
åìbö_©
(
m
, 
idx
)) != 0) {

3730 
size_t
 
sizebôs
 = 
nb
 << 
À·shi·_f‹_åì_ödex
(
idx
);

3731 
tchunk±r
 
	gr°
 = 0;

3733 
tchunk±r
 
	gπ
;

3734 
size_t
 
	gåem
 = 
chunksize
(
t
Ë- 
nb
;

3735 i‡(
	gåem
 < 
	grsize
) {

3736 
	gv
 = 
t
;

3737 i‡((
	grsize
 = 
åem
) == 0)

3740 
	gπ
 = 
t
->
chûd
[1];

3741 
	gt
 = 
t
->
chûd
[(
sizebôs
 >> (
SIZE_T_BITSIZE
-
SIZE_T_ONE
)) & 1];

3742 i‡(
	gπ
 !0 && 
π
 !
t
)

3743 
r°
 = 
π
;

3744 i‡(
	gt
 == 0) {

3745 
t
 = 
r°
;

3748 
	gsizebôs
 <<= 1;

3752 i‡(
	gt
 =0 && 
v
 == 0) {

3753 
böm≠_t
 
À·bôs
 = 
À·_bôs
(
idx2bô
(
idx
)Ë& 
m
->
åìm≠
;

3754 i‡(
	gÀ·bôs
 != 0) {

3755 
bödex_t
 
i
;

3756 
böm≠_t
 
	gÀa°bô
 = 
Àa°_bô
(
À·bôs
);

3757 
compuã_bô2idx
(
Àa°bô
, 
i
);

3758 
	gt
 = *
åìbö_©
(
m
, 
i
);

3762 
	gt
 != 0) {

3763 
size_t
 
åem
 = 
chunksize
(
t
Ë- 
nb
;

3764 i‡(
	gåem
 < 
	grsize
) {

3765 
	grsize
 = 
åem
;

3766 
	gv
 = 
t
;

3768 
	gt
 = 
À·mo°_chûd
(
t
);

3772 i‡(
	gv
 !0 && 
rsize
 < (
size_t
)(
m
->
dvsize
 - 
nb
)) {

3773 i‡(
RTCHECK
(
ok_addªss
(
m
, 
v
))) {

3774 
mchunk±r
 
r
 = 
chunk_∂us_off£t
(
v
, 
nb
);

3775 
as£π
(
chunksize
(
v
Ë=
rsize
 + 
nb
);

3776 i‡(
RTCHECK
(
ok_√xt
(
v
, 
r
))) {

3777 
u∆ök_œrge_chunk
(
m
, 
v
);

3778 i‡(
	grsize
 < 
	gMIN_CHUNK_SIZE
)

3779 
£t_öu£_™d_pöu£
(
m
, 
v
, (
rsize
 + 
nb
));

3781 
£t_size_™d_pöu£_of_öu£_chunk
(
m
, 
v
, 
nb
);

3782 
£t_size_™d_pöu£_of_‰ì_chunk
(
r
, 
rsize
);

3783 
ö£π_chunk
(
m
, 
r
, 
rsize
);

3785  
chunk2mem
(
v
);

3788 
CORRUPTION_ERROR_ACTION
(
m
);

3794 * 
tmÆloc_smÆl
(
m°©e
 
m
, 
size_t
 
nb
) {

3795 
tchunk±r
 
	gt
, 
	gv
;

3796 
size_t
 
	grsize
;

3797 
bödex_t
 
	gi
;

3798 
böm≠_t
 
	gÀa°bô
 = 
Àa°_bô
(
m
->
åìm≠
);

3799 
compuã_bô2idx
(
Àa°bô
, 
i
);

3801 
	gv
 = 
t
 = *
åìbö_©
(
m
, 
i
);

3802 
	grsize
 = 
chunksize
(
t
Ë- 
nb
;

3804 (
	gt
 = 
À·mo°_chûd
(
t
)) != 0) {

3805 
size_t
 
åem
 = 
chunksize
(
t
Ë- 
nb
;

3806 i‡(
	gåem
 < 
	grsize
) {

3807 
	grsize
 = 
åem
;

3808 
	gv
 = 
t
;

3812 i‡(
RTCHECK
(
ok_addªss
(
m
, 
v
))) {

3813 
mchunk±r
 
	gr
 = 
chunk_∂us_off£t
(
v
, 
nb
);

3814 
as£π
(
chunksize
(
v
Ë=
rsize
 + 
nb
);

3815 i‡(
RTCHECK
(
ok_√xt
(
v
, 
r
))) {

3816 
u∆ök_œrge_chunk
(
m
, 
v
);

3817 i‡(
	grsize
 < 
	gMIN_CHUNK_SIZE
)

3818 
£t_öu£_™d_pöu£
(
m
, 
v
, (
rsize
 + 
nb
));

3820 
£t_size_™d_pöu£_of_öu£_chunk
(
m
, 
v
, 
nb
);

3821 
£t_size_™d_pöu£_of_‰ì_chunk
(
r
, 
rsize
);

3822 
ª∂a˚_dv
(
m
, 
r
, 
rsize
);

3824  
chunk2mem
(
v
);

3828 
CORRUPTION_ERROR_ACTION
(
m
);

3834 * 
öã∫Æ_ªÆloc
(
m°©e
 
m
, * 
ﬁdmem
, 
size_t
 
byãs
) {

3835 i‡(
	gbyãs
 >
MAX_REQUEST
) {

3836 
MALLOC_FAILURE_ACTION
;

3839 i‡(!
PREACTION
(
m
)) {

3840 
mchunk±r
 
	gﬁdp
 = 
mem2chunk
(
ﬁdmem
);

3841 
size_t
 
	gﬁdsize
 = 
chunksize
(
ﬁdp
);

3842 
mchunk±r
 
	g√xt
 = 
chunk_∂us_off£t
(
ﬁdp
, 
ﬁdsize
);

3843 
mchunk±r
 
	g√wp
 = 0;

3844 * 
	gexåa
 = 0;

3848 i‡(
RTCHECK
(
ok_addªss
(
m
, 
ﬁdp
Ë&& 
ok_cöu£
(oldp) &&

3849 
ok_√xt
(
ﬁdp
, 
√xt
Ë&& 
ok_pöu£
(next))) {

3850 
size_t
 
	gnb
 = 
ªque°2size
(
byãs
);

3851 i‡(
is_mm≠≥d
(
ﬁdp
))

3852 
	g√wp
 = 
mm≠_ªsize
(
m
, 
ﬁdp
, 
nb
);

3853 i‡(
	gﬁdsize
 >
nb
) {

3854 
size_t
 
rsize
 = 
ﬁdsize
 - 
nb
;

3855 
	g√wp
 = 
ﬁdp
;

3856 i‡(
	grsize
 >
MIN_CHUNK_SIZE
) {

3857 
mchunk±r
 
ªmaödî
 = 
chunk_∂us_off£t
(
√wp
, 
nb
);

3858 
£t_öu£
(
m
, 
√wp
, 
nb
);

3859 
£t_öu£
(
m
, 
ªmaödî
, 
rsize
);

3860 
	gexåa
 = 
chunk2mem
(
ªmaödî
);

3863 i‡(
	g√xt
 =
m
->
t›
 && 
ﬁdsize
 + m->
t›size
 > 
nb
) {

3865 
size_t
 
√wsize
 = 
ﬁdsize
 + 
m
->
t›size
;

3866 
size_t
 
	g√wt›size
 = 
√wsize
 - 
nb
;

3867 
mchunk±r
 
	g√wt›
 = 
chunk_∂us_off£t
(
ﬁdp
, 
nb
);

3868 
£t_öu£
(
m
, 
ﬁdp
, 
nb
);

3869 
	g√wt›
->
	ghód
 = 
√wt›size
 |
PINUSE_BIT
;

3870 
	gm
->
	gt›
 = 
√wt›
;

3871 
	gm
->
	gt›size
 = 
√wt›size
;

3872 
	g√wp
 = 
ﬁdp
;

3876 
USAGE_ERROR_ACTION
(
m
, 
ﬁdmem
);

3877 
POSTACTION
(
m
);

3881 
POSTACTION
(
m
);

3883 i‡(
	g√wp
 != 0) {

3884 i‡(
exåa
 != 0) {

3885 
öã∫Æ_‰ì
(
m
, 
exåa
);

3887 
check_öu£_chunk
(
m
, 
√wp
);

3888  
chunk2mem
(
√wp
);

3891 * 
	g√wmem
 = 
öã∫Æ_mÆloc
(
m
, 
byãs
);

3892 i‡(
	g√wmem
 != 0) {

3893 
size_t
 
oc
 = 
ﬁdsize
 - 
ovîhód_f‹
(
ﬁdp
);

3894 
mem˝y
(
√wmem
, 
ﬁdmem
, (
oc
 < 
byãs
)? oc : bytes);

3895 
öã∫Æ_‰ì
(
m
, 
ﬁdmem
);

3897  
	g√wmem
;

3905 * 
öã∫Æ_memÆign
(
m°©e
 
m
, 
size_t
 
Æignmít
, size_à
byãs
) {

3906 i‡(
	gÆignmít
 <
MALLOC_ALIGNMENT
)

3907  
öã∫Æ_mÆloc
(
m
, 
byãs
);

3908 i‡(
	gÆignmít
 < 
	gMIN_CHUNK_SIZE
)

3909 
	gÆignmít
 = 
MIN_CHUNK_SIZE
;

3910 i‡((
	gÆignmít
 & (Æignmít-
	gSIZE_T_ONE
)) != 0) {

3911 
size_t
 
a
 = 
MALLOC_ALIGNMENT
 << 1;

3912 
	ga
 < 
	gÆignmít
)á <<= 1;

3913 
	gÆignmít
 = 
a
;

3916 i‡(
	gbyãs
 >
MAX_REQUEST
 - 
Æignmít
) {

3917 i‡(
m
 != 0) {

3918 
MALLOC_FAILURE_ACTION
;

3922 
size_t
 
	gnb
 = 
ªque°2size
(
byãs
);

3923 
size_t
 
	gªq
 = 
nb
 + 
Æignmít
 + 
MIN_CHUNK_SIZE
 - 
CHUNK_OVERHEAD
;

3924 * 
	gmem
 = (*)
öã∫Æ_mÆloc
(
m
, 
ªq
);

3925 i‡(
	gmem
 != 0) {

3926 * 
Àadî
 = 0;

3927 * 
	gåaûî
 = 0;

3928 
mchunk±r
 
	gp
 = 
mem2chunk
(
mem
);

3930 i‡(
PREACTION
(
m
))  0;

3931 i‡((((
	gsize_t
)(
	gmem
)Ë% 
	gÆignmít
) != 0) {

3940 * 
br
 = (*)
mem2chunk
((
size_t
)(((size_t)(
mem
 +

3941 
Æignmít
 -

3942 
SIZE_T_ONE
)) &

3943 -
Æignmít
));

3944 * 
	gpos
 = ((
size_t
)(
br
 - (*)(
p
)Ë>
MIN_CHUNK_SIZE
)?

3945 
br
 : br+
Æignmít
;

3946 
mchunk±r
 
	g√wp
 = (mchunk±r)
pos
;

3947 
size_t
 
	gÀadsize
 = 
pos
 - (*)(
p
);

3948 
size_t
 
	g√wsize
 = 
chunksize
(
p
Ë- 
Àadsize
;

3950 i‡(
is_mm≠≥d
(
p
)) {

3951 
	g√wp
->
	g¥ev_foŸ
 = 
p
->
¥ev_foŸ
 + 
Àadsize
;

3952 
	g√wp
->
	ghód
 = (
√wsize
|
CINUSE_BIT
);

3955 
£t_öu£
(
m
, 
√wp
, 
√wsize
);

3956 
£t_öu£
(
m
, 
p
, 
Àadsize
);

3957 
	gÀadî
 = 
chunk2mem
(
p
);

3959 
	gp
 = 
√wp
;

3963 i‡(!
is_mm≠≥d
(
p
)) {

3964 
size_t
 
	gsize
 = 
chunksize
(
p
);

3965 i‡(
	gsize
 > 
	gnb
 + 
	gMIN_CHUNK_SIZE
) {

3966 
size_t
 
	gªmaödî_size
 = 
size
 - 
nb
;

3967 
mchunk±r
 
	gªmaödî
 = 
chunk_∂us_off£t
(
p
, 
nb
);

3968 
£t_öu£
(
m
, 
p
, 
nb
);

3969 
£t_öu£
(
m
, 
ªmaödî
, 
ªmaödî_size
);

3970 
	gåaûî
 = 
chunk2mem
(
ªmaödî
);

3974 
as£π
 (
chunksize
(
p
Ë>
nb
);

3975 
as£π
((((
size_t
)(
chunk2mem
(
p
))Ë% 
Æignmít
) == 0);

3976 
check_öu£_chunk
(
m
, 
p
);

3977 
POSTACTION
(
m
);

3978 i‡(
	gÀadî
 != 0) {

3979 
öã∫Æ_‰ì
(
m
, 
Àadî
);

3981 i‡(
	gåaûî
 != 0) {

3982 
öã∫Æ_‰ì
(
m
, 
åaûî
);

3984  
chunk2mem
(
p
);

3992 ** 
üŒoc
(
m°©e
 
m
,

3993 
size_t
 
n_ñemíts
,

3994 
size_t
* 
sizes
,

3995 
›ts
,

3996 * 
chunks
[]) {

4006 
size_t
 
	gñemít_size
;

4007 
size_t
 
	gc⁄ã¡s_size
;

4008 
size_t
 
	g¨øy_size
;

4009 * 
	gmem
;

4010 
mchunk±r
 
	gp
;

4011 
size_t
 
	gªmaödî_size
;

4012 ** 
	gm¨øy
;

4013 
mchunk±r
 
	g¨øy_chunk
;

4014 
Êag_t
 
	gwas_íabÀd
;

4015 
size_t
 
	gsize
;

4016 
size_t
 
	gi
;

4019 i‡(
	gchunks
 != 0) {

4020 i‡(
n_ñemíts
 == 0)

4021  
chunks
;

4022 
	gm¨øy
 = 
chunks
;

4023 
	g¨øy_size
 = 0;

4027 i‡(
	gn_ñemíts
 == 0)

4028  (**)
öã∫Æ_mÆloc
(
m
, 0);

4029 
	gm¨øy
 = 0;

4030 
	g¨øy_size
 = 
ªque°2size
(
n_ñemíts
 * ((*)));

4034 i‡(
	g›ts
 & 0x1) {

4035 
	gñemít_size
 = 
ªque°2size
(*
sizes
);

4036 
	gc⁄ã¡s_size
 = 
n_ñemíts
 * 
ñemít_size
;

4039 
	gñemít_size
 = 0;

4040 
	gc⁄ã¡s_size
 = 0;

4041 
	gi
 = 0; i !
n_ñemíts
; ++i)

4042 
	gc⁄ã¡s_size
 +
ªque°2size
(
sizes
[
i
]);

4045 
	gsize
 = 
c⁄ã¡s_size
 + 
¨øy_size
;

4052 
	gwas_íabÀd
 = 
u£_mm≠
(
m
);

4053 
dißbÀ_mm≠
(
m
);

4054 
	gmem
 = 
öã∫Æ_mÆloc
(
m
, 
size
 - 
CHUNK_OVERHEAD
);

4055 i‡(
	gwas_íabÀd
)

4056 
íabÀ_mm≠
(
m
);

4057 i‡(
	gmem
 == 0)

4060 i‡(
PREACTION
(
m
))  0;

4061 
	gp
 = 
mem2chunk
(
mem
);

4062 
	gªmaödî_size
 = 
chunksize
(
p
);

4064 
as£π
(!
is_mm≠≥d
(
p
));

4066 i‡(
	g›ts
 & 0x2) {

4067 
mem£t
((
size_t
*)
mem
, 0, 
ªmaödî_size
 - 
SIZE_T_SIZE
 - 
¨øy_size
);

4071 i‡(
	gm¨øy
 == 0) {

4072 
size_t
 
¨øy_chunk_size
;

4073 
	g¨øy_chunk
 = 
chunk_∂us_off£t
(
p
, 
c⁄ã¡s_size
);

4074 
	g¨øy_chunk_size
 = 
ªmaödî_size
 - 
c⁄ã¡s_size
;

4075 
	gm¨øy
 = (**Ë(
chunk2mem
(
¨øy_chunk
));

4076 
£t_size_™d_pöu£_of_öu£_chunk
(
m
, 
¨øy_chunk
, 
¨øy_chunk_size
);

4077 
	gªmaödî_size
 = 
c⁄ã¡s_size
;

4081 
	gi
 = 0; ; ++i) {

4082 
	gm¨øy
[
i
] = 
chunk2mem
(
p
);

4083 i‡(
	gi
 !
n_ñemíts
-1) {

4084 i‡(
ñemít_size
 != 0)

4085 
size
 = 
ñemít_size
;

4087 
	gsize
 = 
ªque°2size
(
sizes
[
i
]);

4088 
	gªmaödî_size
 -
size
;

4089 
£t_size_™d_pöu£_of_öu£_chunk
(
m
, 
p
, 
size
);

4090 
	gp
 = 
chunk_∂us_off£t
(
p
, 
size
);

4093 
£t_size_™d_pöu£_of_öu£_chunk
(
m
, 
p
, 
ªmaödî_size
);

4098 #i‡
DEBUG


4099 i‡(
	gm¨øy
 !
chunks
) {

4101 i‡(
ñemít_size
 != 0) {

4102 
as£π
(
ªmaödî_size
 =
ñemít_size
);

4105 
as£π
(
ªmaödî_size
 =
ªque°2size
(
sizes
[
i
]));

4107 
check_öu£_chunk
(
m
, 
mem2chunk
(
m¨øy
));

4109 
	gi
 = 0; i !
n_ñemíts
; ++i)

4110 
check_öu£_chunk
(
m
, 
mem2chunk
(
m¨øy
[
i
]));

4114 
POSTACTION
(
m
);

4115  
	gm¨øy
;

4121 #i‡!
ONLY_MSPACES


4123 * 
dlmÆloc
(
size_t
 
byãs
) {

4147 i‡(!
PREACTION
(
gm
)) {

4148 * 
	gmem
;

4149 
size_t
 
	gnb
;

4150 i‡(
	gbyãs
 <
MAX_SMALL_REQUEST
) {

4151 
bödex_t
 
idx
;

4152 
böm≠_t
 
	gsmÆlbôs
;

4153 
	gnb
 = (
byãs
 < 
MIN_REQUEST
)? 
MIN_CHUNK_SIZE
 : 
∑d_ªque°
(bytes);

4154 
	gidx
 = 
smÆl_ödex
(
nb
);

4155 
	gsmÆlbôs
 = 
gm
->
smÆlm≠
 >> 
idx
;

4157 i‡((
	gsmÆlbôs
 & 0x3U) != 0) {

4158 
mchunk±r
 
b
, 
p
;

4159 
	gidx
 +~
smÆlbôs
 & 1;

4160 
	gb
 = 
smÆlbö_©
(
gm
, 
idx
);

4161 
	gp
 = 
b
->
fd
;

4162 
as£π
(
chunksize
(
p
Ë=
smÆl_ödex2size
(
idx
));

4163 
u∆ök_fú°_smÆl_chunk
(
gm
, 
b
, 
p
, 
idx
);

4164 
£t_öu£_™d_pöu£
(
gm
, 
p
, 
smÆl_ödex2size
(
idx
));

4165 
	gmem
 = 
chunk2mem
(
p
);

4166 
check_mÆlo˚d_chunk
(
gm
, 
mem
, 
nb
);

4167 
	gpo°a˘i⁄
;

4170 i‡(
	gnb
 > 
	ggm
->
	gdvsize
) {

4171 i‡(
	gsmÆlbôs
 != 0) {

4172 
mchunk±r
 
b
, 
p
, 
r
;

4173 
size_t
 
	grsize
;

4174 
bödex_t
 
	gi
;

4175 
böm≠_t
 
	gÀ·bôs
 = (
smÆlbôs
 << 
idx
Ë& 
À·_bôs
(
idx2bô
(idx));

4176 
böm≠_t
 
	gÀa°bô
 = 
Àa°_bô
(
À·bôs
);

4177 
compuã_bô2idx
(
Àa°bô
, 
i
);

4178 
	gb
 = 
smÆlbö_©
(
gm
, 
i
);

4179 
	gp
 = 
b
->
fd
;

4180 
as£π
(
chunksize
(
p
Ë=
smÆl_ödex2size
(
i
));

4181 
u∆ök_fú°_smÆl_chunk
(
gm
, 
b
, 
p
, 
i
);

4182 
	grsize
 = 
smÆl_ödex2size
(
i
Ë- 
nb
;

4184 i‡(
	gSIZE_T_SIZE
 !4 && 
rsize
 < 
MIN_CHUNK_SIZE
)

4185 
£t_öu£_™d_pöu£
(
gm
, 
p
, 
smÆl_ödex2size
(
i
));

4187 
£t_size_™d_pöu£_of_öu£_chunk
(
gm
, 
p
, 
nb
);

4188 
	gr
 = 
chunk_∂us_off£t
(
p
, 
nb
);

4189 
£t_size_™d_pöu£_of_‰ì_chunk
(
r
, 
rsize
);

4190 
ª∂a˚_dv
(
gm
, 
r
, 
rsize
);

4192 
	gmem
 = 
chunk2mem
(
p
);

4193 
check_mÆlo˚d_chunk
(
gm
, 
mem
, 
nb
);

4194 
	gpo°a˘i⁄
;

4197 i‡(
	ggm
->
	gåìm≠
 !0 && (
mem
 = 
tmÆloc_smÆl
(
gm
, 
nb
)) != 0) {

4198 
check_mÆlo˚d_chunk
(
gm
, 
mem
, 
nb
);

4199 
	gpo°a˘i⁄
;

4203 i‡(
	gbyãs
 >
MAX_REQUEST
)

4204 
nb
 = 
MAX_SIZE_T
;

4206 
	gnb
 = 
∑d_ªque°
(
byãs
);

4207 i‡(
	ggm
->
	gåìm≠
 !0 && (
mem
 = 
tmÆloc_œrge
(
gm
, 
nb
)) != 0) {

4208 
check_mÆlo˚d_chunk
(
gm
, 
mem
, 
nb
);

4209 
	gpo°a˘i⁄
;

4213 i‡(
	gnb
 <
gm
->
dvsize
) {

4214 
size_t
 
rsize
 = 
gm
->
dvsize
 - 
nb
;

4215 
mchunk±r
 
	gp
 = 
gm
->
dv
;

4216 i‡(
	grsize
 >
MIN_CHUNK_SIZE
) {

4217 
mchunk±r
 
r
 = 
gm
->
dv
 = 
chunk_∂us_off£t
(
p
, 
nb
);

4218 
	ggm
->
	gdvsize
 = 
rsize
;

4219 
£t_size_™d_pöu£_of_‰ì_chunk
(
r
, 
rsize
);

4220 
£t_size_™d_pöu£_of_öu£_chunk
(
gm
, 
p
, 
nb
);

4223 
size_t
 
	gdvs
 = 
gm
->
dvsize
;

4224 
	ggm
->
	gdvsize
 = 0;

4225 
	ggm
->
	gdv
 = 0;

4226 
£t_öu£_™d_pöu£
(
gm
, 
p
, 
dvs
);

4228 
	gmem
 = 
chunk2mem
(
p
);

4229 
check_mÆlo˚d_chunk
(
gm
, 
mem
, 
nb
);

4230 
	gpo°a˘i⁄
;

4233 i‡(
	gnb
 < 
	ggm
->
	gt›size
) {

4234 
size_t
 
	grsize
 = 
gm
->
t›size
 -
nb
;

4235 
mchunk±r
 
	gp
 = 
gm
->
t›
;

4236 
mchunk±r
 
	gr
 = 
gm
->
t›
 = 
chunk_∂us_off£t
(
p
, 
nb
);

4237 
	gr
->
	ghód
 = 
rsize
 | 
PINUSE_BIT
;

4238 
£t_size_™d_pöu£_of_öu£_chunk
(
gm
, 
p
, 
nb
);

4239 
	gmem
 = 
chunk2mem
(
p
);

4240 
check_t›_chunk
(
gm
, gm->
t›
);

4241 
check_mÆlo˚d_chunk
(
gm
, 
mem
, 
nb
);

4242 
	gpo°a˘i⁄
;

4245 
	gmem
 = 
sys_Æloc
(
gm
, 
nb
);

4247 
	gpo°a˘i⁄
:

4248 
POSTACTION
(
gm
);

4249  
	gmem
;

4255 
dl‰ì
(* 
mem
) {

4262 i‡(
	gmem
 != 0) {

4263 
mchunk±r
 
p
 = 
mem2chunk
(
mem
);

4264 #i‡
FOOTERS


4265 
m°©e
 
	gfm
 = 
gë_m°©e_f‹
(
p
);

4266 i‡(!
ok_magic
(
fm
)) {

4267 
USAGE_ERROR_ACTION
(
fm
, 
p
);

4271 
	#fm
 
gm


	)

4273 i‡(!
PREACTION
(
fm
)) {

4274 
check_öu£_chunk
(
fm
, 
p
);

4275 i‡(
RTCHECK
(
ok_addªss
(
fm
, 
p
Ë&& 
ok_cöu£
(p))) {

4276 
size_t
 
	gpsize
 = 
chunksize
(
p
);

4277 
mchunk±r
 
	g√xt
 = 
chunk_∂us_off£t
(
p
, 
psize
);

4278 i‡(!
pöu£
(
p
)) {

4279 
size_t
 
	g¥evsize
 = 
p
->
¥ev_foŸ
;

4280 i‡((
	g¥evsize
 & 
	gIS_MMAPPED_BIT
) != 0) {

4281 
¥evsize
 &~
IS_MMAPPED_BIT
;

4282 
	gpsize
 +
¥evsize
 + 
MMAP_FOOT_PAD
;

4283 i‡(
CALL_MUNMAP
((*)
p
 - 
¥evsize
, 
psize
) == 0)

4284 
fm
->
foŸ¥öt
 -
psize
;

4285 
	gpo°a˘i⁄
;

4288 
mchunk±r
 
	g¥ev
 = 
chunk_möus_off£t
(
p
, 
¥evsize
);

4289 
	gpsize
 +
¥evsize
;

4290 
	gp
 = 
¥ev
;

4291 i‡(
RTCHECK
(
ok_addªss
(
fm
, 
¥ev
))) {

4292 i‡(
	gp
 !
fm
->
dv
) {

4293 
u∆ök_chunk
(
fm
, 
p
, 
¥evsize
);

4295 i‡((
	g√xt
->
	ghód
 & 
	gINUSE_BITS
Ë=
INUSE_BITS
) {

4296 
fm
->
dvsize
 = 
psize
;

4297 
£t_‰ì_wôh_pöu£
(
p
, 
psize
, 
√xt
);

4298 
	gpo°a˘i⁄
;

4302 
	gîr‹a˘i⁄
;

4306 i‡(
RTCHECK
(
ok_√xt
(
p
, 
√xt
Ë&& 
ok_pöu£
(next))) {

4307 i‡(!
cöu£
(
√xt
)) {

4308 i‡(
	g√xt
 =
fm
->
t›
) {

4309 
size_t
 
tsize
 = 
fm
->
t›size
 +
psize
;

4310 
	gfm
->
	gt›
 = 
p
;

4311 
	gp
->
	ghód
 = 
tsize
 | 
PINUSE_BIT
;

4312 i‡(
	gp
 =
fm
->
dv
) {

4313 
fm
->
dv
 = 0;

4314 
	gfm
->
	gdvsize
 = 0;

4316 i‡(
should_åim
(
fm
, 
tsize
))

4317 
sys_åim
(
fm
, 0);

4318 
	gpo°a˘i⁄
;

4320 i‡(
	g√xt
 =
fm
->
dv
) {

4321 
size_t
 
dsize
 = 
fm
->
dvsize
 +
psize
;

4322 
	gfm
->
	gdv
 = 
p
;

4323 
£t_size_™d_pöu£_of_‰ì_chunk
(
p
, 
dsize
);

4324 
	gpo°a˘i⁄
;

4327 
size_t
 
	gnsize
 = 
chunksize
(
√xt
);

4328 
	gpsize
 +
nsize
;

4329 
u∆ök_chunk
(
fm
, 
√xt
, 
nsize
);

4330 
£t_size_™d_pöu£_of_‰ì_chunk
(
p
, 
psize
);

4331 i‡(
	gp
 =
fm
->
dv
) {

4332 
fm
->
dvsize
 = 
psize
;

4333 
	gpo°a˘i⁄
;

4338 
£t_‰ì_wôh_pöu£
(
p
, 
psize
, 
√xt
);

4339 
ö£π_chunk
(
fm
, 
p
, 
psize
);

4340 
check_‰ì_chunk
(
fm
, 
p
);

4341 
	gpo°a˘i⁄
;

4344 
	gîr‹a˘i⁄
:

4345 
USAGE_ERROR_ACTION
(
fm
, 
p
);

4346 
	gpo°a˘i⁄
:

4347 
POSTACTION
(
fm
);

4350 #i‡!
FOOTERS


4351 #unde‡
fm


4355 * 
dlˇŒoc
(
size_t
 
n_ñemíts
, size_à
ñem_size
) {

4356 * 
	gmem
;

4357 
size_t
 
	gªq
 = 0;

4358 i‡(
	gn_ñemíts
 != 0) {

4359 
ªq
 = 
n_ñemíts
 * 
ñem_size
;

4360 i‡(((
	gn_ñemíts
 | 
	gñem_size
Ë& ~(
	gsize_t
)0xffff) &&

4361 (
	gªq
 / 
	gn_ñemíts
 !
ñem_size
))

4362 
ªq
 = 
MAX_SIZE_T
;

4364 
	gmem
 = 
dlmÆloc
(
ªq
);

4365 i‡(
	gmem
 !0 && 
ˇŒoc_mu°_˛ór
(
mem2chunk
(
mem
)))

4366 
mem£t
(
mem
, 0, 
ªq
);

4367  
	gmem
;

4370 * 
dÃóŒoc
(* 
ﬁdmem
, 
size_t
 
byãs
) {

4371 i‡(
	gﬁdmem
 == 0)

4372  
dlmÆloc
(
byãs
);

4373 #ifde‡
REALLOC_ZERO_BYTES_FREES


4374 i‡(
	gbyãs
 == 0) {

4375 
dl‰ì
(
ﬁdmem
);

4380 #i‡! 
FOOTERS


4381 
m°©e
 
	gm
 = 
gm
;

4383 
m°©e
 
	gm
 = 
gë_m°©e_f‹
(
mem2chunk
(
ﬁdmem
));

4384 i‡(!
ok_magic
(
m
)) {

4385 
USAGE_ERROR_ACTION
(
m
, 
ﬁdmem
);

4389  
öã∫Æ_ªÆloc
(
m
, 
ﬁdmem
, 
byãs
);

4393 * 
dlmemÆign
(
size_t
 
Æignmít
, size_à
byãs
) {

4394  
öã∫Æ_memÆign
(
gm
, 
Æignmít
, 
byãs
);

4397 ** 
dlödïídít_ˇŒoc
(
size_t
 
n_ñemíts
, size_à
ñem_size
,

4398 * 
chunks
[]) {

4399 
size_t
 
	gsz
 = 
ñem_size
;

4400  
üŒoc
(
gm
, 
n_ñemíts
, &
sz
, 3, 
chunks
);

4403 ** 
dlödïídít_comÆloc
(
size_t
 
n_ñemíts
, size_à
sizes
[],

4404 * 
chunks
[]) {

4405  
üŒoc
(
gm
, 
n_ñemíts
, 
sizes
, 0, 
chunks
);

4408 * 
dlvÆloc
(
size_t
 
byãs
) {

4409 
size_t
 
	g∑gesz
;

4410 
öô_m∑øms
();

4411 
	g∑gesz
 = 
m∑øms
.
∑ge_size
;

4412  
dlmemÆign
(
∑gesz
, 
byãs
);

4415 * 
dÕvÆloc
(
size_t
 
byãs
) {

4416 
size_t
 
	g∑gesz
;

4417 
öô_m∑øms
();

4418 
	g∑gesz
 = 
m∑øms
.
∑ge_size
;

4419  
dlmemÆign
(
∑gesz
, (
byãs
 +Öagesz - 
SIZE_T_ONE
) & ~(pagesz - SIZE_T_ONE));

4422 
dlmÆloc_åim
(
size_t
 
∑d
) {

4423 
	gªsu…
 = 0;

4424 i‡(!
PREACTION
(
gm
)) {

4425 
	gªsu…
 = 
sys_åim
(
gm
, 
∑d
);

4426 
POSTACTION
(
gm
);

4428  
	gªsu…
;

4431 
size_t
 
dlmÆloc_foŸ¥öt
() {

4432  
	ggm
->
	gfoŸ¥öt
;

4435 
size_t
 
dlmÆloc_max_foŸ¥öt
() {

4436  
	ggm
->
	gmax_foŸ¥öt
;

4439 #i‡!
NO_MALLINFO


4440 
mÆlöfo
 
dlmÆlöfo
() {

4441  
öã∫Æ_mÆlöfo
(
gm
);

4445 
dlmÆloc_°©s
() {

4446 
öã∫Æ_mÆloc_°©s
(
gm
);

4449 
size_t
 
dlmÆloc_ußbÀ_size
(* 
mem
) {

4450 i‡(
	gmem
 != 0) {

4451 
mchunk±r
 
p
 = 
mem2chunk
(
mem
);

4452 i‡(
cöu£
(
p
))

4453  
chunksize
(
p
Ë- 
ovîhód_f‹
(p);

4458 
dlmÆl›t
(
∑øm_numbî
, 
vÆue
) {

4459  
ch™ge_m∑øm
(
∑øm_numbî
, 
vÆue
);

4466 #i‡
MSPACES


4468 
m°©e
 
öô_u£r_m°©e
(* 
tba£
, 
size_t
 
tsize
) {

4469 
size_t
 
	gmsize
 = 
∑d_ªque°
((
mÆloc_°©e
));

4470 
mchunk±r
 
	gmn
;

4471 
mchunk±r
 
	gm•
 = 
Æign_as_chunk
(
tba£
);

4472 
m°©e
 
	gm
 = (m°©e)(
chunk2mem
(
m•
));

4473 
mem£t
(
m
, 0, 
msize
);

4474 
INITIAL_LOCK
(&
m
->
muãx
);

4475 
	gm•
->
	ghód
 = (
msize
|
PINUSE_BIT
|
CINUSE_BIT
);

4476 
	gm
->
	g£g
.
	gba£
 = 
m
->
Àa°_addr
 = 
tba£
;

4477 
	gm
->
	g£g
.
	gsize
 = 
m
->
foŸ¥öt
 = m->
max_foŸ¥öt
 = 
tsize
;

4478 
	gm
->
	gmagic
 = 
m∑øms
.
magic
;

4479 
	gm
->
	gmÊags
 = 
m∑øms
.
deÁu…_mÊags
;

4480 
dißbÀ_c⁄tiguous
(
m
);

4481 
öô_bös
(
m
);

4482 
	gmn
 = 
√xt_chunk
(
mem2chunk
(
m
));

4483 
öô_t›
(
m
, 
mn
, (
size_t
)((
tba£
 + 
tsize
Ë- (*)mnË- 
TOP_FOOT_SIZE
);

4484 
check_t›_chunk
(
m
, m->
t›
);

4485  
	gm
;

4488 
m•a˚
 
¸óã_m•a˚
(
size_t
 
ˇ∑côy
, 
locked
) {

4489 
m°©e
 
	gm
 = 0;

4490 
size_t
 
	gmsize
 = 
∑d_ªque°
((
mÆloc_°©e
));

4491 
öô_m∑øms
();

4493 i‡(
	gˇ∑côy
 < (
	gsize_t
Ë-(
	gmsize
 + 
	gTOP_FOOT_SIZE
 + 
	gm∑øms
.
	g∑ge_size
)) {

4494 
size_t
 
	grs
 = ((
ˇ∑côy
 =0)? 
m∑øms
.
gønuœrôy
 :

4495 (
ˇ∑côy
 + 
TOP_FOOT_SIZE
 + 
msize
));

4496 
size_t
 
	gtsize
 = 
gønuœrôy_Æign
(
rs
);

4497 * 
	gtba£
 = (*)(
CALL_MMAP
(
tsize
));

4498 i‡(
	gtba£
 !
CMFAIL
) {

4499 
m
 = 
öô_u£r_m°©e
(
tba£
, 
tsize
);

4500 
£t_£gmít_Êags
(&
m
->
£g
, 
IS_MMAPPED_BIT
);

4501 
£t_lock
(
m
, 
locked
);

4504  (
	gm•a˚
)
	gm
;

4507 
m•a˚
 
¸óã_m•a˚_wôh_ba£
(* 
ba£
, 
size_t
 
ˇ∑côy
, 
locked
) {

4508 
m°©e
 
	gm
 = 0;

4509 
size_t
 
	gmsize
 = 
∑d_ªque°
((
mÆloc_°©e
));

4510 
öô_m∑øms
();

4512 i‡(
	gˇ∑côy
 > 
	gmsize
 + 
	gTOP_FOOT_SIZE
 &&

4513 
	gˇ∑côy
 < (
	gsize_t
Ë-(
	gmsize
 + 
	gTOP_FOOT_SIZE
 + 
	gm∑øms
.
	g∑ge_size
)) {

4514 
	gm
 = 
öô_u£r_m°©e
((*)
ba£
, 
ˇ∑côy
);

4515 
£t_£gmít_Êags
(&
m
->
£g
, 
EXTERN_BIT
);

4516 
£t_lock
(
m
, 
locked
);

4518  (
	gm•a˚
)
	gm
;

4521 
size_t
 
de°roy_m•a˚
(
m•a˚
 
m•
) {

4522 
size_t
 
	g‰ìd
 = 0;

4523 
m°©e
 
	gms
 = (m°©e)
m•
;

4524 i‡(
ok_magic
(
ms
)) {

4525 
m£gmíçå
 
	g•
 = &
ms
->
£g
;

4526 
	g•
 != 0) {

4527 * 
ba£
 = 
•
->base;

4528 
size_t
 
	gsize
 = 
•
->
size
;

4529 
Êag_t
 
	gÊag
 = 
gë_£gmít_Êags
(
•
);

4530 
	g•
 = 
•
->
√xt
;

4531 i‡((
	gÊag
 & 
	gIS_MMAPPED_BIT
Ë&& !(Êag & 
	gEXTERN_BIT
) &&

4532 
CALL_MUNMAP
(
ba£
, 
size
) == 0)

4533 
‰ìd
 +
size
;

4537 
USAGE_ERROR_ACTION
(
ms
,ms);

4539  
	g‰ìd
;

4548 * 
m•a˚_mÆloc
(
m•a˚
 
m•
, 
size_t
 
byãs
) {

4549 
m°©e
 
	gms
 = (m°©e)
m•
;

4550 i‡(!
ok_magic
(
ms
)) {

4551 
USAGE_ERROR_ACTION
(
ms
,ms);

4554 i‡(!
PREACTION
(
ms
)) {

4555 * 
	gmem
;

4556 
size_t
 
	gnb
;

4557 i‡(
	gbyãs
 <
MAX_SMALL_REQUEST
) {

4558 
bödex_t
 
idx
;

4559 
böm≠_t
 
	gsmÆlbôs
;

4560 
	gnb
 = (
byãs
 < 
MIN_REQUEST
)? 
MIN_CHUNK_SIZE
 : 
∑d_ªque°
(bytes);

4561 
	gidx
 = 
smÆl_ödex
(
nb
);

4562 
	gsmÆlbôs
 = 
ms
->
smÆlm≠
 >> 
idx
;

4564 i‡((
	gsmÆlbôs
 & 0x3U) != 0) {

4565 
mchunk±r
 
b
, 
p
;

4566 
	gidx
 +~
smÆlbôs
 & 1;

4567 
	gb
 = 
smÆlbö_©
(
ms
, 
idx
);

4568 
	gp
 = 
b
->
fd
;

4569 
as£π
(
chunksize
(
p
Ë=
smÆl_ödex2size
(
idx
));

4570 
u∆ök_fú°_smÆl_chunk
(
ms
, 
b
, 
p
, 
idx
);

4571 
£t_öu£_™d_pöu£
(
ms
, 
p
, 
smÆl_ödex2size
(
idx
));

4572 
	gmem
 = 
chunk2mem
(
p
);

4573 
check_mÆlo˚d_chunk
(
ms
, 
mem
, 
nb
);

4574 
	gpo°a˘i⁄
;

4577 i‡(
	gnb
 > 
	gms
->
	gdvsize
) {

4578 i‡(
	gsmÆlbôs
 != 0) {

4579 
mchunk±r
 
b
, 
p
, 
r
;

4580 
size_t
 
	grsize
;

4581 
bödex_t
 
	gi
;

4582 
böm≠_t
 
	gÀ·bôs
 = (
smÆlbôs
 << 
idx
Ë& 
À·_bôs
(
idx2bô
(idx));

4583 
böm≠_t
 
	gÀa°bô
 = 
Àa°_bô
(
À·bôs
);

4584 
compuã_bô2idx
(
Àa°bô
, 
i
);

4585 
	gb
 = 
smÆlbö_©
(
ms
, 
i
);

4586 
	gp
 = 
b
->
fd
;

4587 
as£π
(
chunksize
(
p
Ë=
smÆl_ödex2size
(
i
));

4588 
u∆ök_fú°_smÆl_chunk
(
ms
, 
b
, 
p
, 
i
);

4589 
	grsize
 = 
smÆl_ödex2size
(
i
Ë- 
nb
;

4591 i‡(
	gSIZE_T_SIZE
 !4 && 
rsize
 < 
MIN_CHUNK_SIZE
)

4592 
£t_öu£_™d_pöu£
(
ms
, 
p
, 
smÆl_ödex2size
(
i
));

4594 
£t_size_™d_pöu£_of_öu£_chunk
(
ms
, 
p
, 
nb
);

4595 
	gr
 = 
chunk_∂us_off£t
(
p
, 
nb
);

4596 
£t_size_™d_pöu£_of_‰ì_chunk
(
r
, 
rsize
);

4597 
ª∂a˚_dv
(
ms
, 
r
, 
rsize
);

4599 
	gmem
 = 
chunk2mem
(
p
);

4600 
check_mÆlo˚d_chunk
(
ms
, 
mem
, 
nb
);

4601 
	gpo°a˘i⁄
;

4604 i‡(
	gms
->
	gåìm≠
 !0 && (
mem
 = 
tmÆloc_smÆl
(
ms
, 
nb
)) != 0) {

4605 
check_mÆlo˚d_chunk
(
ms
, 
mem
, 
nb
);

4606 
	gpo°a˘i⁄
;

4610 i‡(
	gbyãs
 >
MAX_REQUEST
)

4611 
nb
 = 
MAX_SIZE_T
;

4613 
	gnb
 = 
∑d_ªque°
(
byãs
);

4614 i‡(
	gms
->
	gåìm≠
 !0 && (
mem
 = 
tmÆloc_œrge
(
ms
, 
nb
)) != 0) {

4615 
check_mÆlo˚d_chunk
(
ms
, 
mem
, 
nb
);

4616 
	gpo°a˘i⁄
;

4620 i‡(
	gnb
 <
ms
->
dvsize
) {

4621 
size_t
 
rsize
 = 
ms
->
dvsize
 - 
nb
;

4622 
mchunk±r
 
	gp
 = 
ms
->
dv
;

4623 i‡(
	grsize
 >
MIN_CHUNK_SIZE
) {

4624 
mchunk±r
 
r
 = 
ms
->
dv
 = 
chunk_∂us_off£t
(
p
, 
nb
);

4625 
	gms
->
	gdvsize
 = 
rsize
;

4626 
£t_size_™d_pöu£_of_‰ì_chunk
(
r
, 
rsize
);

4627 
£t_size_™d_pöu£_of_öu£_chunk
(
ms
, 
p
, 
nb
);

4630 
size_t
 
	gdvs
 = 
ms
->
dvsize
;

4631 
	gms
->
	gdvsize
 = 0;

4632 
	gms
->
	gdv
 = 0;

4633 
£t_öu£_™d_pöu£
(
ms
, 
p
, 
dvs
);

4635 
	gmem
 = 
chunk2mem
(
p
);

4636 
check_mÆlo˚d_chunk
(
ms
, 
mem
, 
nb
);

4637 
	gpo°a˘i⁄
;

4640 i‡(
	gnb
 < 
	gms
->
	gt›size
) {

4641 
size_t
 
	grsize
 = 
ms
->
t›size
 -
nb
;

4642 
mchunk±r
 
	gp
 = 
ms
->
t›
;

4643 
mchunk±r
 
	gr
 = 
ms
->
t›
 = 
chunk_∂us_off£t
(
p
, 
nb
);

4644 
	gr
->
	ghód
 = 
rsize
 | 
PINUSE_BIT
;

4645 
£t_size_™d_pöu£_of_öu£_chunk
(
ms
, 
p
, 
nb
);

4646 
	gmem
 = 
chunk2mem
(
p
);

4647 
check_t›_chunk
(
ms
, ms->
t›
);

4648 
check_mÆlo˚d_chunk
(
ms
, 
mem
, 
nb
);

4649 
	gpo°a˘i⁄
;

4652 
	gmem
 = 
sys_Æloc
(
ms
, 
nb
);

4654 
	gpo°a˘i⁄
:

4655 
POSTACTION
(
ms
);

4656  
	gmem
;

4662 
m•a˚_‰ì
(
m•a˚
 
m•
, * 
mem
) {

4663 i‡(
	gmem
 != 0) {

4664 
mchunk±r
 
p
 = 
mem2chunk
(
mem
);

4665 #i‡
FOOTERS


4666 
m°©e
 
	gfm
 = 
gë_m°©e_f‹
(
p
);

4668 
m°©e
 
	gfm
 = (m°©e)
m•
;

4670 i‡(!
ok_magic
(
fm
)) {

4671 
USAGE_ERROR_ACTION
(
fm
, 
p
);

4674 i‡(!
PREACTION
(
fm
)) {

4675 
check_öu£_chunk
(
fm
, 
p
);

4676 i‡(
RTCHECK
(
ok_addªss
(
fm
, 
p
Ë&& 
ok_cöu£
(p))) {

4677 
size_t
 
	gpsize
 = 
chunksize
(
p
);

4678 
mchunk±r
 
	g√xt
 = 
chunk_∂us_off£t
(
p
, 
psize
);

4679 i‡(!
pöu£
(
p
)) {

4680 
size_t
 
	g¥evsize
 = 
p
->
¥ev_foŸ
;

4681 i‡((
	g¥evsize
 & 
	gIS_MMAPPED_BIT
) != 0) {

4682 
¥evsize
 &~
IS_MMAPPED_BIT
;

4683 
	gpsize
 +
¥evsize
 + 
MMAP_FOOT_PAD
;

4684 i‡(
CALL_MUNMAP
((*)
p
 - 
¥evsize
, 
psize
) == 0)

4685 
fm
->
foŸ¥öt
 -
psize
;

4686 
	gpo°a˘i⁄
;

4689 
mchunk±r
 
	g¥ev
 = 
chunk_möus_off£t
(
p
, 
¥evsize
);

4690 
	gpsize
 +
¥evsize
;

4691 
	gp
 = 
¥ev
;

4692 i‡(
RTCHECK
(
ok_addªss
(
fm
, 
¥ev
))) {

4693 i‡(
	gp
 !
fm
->
dv
) {

4694 
u∆ök_chunk
(
fm
, 
p
, 
¥evsize
);

4696 i‡((
	g√xt
->
	ghód
 & 
	gINUSE_BITS
Ë=
INUSE_BITS
) {

4697 
fm
->
dvsize
 = 
psize
;

4698 
£t_‰ì_wôh_pöu£
(
p
, 
psize
, 
√xt
);

4699 
	gpo°a˘i⁄
;

4703 
	gîr‹a˘i⁄
;

4707 i‡(
RTCHECK
(
ok_√xt
(
p
, 
√xt
Ë&& 
ok_pöu£
(next))) {

4708 i‡(!
cöu£
(
√xt
)) {

4709 i‡(
	g√xt
 =
fm
->
t›
) {

4710 
size_t
 
tsize
 = 
fm
->
t›size
 +
psize
;

4711 
	gfm
->
	gt›
 = 
p
;

4712 
	gp
->
	ghód
 = 
tsize
 | 
PINUSE_BIT
;

4713 i‡(
	gp
 =
fm
->
dv
) {

4714 
fm
->
dv
 = 0;

4715 
	gfm
->
	gdvsize
 = 0;

4717 i‡(
should_åim
(
fm
, 
tsize
))

4718 
sys_åim
(
fm
, 0);

4719 
	gpo°a˘i⁄
;

4721 i‡(
	g√xt
 =
fm
->
dv
) {

4722 
size_t
 
dsize
 = 
fm
->
dvsize
 +
psize
;

4723 
	gfm
->
	gdv
 = 
p
;

4724 
£t_size_™d_pöu£_of_‰ì_chunk
(
p
, 
dsize
);

4725 
	gpo°a˘i⁄
;

4728 
size_t
 
	gnsize
 = 
chunksize
(
√xt
);

4729 
	gpsize
 +
nsize
;

4730 
u∆ök_chunk
(
fm
, 
√xt
, 
nsize
);

4731 
£t_size_™d_pöu£_of_‰ì_chunk
(
p
, 
psize
);

4732 i‡(
	gp
 =
fm
->
dv
) {

4733 
fm
->
dvsize
 = 
psize
;

4734 
	gpo°a˘i⁄
;

4739 
£t_‰ì_wôh_pöu£
(
p
, 
psize
, 
√xt
);

4740 
ö£π_chunk
(
fm
, 
p
, 
psize
);

4741 
check_‰ì_chunk
(
fm
, 
p
);

4742 
	gpo°a˘i⁄
;

4745 
	gîr‹a˘i⁄
:

4746 
USAGE_ERROR_ACTION
(
fm
, 
p
);

4747 
	gpo°a˘i⁄
:

4748 
POSTACTION
(
fm
);

4753 * 
m•a˚_ˇŒoc
(
m•a˚
 
m•
, 
size_t
 
n_ñemíts
, size_à
ñem_size
) {

4754 * 
	gmem
;

4755 
size_t
 
	gªq
 = 0;

4756 
m°©e
 
	gms
 = (m°©e)
m•
;

4757 i‡(!
ok_magic
(
ms
)) {

4758 
USAGE_ERROR_ACTION
(
ms
,ms);

4761 i‡(
	gn_ñemíts
 != 0) {

4762 
ªq
 = 
n_ñemíts
 * 
ñem_size
;

4763 i‡(((
	gn_ñemíts
 | 
	gñem_size
Ë& ~(
	gsize_t
)0xffff) &&

4764 (
	gªq
 / 
	gn_ñemíts
 !
ñem_size
))

4765 
ªq
 = 
MAX_SIZE_T
;

4767 
	gmem
 = 
öã∫Æ_mÆloc
(
ms
, 
ªq
);

4768 i‡(
	gmem
 !0 && 
ˇŒoc_mu°_˛ór
(
mem2chunk
(
mem
)))

4769 
mem£t
(
mem
, 0, 
ªq
);

4770  
	gmem
;

4773 * 
m•a˚_ªÆloc
(
m•a˚
 
m•
, * 
ﬁdmem
, 
size_t
 
byãs
) {

4774 i‡(
	gﬁdmem
 == 0)

4775  
m•a˚_mÆloc
(
m•
, 
byãs
);

4776 #ifde‡
REALLOC_ZERO_BYTES_FREES


4777 i‡(
	gbyãs
 == 0) {

4778 
m•a˚_‰ì
(
m•
, 
ﬁdmem
);

4783 #i‡
FOOTERS


4784 
mchunk±r
 
	gp
 = 
mem2chunk
(
ﬁdmem
);

4785 
m°©e
 
	gms
 = 
gë_m°©e_f‹
(
p
);

4787 
m°©e
 
	gms
 = (m°©e)
m•
;

4789 i‡(!
ok_magic
(
ms
)) {

4790 
USAGE_ERROR_ACTION
(
ms
,ms);

4793  
öã∫Æ_ªÆloc
(
ms
, 
ﬁdmem
, 
byãs
);

4797 * 
m•a˚_memÆign
(
m•a˚
 
m•
, 
size_t
 
Æignmít
, size_à
byãs
) {

4798 
m°©e
 
	gms
 = (m°©e)
m•
;

4799 i‡(!
ok_magic
(
ms
)) {

4800 
USAGE_ERROR_ACTION
(
ms
,ms);

4803  
öã∫Æ_memÆign
(
ms
, 
Æignmít
, 
byãs
);

4806 ** 
m•a˚_ödïídít_ˇŒoc
(
m•a˚
 
m•
, 
size_t
 
n_ñemíts
,

4807 
size_t
 
ñem_size
, * 
chunks
[]) {

4808 
size_t
 
	gsz
 = 
ñem_size
;

4809 
m°©e
 
	gms
 = (m°©e)
m•
;

4810 i‡(!
ok_magic
(
ms
)) {

4811 
USAGE_ERROR_ACTION
(
ms
,ms);

4814  
üŒoc
(
ms
, 
n_ñemíts
, &
sz
, 3, 
chunks
);

4817 ** 
m•a˚_ödïídít_comÆloc
(
m•a˚
 
m•
, 
size_t
 
n_ñemíts
,

4818 
size_t
 
sizes
[], * 
chunks
[]) {

4819 
m°©e
 
	gms
 = (m°©e)
m•
;

4820 i‡(!
ok_magic
(
ms
)) {

4821 
USAGE_ERROR_ACTION
(
ms
,ms);

4824  
üŒoc
(
ms
, 
n_ñemíts
, 
sizes
, 0, 
chunks
);

4827 
m•a˚_åim
(
m•a˚
 
m•
, 
size_t
 
∑d
) {

4828 
	gªsu…
 = 0;

4829 
m°©e
 
	gms
 = (m°©e)
m•
;

4830 i‡(
ok_magic
(
ms
)) {

4831 i‡(!
PREACTION
(
ms
)) {

4832 
	gªsu…
 = 
sys_åim
(
ms
, 
∑d
);

4833 
POSTACTION
(
ms
);

4837 
USAGE_ERROR_ACTION
(
ms
,ms);

4839  
	gªsu…
;

4842 
m•a˚_mÆloc_°©s
(
m•a˚
 
m•
) {

4843 
m°©e
 
	gms
 = (m°©e)
m•
;

4844 i‡(
ok_magic
(
ms
)) {

4845 
öã∫Æ_mÆloc_°©s
(
ms
);

4848 
USAGE_ERROR_ACTION
(
ms
,ms);

4852 
size_t
 
m•a˚_foŸ¥öt
(
m•a˚
 
m•
) {

4853 
size_t
 
	gªsu…
;

4854 
m°©e
 
	gms
 = (m°©e)
m•
;

4855 i‡(
ok_magic
(
ms
)) {

4856 
	gªsu…
 = 
ms
->
foŸ¥öt
;

4858 
USAGE_ERROR_ACTION
(
ms
,ms);

4859  
	gªsu…
;

4863 
size_t
 
m•a˚_max_foŸ¥öt
(
m•a˚
 
m•
) {

4864 
size_t
 
	gªsu…
;

4865 
m°©e
 
	gms
 = (m°©e)
m•
;

4866 i‡(
ok_magic
(
ms
)) {

4867 
	gªsu…
 = 
ms
->
max_foŸ¥öt
;

4869 
USAGE_ERROR_ACTION
(
ms
,ms);

4870  
	gªsu…
;

4874 #i‡!
NO_MALLINFO


4875 
mÆlöfo
 
m•a˚_mÆlöfo
(
m•a˚
 
m•
) {

4876 
m°©e
 
	gms
 = (m°©e)
m•
;

4877 i‡(!
ok_magic
(
ms
)) {

4878 
USAGE_ERROR_ACTION
(
ms
,ms);

4880  
öã∫Æ_mÆlöfo
(
ms
);

4884 
m•a˚_mÆl›t
(
∑øm_numbî
, 
vÆue
) {

4885  
ch™ge_m∑øm
(
∑øm_numbî
, 
vÆue
);

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/frv/eabi.S

26 
	#LIBFFI_ASM


	)

27 
	~<ffic⁄fig.h
>

28 
	~<ffi.h
>

30 .
globl
 
	gffi_¥ï_¨gs_EABI


32 .
	gãxt


33 .
	gp2Æign
 4

34 .
globl
 
	gffi_ˇŒ_EABI


35 .
ty≥
 
	gffi_ˇŒ_EABI
, @
	gfun˘i⁄


37 #gr8 : 
ffi_¥ï_¨gs


38 #gr9 : &
ecif


39 #gr10: 
cif
->
byãs


40 #gr11: 
fig
->
Êags


41 #gr12: 
ecif
.
rvÆue


42 #gr13: 
‚


44 
	gffi_ˇŒ_EABI
:

45 
addi
 
•
, #-80, sp

46 
°i
 
	gÂ
, @(
	g•
, #24)

47 
addi
 
	g•
, #24, 
Â


48 
movsg
 
	gÃ
, 
gr5


54 
°i
 
	ggr5
, @(
	gÂ
, #8)

55 
°i
 
	ggr8
, @(
	gÂ
, #-4)

56 
°i
 
	ggr9
, @(
	gÂ
, #-8)

57 
°i
 
	ggr10
, @(
	gÂ
, #-12)

58 
°i
 
	ggr11
, @(
	gÂ
, #-16)

59 
°i
 
	ggr12
, @(
	gÂ
, #-20)

60 
°i
 
	ggr13
, @(
	gÂ
, #-24)

62 
sub
 
	g•
, 
	ggr10
, 
•


65 
	gldi
 @(
	gÂ
, #-4), 
gr4


66 
addi
 
	g•
, #0, 
gr8


67 
	gldi
 @(
	gÂ
, #-8), 
	ggr9


68 #ifde‡
__FRV_FDPIC__


69 
	gldd
 @(
	ggr4
, 
	ggr0
), 
gr14


70 
	gˇŒl
 @(
	ggr14
, 
	ggr0
)

72 
	gˇŒl
 @(
	ggr4
, 
	ggr0
)

76 
mov
 
	ggr8
, 
gr4


78 
	gldi
 @(
	g•
, #0), 
gr8


79 
	gldi
 @(
	g•
, #4), 
gr9


80 
	gldi
 @(
	g•
, #8), 
gr10


81 
	gldi
 @(
	g•
, #12), 
gr11


82 
	gldi
 @(
	g•
, #16), 
gr12


83 
	gldi
 @(
	g•
, #20), 
gr13


89 
	gldi
 @(
	gÂ
, #-20), 
gr3


92 
mov
 
	ggr4
, 
•


95 
	gldi
 @(
	gÂ
, -24), 
	ggr4


96 #ifde‡
__FRV_FDPIC__


97 
	gldd
 @(
	ggr4
, 
	ggr0
), 
gr14


98 
	gˇŒl
 @(
	ggr14
, 
	ggr0
)

100 
	gˇŒl
 @(
	ggr4
, 
	ggr0
)

104 
	gldi
 @(
	gÂ
, #-16), 
gr10


105 
	gldi
 @(
	gÂ
, #-20), 
gr4


108 
cmpi
 
	ggr10
, #8, 
icc0


109 
b√
 
	gicc0
, 0, .
L2


111 
°i
 
	ggr8
, @(
	ggr4
, #0)

112 
°i
 
	ggr9
, @(
	ggr4
, #4)

113 
	gbø
 .
	gL3


114 .
	gL2
:

116 
cmpi
 
gr10
, #-1, 
icc0


117 
beq
 
	gicc0
, 0, .
L3


119 
°i
 
	ggr8
, @(
	ggr4
, #0)

120 .
	gL3
:

123 
ldi
 @(
Â
, 8), 
gr5


124 
	gld
 @(
	gÂ
, 
	ggr0
), 
Â


125 
addi
 
	g•
,#80,
•


126 
	gjm∂
 @(
	ggr5
,
	ggr0
)

127 .
size
 
	gffi_ˇŒ_EABI
, .-ffi_call_EABI

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/frv/ffi.c

29 
	~<ffi.h
>

30 
	~<ffi_comm⁄.h
>

32 
	~<°dlib.h
>

37 *
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

39 
i
;

40 **
p_¨gv
;

41 *
¨gp
;

42 
ffi_ty≥
 **
p_¨g
;

43 
cou¡
 = 0;

45 
p_¨gv
 = 
ecif
->
avÆue
;

46 
¨gp
 = 
°ack
;

48 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

49 (
i
 != 0);

50 
i
--, 
p_¨g
++)

52 
size_t
 
z
;

54 
z
 = (*
p_¨g
)->
size
;

56 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT
)

58 
z
 = (*);

59 *(**Ë
¨gp
 = *
p_¨gv
;

72 i‡(
z
 < ())

74 
z
 = ();

75 (*
p_¨g
)->
ty≥
)

77 
FFI_TYPE_SINT8
:

78 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT8
 *)(* 
p_¨gv
);

81 
FFI_TYPE_UINT8
:

82 *(*Ë
¨gp
 = ()*(
UINT8
 *)(* 
p_¨gv
);

85 
FFI_TYPE_SINT16
:

86 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT16
 *)(* 
p_¨gv
);

89 
FFI_TYPE_UINT16
:

90 *(*Ë
¨gp
 = ()*(
UINT16
 *)(* 
p_¨gv
);

94 
	`FFI_ASSERT
(0);

97 i‡(
z
 == ())

99 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

103 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

105 
p_¨gv
++;

106 
¨gp
 +
z
;

107 
cou¡
 +
z
;

110  (
°ack
 + ((
cou¡
 > 24Ë? 24 : 
	`ALIGN_DOWN
(count, 8)));

111 
	}
}

114 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

116 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

117 
cif
->
Êags
 = -1;

119 
cif
->
Êags
 = cif->
πy≥
->
size
;

121 
cif
->
byãs
 = 
	`ALIGN
 (cif->bytes, 8);

123  
FFI_OK
;

124 
	}
}

126 
ffi_ˇŒ_EABI
(*(*)(*, 
exãnded_cif
 *),

127 
exãnded_cif
 *,

130 (*
‚
)());

132 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
,

133 (*
‚
)(),

134 *
rvÆue
,

135 **
avÆue
)

137 
exãnded_cif
 
ecif
;

139 
ecif
.
cif
 = cif;

140 
ecif
.
avÆue
 =ávalue;

145 i‡((
rvÆue
 =
NULL
) &&

146 (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

148 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

151 
ecif
.
rvÆue
 =Ñvalue;

154 
cif
->
abi
)

156 
FFI_EABI
:

157 
	`ffi_ˇŒ_EABI
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
,

158 
cif
->
Êags
, 
ecif
.
rvÆue
, 
‚
);

161 
	`FFI_ASSERT
(0);

164 
	}
}

166 
	$ffi_˛osuª_óbi
 (
¨g1
, 
¨g2
, 
¨g3
,

167 
¨g4
, 
¨g5
, 
¨g6
)

172 
ffi_˛osuª
 *
¸eg
 
	`__asm__
 ("gr7");

173 
ffi_˛osuª
 *
˛osuª
 = 
¸eg
;

177 *
‰ame_poöãr
 
	`__asm__
 ("fp");

178 *
°ack_¨gs
 = 
‰ame_poöãr
 + 16;

181 
ªgi°î_¨gs
[6] =

182 { 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, 
¨g6
 };

184 
ffi_cif
 *
cif
 = 
˛osuª
->cif;

185 
ffi_ty≥
 **
¨g_ty≥s
 = 
cif
->arg_types;

186 **
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 * (*));

187 *
±r
 = (*Ë
ªgi°î_¨gs
;

188 
i
;

191 
i
 = 0; i < 
cif
->
«rgs
; i++)

193 
¨g_ty≥s
[
i
]->
ty≥
)

195 
FFI_TYPE_SINT8
:

196 
FFI_TYPE_UINT8
:

197 
avÆue
[
i
] = 
±r
 + 3;

199 
FFI_TYPE_SINT16
:

200 
FFI_TYPE_UINT16
:

201 
avÆue
[
i
] = 
±r
 + 2;

203 
FFI_TYPE_SINT32
:

204 
FFI_TYPE_UINT32
:

205 
FFI_TYPE_FLOAT
:

206 
avÆue
[
i
] = 
±r
;

208 
FFI_TYPE_STRUCT
:

209 
avÆue
[
i
] = *(**)
±r
;

213 
avÆue
[
i
] = 
±r
;

214 
±r
 += 4;

217 
±r
 += 4;

221 i‡(
±r
 =((*)
ªgi°î_¨gs
 + (6*4)))

222 
±r
 = 
°ack_¨gs
;

226 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

231 *
ªtu∫_°ru˘_±r
 
	`__asm__
("gr3");

232 (
˛osuª
->
fun
Ë(
cif
, 
ªtu∫_°ru˘_±r
, 
avÆue
, closuª->
u£r_d©a
);

237 
rvÆue
;

238 (
˛osuª
->
fun
Ë(
cif
, &
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

243 
	`asm
 ("ldò @(%0, #0), gr8" : : "r" (&
rvÆue
));

244 
	`asm
 ("ldò @(%0, #0), gr9" : : "r" (&((*Ë&
rvÆue
)[1]));

246 
	}
}

248 
ffi_°©us


249 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

250 
ffi_cif
* 
cif
,

251 (*
fun
)(
ffi_cif
*, *, **, *),

252 *
u£r_d©a
,

253 *
codñoc
)

255 *
åamp
 = (*Ë&
˛osuª
->tramp[0];

256 
‚
 = (Ë
ffi_˛osuª_óbi
;

257 
˛s
 = (Ë
codñoc
;

258 #ifde‡
__FRV_FDPIC__


259 *
gŸ
 
	`__asm__
("gr15");

261 
i
;

263 
‚
 = (Ë
ffi_˛osuª_óbi
;

265 #ifde‡
__FRV_FDPIC__


266 
åamp
[0] = &((*)
codñoc
)[2];

267 
åamp
[1] = 
gŸ
;

268 
åamp
[2] = 0x8cfc0000 + (
‚
 & 0xffff);

269 
åamp
[3] = 0x8efc0000 + (
˛s
 & 0xffff);

270 
åamp
[4] = 0x8cf80000 + (
‚
 >> 16);

271 
åamp
[5] = 0x8ef80000 + (
˛s
 >> 16);

272 
åamp
[6] = 0x9cc86000;

273 
åamp
[7] = 0x8030e000;

275 
åamp
[0] = 0x8cfc0000 + (
‚
 & 0xffff);

276 
åamp
[1] = 0x8efc0000 + (
˛s
 & 0xffff);

277 
åamp
[2] = 0x8cf80000 + (
‚
 >> 16);

278 
åamp
[3] = 0x8ef80000 + (
˛s
 >> 16);

279 
åamp
[4] = 0x80300006;

282 
˛osuª
->
cif
 = cif;

283 
˛osuª
->
fun
 = fun;

284 
˛osuª
->
u£r_d©a
 = user_data;

287 
i
 = 0; i < 
FFI_TRAMPOLINE_SIZE
; i++)

288 
__asm__
 vﬁ©ûê("dc‡@(%0,%1)\n\ticò@(%2,%1)" :: "r" (
åamp
), "r" (
i
),

289 "r" (
codñoc
));

291  
FFI_OK
;

292 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/frv/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


37 #i‚de‡
LIBFFI_ASM


38 
	tffi_¨g
;

39 sig√d 
	tffi_ßrg
;

41 
	effi_abi
 {

42 
	mFFI_FIRST_ABI
 = 0,

43 
	mFFI_EABI
,

44 
	mFFI_LAST_ABI
,

45 
	mFFI_DEFAULT_ABI
 = 
FFI_EABI


46 } 
	tffi_abi
;

51 
	#FFI_CLOSURES
 1

	)

52 
	#FFI_NATIVE_RAW_API
 0

	)

54 #ifde‡
__FRV_FDPIC__


56 
	#FFI_TRAMPOLINE_SIZE
 (8*4)

	)

59 
	#FFI_TRAMPOLINE_SIZE
 (5*4)

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/ia64/ffi.c

29 
	~<ffi.h
>

30 
	~<ffi_comm⁄.h
>

32 
	~<°dlib.h
>

33 
	~<°dboﬁ.h
>

34 
	~<Êﬂt.h
>

36 
	~"ü64_Êags.h
"

41 *
	tPTR64
 
	t__©åibuã__
((
	tmode
(
	tDI
)));

48 
UINT64
 
	mx
[2] 
__©åibuã__
((
Æig√d
(16)));

49 } 
	tÂªg
;

54 
	sü64_¨gs


56 
Âªg
 
	mÂ_ªgs
[8];

57 
UINT64
 
	mgp_ªgs
[8];

58 
UINT64
 
	mŸhî_¨gs
[];

64 
ölöe
 *

65 
	$ídün_adju°
 (*
addr
, 
size_t
 
Àn
)

67 #ifde‡
__BIG_ENDIAN__


68  
addr
 + (8 - 
Àn
);

70  
addr
;

72 
	}
}

79 
	#°f_•ûl
(
addr
, 
vÆue
) \

80 
	`asm
 ("°f.•û»%0 = %1%P0" : "=m" (*
addr
Ë: "f"(
vÆue
));

	)

85 
	#ldf_fûl
(
ªsu…
, 
addr
) \

86 
	`asm
 ("ldf.fû»%0 = %1%P1" : "=f"(
ªsu…
Ë: "m"(*
addr
));

	)

91 
size_t


92 
	$hÁ_ty≥_size
 (
ty≥
)

94 
ty≥
)

96 
FFI_IA64_TYPE_HFA_FLOAT
:

98 
FFI_IA64_TYPE_HFA_DOUBLE
:

100 
FFI_IA64_TYPE_HFA_LDOUBLE
:

101  (
__Êﬂt80
);

103 
	`ab‹t
 ();

105 
	}
}

111 
	$hÁ_ty≥_lﬂd
 (
Âªg
 *
Âaddr
, 
ty≥
, *
addr
)

113 
ty≥
)

115 
FFI_IA64_TYPE_HFA_FLOAT
:

116 
	`°f_•ûl
 (
Âaddr
, *(*Ë
addr
);

118 
FFI_IA64_TYPE_HFA_DOUBLE
:

119 
	`°f_•ûl
 (
Âaddr
, *(*Ë
addr
);

121 
FFI_IA64_TYPE_HFA_LDOUBLE
:

122 
	`°f_•ûl
 (
Âaddr
, *(
__Êﬂt80
 *Ë
addr
);

125 
	`ab‹t
 ();

127 
	}
}

133 
	$hÁ_ty≥_°‹e
 (
ty≥
, *
addr
, 
Âªg
 *
Âaddr
)

135 
ty≥
)

137 
FFI_IA64_TYPE_HFA_FLOAT
:

139 
ªsu…
;

140 
	`ldf_fûl
 (
ªsu…
, 
Âaddr
);

141 *(*Ë
addr
 = 
ªsu…
;

144 
FFI_IA64_TYPE_HFA_DOUBLE
:

146 
ªsu…
;

147 
	`ldf_fûl
 (
ªsu…
, 
Âaddr
);

148 *(*Ë
addr
 = 
ªsu…
;

151 
FFI_IA64_TYPE_HFA_LDOUBLE
:

153 
__Êﬂt80
 
ªsu…
;

154 
	`ldf_fûl
 (
ªsu…
, 
Âaddr
);

155 *(
__Êﬂt80
 *Ë
addr
 = 
ªsu…
;

159 
	`ab‹t
 ();

161 
	}
}

168 
	$hÁ_ñemít_ty≥
 (
ffi_ty≥
 *
ty≥
, 
√°ed
)

170 
ñemít
 = 
FFI_TYPE_VOID
;

172 
ty≥
->type)

174 
FFI_TYPE_FLOAT
:

177 i‡(
√°ed
)

178 
ñemít
 = 
FFI_IA64_TYPE_HFA_FLOAT
;

181 
FFI_TYPE_DOUBLE
:

183 i‡(
√°ed
)

184 
ñemít
 = 
FFI_IA64_TYPE_HFA_DOUBLE
;

187 
FFI_TYPE_LONGDOUBLE
:

191 i‡(
LDBL_MANT_DIG
 =64 && 
√°ed
)

192 
ñemít
 = 
FFI_IA64_TYPE_HFA_LDOUBLE
;

195 
FFI_TYPE_STRUCT
:

197 
ffi_ty≥
 **
±r
 = &
ty≥
->
ñemíts
[0];

199 
±r
 = &
ty≥
->
ñemíts
[0]; *ptr ;Ötr++)

201 
sub_ñemít
 = 
	`hÁ_ñemít_ty≥
 (*
±r
, 1);

202 i‡(
sub_ñemít
 =
FFI_TYPE_VOID
)

203  
FFI_TYPE_VOID
;

205 i‡(
ñemít
 =
FFI_TYPE_VOID
)

206 
ñemít
 = 
sub_ñemít
;

207 i‡(
ñemít
 !
sub_ñemít
)

208  
FFI_TYPE_VOID
;

214  
FFI_TYPE_VOID
;

217  
ñemít
;

218 
	}
}

223 
ffi_°©us


224 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

226 
Êags
;

232 
cif
->
byãs
 +
	`off£tof
(
ü64_¨gs
, 
gp_ªgs
[0]);

233 i‡(
cif
->
byãs
 < (
ü64_¨gs
))

234 
cif
->
byãs
 = (
ü64_¨gs
);

237 
Êags
 = 
cif
->
πy≥
->
ty≥
;

238 
cif
->
πy≥
->
ty≥
)

240 
FFI_TYPE_LONGDOUBLE
:

243 i‡(
LDBL_MANT_DIG
 != 64)

244 
Êags
 = 
FFI_IA64_TYPE_SMALL_STRUCT
 | (16 << 8);

247 
FFI_TYPE_STRUCT
:

249 
size_t
 
size
 = 
cif
->
πy≥
->size;

250 
hÁ_ty≥
 = 
	`hÁ_ñemít_ty≥
 (
cif
->
πy≥
, 0);

252 i‡(
hÁ_ty≥
 !
FFI_TYPE_VOID
)

254 
size_t
 
√…s
 = 
size
 / 
	`hÁ_ty≥_size
 (
hÁ_ty≥
);

255 i‡(
√…s
 <= 8)

256 
Êags
 = 
hÁ_ty≥
 | (
size
 << 8);

260 i‡(
size
 <= 32)

261 
Êags
 = 
FFI_IA64_TYPE_SMALL_STRUCT
 | (
size
 << 8);

269 
cif
->
Êags
 = flags;

271  
FFI_OK
;

272 
	}
}

274 
ffi_ˇŒ_unix
 (
ü64_¨gs
 *, 
PTR64
, (*)(), 
UINT64
);

277 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

279 
ü64_¨gs
 *
°ack
;

280 
i
, 
avn
, 
gpcou¡
, 
Âcou¡
;

281 
ffi_ty≥
 **
p_¨g
;

283 
	`FFI_ASSERT
 (
cif
->
abi
 =
FFI_UNIX
);

286 i‡(
rvÆue
 =
NULL
 && 
cif
->
πy≥
->
ty≥
 !
FFI_TYPE_VOID
)

287 
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

290 
°ack
 = 
	`Æloˇ
 (
cif
->
byãs
);

292 
gpcou¡
 = 
Âcou¡
 = 0;

293 
avn
 = 
cif
->
«rgs
;

294 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
; i < 
avn
; i++,Ö_arg++)

296 (*
p_¨g
)->
ty≥
)

298 
FFI_TYPE_SINT8
:

299 
°ack
->
gp_ªgs
[
gpcou¡
++] = *(
SINT8
 *)
avÆue
[
i
];

301 
FFI_TYPE_UINT8
:

302 
°ack
->
gp_ªgs
[
gpcou¡
++] = *(
UINT8
 *)
avÆue
[
i
];

304 
FFI_TYPE_SINT16
:

305 
°ack
->
gp_ªgs
[
gpcou¡
++] = *(
SINT16
 *)
avÆue
[
i
];

307 
FFI_TYPE_UINT16
:

308 
°ack
->
gp_ªgs
[
gpcou¡
++] = *(
UINT16
 *)
avÆue
[
i
];

310 
FFI_TYPE_SINT32
:

311 
°ack
->
gp_ªgs
[
gpcou¡
++] = *(
SINT32
 *)
avÆue
[
i
];

313 
FFI_TYPE_UINT32
:

314 
°ack
->
gp_ªgs
[
gpcou¡
++] = *(
UINT32
 *)
avÆue
[
i
];

316 
FFI_TYPE_SINT64
:

317 
FFI_TYPE_UINT64
:

318 
°ack
->
gp_ªgs
[
gpcou¡
++] = *(
UINT64
 *)
avÆue
[
i
];

321 
FFI_TYPE_POINTER
:

322 
°ack
->
gp_ªgs
[
gpcou¡
++] = (
UINT64
)(
PTR64
Ë*(**)
avÆue
[
i
];

325 
FFI_TYPE_FLOAT
:

326 i‡(
gpcou¡
 < 8 && 
Âcou¡
 < 8)

327 
	`°f_•ûl
 (&
°ack
->
Â_ªgs
[
Âcou¡
++], *(*)
avÆue
[
i
]);

329 
UINT32
 
tmp
;

330 
	`mem˝y
 (&
tmp
, 
avÆue
[
i
],  (
UINT32
));

331 
°ack
->
gp_ªgs
[
gpcou¡
++] = 
tmp
;

335 
FFI_TYPE_DOUBLE
:

336 i‡(
gpcou¡
 < 8 && 
Âcou¡
 < 8)

337 
	`°f_•ûl
 (&
°ack
->
Â_ªgs
[
Âcou¡
++], *(*)
avÆue
[
i
]);

338 
	`mem˝y
 (&
°ack
->
gp_ªgs
[
gpcou¡
++], 
avÆue
[
i
],  (
UINT64
));

341 
FFI_TYPE_LONGDOUBLE
:

342 i‡(
gpcou¡
 & 1)

343 
gpcou¡
++;

344 i‡(
LDBL_MANT_DIG
 =64 && 
gpcou¡
 < 8 && 
Âcou¡
 < 8)

345 
	`°f_•ûl
 (&
°ack
->
Â_ªgs
[
Âcou¡
++], *(
__Êﬂt80
 *)
avÆue
[
i
]);

346 
	`mem˝y
 (&
°ack
->
gp_ªgs
[
gpcou¡
], 
avÆue
[
i
], 16);

347 
gpcou¡
 += 2;

350 
FFI_TYPE_STRUCT
:

352 
size_t
 
size
 = (*
p_¨g
)->size;

353 
size_t
 
Æign
 = (*
p_¨g
)->
Æignmít
;

354 
hÁ_ty≥
 = 
	`hÁ_ñemít_ty≥
 (*
p_¨g
, 0);

356 
	`FFI_ASSERT
 (
Æign
 <= 16);

357 i‡(
Æign
 =16 && (
gpcou¡
 & 1))

358 
gpcou¡
++;

360 i‡(
hÁ_ty≥
 !
FFI_TYPE_VOID
)

362 
size_t
 
hÁ_size
 = 
	`hÁ_ty≥_size
 (
hÁ_ty≥
);

363 
size_t
 
off£t
 = 0;

364 
size_t
 
gp_off£t
 = 
gpcou¡
 * 8;

366 
Âcou¡
 < 8

367 && 
off£t
 < 
size


368 && 
gp_off£t
 < 8 * 8)

370 
	`hÁ_ty≥_lﬂd
 (&
°ack
->
Â_ªgs
[
Âcou¡
], 
hÁ_ty≥
,

371 
avÆue
[
i
] + 
off£t
);

372 
off£t
 +
hÁ_size
;

373 
gp_off£t
 +
hÁ_size
;

374 
Âcou¡
 += 1;

378 
	`mem˝y
 (&
°ack
->
gp_ªgs
[
gpcou¡
], 
avÆue
[
i
], 
size
);

379 
gpcou¡
 +(
size
 + 7) / 8;

384 
	`ab‹t
 ();

388 
	`ffi_ˇŒ_unix
 (
°ack
, 
rvÆue
, 
‚
, 
cif
->
Êags
);

389 
	}
}

406 
ffi_˛osuª_unix
 ();

408 
ffi_°©us


409 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

410 
ffi_cif
* 
cif
,

411 (*
fun
)(
ffi_cif
*,*,**,*),

412 *
u£r_d©a
,

413 *
codñoc
)

417 
	sü64_fd


419 
UINT64
 
code_poöãr
;

420 
UINT64
 
gp
;

423 
	sffi_ü64_åampﬁöe_°ru˘


425 
UINT64
 
code_poöãr
;

426 
UINT64
 
Áke_gp
;

427 
UINT64
 
ªÆ_gp
;

430 
ffi_ü64_åampﬁöe_°ru˘
 *
åamp
;

431 
ü64_fd
 *
fd
;

433 i‡(
cif
->
abi
 !
FFI_UNIX
)

434  
FFI_BAD_ABI
;

436 
åamp
 = (
ffi_ü64_åampﬁöe_°ru˘
 *)
˛osuª
->tramp;

437 
fd
 = (
ü64_fd
 *)(*)
ffi_˛osuª_unix
;

439 
åamp
->
code_poöãr
 = 
fd
->code_pointer;

440 
åamp
->
ªÆ_gp
 = 
fd
->
gp
;

441 
åamp
->
Áke_gp
 = (
UINT64
)(
PTR64
)
codñoc
;

442 
˛osuª
->
cif
 = cif;

443 
˛osuª
->
u£r_d©a
 = user_data;

444 
˛osuª
->
fun
 = fun;

446  
FFI_OK
;

447 
	}
}

450 
UINT64


451 
	$ffi_˛osuª_unix_ö√r
 (
ffi_˛osuª
 *
˛osuª
, 
ü64_¨gs
 *
°ack
,

452 *
rvÆue
, *
r8
)

454 
ffi_cif
 *
cif
;

455 **
avÆue
;

456 
ffi_ty≥
 **
p_¨g
;

457 
i
, 
avn
, 
gpcou¡
, 
Âcou¡
;

459 
cif
 = 
˛osuª
->cif;

460 
avn
 = 
cif
->
«rgs
;

461 
avÆue
 = 
	`Æloˇ
 (
avn
 *  (*));

465 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

466 
rvÆue
 = 
r8
;

468 
gpcou¡
 = 
Âcou¡
 = 0;

469 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
; i < 
avn
; i++,Ö_arg++)

471 (*
p_¨g
)->
ty≥
)

473 
FFI_TYPE_SINT8
:

474 
FFI_TYPE_UINT8
:

475 
avÆue
[
i
] = 
	`ídün_adju°
(&
°ack
->
gp_ªgs
[
gpcou¡
++], 1);

477 
FFI_TYPE_SINT16
:

478 
FFI_TYPE_UINT16
:

479 
avÆue
[
i
] = 
	`ídün_adju°
(&
°ack
->
gp_ªgs
[
gpcou¡
++], 2);

481 
FFI_TYPE_SINT32
:

482 
FFI_TYPE_UINT32
:

483 
avÆue
[
i
] = 
	`ídün_adju°
(&
°ack
->
gp_ªgs
[
gpcou¡
++], 4);

485 
FFI_TYPE_SINT64
:

486 
FFI_TYPE_UINT64
:

487 
avÆue
[
i
] = &
°ack
->
gp_ªgs
[
gpcou¡
++];

489 
FFI_TYPE_POINTER
:

490 
avÆue
[
i
] = 
	`ídün_adju°
(&
°ack
->
gp_ªgs
[
gpcou¡
++], (*));

493 
FFI_TYPE_FLOAT
:

494 i‡(
gpcou¡
 < 8 && 
Âcou¡
 < 8)

496 
Âªg
 *
addr
 = &
°ack
->
Â_ªgs
[
Âcou¡
++];

497 
ªsu…
;

498 
avÆue
[
i
] = 
addr
;

499 
	`ldf_fûl
 (
ªsu…
, 
addr
);

500 *(*)
addr
 = 
ªsu…
;

503 
avÆue
[
i
] = 
	`ídün_adju°
(&
°ack
->
gp_ªgs
[
gpcou¡
], 4);

504 
gpcou¡
++;

507 
FFI_TYPE_DOUBLE
:

508 i‡(
gpcou¡
 < 8 && 
Âcou¡
 < 8)

510 
Âªg
 *
addr
 = &
°ack
->
Â_ªgs
[
Âcou¡
++];

511 
ªsu…
;

512 
avÆue
[
i
] = 
addr
;

513 
	`ldf_fûl
 (
ªsu…
, 
addr
);

514 *(*)
addr
 = 
ªsu…
;

517 
avÆue
[
i
] = &
°ack
->
gp_ªgs
[
gpcou¡
];

518 
gpcou¡
++;

521 
FFI_TYPE_LONGDOUBLE
:

522 i‡(
gpcou¡
 & 1)

523 
gpcou¡
++;

524 i‡(
LDBL_MANT_DIG
 =64 && 
gpcou¡
 < 8 && 
Âcou¡
 < 8)

526 
Âªg
 *
addr
 = &
°ack
->
Â_ªgs
[
Âcou¡
++];

527 
__Êﬂt80
 
ªsu…
;

528 
avÆue
[
i
] = 
addr
;

529 
	`ldf_fûl
 (
ªsu…
, 
addr
);

530 *(
__Êﬂt80
 *)
addr
 = 
ªsu…
;

533 
avÆue
[
i
] = &
°ack
->
gp_ªgs
[
gpcou¡
];

534 
gpcou¡
 += 2;

537 
FFI_TYPE_STRUCT
:

539 
size_t
 
size
 = (*
p_¨g
)->size;

540 
size_t
 
Æign
 = (*
p_¨g
)->
Æignmít
;

541 
hÁ_ty≥
 = 
	`hÁ_ñemít_ty≥
 (*
p_¨g
, 0);

543 
	`FFI_ASSERT
 (
Æign
 <= 16);

544 i‡(
Æign
 =16 && (
gpcou¡
 & 1))

545 
gpcou¡
++;

547 i‡(
hÁ_ty≥
 !
FFI_TYPE_VOID
)

549 
size_t
 
hÁ_size
 = 
	`hÁ_ty≥_size
 (
hÁ_ty≥
);

550 
size_t
 
off£t
 = 0;

551 
size_t
 
gp_off£t
 = 
gpcou¡
 * 8;

552 *
addr
 = 
	`Æloˇ
 (
size
);

554 
avÆue
[
i
] = 
addr
;

556 
Âcou¡
 < 8

557 && 
off£t
 < 
size


558 && 
gp_off£t
 < 8 * 8)

560 
	`hÁ_ty≥_°‹e
 (
hÁ_ty≥
, 
addr
 + 
off£t
,

561 &
°ack
->
Â_ªgs
[
Âcou¡
]);

562 
off£t
 +
hÁ_size
;

563 
gp_off£t
 +
hÁ_size
;

564 
Âcou¡
 += 1;

567 i‡(
off£t
 < 
size
)

568 
	`mem˝y
 (
addr
 + 
off£t
, (*)
°ack
->
gp_ªgs
 + 
gp_off£t
,

569 
size
 - 
off£t
);

572 
avÆue
[
i
] = &
°ack
->
gp_ªgs
[
gpcou¡
];

574 
gpcou¡
 +(
size
 + 7) / 8;

579 
	`ab‹t
 ();

583 
˛osuª
->
	`fun
 (
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

585  
cif
->
Êags
;

586 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/ia64/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


35 #i‚de‡
LIBFFI_ASM


36 
	tffi_¨g
;

37 sig√d 
	tffi_ßrg
;

39 
	effi_abi
 {

40 
	mFFI_FIRST_ABI
 = 0,

41 
	mFFI_UNIX
,

42 
	mFFI_LAST_ABI
,

43 
	mFFI_DEFAULT_ABI
 = 
FFI_UNIX


44 } 
	tffi_abi
;

49 
	#FFI_CLOSURES
 1

	)

50 
	#FFI_TRAMPOLINE_SIZE
 24

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/ia64/ia64_flags.h

34 
	#FFI_IA64_TYPE_SMALL_STRUCT
 (
FFI_TYPE_LAST
 + 1)

	)

38 
	#FFI_IA64_TYPE_HFA_FLOAT
 (
FFI_TYPE_LAST
 + 2)

	)

39 
	#FFI_IA64_TYPE_HFA_DOUBLE
 (
FFI_TYPE_LAST
 + 3)

	)

40 
	#FFI_IA64_TYPE_HFA_LDOUBLE
 (
FFI_TYPE_LAST
 + 4)

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/ia64/unix.S

32 
	#LIBFFI_ASM


	)

33 
	~<ffic⁄fig.h
>

34 
	~<ffi.h
>

35 
	~"ü64_Êags.h
"

37 .
	g¥ed
.
ß„_a¸oss_ˇŒs
 
	gp1
-
	gp5
,
	gp16
-
	gp63


38 .
	gãxt


44 .
	gÆign
 16

45 .
globÆ
 
	gffi_ˇŒ_unix


46 .
¥oc
 
ffi_ˇŒ_unix


47 
	gffi_ˇŒ_unix
:

48 .
¥ﬁogue


52 .
f‰ame
 0

53 .
ßve
 
¨
.
pfs
, 
r36


54 
Æloc
 
	gloc0
 = 
¨
.
pfs
, 4, 3, 8, 0

55 .
ßve
 
	gΩ
, 
loc1


56 
mov
 
	gloc1
 = 
b0


57 .
body


58 
add
 
r16
 = 16, 
ö0


59 
mov
 
	gloc2
 = 
gp


60 
mov
 
r8
 = 
ö1


64 
	gldf
.
fûl
 
	gf8
 = [
ö0
], 32

65 
	gldf
.
fûl
 
	gf9
 = [
r16
], 32

67 
	gldf
.
fûl
 
	gf10
 = [
ö0
], 32

68 
	gldf
.
fûl
 
	gf11
 = [
r16
], 32

70 
	gldf
.
fûl
 
	gf12
 = [
ö0
], 32

71 
	gldf
.
fûl
 
	gf13
 = [
r16
], 32

73 
	gldf
.
fûl
 
	gf14
 = [
ö0
], 32

74 
	gldf
.
fûl
 
	gf15
 = [
r16
], 24

76 
ld8
 
	gout0
 = [
ö0
], 16

77 
ld8
 
	gout1
 = [
r16
], 16

79 
ld8
 
	gout2
 = [
ö0
], 16

80 
ld8
 
	gout3
 = [
r16
], 16

82 
ld8
 
	gout4
 = [
ö0
], 16

83 
ld8
 
	gout5
 = [
r16
], 16

85 
ld8
 
	gout6
 = [
ö0
]

86 
ld8
 
out7
 = [
r16
]

90 
mov
 
	g•
 = 
ö0


93 
ld8
 
r16
 = [
ö2
], 8

95 
ld8
 
	ggp
 = [
ö2
]

96 
mov
 
b6
 = 
r16


97 
br
.
ˇŒ
.
•tk
.
m™y
 
b0
 = 
b6


101 
mov
 
	ggp
 = 
loc2


102 
zxt1
 
r16
 = 
ö3


104 
mov
 
	g¨
.
	gpfs
 = 
loc0


105 
addl
 
r18
 = @
…offx
(.
L°_èbÀ
), 
	ggp


107 
	gld8
.
mov
 
	gr18
 = [
r18
], .
L°_èbÀ


108 
mov
 
	gb0
 = 
loc1


110 
shœdd
 
	gr18
 = 
r16
, 3,Ñ18

112 
ld8
 
	gr17
 = [
r18
]

113 
shr
 
ö3
 = in3, 8

115 
add
 
	gr17
 = 
r17
, 
	gr18


117 
mov
 
	gb6
 = 
r17


118 
br
 
b6


121 .
	gL°_void
:

122 
br
.
ªt
.
•tk
.
m™y
 
b0


124 .
	gL°_uöt8
:

125 
zxt1
 
r8
 =Ñ8

127 
	g°8
 [
ö1
] = 
r8


128 
br
.
ªt
.
•tk
.
m™y
 
b0


130 .
	gL°_söt8
:

131 
sxt1
 
r8
 =Ñ8

133 
	g°8
 [
ö1
] = 
r8


134 
br
.
ªt
.
•tk
.
m™y
 
b0


136 .
	gL°_uöt16
:

137 
zxt2
 
r8
 =Ñ8

139 
	g°8
 [
ö1
] = 
r8


140 
br
.
ªt
.
•tk
.
m™y
 
b0


142 .
	gL°_söt16
:

143 
sxt2
 
r8
 =Ñ8

145 
	g°8
 [
ö1
] = 
r8


146 
br
.
ªt
.
•tk
.
m™y
 
b0


148 .
	gL°_uöt32
:

149 
zxt4
 
r8
 =Ñ8

151 
	g°8
 [
ö1
] = 
r8


152 
br
.
ªt
.
•tk
.
m™y
 
b0


154 .
	gL°_söt32
:

155 
sxt4
 
r8
 =Ñ8

157 
	g°8
 [
ö1
] = 
r8


158 
br
.
ªt
.
•tk
.
m™y
 
b0


160 .
	gL°_öt64
:

161 
°8
 [
ö1
] = 
r8


162 
br
.
ªt
.
•tk
.
m™y
 
b0


164 .
	gL°_Êﬂt
:

165 
°fs
 [
ö1
] = 
f8


166 
br
.
ªt
.
•tk
.
m™y
 
b0


168 .
	gL°_doubÀ
:

169 
°fd
 [
ö1
] = 
f8


170 
br
.
ªt
.
•tk
.
m™y
 
b0


172 .
	gL°_ldoubÀ
:

173 
°„
 [
ö1
] = 
f8


174 
br
.
ªt
.
•tk
.
m™y
 
b0


177 .
	gL°_smÆl_°ru˘
:

178 
add
 
•
 = -16, sp

179 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 8, 
ö3


180 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 16, 
ö3


181 
	gcmp
.
…
 
	gp8
, 
	gp0
 = 24, 
	gö3


183 
add
 
	gr16
 = 8, 
•


184 
add
 
	gr17
 = 16, 
•


185 
add
 
	gr18
 = 24, 
	g•


187 
	g°8
 [
•
] = 
r8


188 (
p6
Ë
°8
 [
r16
] = 
r9


189 
mov
 
out0
 = 
ö1


190 (
p7
Ë
°8
 [
r17
] = 
r10


191 (
p8
Ë
°8
 [
r18
] = 
r11


192 
mov
 
out1
 = 
•


193 
mov
 
out2
 = 
ö3


194 
br
.
ˇŒ
.
•tk
.
m™y
 
b0
 = 
mem˝y
#
;;

196 
mov
 
	g¨
.
	gpfs
 = 
loc0


197 
mov
 
b0
 = 
loc1


198 
mov
 
gp
 = 
loc2


199 
br
.
ªt
.
•tk
.
m™y
 
b0


201 .
L°_hÁ_Êﬂt
:

202 
add
 
r16
 = 4, 
ö1


203 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 4, 
	gö3


205 
	g°fs
 [
ö1
] = 
f8
, 8

206 (
	gp6
Ë
	g°fs
 [
r16
] = 
f9
, 8

207 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 8, 
ö3


208 
	gcmp
.
…
 
	gp8
, 
	gp0
 = 12, 
	gö3


210 (
	gp7
Ë
	g°fs
 [
ö1
] = 
f10
, 8

211 (
	gp8
Ë
	g°fs
 [
r16
] = 
f11
, 8

212 
	gcmp
.
…
 
	gp9
, 
	gp0
 = 16, 
ö3


213 
	gcmp
.
…
 
	gp10
, 
	gp0
 = 20, 
	gö3


215 (
	gp9
Ë
	g°fs
 [
ö1
] = 
f12
, 8

216 (
	gp10
Ë
	g°fs
 [
r16
] = 
f13
, 8

217 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 24, 
ö3


218 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 28, 
	gö3


220 (
	gp6
Ë
	g°fs
 [
ö1
] = 
f14


221 (
p7
Ë
°fs
 [
r16
] = 
f15


222 
br
.
ªt
.
•tk
.
m™y
 
b0


225 .
	gL°_hÁ_doubÀ
:

226 
add
 
r16
 = 8, 
ö1


227 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 8, 
	gö3


229 
	g°fd
 [
ö1
] = 
f8
, 16

230 (
	gp6
Ë
	g°fd
 [
r16
] = 
f9
, 16

231 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 16, 
ö3


232 
	gcmp
.
…
 
	gp8
, 
	gp0
 = 24, 
	gö3


234 (
	gp7
Ë
	g°fd
 [
ö1
] = 
f10
, 16

235 (
	gp8
Ë
	g°fd
 [
r16
] = 
f11
, 16

236 
	gcmp
.
…
 
	gp9
, 
	gp0
 = 32, 
ö3


237 
	gcmp
.
…
 
	gp10
, 
	gp0
 = 40, 
	gö3


239 (
	gp9
Ë
	g°fd
 [
ö1
] = 
f12
, 16

240 (
	gp10
Ë
	g°fd
 [
r16
] = 
f13
, 16

241 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 48, 
ö3


242 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 56, 
	gö3


244 (
	gp6
Ë
	g°fd
 [
ö1
] = 
f14


245 (
p7
Ë
°fd
 [
r16
] = 
f15


246 
br
.
ªt
.
•tk
.
m™y
 
b0


249 .
	gL°_hÁ_ldoubÀ
:

250 
add
 
r16
 = 16, 
ö1


251 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 16, 
	gö3


253 
	g°„
 [
ö1
] = 
f8
, 32

254 (
	gp6
Ë
	g°„
 [
r16
] = 
f9
, 32

255 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 32, 
ö3


256 
	gcmp
.
…
 
	gp8
, 
	gp0
 = 48, 
	gö3


258 (
	gp7
Ë
	g°„
 [
ö1
] = 
f10
, 32

259 (
	gp8
Ë
	g°„
 [
r16
] = 
f11
, 32

260 
	gcmp
.
…
 
	gp9
, 
	gp0
 = 64, 
ö3


261 
	gcmp
.
…
 
	gp10
, 
	gp0
 = 80, 
	gö3


263 (
	gp9
Ë
	g°„
 [
ö1
] = 
f12
, 32

264 (
	gp10
Ë
	g°„
 [
r16
] = 
f13
, 32

265 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 96, 
ö3


266 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 112, 
	gö3


268 (
	gp6
Ë
	g°„
 [
ö1
] = 
f14


269 (
p7
Ë
°„
 [
r16
] = 
f15


270 
br
.
ªt
.
•tk
.
m™y
 
b0


273 .
ídp
 
	gffi_ˇŒ_unix


275 .
	gÆign
 16

276 .
globÆ
 
	gffi_˛osuª_unix


277 .
¥oc
 
	gffi_˛osuª_unix


279 
	#FRAME_SIZE
 (8*16 + 8*8 + 8*16)

	)

281 
	gffi_˛osuª_unix
:

282 .
¥ﬁogue


283 .
ßve
 
¨
.
pfs
, 
r40


284 
Æloc
 
	gloc0
 = 
¨
.
pfs
, 8, 4, 4, 0

285 .
f‰ame
 
FRAME_SIZE


286 
add
 
	gr12
 = -
FRAME_SIZE
,Ñ12

287 .
ßve
 
	gΩ
, 
loc1


288 
mov
 
	gloc1
 = 
b0


289 .
ßve
 
¨
.
u«t
, 
loc2


290 
mov
 
	gloc2
 = 
¨
.
u«t


291 .
body


294 #ifde‡
_ILP32


295 
addp4
 
out0
 = 0, 
gp


296 
addp4
 
	ggp
 = 16, gp

298 
mov
 
	gout0
 = 
gp


299 
add
 
gp
 = 16, 
	ggp


302 
ld8
 
	ggp
 = [
gp
]

305 
add
 
r16
 = 16 + 8*16, 
•


306 
add
 
	gr17
 = 16 + 8*16 + 16, 
	g•


308 
	g°f
.
	g•ûl
 [
r16
] = 
f8
, 32

309 
	g°f
.
	g•ûl
 [
r17
] = 
f9
, 32

310 
mov
 
	gloc3
 = 
gp


312 
	g°f
.
	g•ûl
 [
r16
] = 
f10
, 32

313 
	g°f
.
	g•ûl
 [
r17
] = 
f11
, 32

315 
	g°f
.
	g•ûl
 [
r16
] = 
f12
, 32

316 
	g°f
.
	g•ûl
 [
r17
] = 
f13
, 32

318 
	g°f
.
	g•ûl
 [
r16
] = 
f14
, 32

319 
	g°f
.
	g•ûl
 [
r17
] = 
f15
, 24

321 .
	gmem
.
	goff£t
 0, 0

322 
	g°8
.
	g•ûl
 [
r16
] = 
ö0
, 16

323 .
	gmem
.
	goff£t
 8, 0

324 
	g°8
.
	g•ûl
 [
r17
] = 
ö1
, 16

325 
add
 
	gout1
 = 16 + 8*16, 
	g•


327 .
	gmem
.
	goff£t
 0, 0

328 
	g°8
.
	g•ûl
 [
r16
] = 
ö2
, 16

329 .
	gmem
.
	goff£t
 8, 0

330 
	g°8
.
	g•ûl
 [
r17
] = 
ö3
, 16

331 
add
 
	gout2
 = 16, 
	g•


333 .
	gmem
.
	goff£t
 0, 0

334 
	g°8
.
	g•ûl
 [
r16
] = 
ö4
, 16

335 .
	gmem
.
	goff£t
 8, 0

336 
	g°8
.
	g•ûl
 [
r17
] = 
ö5
, 16

337 
mov
 
	gout3
 = 
r8


339 .
	gmem
.
	goff£t
 0, 0

340 
	g°8
.
	g•ûl
 [
r16
] = 
ö6


341 .
mem
.
off£t
 8, 0

342 
	g°8
.
	g•ûl
 [
r17
] = 
ö7


345 
br
.
ˇŒ
.
•tk
.
m™y
 
b0
 = 
ffi_˛osuª_unix_ö√r


349 
mov
 
	ggp
 = 
loc3


350 
zxt1
 
r16
 = 
r8


352 
addl
 
	gr18
 = @
…offx
(.
Lld_èbÀ
), 
gp


353 
mov
 
	g¨
.
	gpfs
 = 
loc0


355 
	gld8
.
mov
 
	gr18
 = [
r18
], .
Lld_èbÀ


356 
mov
 
	gb0
 = 
loc1


358 
shœdd
 
	gr18
 = 
r16
, 3, 
r18


359 
mov
 
	g¨
.
	gu«t
 = 
loc2


361 
ld8
 
	gr17
 = [
r18
]

362 
shr
 
r8
 =Ñ8, 8

364 
add
 
	gr17
 = 
r17
, 
r18


365 
add
 
	gr16
 = 16, 
	g•


367 
mov
 
	gb6
 = 
r17


368 
br
 
b6


370 .
	gœbñ_°©e
 1

372 .
	gLld_void
:

373 .
ª°‹e
 
•


374 
add
 
•
 = 
FRAME_SIZE
, sp

375 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


377 .
	gLld_öt
:

378 .
body


379 .
c›y_°©e
 1

380 
ld8
 
r8
 = [
r16
]

381 .
ª°‹e
 
•


382 
add
 
•
 = 
FRAME_SIZE
, sp

383 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


385 .
	gLld_Êﬂt
:

386 .
body


387 .
c›y_°©e
 1

388 
ldfs
 
f8
 = [
r16
]

389 .
ª°‹e
 
•


390 
add
 
•
 = 
FRAME_SIZE
, sp

391 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


393 .
	gLld_doubÀ
:

394 .
body


395 .
c›y_°©e
 1

396 
ldfd
 
f8
 = [
r16
]

397 .
ª°‹e
 
•


398 
add
 
•
 = 
FRAME_SIZE
, sp

399 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


401 .
	gLld_ldoubÀ
:

402 .
body


403 .
c›y_°©e
 1

404 
ld„
 
f8
 = [
r16
]

405 .
ª°‹e
 
•


406 
add
 
•
 = 
FRAME_SIZE
, sp

407 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


410 .
	gLld_smÆl_°ru˘
:

411 .
body


412 .
c›y_°©e
 1

413 
add
 
r17
 = 8, 
r16


414 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 8, 
r8


415 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 16, 
r8


416 
	gcmp
.
…
 
	gp8
, 
	gp0
 = 24, 
	gr8


418 
ld8
 
	gr8
 = [
r16
], 16

419 (
	gp6
Ë
ld8
 
	gr9
 = [
r17
], 16

421 (
	gp7
Ë
ld8
 
	gr10
 = [
r16
]

422 (
p8
Ë
ld8
 
r11
 = [
r17
]

423 .
ª°‹e
 
•


424 
add
 
•
 = 
FRAME_SIZE
, sp

425 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


428 .
	gLld_hÁ_Êﬂt
:

429 .
body


430 .
c›y_°©e
 1

431 
add
 
r17
 = 4, 
r16


432 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 4, 
	gr8


434 
ldfs
 
	gf8
 = [
r16
], 8

435 (
	gp6
Ë
ldfs
 
	gf9
 = [
r17
], 8

436 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 8, 
r8


437 
	gcmp
.
…
 
	gp8
, 
	gp0
 = 12, 
	gr8


439 (
	gp7
Ë
ldfs
 
	gf10
 = [
r16
], 8

440 (
	gp8
Ë
ldfs
 
	gf11
 = [
r17
], 8

441 
	gcmp
.
…
 
	gp9
, 
	gp0
 = 16, 
r8


442 
	gcmp
.
…
 
	gp10
, 
	gp0
 = 20, 
	gr8


444 (
	gp9
Ë
ldfs
 
	gf12
 = [
r16
], 8

445 (
	gp10
Ë
ldfs
 
	gf13
 = [
r17
], 8

446 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 24, 
r8


447 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 28, 
	gr8


449 (
	gp6
Ë
ldfs
 
	gf14
 = [
r16
]

450 (
p7
Ë
ldfs
 
f15
 = [
r17
]

451 .
ª°‹e
 
•


452 
add
 
•
 = 
FRAME_SIZE
, sp

453 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


456 .
	gLld_hÁ_doubÀ
:

457 .
body


458 .
c›y_°©e
 1

459 
add
 
r17
 = 8, 
r16


460 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 8, 
	gr8


462 
ldfd
 
	gf8
 = [
r16
], 16

463 (
	gp6
Ë
ldfd
 
	gf9
 = [
r17
], 16

464 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 16, 
r8


465 
	gcmp
.
…
 
	gp8
, 
	gp0
 = 24, 
	gr8


467 (
	gp7
Ë
ldfd
 
	gf10
 = [
r16
], 16

468 (
	gp8
Ë
ldfd
 
	gf11
 = [
r17
], 16

469 
	gcmp
.
…
 
	gp9
, 
	gp0
 = 32, 
r8


470 
	gcmp
.
…
 
	gp10
, 
	gp0
 = 40, 
	gr8


472 (
	gp9
Ë
ldfd
 
	gf12
 = [
r16
], 16

473 (
	gp10
Ë
ldfd
 
	gf13
 = [
r17
], 16

474 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 48, 
r8


475 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 56, 
	gr8


477 (
	gp6
Ë
ldfd
 
	gf14
 = [
r16
]

478 (
p7
Ë
ldfd
 
f15
 = [
r17
]

479 .
ª°‹e
 
•


480 
add
 
•
 = 
FRAME_SIZE
, sp

481 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


484 .
	gLld_hÁ_ldoubÀ
:

485 .
body


486 .
c›y_°©e
 1

487 
add
 
r17
 = 16, 
r16


488 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 16, 
	gr8


490 
ld„
 
	gf8
 = [
r16
], 32

491 (
	gp6
Ë
ld„
 
	gf9
 = [
r17
], 32

492 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 32, 
r8


493 
	gcmp
.
…
 
	gp8
, 
	gp0
 = 48, 
	gr8


495 (
	gp7
Ë
ld„
 
	gf10
 = [
r16
], 32

496 (
	gp8
Ë
ld„
 
	gf11
 = [
r17
], 32

497 
	gcmp
.
…
 
	gp9
, 
	gp0
 = 64, 
r8


498 
	gcmp
.
…
 
	gp10
, 
	gp0
 = 80, 
	gr8


500 (
	gp9
Ë
ld„
 
	gf12
 = [
r16
], 32

501 (
	gp10
Ë
ld„
 
	gf13
 = [
r17
], 32

502 
	gcmp
.
…
 
	gp6
, 
	gp0
 = 96, 
r8


503 
	gcmp
.
…
 
	gp7
, 
	gp0
 = 112, 
	gr8


505 (
	gp6
Ë
ld„
 
	gf14
 = [
r16
]

506 (
p7
Ë
ld„
 
f15
 = [
r17
]

507 .
ª°‹e
 
•


508 
add
 
•
 = 
FRAME_SIZE
, sp

509 
	gbr
.
	gªt
.
	g•tk
.
m™y
 
	gb0


512 .
ídp
 
	gffi_˛osuª_unix


514 .
	g£˘i⁄
 .
	grod©a


515 .
	gÆign
 8

516 .
	gL°_èbÀ
:

517 
d©a8
 @
	$p¸ñ
(.
L°_void
)

518 
d©a8
 @
	$p¸ñ
(.
L°_söt32
)

519 
d©a8
 @
	$p¸ñ
(.
L°_Êﬂt
)

520 
d©a8
 @
	$p¸ñ
(.
L°_doubÀ
)

521 
d©a8
 @
	$p¸ñ
(.
L°_ldoubÀ
)

522 
d©a8
 @
	$p¸ñ
(.
L°_uöt8
)

523 
d©a8
 @
	$p¸ñ
(.
L°_söt8
)

524 
d©a8
 @
	$p¸ñ
(.
L°_uöt16
)

525 
d©a8
 @
	$p¸ñ
(.
L°_söt16
)

526 
d©a8
 @
	$p¸ñ
(.
L°_uöt32
)

527 
d©a8
 @
	$p¸ñ
(.
L°_söt32
)

528 
d©a8
 @
	$p¸ñ
(.
L°_öt64
)

529 
d©a8
 @
	$p¸ñ
(.
L°_öt64
)

530 
d©a8
 @
	$p¸ñ
(.
L°_void
)

531 
d©a8
 @
	$p¸ñ
(.
L°_öt64
)

532 
d©a8
 @
	$p¸ñ
(.
L°_smÆl_°ru˘
)

533 
d©a8
 @
	$p¸ñ
(.
L°_hÁ_Êﬂt
)

534 
d©a8
 @
	$p¸ñ
(.
L°_hÁ_doubÀ
)

535 
d©a8
 @
	`p¸ñ
(.
L°_hÁ_ldoubÀ
)

537 .
Lld_èbÀ
:

538 
d©a8
 @
	$p¸ñ
(.
Lld_void
)

539 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

540 
d©a8
 @
	$p¸ñ
(.
Lld_Êﬂt
)

541 
d©a8
 @
	$p¸ñ
(.
Lld_doubÀ
)

542 
d©a8
 @
	$p¸ñ
(.
Lld_ldoubÀ
)

543 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

544 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

545 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

546 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

547 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

548 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

549 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

550 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

551 
d©a8
 @
	$p¸ñ
(.
Lld_void
)

552 
d©a8
 @
	$p¸ñ
(.
Lld_öt
)

553 
d©a8
 @
	$p¸ñ
(.
Lld_smÆl_°ru˘
)

554 
d©a8
 @
	$p¸ñ
(.
Lld_hÁ_Êﬂt
)

555 
d©a8
 @
	$p¸ñ
(.
Lld_hÁ_doubÀ
)

556 
d©a8
 @
	$p¸ñ
(.
Lld_hÁ_ldoubÀ
)

558 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


559 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/java_raw_api.c

38 
	~<ffi.h
>

39 
	~<ffi_comm⁄.h
>

40 
	~<°dlib.h
>

42 #i‡!
deföed
(
NO_JAVA_RAW_API
)

44 
size_t


45 
	$ffi_java_øw_size
 (
ffi_cif
 *
cif
)

47 
size_t
 
ªsu…
 = 0;

48 
i
;

50 
ffi_ty≥
 **
©
 = 
cif
->
¨g_ty≥s
;

52 
i
 = 
cif
->
«rgs
-1; i >0; i--, 
©
++)

54 (*
©
Ë-> 
ty≥
) {

55 
FFI_TYPE_UINT64
:

56 
FFI_TYPE_SINT64
:

57 
FFI_TYPE_DOUBLE
:

58 
ªsu…
 +2 * 
FFI_SIZEOF_JAVA_RAW
;

60 
FFI_TYPE_STRUCT
:

62 
	`ab‹t
();

63 
FFI_TYPE_COMPLEX
:

65 
	`ab‹t
();

67 
ªsu…
 +
FFI_SIZEOF_JAVA_RAW
;

71  
ªsu…
;

72 
	}
}

76 
	$ffi_java_øw_to_±øºay
 (
ffi_cif
 *
cif
, 
ffi_java_øw
 *
øw
, **
¨gs
)

78 
i
;

79 
ffi_ty≥
 **
ç
 = 
cif
->
¨g_ty≥s
;

81 #i‡
WORDS_BIGENDIAN


83 
i
 = 0; i < 
cif
->
«rgs
; i++, 
ç
++, 
¨gs
++)

85 (*
ç
)->
ty≥
)

87 
FFI_TYPE_UINT8
:

88 
FFI_TYPE_SINT8
:

89 *
¨gs
 = (*Ë((*)(
øw
++) + 3);

92 
FFI_TYPE_UINT16
:

93 
FFI_TYPE_SINT16
:

94 *
¨gs
 = (*Ë((*)(
øw
++) + 2);

97 #i‡
FFI_SIZEOF_JAVA_RAW
 == 8

98 
FFI_TYPE_UINT64
:

99 
FFI_TYPE_SINT64
:

100 
FFI_TYPE_DOUBLE
:

101 *
¨gs
 = (*)
øw
;

102 
øw
 += 2;

106 
FFI_TYPE_POINTER
:

107 *
¨gs
 = (*Ë&(
øw
++)->
±r
;

110 
FFI_TYPE_COMPLEX
:

112 
	`ab‹t
();

115 *
¨gs
 = 
øw
;

116 
øw
 +=

117 
	`ALIGN
 ((*
ç
)->
size
, (
ffi_java_øw
)) / (ffi_java_raw);

123 #i‡!
PDP


126 
i
 = 0; i < 
cif
->
«rgs
; i++, 
ç
++, 
¨gs
++)

128 #i‡
FFI_SIZEOF_JAVA_RAW
 == 8

129 (*
ç
)->
ty≥
) {

130 
FFI_TYPE_UINT64
:

131 
FFI_TYPE_SINT64
:

132 
FFI_TYPE_DOUBLE
:

133 *
¨gs
 = (*Ë
øw
;

134 
øw
 += 2;

136 
FFI_TYPE_COMPLEX
:

138 
	`ab‹t
();

140 *
¨gs
 = (*Ë
øw
++;

143 *
¨gs
 = (*Ë
øw
;

144 
øw
 +=

145 
	`ALIGN
 ((*
ç
)->
size
, (
ffi_java_øw
)) / (ffi_java_raw);

154 
	}
}

157 
	$ffi_java_±øºay_to_øw
 (
ffi_cif
 *
cif
, **
¨gs
, 
ffi_java_øw
 *
øw
)

159 
i
;

160 
ffi_ty≥
 **
ç
 = 
cif
->
¨g_ty≥s
;

162 
i
 = 0; i < 
cif
->
«rgs
; i++, 
ç
++, 
¨gs
++)

164 (*
ç
)->
ty≥
)

166 
FFI_TYPE_UINT8
:

167 #i‡
WORDS_BIGENDIAN


168 *(
UINT32
*)(
øw
++Ë*(
UINT8
*Ë(*
¨gs
);

170 (
øw
++)->
uöt
 = *(
UINT8
*Ë(*
¨gs
);

174 
FFI_TYPE_SINT8
:

175 #i‡
WORDS_BIGENDIAN


176 *(
SINT32
*)(
øw
++Ë*(
SINT8
*Ë(*
¨gs
);

178 (
øw
++)->
söt
 = *(
SINT8
*Ë(*
¨gs
);

182 
FFI_TYPE_UINT16
:

183 #i‡
WORDS_BIGENDIAN


184 *(
UINT32
*)(
øw
++Ë*(
UINT16
*Ë(*
¨gs
);

186 (
øw
++)->
uöt
 = *(
UINT16
*Ë(*
¨gs
);

190 
FFI_TYPE_SINT16
:

191 #i‡
WORDS_BIGENDIAN


192 *(
SINT32
*)(
øw
++Ë*(
SINT16
*Ë(*
¨gs
);

194 (
øw
++)->
söt
 = *(
SINT16
*Ë(*
¨gs
);

198 
FFI_TYPE_UINT32
:

199 #i‡
WORDS_BIGENDIAN


200 *(
UINT32
*)(
øw
++Ë*(UINT32*Ë(*
¨gs
);

202 (
øw
++)->
uöt
 = *(
UINT32
*Ë(*
¨gs
);

206 
FFI_TYPE_SINT32
:

207 #i‡
WORDS_BIGENDIAN


208 *(
SINT32
*)(
øw
++Ë*(SINT32*Ë(*
¨gs
);

210 (
øw
++)->
söt
 = *(
SINT32
*Ë(*
¨gs
);

214 
FFI_TYPE_FLOAT
:

215 (
øw
++)->
Êt
 = *(
FLOAT32
*Ë(*
¨gs
);

218 #i‡
FFI_SIZEOF_JAVA_RAW
 == 8

219 
FFI_TYPE_UINT64
:

220 
FFI_TYPE_SINT64
:

221 
FFI_TYPE_DOUBLE
:

222 
øw
->
uöt
 = *(
UINT64
*Ë(*
¨gs
);

223 
øw
 += 2;

227 
FFI_TYPE_POINTER
:

228 (
øw
++)->
±r
 = **(***Ë
¨gs
;

232 #i‡
FFI_SIZEOF_JAVA_RAW
 == 8

233 
	`FFI_ASSERT
(0);

235 
	`mem˝y
 ((*Ë
øw
->
d©a
, (*)*
¨gs
, (*
ç
)->
size
);

236 
øw
 +=

237 
	`ALIGN
 ((*
ç
)->
size
, (
ffi_java_øw
)) / (ffi_java_raw);

241 
	}
}

243 #i‡!
FFI_NATIVE_RAW_API


246 
	$ffi_java_rvÆue_to_øw
 (
ffi_cif
 *
cif
, *
rvÆue
)

248 #i‡
WORDS_BIGENDIAN
 && 
FFI_SIZEOF_ARG
 == 8

249 
cif
->
πy≥
->
ty≥
)

251 
FFI_TYPE_UINT8
:

252 
FFI_TYPE_UINT16
:

253 
FFI_TYPE_UINT32
:

254 *(
UINT64
 *)
rvÆue
 <<= 32;

257 
FFI_TYPE_SINT8
:

258 
FFI_TYPE_SINT16
:

259 
FFI_TYPE_SINT32
:

260 
FFI_TYPE_INT
:

261 #i‡
FFI_SIZEOF_JAVA_RAW
 == 4

262 
FFI_TYPE_POINTER
:

264 *(
SINT64
 *)
rvÆue
 <<= 32;

267 
FFI_TYPE_COMPLEX
:

269 
	`ab‹t
();

275 
	}
}

278 
	$ffi_java_øw_to_rvÆue
 (
ffi_cif
 *
cif
, *
rvÆue
)

280 #i‡
WORDS_BIGENDIAN
 && 
FFI_SIZEOF_ARG
 == 8

281 
cif
->
πy≥
->
ty≥
)

283 
FFI_TYPE_UINT8
:

284 
FFI_TYPE_UINT16
:

285 
FFI_TYPE_UINT32
:

286 *(
UINT64
 *)
rvÆue
 >>= 32;

289 
FFI_TYPE_SINT8
:

290 
FFI_TYPE_SINT16
:

291 
FFI_TYPE_SINT32
:

292 
FFI_TYPE_INT
:

293 *(
SINT64
 *)
rvÆue
 >>= 32;

296 
FFI_TYPE_COMPLEX
:

298 
	`ab‹t
();

304 
	}
}

313 
ffi_java_øw_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
,

314 
ffi_java_øw
 *
øw
)

316 **
avÆue
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

317 
	`ffi_java_øw_to_±øºay
 (
cif
, 
øw
, 
avÆue
);

318 
	`ffi_ˇŒ
 (
cif
, 
‚
, 
rvÆue
, 
avÆue
);

319 
	`ffi_java_rvÆue_to_øw
 (
cif
, 
rvÆue
);

320 
	}
}

322 #i‡
FFI_CLOSURES


325 
	$ffi_java_å™¶©e_¨gs
 (
ffi_cif
 *
cif
, *
rvÆue
,

326 **
avÆue
, *
u£r_d©a
)

328 
ffi_java_øw
 *
øw
 = (ffi_java_øw*)
	`Æloˇ
 (
	`ffi_java_øw_size
 (
cif
));

329 
ffi_øw_˛osuª
 *
˛
 = (ffi_øw_˛osuª*)
u£r_d©a
;

331 
	`ffi_java_±øºay_to_øw
 (
cif
, 
avÆue
, 
øw
);

332 (*
˛
->
fun
Ë(
cif
, 
rvÆue
, (
ffi_øw
*)
øw
, cl->
u£r_d©a
);

333 
	`ffi_java_øw_to_rvÆue
 (
cif
, 
rvÆue
);

334 
	}
}

336 
ffi_°©us


337 
ffi_¥ï_java_øw_˛osuª_loc
 (
ffi_java_øw_˛osuª
* 
˛
,

338 
ffi_cif
 *
cif
,

339 (*
fun
)(
ffi_cif
*,*,
ffi_java_øw
*,*),

340 *
u£r_d©a
,

341 *
codñoc
)

343 
ffi_°©us
 
°©us
;

345 
°©us
 = 
	`ffi_¥ï_˛osuª_loc
 ((
ffi_˛osuª
*Ë
˛
,

346 
cif
,

347 &
ffi_java_å™¶©e_¨gs
,

348 
codñoc
,

349 
codñoc
);

350 i‡(
°©us
 =
FFI_OK
)

352 
˛
->
fun
 = fun;

353 
˛
->
u£r_d©a
 = user_data;

356  
°©us
;

357 
	}
}

363 
ffi_°©us


364 
ffi_¥ï_java_øw_˛osuª
 (
ffi_java_øw_˛osuª
* 
˛
,

365 
ffi_cif
 *
cif
,

366 (*
fun
)(
ffi_cif
*,*,
ffi_java_øw
*,*),

367 *
u£r_d©a
)

369  
	`ffi_¥ï_java_øw_˛osuª_loc
 (
˛
, 
cif
, 
fun
, 
u£r_d©a
, cl);

370 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m32r/ffi.c

27 
	~<ffi.h
>

28 
	~<ffi_comm⁄.h
>

30 
	~<°dlib.h
>

35 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

37 
i
;

38 
tmp
;

39 
avn
;

40 **
p_¨gv
;

41 *
¨gp
;

42 
ffi_ty≥
 **
p_¨g
;

44 
tmp
 = 0;

45 
¨gp
 = 
°ack
;

47 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 &&Écif->cif->πy≥->
size
 > 8)

49 *(**Ë
¨gp
 = 
ecif
->
rvÆue
;

50 
¨gp
 += 4;

53 
avn
 = 
ecif
->
cif
->
«rgs
;

54 
p_¨gv
 = 
ecif
->
avÆue
;

56 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

57 (
i
 !0Ë&& (
avn
 != 0);

58 
i
--, 
p_¨g
++)

60 
size_t
 
z
;

63 i‡(((*
p_¨g
)->
Æignmít
 - 1Ë& (Ë
¨gp
)

64 
¨gp
 = (*Ë
	`ALIGN
 (¨gp, (*
p_¨g
)->
Æignmít
);

66 i‡(
avn
 != 0)

68 
avn
--;

69 
z
 = (*
p_¨g
)->
size
;

70 i‡(
z
 <  ())

72 
z
 =  ();

74 (*
p_¨g
)->
ty≥
)

76 
FFI_TYPE_SINT8
:

77 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT8
 *)(* 
p_¨gv
);

80 
FFI_TYPE_UINT8
:

81 *(*Ë
¨gp
 = ()*(
UINT8
 *)(* 
p_¨gv
);

84 
FFI_TYPE_SINT16
:

85 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT16
 *)(* 
p_¨gv
);

88 
FFI_TYPE_UINT16
:

89 *(*Ë
¨gp
 = ()*(
UINT16
 *)(* 
p_¨gv
);

92 
FFI_TYPE_STRUCT
:

93 
z
 = (*
p_¨g
)->
size
;

94 i‡((*
p_¨g
)->
Æignmít
 != 1)

95 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

97 
	`mem˝y
 (
¨gp
 + 4 - 
z
, *
p_¨gv
, z);

98 
z
 =  ();

102 
	`FFI_ASSERT
(0);

105 i‡(
z
 ==  ())

107 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

111 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT
)

113 i‡(
z
 > 8)

115 *(*Ë
¨gp
 = ()(*)(* 
p_¨gv
);

116 
z
 = (*);

120 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

121 
z
 = 8;

127 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

130 
p_¨gv
++;

131 
¨gp
 +
z
;

136 
	}
}

139 
ffi_°©us


140 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

143 
cif
->
πy≥
->
ty≥
)

145 
FFI_TYPE_VOID
:

146 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

149 
FFI_TYPE_STRUCT
:

150 i‡(
cif
->
πy≥
->
size
 <= 4)

151 
cif
->
Êags
 = 
FFI_TYPE_INT
;

153 i‡(
cif
->
πy≥
->
size
 <= 8)

154 
cif
->
Êags
 = 
FFI_TYPE_DOUBLE
;

157 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

160 
FFI_TYPE_SINT64
:

161 
FFI_TYPE_UINT64
:

162 
FFI_TYPE_DOUBLE
:

163 
cif
->
Êags
 = 
FFI_TYPE_DOUBLE
;

166 
FFI_TYPE_FLOAT
:

168 
cif
->
Êags
 = 
FFI_TYPE_INT
;

172  
FFI_OK
;

173 
	}
}

175 
ffi_ˇŒ_SYSV
((*)(*, 
exãnded_cif
 *),Éxtended_cif *,

176 , , *, (*
‚
)());

178 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

180 
exãnded_cif
 
ecif
;

182 
ecif
.
cif
 = cif;

183 
ecif
.
avÆue
 =ávalue;

187 i‡((
rvÆue
 =
NULL
) &&

188 (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

190 
ecif
.
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

193 
ecif
.
rvÆue
 =Ñvalue;

195 
cif
->
abi
)

197 
FFI_SYSV
:

198 
	`ffi_ˇŒ_SYSV
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
,

199 
cif
->
Êags
, 
ecif
.
rvÆue
, 
‚
);

200 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

202 
size
 = 
cif
->
πy≥
->size;

203 
Æign
 = 
cif
->
πy≥
->
Æignmít
;

205 i‡(
size
 < 4)

207 i‡(
Æign
 == 1)

208 *(*)(
ecif
.
rvÆue
Ë<<(4 - 
size
) * 8;

210 i‡(4 < 
size
 && size < 8)

212 i‡(
Æign
 == 1)

214 
	`mem˝y
 (
ecif
.
rvÆue
,Écif.rvÆuê+ 8-
size
, size);

216 i‡(
Æign
 == 2)

218 i‡(
size
 & 1)

219 
size
 += 1;

221 i‡(
size
 != 8)

222 
	`mem˝y
 (
ecif
.
rvÆue
,Écif.rvÆuê+ 8-
size
, size);

229 
	`FFI_ASSERT
(0);

232 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m32r/ffitarget.h

27 #i‚de‡
LIBFFI_TARGET_H


28 
	#LIBFFI_TARGET_H


	)

30 #i‚de‡
LIBFFI_H


36 #i‚de‡
LIBFFI_ASM


37 
	tffi_¨g
;

38 sig√d 
	tffi_ßrg
;

40 
	effi_abi


42 
	mFFI_FIRST_ABI
 = 0,

43 
	mFFI_SYSV
,

44 
	mFFI_LAST_ABI
,

45 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


46 } 
	tffi_abi
;

49 
	#FFI_CLOSURES
 0

	)

50 
	#FFI_TRAMPOLINE_SIZE
 24

	)

51 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m32r/sysv.S

26 
	#LIBFFI_ASM


	)

27 
	~<ffic⁄fig.h
>

28 
	~<ffi.h
>

29 #ifde‡
HAVE_MACHINE_ASM_H


30 
	~<machöe/asm.h
>

33 
	#CNAME
(
x
Ë
	)
x

34 
	#ENTRY
(
x
Ë.
globl
 
	`CNAME
(x)! .
ty≥
 CNAME(x),%
fun˘i⁄
! CNAME(x):

	)

37 .
ãxt


47 
	$ENTRY
(
ffi_ˇŒ_SYSV
)

49 
push
 
Â


50 
push
 
Ã


51 
push
 
r3


52 
push
 
r2


53 
push
 
r1


54 
push
 
r0


55 
mv
 
Â
, 
•


58 
sub
 
•
, 
r2


61 
mv
 
Ã
, 
r0


62 
mv
 
r0
, 
•


66 
jl
 
Ã


69 
ld
 
r0
, @(0,
•
)

70 
ld
 
r1
, @(4,
•
)

71 
ld
 
r2
, @(8,
•
)

72 
ld
 
r3
, @(12,
•
)

75 
ld
 
Ã
, @(8,
Â
)

76 
cmpi
 
Ã
, #16

77 
bc
 
adju°_°ack


78 
ldi
 
Ã
, #16

79 
adju°_°ack
:

80 
add
 
•
, 
Ã


83 
ld
 
Ã
, @(28,
Â
)

84 
jl
 
Ã


87 
mv
 
•
, 
Â


90 
ld
 
r2
, @(24,
•
)

93 
ld
 
r3
, @(12,
•
)

96 
beqz
 
r2
, 
ïûogue


99 
ldi
 
r4
, #FFI_TYPE_INT

100 
b√
 
r3
, 
r4
, 
ªtu∫_doubÀ


101 
°
 
r0
, @
r2


102 
bø
 
ïûogue


104 
ªtu∫_doubÀ
:

106 
ldi
 
r4
, #FFI_TYPE_DOUBLE

107 
b√
 
r3
, 
r4
, 
ïûogue


108 
°
 
r0
, @
r2


109 
°
 
r1
, @(4,
r2
)

111 
ïûogue
:

112 
p›
 
r0


113 
p›
 
r1


114 
p›
 
r2


115 
p›
 
r3


116 
p›
 
Ã


117 
p›
 
Â


118 
jmp
 
Ã


120 .
ffi_ˇŒ_SYSV_íd
:

121 .
size
 
	`CNAME
(
ffi_ˇŒ_SYSV
),.
ffi_ˇŒ_SYSV_íd
-CNAME(ffi_call_SYSV)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m68k/ffi.c

7 
	~<ffi.h
>

8 
	~<ffi_comm⁄.h
>

10 
	~<°dlib.h
>

11 
	~<uni°d.h
>

12 #ifde‡
__πems__


13 
πems_ˇche_Êush_mu…ùÀ_d©a_löes
–c⁄° *, 
size_t
 );

15 
	~<sys/sysˇŒ.h
>

16 #ifde‡
__MINT__


17 
	~<möt/mötböd.h
>

18 
	~<möt/ssy°em.h
>

20 
	~<asm/ˇche˘l.h
>

24 
ffi_ˇŒ_SYSV
 (
exãnded_cif
 *,

26 *, (*
‚
) ());

27 *
ffi_¥ï_¨gs
 (*
°ack
, 
exãnded_cif
 *
ecif
);

28 
ffi_˛osuª_SYSV
 (
ffi_˛osuª
 *);

29 
ffi_˛osuª_°ru˘_SYSV
 (
ffi_˛osuª
 *);

30 
ffi_˛osuª_SYSV_ö√r
 (
ffi_˛osuª
 *
˛osuª
,

31 *
ª•
, *
¨gs
);

37 
	$ffi_¥ï_¨gs
 (*
°ack
, 
exãnded_cif
 *
ecif
)

39 
i
;

40 **
p_¨gv
;

41 *
¨gp
;

42 
ffi_ty≥
 **
p_¨g
;

43 *
°ru˘_vÆue_±r
;

45 
¨gp
 = 
°ack
;

48 #ifde‡
__MINT__


49 (
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_LONGDOUBLE
) ||

51 (((
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

52 && !
ecif
->
cif
->
Êags
)))

53 
°ru˘_vÆue_±r
 = 
ecif
->
rvÆue
;

55 
°ru˘_vÆue_±r
 = 
NULL
;

57 
p_¨gv
 = 
ecif
->
avÆue
;

59 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

60 
i
 != 0;

61 
i
--, 
p_¨g
++)

63 
size_t
 
z
 = (*
p_¨g
)->
size
;

64 
ty≥
 = (*
p_¨g
)->type;

66 i‡(
z
 <  ())

68 
ty≥
)

70 
FFI_TYPE_SINT8
:

71 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT8
 *Ë*
p_¨gv
;

74 
FFI_TYPE_UINT8
:

75 *(*Ë
¨gp
 = (Ë*(
UINT8
 *Ë*
p_¨gv
;

78 
FFI_TYPE_SINT16
:

79 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT16
 *Ë*
p_¨gv
;

82 
FFI_TYPE_UINT16
:

83 *(*Ë
¨gp
 = (Ë*(
UINT16
 *Ë*
p_¨gv
;

86 
FFI_TYPE_STRUCT
:

87 #ifde‡
__MINT__


88 i‡(
z
 == 1 || z == 2)

89 
	`mem˝y
 (
¨gp
 + 2, *
p_¨gv
, 
z
);

91 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

93 
	`mem˝y
 (
¨gp
 +  (Ë- 
z
, *
p_¨gv
, z);

98 
	`FFI_ASSERT
 (0);

100 
z
 =  ();

104 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

107 i‡(((Ë- 1Ë& 
z
)

108 
z
 = 
	`ALIGN
(z, ());

111 
p_¨gv
++;

112 
¨gp
 +
z
;

115  
°ru˘_vÆue_±r
;

116 
	}
}

118 
	#CIF_FLAGS_INT
 1

	)

119 
	#CIF_FLAGS_DINT
 2

	)

120 
	#CIF_FLAGS_FLOAT
 4

	)

121 
	#CIF_FLAGS_DOUBLE
 8

	)

122 
	#CIF_FLAGS_LDOUBLE
 16

	)

123 
	#CIF_FLAGS_POINTER
 32

	)

124 
	#CIF_FLAGS_STRUCT1
 64

	)

125 
	#CIF_FLAGS_STRUCT2
 128

	)

126 
	#CIF_FLAGS_SINT8
 256

	)

127 
	#CIF_FLAGS_SINT16
 512

	)

130 
ffi_°©us


131 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

134 
cif
->
πy≥
->
ty≥
)

136 
FFI_TYPE_VOID
:

137 
cif
->
Êags
 = 0;

140 
FFI_TYPE_STRUCT
:

141 i‡(
cif
->
πy≥
->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_STRUCT
 &&

142 
cif
->
πy≥
->
ñemíts
[1])

144 
cif
->
Êags
 = 0;

148 
cif
->
πy≥
->
size
)

151 #ifde‡
__MINT__


152 
cif
->
Êags
 = 
CIF_FLAGS_STRUCT2
;

154 
cif
->
Êags
 = 
CIF_FLAGS_STRUCT1
;

158 
cif
->
Êags
 = 
CIF_FLAGS_STRUCT2
;

160 #ifde‡
__MINT__


164 
cif
->
Êags
 = 
CIF_FLAGS_INT
;

166 #ifde‡
__MINT__


170 
cif
->
Êags
 = 
CIF_FLAGS_DINT
;

173 
cif
->
Êags
 = 0;

178 
FFI_TYPE_FLOAT
:

179 
cif
->
Êags
 = 
CIF_FLAGS_FLOAT
;

182 
FFI_TYPE_DOUBLE
:

183 
cif
->
Êags
 = 
CIF_FLAGS_DOUBLE
;

186 #i‡(
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE
)

187 
FFI_TYPE_LONGDOUBLE
:

188 #ifde‡
__MINT__


189 
cif
->
Êags
 = 0;

191 
cif
->
Êags
 = 
CIF_FLAGS_LDOUBLE
;

196 
FFI_TYPE_POINTER
:

197 
cif
->
Êags
 = 
CIF_FLAGS_POINTER
;

200 
FFI_TYPE_SINT64
:

201 
FFI_TYPE_UINT64
:

202 
cif
->
Êags
 = 
CIF_FLAGS_DINT
;

205 
FFI_TYPE_SINT16
:

206 
cif
->
Êags
 = 
CIF_FLAGS_SINT16
;

209 
FFI_TYPE_SINT8
:

210 
cif
->
Êags
 = 
CIF_FLAGS_SINT8
;

214 
cif
->
Êags
 = 
CIF_FLAGS_INT
;

218  
FFI_OK
;

219 
	}
}

222 
ffi_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
Ë(), *
rvÆue
, **
avÆue
)

224 
exãnded_cif
 
	gecif
;

226 
	gecif
.
	gcif
 = 
cif
;

227 
	gecif
.
	gavÆue
 = 
avÆue
;

232 i‡(
	grvÆue
 =
NULL


233 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


234 && 
cif
->
πy≥
->
size
 > 8)

235 
ecif
.
rvÆue
 = 
Æloˇ
 (
cif
->
πy≥
->
size
);

237 
	gecif
.
	grvÆue
 = 
rvÆue
;

239 
	gcif
->
	gabi
)

241 
	gFFI_SYSV
:

242 
ffi_ˇŒ_SYSV
 (&
ecif
, 
cif
->
byãs
, cif->
Êags
,

243 
ecif
.
rvÆue
, 
‚
);

247 
FFI_ASSERT
 (0);

253 
	$ffi_¥ï_öcomög_¨gs_SYSV
 (*
°ack
, **
avÆue
, 
ffi_cif
 *
cif
)

255 
i
;

256 **
p_¨gv
;

257 *
¨gp
;

258 
ffi_ty≥
 **
p_¨g
;

260 
¨gp
 = 
°ack
;

261 
p_¨gv
 = 
avÆue
;

263 
i
 = 
cif
->
«rgs
, 
p_¨g
 = cif->
¨g_ty≥s
; (i != 0); i--,Ö_arg++)

265 
size_t
 
z
;

267 
z
 = (*
p_¨g
)->
size
;

268 #ifde‡
__MINT__


269 i‡(
cif
->
Êags
 &&

270 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 &&

271 (
z
 == 1 || z == 2))

273 *
p_¨gv
 = (*Ë(
¨gp
 + 2);

275 
z
 = 4;

278 i‡(
cif
->
Êags
 &&

279 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 &&

280 (
z
 == 3 || z == 4))

282 *
p_¨gv
 = (*Ë(
¨gp
);

284 
z
 = 4;

288 i‡(
z
 <= 4)

290 *
p_¨gv
 = (*Ë(
¨gp
 + 4 - 
z
);

292 
z
 = 4;

296 *
p_¨gv
 = (*Ë
¨gp
;

299 i‡(((Ë- 1Ë& 
z
)

300 
z
 = 
	`ALIGN
(z, ());

303 
p_¨gv
++;

304 
¨gp
 +
z
;

306 
	}
}

309 
	$ffi_˛osuª_SYSV_ö√r
 (
ffi_˛osuª
 *
˛osuª
, *
ª•
, *
¨gs
)

311 
ffi_cif
 *
cif
;

312 **
¨g_¨ó
;

314 
cif
 = 
˛osuª
->cif;

315 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

317 
	`ffi_¥ï_öcomög_¨gs_SYSV
(
¨gs
, 
¨g_¨ó
, 
cif
);

319 (
˛osuª
->
fun
Ë(
cif
, 
ª•
, 
¨g_¨ó
, closuª->
u£r_d©a
);

321  
cif
->
Êags
;

322 
	}
}

324 
ffi_°©us


325 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

326 
ffi_cif
* 
cif
,

327 (*
fun
)(
ffi_cif
*,*,**,*),

328 *
u£r_d©a
,

329 *
codñoc
)

331 i‡(
cif
->
abi
 !
FFI_SYSV
)

332  
FFI_BAD_ABI
;

334 *(*)
˛osuª
->
åamp
 = 0x207c;

335 *(**)(
˛osuª
->
åamp
 + 2Ë
codñoc
;

336 *(*)(
˛osuª
->
åamp
 + 6) = 0x4ef9;

339 #ifde‡
__MINT__


340 (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_LONGDOUBLE
) ||

342 (((
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

343 && !
cif
->
Êags
)))

344 *(**)(
˛osuª
->
åamp
 + 8Ë
ffi_˛osuª_°ru˘_SYSV
;

346 *(**)(
˛osuª
->
åamp
 + 8Ë
ffi_˛osuª_SYSV
;

348 #ifde‡
__πems__


349 
	`πems_ˇche_Êush_mu…ùÀ_d©a_löes
–
codñoc
, 
FFI_TRAMPOLINE_SIZE
 );

350 #ñi‡
	`deföed
(
__MINT__
)

351 
	`Ssy°em
(
S_FLUSHCACHE
, 
codñoc
, 
FFI_TRAMPOLINE_SIZE
);

353 
	`sysˇŒ
(
SYS_ˇcheÊush
, 
codñoc
, 
FLUSH_SCOPE_LINE
,

354 
FLUSH_CACHE_BOTH
, 
FFI_TRAMPOLINE_SIZE
);

357 
˛osuª
->
cif
 = cif;

358 
˛osuª
->
u£r_d©a
 = user_data;

359 
˛osuª
->
fun
 = fun;

361  
FFI_OK
;

362 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m68k/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


35 #i‚de‡
LIBFFI_ASM


36 
	tffi_¨g
;

37 sig√d 
	tffi_ßrg
;

39 
	effi_abi
 {

40 
	mFFI_FIRST_ABI
 = 0,

41 
	mFFI_SYSV
,

42 
	mFFI_LAST_ABI
,

43 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


44 } 
	tffi_abi
;

49 
	#FFI_CLOSURES
 1

	)

50 
	#FFI_TRAMPOLINE_SIZE
 16

	)

51 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m68k/sysv.S

31 
	#LIBFFI_ASM


	)

32 
	~<ffic⁄fig.h
>

33 
	~<ffi.h
>

35 #ifde‡
HAVE_AS_CFI_PSEUDO_OP


36 
	#CFI_STARTPROC
(Ë.
cfi_°¨çroc


	)

37 
	#CFI_OFFSET
(
ªg
,
off
Ë.
cfi_off£t
Ñeg,
	)
off

38 
	#CFI_DEF_CFA
(
ªg
,
off
Ë.
cfi_def_cÁ
Ñeg,
	)
off

39 
	#CFI_ENDPROC
(Ë.
cfi_íd¥oc


	)

41 
	#CFI_STARTPROC
()

	)

42 
	#CFI_OFFSET
(
ªg
,
off
)

	)

43 
	#CFI_DEF_CFA
(
ªg
,
off
)

	)

44 
	#CFI_ENDPROC
()

	)

47 #ifde‡
__MINT__


48 
	#CALLFUNC
(
fun˙ame
Ë
_
 ## 
	)
funcname

50 
	#CALLFUNC
(
fun˙ame
Ë
	)
funcname

53 .
	gãxt


55 .
globl
 
CALLFUNC
(
ffi_ˇŒ_SYSV
)

56 .
ty≥
 
CALLFUNC
(
ffi_ˇŒ_SYSV
),@
	gfun˘i⁄


57 .
	gÆign
 4

59 
	$CALLFUNC
(
ffi_ˇŒ_SYSV
):

60 
	$CFI_STARTPROC
()

61 
lök
 %
Â
,#0

62 
	`CFI_OFFSET
(14,-8)

63 
	$CFI_DEF_CFA
(14,8)

64 
move
.
l
 %
d2
,-(%
•
)

65 
	`CFI_OFFSET
(2,-12)

67 | 
Make
 
room
 
Æl
 
of
 
the
 
√w
 
¨gs
.

68 
sub
.
l
 12(%
Â
),%
•


70 | 
CÆl
 
ffi_¥ï_¨gs


71 
move
.
l
 8(%
Â
),-(%
•
)

72 
≥a
 4(%
•
)

73 #i‡!
deföed
 
__PIC__


74 
j§
 
	$CALLFUNC
(
ffi_¥ï_¨gs
)

76 
b§
.
l
 
	`CALLFUNC
(
ffi_¥ï_¨gs
@
PLTPC
)

78 
addq
.
l
 #8,%
•


80 | 
Pass
 
poöãr
 
to
 
vÆue
, 
™y


81 #ifde‡
__MINT__


82 
move
.
l
 %
d0
,%
a1


84 
move
.
l
 %
a0
,%
a1


87 | 
CÆl
 
the
 
fun˘i⁄


88 
move
.
l
 24(%
Â
),%
a0


89 
	`j§
 (%
a0
)

91 | 
Remove
 
the
 
•a˚
 
we
 
pushed
 thê
¨gs


92 
add
.
l
 12(%
Â
),%
•


94 | 
Lﬂd
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


95 
move
.
l
 20(%
Â
),%
a1


97 | 
Lﬂd
 
the
  
ty≥
 
code


98 
move
.
l
 16(%
Â
),%
d2


100 | 
If
 
the
  
vÆue
 
poöãr
 
is
 
NULL
, 
assume
 
no
  value.

101 | 
NOTE
: 
On
 
the
 
mc68000
, 
t°
 
⁄
 
™
 
addªss
 
is
 
nŸ
 
suµ‹ãd
.

102 #i‡!
	`deföed
(
__mc68020__
Ë&& !deföed(
__mc68030__
Ë&& !deföed(
__mc68040__
Ë&& !deföed(
__mc68060__
Ë&& !deföed(
__mcﬁdfúe__
)

103 
cmp
.
w
 #0, %
a1


105 
t°
.
l
 %
a1


107 
jbeq
 
n‹ëvÆ


109 
bt°
 #0,%
d2


110 
jbeq
 
ªé⁄göt


111 
move
.
l
 %
d0
,(%
a1
)

112 
jbø
 
ïûogue


114 
ªé⁄göt
:

115 
bt°
 #1,%
d2


116 
jbeq
 
ªtÊﬂt


117 
move
.
l
 %
d0
,(%
a1
)

118 
move
.
l
 %
d1
,4(%
a1
)

119 
jbø
 
ïûogue


121 
ªtÊﬂt
:

122 
bt°
 #2,%
d2


123 
jbeq
 
ªtdoubÀ


124 #i‡
	`deföed
(
__MC68881__
Ë|| deföed(
__HAVE_68881__
)

125 
fmove
.
s
 %
Â0
,(%
a1
)

127 
move
.
l
 %
d0
,(%
a1
)

129 
jbø
 
ïûogue


131 
ªtdoubÀ
:

132 
bt°
 #3,%
d2


133 
jbeq
 
ªé⁄gdoubÀ


134 #i‡
	`deföed
(
__MC68881__
Ë|| deföed(
__HAVE_68881__
)

135 
fmove
.
d
 %
Â0
,(%
a1
)

137 
move
.
l
 %
d0
,(%
a1
)+

138 
move
.
l
 %
d1
,(%
a1
)

140 
jbø
 
ïûogue


142 
ªé⁄gdoubÀ
:

143 
bt°
 #4,%
d2


144 
jbeq
 
ªçoöãr


145 #i‡
	`deföed
(
__MC68881__
Ë|| deföed(
__HAVE_68881__
)

146 
fmove
.
x
 %
Â0
,(%
a1
)

148 
move
.
l
 %
d0
,(%
a1
)+

149 
move
.
l
 %
d1
,(%
a1
)+

150 
move
.
l
 %
d2
,(%
a1
)

152 
jbø
 
ïûogue


154 
ªçoöãr
:

155 
bt°
 #5,%
d2


156 
jbeq
 
ªt°ru˘1


157 #ifde‡
__MINT__


158 
move
.
l
 %
d0
,(%
a1
)

160 
move
.
l
 %
a0
,(%
a1
)

162 
jbø
 
ïûogue


164 
ªt°ru˘1
:

165 
bt°
 #6,%
d2


166 
jbeq
 
ªt°ru˘2


167 
move
.
b
 %
d0
,(%
a1
)

168 
jbø
 
ïûogue


170 
ªt°ru˘2
:

171 
bt°
 #7,%
d2


172 
jbeq
 
ªtsöt8


173 
move
.
w
 %
d0
,(%
a1
)

174 
jbø
 
ïûogue


176 
ªtsöt8
:

177 
bt°
 #8,%
d2


178 
jbeq
 
ªtsöt16


179 | 
NOTE
: 
On
 
the
 
mc68000
, 
extb
 
is
 
nŸ
 
suµ‹ãd
. 8->16, 
thí
 16->32.

180 #i‡!
	`deföed
(
__mc68020__
Ë&& !deföed(
__mc68030__
Ë&& !deföed(
__mc68040__
Ë&& !deföed(
__mc68060__
Ë&& !deföed(
__mcﬁdfúe__
)

181 
ext
.
w
 %
d0


182 
ext
.
l
 %
d0


184 
extb
.
l
 %
d0


186 
move
.
l
 %
d0
,(%
a1
)

187 
jbø
 
ïûogue


189 
ªtsöt16
:

190 
bt°
 #9,%
d2


191 
jbeq
 
n‹ëvÆ


192 
ext
.
l
 %
d0


193 
move
.
l
 %
d0
,(%
a1
)

195 
n‹ëvÆ
:

196 
ïûogue
:

197 
move
.
	`l
 (%
•
)+,%
d2


198 
u∆k
 %
Â


199 
πs


200 
	`CFI_ENDPROC
()

201 .
size
 
	`CALLFUNC
(
ffi_ˇŒ_SYSV
),.-CALLFUNC(ffi_call_SYSV)

203 .
globl
 
	`CALLFUNC
(
ffi_˛osuª_SYSV
)

204 .
ty≥
 
	`CALLFUNC
(
ffi_˛osuª_SYSV
), @
fun˘i⁄


205 .
Æign
 4

207 
	$CALLFUNC
(
ffi_˛osuª_SYSV
):

208 
	$CFI_STARTPROC
()

209 
lök
 %
Â
,#-12

210 
	`CFI_OFFSET
(14,-8)

211 
	$CFI_DEF_CFA
(14,8)

212 
move
.
l
 %
•
,-12(%
Â
)

213 
≥a
 8(%
Â
)

214 
≥a
 -12(%
Â
)

215 
move
.
l
 %
a0
,-(%
•
)

216 #i‡!
deföed
 
__PIC__


217 
j§
 
	$CALLFUNC
(
ffi_˛osuª_SYSV_ö√r
)

219 
b§
.
l
 
	`CALLFUNC
(
ffi_˛osuª_SYSV_ö√r
@
PLTPC
)

222 
l§
.
l
 #1,%
d0


223 
j√
 1f

224 
jcc
 .
L˛s_ïûogue


225 | 
CIF_FLAGS_INT


226 
move
.
l
 -12(%
Â
),%
d0


227 .
L˛s_ïûogue
:

228 | 
no
 
CIF_FLAGS_
*

229 
u∆k
 %
Â


230 
πs


232 
Àa
 -12(%
Â
),%
a0


233 
l§
.
l
 #2,%
d0


234 
j√
 1f

235 
jcs
 .
L˛s_ªt_Êﬂt


236 | 
CIF_FLAGS_DINT


237 
move
.
	`l
 (%
a0
)+,%
d0


238 
move
.
	`l
 (%
a0
),%
d1


239 
jø
 .
L˛s_ïûogue


240 .
L˛s_ªt_Êﬂt
:

241 #i‡
	`deföed
(
__MC68881__
Ë|| deföed(
__HAVE_68881__
)

242 
fmove
.
	`s
 (%
a0
),%
Â0


244 
move
.
	`l
 (%
a0
),%
d0


246 
jø
 .
L˛s_ïûogue


248 
l§
.
l
 #2,%
d0


249 
j√
 1f

250 
jcs
 .
L˛s_ªt_ldoubÀ


251 | 
CIF_FLAGS_DOUBLE


252 #i‡
	`deföed
(
__MC68881__
Ë|| deföed(
__HAVE_68881__
)

253 
fmove
.
	`d
 (%
a0
),%
Â0


255 
move
.
	`l
 (%
a0
)+,%
d0


256 
move
.
	`l
 (%
a0
),%
d1


258 
jø
 .
L˛s_ïûogue


259 .
L˛s_ªt_ldoubÀ
:

260 #i‡
	`deföed
(
__MC68881__
Ë|| deföed(
__HAVE_68881__
)

261 
fmove
.
	`x
 (%
a0
),%
Â0


263 
move
.
	`l
 (%
a0
)+,%
d0


264 
move
.
	`l
 (%
a0
)+,%
d1


265 
move
.
	`l
 (%
a0
),%
d2


267 
jø
 .
L˛s_ïûogue


269 
l§
.
l
 #2,%
d0


270 
j√
 1f

271 
jcs
 .
L˛s_ªt_°ru˘1


272 | 
CIF_FLAGS_POINTER


273 
move
.
	`l
 (%
a0
),%a0

274 
move
.
l
 %
a0
,%
d0


275 
jø
 .
L˛s_ïûogue


276 .
L˛s_ªt_°ru˘1
:

277 
move
.
	`b
 (%
a0
),%
d0


278 
jø
 .
L˛s_ïûogue


280 
l§
.
l
 #2,%
d0


281 
j√
 1f

282 
jcs
 .
L˛s_ªt_söt8


283 | 
CIF_FLAGS_STRUCT2


284 
move
.
	`w
 (%
a0
),%
d0


285 
jø
 .
L˛s_ïûogue


286 .
L˛s_ªt_söt8
:

287 
move
.
	`l
 (%
a0
),%
d0


288 | 
NOTE
: 
On
 
the
 
mc68000
, 
extb
 
is
 
nŸ
 
suµ‹ãd
. 8->16, 
thí
 16->32.

289 #i‡!
	`deföed
(
__mc68020__
Ë&& !deföed(
__mc68030__
Ë&& !deföed(
__mc68040__
Ë&& !deföed(
__mc68060__
Ë&& !deföed(
__mcﬁdfúe__
)

290 
ext
.
w
 %
d0


291 
ext
.
l
 %
d0


293 
extb
.
l
 %
d0


295 
jø
 .
L˛s_ïûogue


297 | 
CIF_FLAGS_SINT16


298 
move
.
	`l
 (%
a0
),%
d0


299 
ext
.
l
 %
d0


300 
jø
 .
L˛s_ïûogue


301 
	`CFI_ENDPROC
()

303 .
size
 
	`CALLFUNC
(
ffi_˛osuª_SYSV
),.-CALLFUNC(ffi_closure_SYSV)

305 .
globl
 
	`CALLFUNC
(
ffi_˛osuª_°ru˘_SYSV
)

306 .
ty≥
 
	`CALLFUNC
(
ffi_˛osuª_°ru˘_SYSV
), @
fun˘i⁄


307 .
Æign
 4

309 
	$CALLFUNC
(
ffi_˛osuª_°ru˘_SYSV
):

310 
	$CFI_STARTPROC
()

311 
lök
 %
Â
,#0

312 
	`CFI_OFFSET
(14,-8)

313 
	$CFI_DEF_CFA
(14,8)

314 
move
.
l
 %
•
,-12(%
Â
)

315 
≥a
 8(%
Â
)

316 
move
.
l
 %
a1
,-(%
•
)

317 
move
.
l
 %
a0
,-(%
•
)

318 #i‡!
deföed
 
__PIC__


319 
j§
 
	$CALLFUNC
(
ffi_˛osuª_SYSV_ö√r
)

321 
b§
.
l
 
	`CALLFUNC
(
ffi_˛osuª_SYSV_ö√r
@
PLTPC
)

323 
u∆k
 %
Â


324 
πs


325 
	`CFI_ENDPROC
()

326 .
size
 
	`CALLFUNC
(
ffi_˛osuª_°ru˘_SYSV
),.-
	$CALLFUNC
(
ffi_˛osuª_°ru˘_SYSV
)

328 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


329 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m88k/ffi.c

46 
	~<ffi.h
>

47 
	~<ffi_comm⁄.h
>

49 
	~<°dlib.h
>

50 
	~<uni°d.h
>

52 
ffi_ˇŒ_OBSD
 (, 
exãnded_cif
 *, , *,

53 (*
‚
) ());

54 *
ffi_¥ï_¨gs
 (*, 
exãnded_cif
 *);

55 
ffi_˛osuª_OBSD
 (
ffi_˛osuª
 *);

56 
ffi_˛osuª_°ru˘_OBSD
 (
ffi_˛osuª
 *);

57 
ffi_˛osuª_OBSD_ö√r
 (
ffi_˛osuª
 *, *, *,

59 
ffi_ˇcheÊush_OBSD
 (, );

61 
	#CIF_FLAGS_INT
 (1 << 0)

	)

62 
	#CIF_FLAGS_DINT
 (1 << 1)

	)

72 
	$ffi_¥ï_¨gs
 (*
°ack
, 
exãnded_cif
 *
ecif
)

74 
i
;

75 **
p_¨gv
;

76 *
¨gp
, *
°ackp
;

77 *
ªgp
;

78 
ªgu£d
;

79 
ffi_ty≥
 **
p_¨g
;

80 *
°ru˘_vÆue_±r
;

82 
ªgp
 = (*)
°ack
;

83 
°ackp
 = (*)(
ªgp
 + 8);

84 
ªgu£d
 = 0;

86 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


87 && !
ecif
->
cif
->
Êags
)

88 
°ru˘_vÆue_±r
 = 
ecif
->
rvÆue
;

90 
°ru˘_vÆue_±r
 = 
NULL
;

92 
p_¨gv
 = 
ecif
->
avÆue
;

94 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
; i != 0; i--,Ö_arg++)

96 
size_t
 
z
;

97 
t
, 
a
;

99 
z
 = (*
p_¨g
)->
size
;

100 
t
 = (*
p_¨g
)->
ty≥
;

101 
a
 = (*
p_¨g
)->
Æignmít
;

110 i‡(
t
 =
FFI_TYPE_STRUCT
)

112 i‡(
z
 = (Ë&& 
a
 = (Ë&& 
ªgu£d
 < 8)

113 
¨gp
 = (*)
ªgp
;

115 
¨gp
 = 
°ackp
;

119 i‡(
z
 >  (Ë&& 
ªgu£d
 < 8 - 1)

122 i‡(
ªgu£d
 & 1)

124 
ªgp
++;

125 
ªgu£d
++;

128 i‡(
ªgu£d
 < 8)

129 
¨gp
 = (*)
ªgp
;

131 
¨gp
 = 
°ackp
;

135 i‡(
¨gp
 =
°ackp
 && 
a
 >  ())

137 
°ackp
 = (*Ë
	`ALIGN
(°ackp, 
a
);

138 
¨gp
 = 
°ackp
;

141 
t
)

143 
FFI_TYPE_SINT8
:

144 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT8
 *Ë*
p_¨gv
;

147 
FFI_TYPE_UINT8
:

148 *(*Ë
¨gp
 = (Ë*(
UINT8
 *Ë*
p_¨gv
;

151 
FFI_TYPE_SINT16
:

152 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT16
 *Ë*
p_¨gv
;

155 
FFI_TYPE_UINT16
:

156 *(*Ë
¨gp
 = (Ë*(
UINT16
 *Ë*
p_¨gv
;

159 
FFI_TYPE_INT
:

160 
FFI_TYPE_FLOAT
:

161 
FFI_TYPE_UINT32
:

162 
FFI_TYPE_SINT32
:

163 
FFI_TYPE_POINTER
:

164 *(*Ë
¨gp
 = *(*Ë*
p_¨gv
;

167 
FFI_TYPE_DOUBLE
:

168 
FFI_TYPE_UINT64
:

169 
FFI_TYPE_SINT64
:

170 
FFI_TYPE_STRUCT
:

171 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

175 
	`FFI_ASSERT
 (0);

179 i‡(( (Ë- 1Ë& 
z
)

180 
z
 = 
	`ALIGN
(z,  ());

182 
p_¨gv
++;

186 i‡(
¨gp
 =(*)
ªgp
 && 
ªgu£d
 < 8)

188 
ªgp
 +
z
 /  ();

189 
ªgu£d
 +
z
 /  ();

192 
°ackp
 +
z
;

195  
°ru˘_vÆue_±r
;

196 
	}
}

199 
ffi_°©us


200 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

203 
cif
->
πy≥
->
ty≥
)

205 
FFI_TYPE_VOID
:

206 
cif
->
Êags
 = 0;

209 
FFI_TYPE_STRUCT
:

210 i‡(
cif
->
πy≥
->
size
 ==  () &&

211 
cif
->
πy≥
->
Æignmít
 ==  ())

212 
cif
->
Êags
 = 
CIF_FLAGS_INT
;

214 
cif
->
Êags
 = 0;

217 
FFI_TYPE_DOUBLE
:

218 
FFI_TYPE_SINT64
:

219 
FFI_TYPE_UINT64
:

220 
cif
->
Êags
 = 
CIF_FLAGS_DINT
;

224 
cif
->
Êags
 = 
CIF_FLAGS_INT
;

228  
FFI_OK
;

229 
	}
}

232 
ffi_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
Ë(), *
rvÆue
, **
avÆue
)

234 
exãnded_cif
 
	gecif
;

236 
	gecif
.
	gcif
 = 
cif
;

237 
	gecif
.
	gavÆue
 = 
avÆue
;

242 i‡(
	grvÆue
 =
NULL


243 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


244 && (
cif
->
πy≥
->
size
 !=  ()

245 || 
cif
->
πy≥
->
Æignmít
 !=  ()))

246 
ecif
.
rvÆue
 = 
Æloˇ
 (
cif
->
πy≥
->
size
);

248 
	gecif
.
	grvÆue
 = 
rvÆue
;

250 
	gcif
->
	gabi
)

252 
	gFFI_OBSD
:

253 
ffi_ˇŒ_OBSD
 (
cif
->
byãs
, &
ecif
, cif->
Êags
,Écif.
rvÆue
, 
‚
);

257 
FFI_ASSERT
 (0);

267 
	$ffi_¥ï_˛osuª_¨gs_OBSD
 (
ffi_cif
 *
cif
, **
avÆue
, *
ªgp
,

268 *
°ackp
)

270 
i
;

271 **
p_¨gv
;

272 *
¨gp
;

273 
ªgu£d
;

274 
ffi_ty≥
 **
p_¨g
;

276 
ªgu£d
 = 0;

278 
p_¨gv
 = 
avÆue
;

280 
i
 = 
cif
->
«rgs
, 
p_¨g
 = cif->
¨g_ty≥s
; i != 0; i--,Ö_arg++)

282 
size_t
 
z
;

283 
t
, 
a
;

285 
z
 = (*
p_¨g
)->
size
;

286 
t
 = (*
p_¨g
)->
ty≥
;

287 
a
 = (*
p_¨g
)->
Æignmít
;

296 i‡(
t
 =
FFI_TYPE_STRUCT
)

298 i‡(
z
 = (Ë&& 
a
 = (Ë&& 
ªgu£d
 < 8)

299 
¨gp
 = (*)
ªgp
;

301 
¨gp
 = 
°ackp
;

305 i‡(
z
 >  (Ë&& 
ªgu£d
 < 8 - 1)

308 i‡(
ªgu£d
 & 1)

310 
ªgp
++;

311 
ªgu£d
++;

314 i‡(
ªgu£d
 < 8)

315 
¨gp
 = (*)
ªgp
;

317 
¨gp
 = 
°ackp
;

321 i‡(
¨gp
 =
°ackp
 && 
a
 >  ())

323 
°ackp
 = (*Ë
	`ALIGN
(°ackp, 
a
);

324 
¨gp
 = 
°ackp
;

327 i‡(
z
 <  (Ë&& 
t
 !
FFI_TYPE_STRUCT
)

328 *
p_¨gv
 = (*Ë(
¨gp
 +  (Ë- 
z
);

330 *
p_¨gv
 = (*Ë
¨gp
;

333 i‡(( (Ë- 1Ë& 
z
)

334 
z
 = 
	`ALIGN
(z,  ());

336 
p_¨gv
++;

340 i‡(
¨gp
 =(*)
ªgp
 && 
ªgu£d
 < 8)

342 
ªgp
 +
z
 /  ();

343 
ªgu£d
 +
z
 /  ();

346 
°ackp
 +
z
;

348 
	}
}

351 
	$ffi_˛osuª_OBSD_ö√r
 (
ffi_˛osuª
 *
˛osuª
, *
ª•
, *
ªgp
,

352 *
°ackp
)

354 
ffi_cif
 *
cif
;

355 **
¨g_¨ó
;

357 
cif
 = 
˛osuª
->cif;

358 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

360 
	`ffi_¥ï_˛osuª_¨gs_OBSD
(
cif
, 
¨g_¨ó
, 
ªgp
, 
°ackp
);

362 (
˛osuª
->
fun
Ë(
cif
, 
ª•
, 
¨g_¨ó
, closuª->
u£r_d©a
);

364  
cif
->
Êags
;

365 
	}
}

367 
ffi_°©us


368 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
, 
ffi_cif
* 
cif
,

369 (*
fun
)(
ffi_cif
*,*,**,*),

370 *
u£r_d©a
, *
codñoc
)

372 *
åamp
 = (*Ë
codñoc
;

373 *
‚
;

375 
	`FFI_ASSERT
 (
cif
->
abi
 =
FFI_OBSD
);

377 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 && !cif->
Êags
)

378 
‚
 = &
ffi_˛osuª_°ru˘_OBSD
;

380 
‚
 = &
ffi_˛osuª_OBSD
;

383 
åamp
[0] = 0x5d400000 | ((()
‚
) >> 16);

385 
åamp
[1] = 0x5da00000 | (()
˛osuª
 >> 16);

387 
åamp
[2] = 0x594a0000 | ((()
‚
) & 0xffff);

389 
åamp
[3] = 0xf400c40a;

391 
åamp
[4] = 0x59ad0000 | (()
˛osuª
 & 0xffff);

393 
	`ffi_ˇcheÊush_OBSD
(()
codñoc
, 
FFI_TRAMPOLINE_SIZE
);

395 
˛osuª
->
cif
 = cif;

396 
˛osuª
->
u£r_d©a
 = user_data;

397 
˛osuª
->
fun
 = fun;

399  
FFI_OK
;

400 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m88k/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_ASM


32 
	tffi_¨g
;

33 sig√d 
	tffi_ßrg
;

35 
	effi_abi
 {

36 
	mFFI_FIRST_ABI
 = 0,

37 
	mFFI_OBSD
,

38 
	mFFI_DEFAULT_ABI
 = 
FFI_OBSD
,

39 
	mFFI_LAST_ABI
 = 
FFI_DEFAULT_ABI
 + 1

40 } 
	tffi_abi
;

45 
	#FFI_CLOSURES
 1

	)

46 
	#FFI_TRAMPOLINE_SIZE
 0x14

	)

47 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m88k/obsd.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

32 .
	gãxt


38 .
	gÆign
 4

39 .
globl
 
	gffi_ˇcheÊush_OBSD


40 .
ty≥
 
	gffi_ˇcheÊush_OBSD
,@
fun˘i⁄


41 
	gffi_ˇcheÊush_OBSD
:

42 
tb0
 0, %
	gr0
, 451

43 
	g‹
 %
	gr0
, %r0, %
r0


44 
	gjmp
 %
	gr1


45 .
size
 
	gffi_ˇcheÊush_OBSD
, . - ffi_cacheflush_OBSD

54 .
	gÆign
 4

55 .
globl
 
	gffi_ˇŒ_OBSD


56 .
ty≥
 
	gffi_ˇŒ_OBSD
,@
fun˘i⁄


57 
	gffi_ˇŒ_OBSD
:

58 
subu
 %
r31
, %
	gr31
, 32

59 
	g°
 %
	gr30
, %
	gr31
, 4

60 
	g°
 %
	gr1
, %
	gr31
, 0

61 
	gaddu
 %
	gr30
, %
	gr31
, 32

63 | 
Save
 
the
 
„w
 
¨gumíts
 
	gwe
'llÇeedáfter ffi_prep_args()

64 
	g°
.
	gd
 %
	gr4
, %
	gr31
, 8

65 
	g°
 %
	gr6
, %
	gr31
, 16

67 | 
AŒoˇã
 
room
 
the
 
image
 
of
 
	gr2
-
	gr9
, 
™d
Åhê
°ack
 
•a˚
 

68 | 
the
 
¨gs
 (
rounded
 
to
 
a
 16-
byã
 
bound¨y
)

69 
	gaddu
 %
	gr2
, %r2, (8 * 4) + 15

70 
	g˛r
 %
	gr2
, %r2, 4<0>

71 
	gsubu
 %
	gr31
, %r31, %
	gr2


73 | 
Fûl
 
™d
 
°ack
 
image


74 
	g‹
 %
	gr2
, %
	gr31
, %
	gr0


75 #ifde‡
PIC


76 
b§
 
	gffi_¥ï_¨gs
#plt

78 
b§
 
	gffi_¥ï_¨gs


81 | 
Save
 
poöãr
 
to
  
	gaddªss
, 
™y


82 
	g‹
 %
	gr12
, %
	gr2
, %
	gr0


84 | 
Gë
 
fun˘i⁄
 
poöãr


85 
	gsubu
 %
	gr4
, %
	gr30
, 32

86 
	gld
 %
	gr1
, %
	gr4
, 16

88 | 
Fëch
 
the
 
¨gumíts


89 
	gld
.
	gd
 %
	gr2
, %
	gr31
, (0 * 4)

90 
	gld
.
	gd
 %
	gr4
, %
	gr31
, (2 * 4)

91 
	gld
.
	gd
 %
	gr6
, %
	gr31
, (4 * 4)

92 
	gld
.
	gd
 %
	gr8
, %
	gr31
, (6 * 4)

93 
	gaddu
 %
	gr31
, %r31, (8 * 4)

95 | 
Invoke
 
the
 
fun˘i⁄


96 
	gj§
 %
	gr1


98 | 
Re°‹e
 
°ack
 
now
 
th©
 
we
 
	gd⁄
'tÇeedÅheárgsánymore

99 
	gsubu
 %
	gr31
, %
	gr30
, 32

101 | 
Figuª
 
out
 
wh©
 
to
  
as
 
the
 
	gfun˘i⁄
'sÑeturn value

102 
	gld
 %
	gr5
, %
	gr31
, 12 | 
rvÆue


103 
	gld
 %
	gr4
, %
	gr31
, 8 | 
Êags


105 
b˙d
 
	geq0
, %
	gr5
, 9f

107 
	gbb0
 0, %
	gr4
, 1‡| 
CIF_FLAGS_INT


108 
	g°
 %
	gr2
, %
	gr5
, 0

109 
	gbr
 9f

112 
bb0
 1, %
	gr4
, 1‡| 
CIF_FLAGS_DINT


113 
	g°
.
	gd
 %
	gr2
, %
	gr5
, 0

114 
	gbr
 9f

118 
ld
 %
r1
, %
	gr31
, 0

119 
	gld
 %
	gr30
, %
	gr31
, 4

120 
	gjmp
.
	gn
 %
r1


121 
	gaddu
 %
	gr31
, %r31, 32

122 .
size
 
	gffi_ˇŒ_OBSD
, . - ffi_call_OBSD

127 .
	gÆign
 4

128 .
globl
 
	gffi_˛osuª_OBSD


129 .
ty≥
 
	gffi_˛osuª_OBSD
, @
fun˘i⁄


130 
	gffi_˛osuª_OBSD
:

131 
subu
 %
r31
, %
	gr31
, 16

132 
	g°
 %
	gr30
, %
	gr31
, 4

133 
	g°
 %
	gr1
, %
	gr31
, 0

134 
	gaddu
 %
	gr30
, %
	gr31
, 16

136 | 
Make
 
room
 
⁄
 
the
 
°ack
 
ßved
 
¨gumíts
 
™d
 

137 | 
vÆue


138 
	gsubu
 %
	gr31
, %r31, (8 * 4) + (2 * 4)

139 
	g°
.
	gd
 %
	gr2
, %
	gr31
, (0 * 4)

140 
	g°
.
	gd
 %
	gr4
, %
	gr31
, (2 * 4)

141 
	g°
.
	gd
 %
	gr6
, %
	gr31
, (4 * 4)

142 
	g°
.
	gd
 %
	gr8
, %
	gr31
, (6 * 4)

144 | 
Invoke
 
the
 
˛osuª
 
fun˘i⁄


145 
	g‹
 %
	gr5
, %
	gr30
, 0 | 
ˇŒög
 
°ack


146 
	gaddu
 %
	gr4
, %
	gr31
, 0 | 
ßved
 
ªgi°îs


147 
	gaddu
 %
	gr3
, %
	gr31
, (8 * 4Ë|  
vÆue


148 
	g‹
 %
	gr2
, %
	gr13
, %
	gr0
 | 
	g˛osuª


149 #ifde‡
PIC


150 
b§
 
	gffi_˛osuª_OBSD_ö√r
#plt

152 
b§
 
	gffi_˛osuª_OBSD_ö√r


155 | 
Figuª
 
out
 
wh©
 
to
  
as
 
the
 
	gfun˘i⁄
'sÑeturn value

156 
	gbb0
 0, %
	gr2
, 1‡| 
CIF_FLAGS_INT


157 
	gld
 %
	gr2
, %
	gr31
, (8 * 4)

158 
	gbr
 9f

161 
bb0
 1, %
	gr2
, 1‡| 
CIF_FLAGS_DINT


162 
	gld
.
	gd
 %
	gr2
, %
	gr31
, (8 * 4)

163 
	gbr
 9f

167 
subu
 %
r31
, %
	gr30
, 16

168 
	gld
 %
	gr1
, %
	gr31
, 0

169 
	gld
 %
	gr30
, %
	gr31
, 4

170 
	gjmp
.
	gn
 %
r1


171 
	gaddu
 %
	gr31
, %r31, 16

172 .
size
 
	gffi_˛osuª_OBSD
,.-ffi_closure_OBSD

177 .
	gÆign
 4

178 .
globl
 
	gffi_˛osuª_°ru˘_OBSD


179 .
ty≥
 
	gffi_˛osuª_°ru˘_OBSD
, @
fun˘i⁄


180 
	gffi_˛osuª_°ru˘_OBSD
:

181 
subu
 %
r31
, %
	gr31
, 16

182 
	g°
 %
	gr30
, %
	gr31
, 4

183 
	g°
 %
	gr1
, %
	gr31
, 0

184 
	gaddu
 %
	gr30
, %
	gr31
, 16

186 | 
Make
 
room
 
⁄
 
the
 
°ack
 
ßved
 
¨gumíts


187 
	gsubu
 %
	gr31
, %r31, (8 * 4)

188 
	g°
.
	gd
 %
	gr2
, %
	gr31
, (0 * 4)

189 
	g°
.
	gd
 %
	gr4
, %
	gr31
, (2 * 4)

190 
	g°
.
	gd
 %
	gr6
, %
	gr31
, (4 * 4)

191 
	g°
.
	gd
 %
	gr8
, %
	gr31
, (6 * 4)

193 | 
Invoke
 
the
 
˛osuª
 
fun˘i⁄


194 
	g‹
 %
	gr5
, %
	gr30
, 0 | 
ˇŒög
 
°ack


195 
	gaddu
 %
	gr4
, %
	gr31
, 0 | 
ßved
 
ªgi°îs


196 
	g‹
 %
	gr3
, %
	gr12
, 0 |  
vÆue


197 
	g‹
 %
	gr2
, %
	gr13
, %
	gr0
 | 
	g˛osuª


198 #ifde‡
PIC


199 
b§
 
	gffi_˛osuª_OBSD_ö√r
#plt

201 
b§
 
	gffi_˛osuª_OBSD_ö√r


204 
	gsubu
 %
	gr31
, %
	gr30
, 16

205 
	gld
 %
	gr1
, %
	gr31
, 0

206 
	gld
 %
	gr30
, %
	gr31
, 4

207 
	gjmp
.
	gn
 %
r1


208 
	gaddu
 %
	gr31
, %r31, 16

209 .
size
 
	gffi_˛osuª_°ru˘_OBSD
,.-ffi_closure_struct_OBSD

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/metag/ffi.c

25 
	~<ffi.h
>

26 
	~<ffi_comm⁄.h
>

28 
	~<°dlib.h
>

30 
	#MIN
(
a
,
b
Ë((◊Ë< (b)Ë? (aË: (b))

	)

37 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

39 
i
;

40 **
p_¨gv
;

41 *
¨gp
;

42 
ffi_ty≥
 **
p_¨g
;

44 
¨gp
 = 
°ack
;

47 i‡–
ecif
->
cif
->
Êags
 =
FFI_TYPE_STRUCT
 ) {

48 
¨gp
 -= 4;

49 *(**Ë
¨gp
 = 
ecif
->
rvÆue
;

52 
p_¨gv
 = 
ecif
->
avÆue
;

55 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
; (ò!0); i--,Ö_¨g++, 
p_¨gv
++)

57 
size_t
 
z
;

60 
z
 = (*
p_¨g
)->
size
;

61 
¨gp
 -
z
;

64 
¨gp
 = (*Ë
	`ALIGN_DOWN
(ALIGN_DOWN◊rgp, (*
p_¨g
)->
Æignmít
), 4);

66 i‡(
z
 < ()) {

67 
z
 = ();

68 (*
p_¨g
)->
ty≥
)

70 
FFI_TYPE_SINT8
:

71 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT8
 *)(* 
p_¨gv
);

73 
FFI_TYPE_UINT8
:

74 *(*Ë
¨gp
 = ()*(
UINT8
 *)(* 
p_¨gv
);

76 
FFI_TYPE_SINT16
:

77 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT16
 *)(* 
p_¨gv
);

79 
FFI_TYPE_UINT16
:

80 *(*Ë
¨gp
 = ()*(
UINT16
 *)(* 
p_¨gv
);

81 
FFI_TYPE_STRUCT
:

82 
	`mem˝y
(
¨gp
, *
p_¨gv
, (*
p_¨g
)->
size
);

85 
	`FFI_ASSERT
(0);

87 } i‡–
z
 == ()) {

88 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

90 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

96  
	`ALIGN
(
	`MIN
(
°ack
 - 
¨gp
, 6*4), 8);

97 
	}
}

100 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

102 
ffi_ty≥
 **
±r
;

103 
i
, 
byãs
 = 0;

105 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = cif->
«rgs
; i > 0; i--,Ötr++) {

106 i‡((*
±r
)->
size
 == 0)

107  
FFI_BAD_TYPEDEF
;

111 
	`FFI_ASSERT_VALID_TYPE
(*
±r
);

114 i‡(((*
±r
)->
Æignmít
 - 1Ë& 
byãs
)

115 
byãs
 = 
	`ALIGN
(byãs, (*
±r
)->
Æignmít
);

117 
byãs
 +
	`ALIGN
((*
±r
)->
size
, 4);

121 
byãs
 = 
	`ALIGN
(bytes, 8);

124 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
) {

125 
byãs
 += (*);

128 
byãs
 = 
	`ALIGN
(bytes, 8);

131 
cif
->
byãs
 = bytes;

134 
cif
->
πy≥
->
ty≥
) {

135 
FFI_TYPE_VOID
:

136 
FFI_TYPE_FLOAT
:

137 
FFI_TYPE_DOUBLE
:

138 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

140 
FFI_TYPE_SINT64
:

141 
FFI_TYPE_UINT64
:

142 
cif
->
Êags
 = (Ë
FFI_TYPE_SINT64
;

144 
FFI_TYPE_STRUCT
:

146 i‡(
cif
->
πy≥
->
size
 <= 4)

148 
cif
->
Êags
 = ()
FFI_TYPE_INT
;

149 i‡((
cif
->
πy≥
->
size
 > 4) && (cif->rtype->size <= 8))

151 
cif
->
Êags
 = ()
FFI_TYPE_DOUBLE
;

154 
cif
->
Êags
 = ()
FFI_TYPE_STRUCT
;

157 
cif
->
Êags
 = ()
FFI_TYPE_INT
;

160  
FFI_OK
;

161 
	}
}

163 
ffi_ˇŒ_SYSV
((*
‚
)(), 
exãnded_cif
 *, , , *);

173 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

175 
exãnded_cif
 
ecif
;

177 
smÆl_°ru˘
 = (((
cif
->
Êags
 =
FFI_TYPE_INT
Ë|| (cif->Êag†=
FFI_TYPE_DOUBLE
)Ë&& (cif->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
));

178 
ecif
.
cif
 = cif;

179 
ecif
.
avÆue
 =ávalue;

181 
ãmp
;

188 i‡((
rvÆue
 =
NULL
 ) && (
cif
->
Êags
 =
FFI_TYPE_STRUCT
))

189 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

190 i‡(
smÆl_°ru˘
)

191 
ecif
.
rvÆue
 = &
ãmp
;

193 
ecif
.
rvÆue
 =Ñvalue;

195 
cif
->
abi
) {

196 
FFI_SYSV
:

197 
	`ffi_ˇŒ_SYSV
(
‚
, &
ecif
, 
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
);

200 
	`FFI_ASSERT
(0);

204 i‡(
smÆl_°ru˘
)

205 
	`mem˝y
 (
rvÆue
, &
ãmp
, 
cif
->
πy≥
->
size
);

206 
	}
}

210 
ffi_¥ï_öcomög_¨gs_SYSV
 (*, **, **,

211 
ffi_cif
*, *);

213 
ffi_˛osuª_SYSV
 (
ffi_˛osuª
 *);

216 
ffi_mëag_åampﬁöe
[10];

227 
	$ffi_öô_åampﬁöe
(*
__åamp
, 
__fun
, 
__˘x
) {

228 
	`mem˝y
 (
__åamp
, 
ffi_mëag_åampﬁöe
, (ffi_metag_trampoline));

229 *(*Ë&
__åamp
[40] = 
__˘x
;

230 *(*Ë&
__åamp
[44] = 
__fun
;

232 
	`__buûtö_mëa2_ˇchewd
(&
__åamp
[0], 1);

233 
	`__buûtö_mëa2_ˇchewd
(&
__åamp
[47], 1);

234 
	}
}

240 
ffi_°©us


241 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
 *
˛osuª
,

242 
ffi_cif
* 
cif
,

243 (*
fun
)(
ffi_cif
*,*,**,*),

244 *
u£r_d©a
,

245 *
codñoc
)

247 (*
˛osuª_func
)(
ffi_˛osuª
*Ë
NULL
;

249 i‡(
cif
->
abi
 =
FFI_SYSV
)

250 
˛osuª_func
 = &
ffi_˛osuª_SYSV
;

252  
FFI_BAD_ABI
;

254 
	`ffi_öô_åampﬁöe
(

255 (*)&
˛osuª
->
åamp
[0],

256 ()
˛osuª_func
,

257 ()
codñoc
);

259 
˛osuª
->
cif
 = cif;

260 
˛osuª
->
u£r_d©a
 = user_data;

261 
˛osuª
->
fun
 = fun;

263  
FFI_OK
;

264 
	}
}

268 
	$ffi_˛osuª_SYSV_ö√r
 (
˛osuª
, 
ª•p
, 
¨gs
, 
vÂ_¨gs
)

269 
ffi_˛osuª
 *
˛osuª
;

270 **
ª•p
;

271 *
¨gs
;

272 *
vÂ_¨gs
;

274 
ffi_cif
 *
cif
;

275 **
¨g_¨ó
;

277 
cif
 = 
˛osuª
->cif;

278 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

287 
	`ffi_¥ï_öcomög_¨gs_SYSV
(
¨gs
, 
ª•p
, 
¨g_¨ó
, 
cif
, 
vÂ_¨gs
);

289 (
˛osuª
->
fun
Ë–
cif
, *
ª•p
, 
¨g_¨ó
, closuª->
u£r_d©a
);

291  
cif
->
Êags
;

292 
	}
}

294 
	$ffi_¥ï_öcomög_¨gs_SYSV
(*
°ack
, **
rvÆue
,

295 **
avÆue
, 
ffi_cif
 *
cif
,

296 *
vÂ_°ack
)

298 
i
;

299 **
p_¨gv
;

300 *
¨gp
;

301 
ffi_ty≥
 **
p_¨g
;

304 
¨gp
 = 
°ack
;

307 i‡–
cif
->
Êags
 =
FFI_TYPE_STRUCT
 ) {

308 
¨gp
 -= 4;

309 *
rvÆue
 = *(**Ë
¨gp
;

312 
p_¨gv
 = 
avÆue
;

314 
i
 = 
cif
->
«rgs
, 
p_¨g
 = cif->
¨g_ty≥s
; (i != 0); i--,Ö_arg++) {

315 
size_t
 
z
;

316 
size_t
 
Æignmít
;

318 
Æignmít
 = (*
p_¨g
)->alignment;

319 i‡(
Æignmít
 < 4)

320 
Æignmít
 = 4;

321 i‡((
Æignmít
 - 1Ë& ()
¨gp
)

322 
¨gp
 = (*Ë
	`ALIGN
◊rgp, 
Æignmít
);

324 
z
 = (*
p_¨g
)->
size
;

325 *
p_¨gv
 = (*Ë
¨gp
;

326 
p_¨gv
++;

327 
¨gp
 -
z
;

330 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/metag/ffitarget.h

27 #i‚de‡
LIBFFI_TARGET_H


28 
	#LIBFFI_TARGET_H


	)

30 #i‚de‡
LIBFFI_H


34 #i‚de‡
LIBFFI_ASM


35 
	tffi_¨g
;

36 sig√d 
	tffi_ßrg
;

38 
	effi_abi
 {

39 
	mFFI_FIRST_ABI
 = 0,

40 
	mFFI_SYSV
,

41 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV
,

42 
	mFFI_LAST_ABI
 = 
FFI_DEFAULT_ABI
 + 1,

43 } 
	tffi_abi
;

48 
	#FFI_CLOSURES
 1

	)

49 
	#FFI_TRAMPOLINE_SIZE
 48

	)

50 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/metag/sysv.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

31 #ifde‡
HAVE_MACHINE_ASM_H


32 
	~<machöe/asm.h
>

34 #ifde‡
__USER_LABEL_PREFIX__


35 
	#CONCAT1
(
a
, 
b
Ë
	`CONCAT2
◊, b)

	)

36 
	#CONCAT2
(
a
, 
b
Ë®## 
	)
b

39 
	#CNAME
(
x
Ë
	`CONCAT1
 (
__USER_LABEL_PREFIX__
, x)

	)

41 
	#CNAME
(
x
Ë
	)
x

43 
	#ENTRY
(
x
Ë.
globl
 
	`CNAME
(x); .
ty≥
 CNAME(x), %
fun˘i⁄
; CNAME(x):

	)

46 #ifde‡
__ELF__


47 
	#LSYM
(
x
Ë.
	)
x

49 
	#LSYM
(
x
Ë
	)
x

52 .
ma¸o
 
ˇŒ_ªg
 
	gx
=

53 .
ãxt


54 .
bÆign
 4

55 
mov
 
D1RtP
, \
x


56 
sw≠
 
	gD1RtP
, 
	gPC


57 .
	gídm


59 ! 
Save
 
	g¨gumíts


60 .
ma¸o
 
	gSAVE_ARGS


61 .
	gãxt


62 .
	gbÆign
 4

63 
	g£é
 [
A0StP
++], 
	gD0Ar6
, 
D1Ar5


64 
	g£é
 [
A0StP
++], 
	gD0Ar4
, 
D1Ar3


65 
	g£é
 [
A0StP
++], 
	gD0Ar2
, 
	gD1Ar1


66 .
	gídm


68 ! 
Save
 
	gªåun
, 
‰ame
 
poöãr
 
™d
 
Ÿhî
 
	gªgs


69 .
ma¸o
 
SAVE_REGS
 
	gªgs
=

70 .
ãxt


71 .
bÆign
 4

72 
£é
 [
A0StP
++], 
	gD0FrT
, 
	gD1RtP


73 ! 
Nìds
 
to
 
be
 
a
 
∑ú
 
of
 
	gªgs


74 .
	gi‚c
 "\regs",""

75 
	g£é
 [
A0StP
++], \
	gªgs


76 .
	gídif


77 .
	gídm


79 ! 
De˛¨e
 
a
 
globÆ
 
	gfun˘i⁄


80 .
ma¸o
 
METAG_FUNC_START
 
	g«me


81 .
	gãxt


82 .
	gbÆign
 4

83 
ENTRY
(\
«me
)

84 .
	gídm


86 ! 
Rëu∫
 
ªgi°îs
 
‰om
 
the
 
	g°ack
. 
Revî£
 
SAVE_REGS
 
	g›î©i⁄


87 .
ma¸o
 
RET_REGS
 
	gªgs
=, 
	gc⁄d
=

88 .
i‚c
 "\regs", ""

89 
	ggël
 \
	gªgs
, [--
A0StP
]

90 .
ídif


91 
gël
 
	gD0FrT
, 
	gD1RtP
, [--
A0StP
]

92 .
	gídm


94 ! 
Rëu∫
 
	g¨gumíts


95 .
ma¸o
 
RET_ARGS


96 
gël
 
	gD0Ar2
, 
	gD1Ar1
, [--
A0StP
]

97 
gël
 
	gD0Ar4
, 
	gD1Ar3
, [--
A0StP
]

98 
gël
 
	gD0Ar6
, 
	gD1Ar5
, [--
A0StP
]

99 .
	gídm


102 ! 
	gD1Ar1
: 
‚


103 ! 
D0Ar2
: &
ecif


104 ! 
D1Ar3
: 
cif
->
byãs


105 ! 
D0Ar4
: 
fig
->
Êags


106 ! 
D1Ar5
: 
ecif
.
rvÆue


108 ! 
This
 
assumes
 
we
 
¨e
 
usög
 
GNU
 
as


109 
METAG_FUNC_START
 
ffi_ˇŒ_SYSV


110 ! 
Save
 
¨gumít
 
ªgi°îs


112 
SAVE_ARGS


114 ! 
√w
 
‰ame


115 
mov
 
D0FrT
, 
A0FrP


116 
add
 
	gA0FrP
, 
	gA0StP
, #0

118 ! 
Pª£rve
 
the
 
ﬁd
 
‰ame
 
poöãr


119 
	gSAVE_REGS
 "D1.5, D0.5"

121 ! 
Make
 
room
 
√w
 
	g¨gs
. 
	gcifs
->
byãs
 
is
 
the
 
tŸÆ
 
•a˚
 
	göput


122 ! 
™d
  
¨gumíts


124 
add
 
	gA0StP
, A0StP, 
	gD1Ar3


126 ! 
Pª£rve
 
	gcifs
->
	gbyãs
 & 
‚


127 
mov
 
	gD0
.5, 
D1Ar3


128 
mov
 
	gD1
.5, 
	gD1Ar1


130 ! 
Pœ˚
 
Æl
 
of
 
the
 
ffi_¥ï_¨gs
 
ö
 
posôi⁄


131 
mov
 
	gD1Ar1
, 
	gA0StP


133 ! 
CÆl
 
	$ffi_¥ï_¨gs
(
°ack
, &
ecif
)

134 #ifde‡
__PIC__


135 
ˇŒr
 
D1RtP
, 
	`CNAME
(
ffi_¥ï_¨gs
@
PLT
)

137 
ˇŒr
 
D1RtP
, 
	$CNAME
(
ffi_¥ï_¨gs
)

140 ! 
Re°‹e
 
‚
 
poöãr


142 ! 
The
 
f‹eign
 
°ack
 
should
 
look
 
like
 
this


143 ! 
XXXXX
 
XXXXXX
 <--- 
°ack
 
poöãr


144 ! 
FnArgN
 
rvÆue


145 ! 
FnArgN
+2 FnArgN+1

146 ! 
FnArgN
+4 FnArgN+3

150 ! 
A0StP
 
now
 
poöts
 
to
 
the
 
	$fú°
 (
‹
 Ë
¨gumít
 + 4

152 ! 
Pª£rve
 
cif
->
byãs


153 
gël
 
D0Ar2
, 
D1Ar1
, [--
A0StP
]

154 
gël
 
D0Ar4
, 
D1Ar3
, [--
A0StP
]

155 
gël
 
D0Ar6
, 
D1Ar5
, [--
A0StP
]

157 ! 
Pœ˚
 
A0StP
 
to
 
the
 
fú°
 
¨gumít
 
agaö


158 
add
 
A0StP
, A0StP, #24 ! 
Th©
's because weÜoaded 6Ñegs x 4 byteÉach

160 ! 
A0FrP
 
poöts
 
to
 
the
 
öôül
 
°ack
 
wôhout
Åhê
ª£rved
 
•a˚
 the

161 ! 
cifs
->
byãs
, 
whû°
 
A0StP
 
poöts
 
to
 
the
 
°ack
 
a·î
Åhê
•a˚
 
Æloˇti⁄


163 ! 
‚
 
was
 
the
 
fú°
 
¨gumít
 
of
 
ffi_ˇŒ_SYSV
.

164 ! 
The
 
°ack
 
©
 
this
 
poöt
 
looks
 
like
Åhis:

166 ! 
	`A0StP
(
⁄
 
íåy
 
to
 
_SYSV
Ë-> 
Arg6
 
Arg5
 | 
low


167 ! 
Arg4
 
Arg3
 |

168 ! 
Arg2
 
Arg1
 |

169 ! 
A0FrP
 ----> 
D0FπP
 
D1RtP
 |

170 ! 
D1
.5 
D0
.5 |

171 ! 
	`A0StP
(
bf
 
¥ï_¨gs
Ë-> 
FnArgn
 FnArgn-1 |

172 ! 
FnArgn
-2F
nArgn
-3 |

173 ! ................ | <
cifs
->
byãs


174 ! 
FnArg4
 
FnArg3
 |

175 ! 
	`A0StP
 (
¥v_A0StP
+
cifs
->
byãs
Ë
FnArg2
 
FnArg1
 | 
high


177 ! 
‚
 
was
 
ö
 
Arg1
 
so
 
ô
'sÜocated in in A0FrP+#-0xC

180 ! 
D0Re0
 
c⁄èös
 
the
 
size
 
of
 
¨gumíts
 
°‹ed
 
ö
 
ªgi°îs


181 
sub
 
A0StP
, A0StP, 
D0Re0


183 ! 
Arg1
 
is
 
the
 
fun˘i⁄
 
poöãr
 thê
f‹eign
 
ˇŒ
. 
This
 
has
 
bìn


184 ! 
¥e£rved
 
ö
 
D1
.5

186 ! 
Time
 
to
 
	`ˇŒ
 (
‚
). 
Argumíts
 
should
 
be
 
like
 
this
:

187 ! 
Arg1
-
Arg6
 
¨e
 
lﬂded
 
to
 
ªgs


188 ! 
The
 
ª°
 
of
 
the
 
¨gumíts
 
¨e
 
°‹ed
 
ö
 
°ack
 
poöãd
 
by
 
A0StP


190 
ˇŒ_ªg
 
D1
.5

192 ! 
Re£t
 
°ack
.

194 
mov
 
A0StP
, 
A0FrP


196 ! 
Lﬂd
 
Arg1
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
ty≥


197 ! 
This
 
was
 
°‹ed
 
ö
 
Arg5


199 
gëd
 
D1Ar1
, [
A0FrP
+#-20]

201 ! 
Lﬂd
 
D0Ar2
 
wôh
 
the
  
ty≥
 
code
. 
This
 
was
 
°‹ed
 
ö
 
	$Arg4
 (
Êags
)

203 
gëd
 
D0Ar2
, [
A0FrP
+#-16]

205 ! 
We
 
¨e
 
ªady
 
to
 
°¨t
 
¥o˚ssög
 
the
  
vÆue


206 ! 
	$D0Re0
 (
™d
 
D1Re0
Ë
hﬁd
 
the
  
vÆue


208 ! 
If
 
the
  
vÆue
 
is
 
NULL
, 
assume
 
no
  value

209 
cmp
 
D1Ar1
, #0

210 
beq
 
	`LSYM
(
Lïûogue
)

212 !  
INT


213 
cmp
 
D0Ar2
, #FFI_TYPE_INT

214 ! 
Sadly
, 
thîe
 
is
 
no
 
£td
{
cc
} in°ru˘i⁄ sÿwê√edÅÿw‹k¨oundÅh©

215 
	gb√
 .
INT64


216 
	g£td
 [
D1Ar1
], 
D0Re0


217 
b
 
LSYM
(
Lïûogue
)

219 !  
	gINT64


220 .
	gINT64
:

221 
cmp
 
D0Ar2
, #FFI_TYPE_SINT64

222 
	g£éeq
 [
D1Ar1
], 
	gD0Re0
, 
	gD1Re0


224 !  
DOUBLE


225 
cmp
 
	gD0Ar2
, #FFI_TYPE_DOUBLE

226 
	g£é
 [
D1AR1
++], 
	gD0Re0
, 
D1Re0


228 
	$LSYM
(
Lïûogue
):

229 ! 
At
 
this
 
poöt
, 
the
 
°ack
 
poöãr
 
poöts
 
right
 
a·î
Åhê
¨gumít


230 ! 
ßved
 
¨ó
. 
We
 
√ed
 
to
 
ª°‹e
 4 
ªgs
, 
thîef‹e
 
we
ÇìdÅÿ
move


231 ! 16 
byãs
 
ahód
.

232 
add
 
A0StP
, A0StP, #16

233 
RET_REGS
 "D1.5, D0.5"

234 
RET_ARGS


235 
gëd
 
D0Re0
, [
A0StP
]

236 
mov
 
A0FrP
, 
D0FrT


237 
sw≠
 
D1RtP
, 
PC


239 .
ffi_ˇŒ_SYSV_íd
:

240 .
size
 
	`CNAME
(
ffi_ˇŒ_SYSV
),.
ffi_ˇŒ_SYSV_íd
-
	$CNAME
(
ffi_ˇŒ_SYSV
)

255 
METAG_FUNC_START
 
ffi_˛osuª_SYSV


256 ! 
We
 
assume
 
th©
 
D1Ar1
 
hﬁds
 
the
 
addªss
 
of
Åhe

257 ! 
ffi_˛osuª
 . 
We
 
wûl
 
u£
 
th©
 
to
 
„tch
 
the


258 ! 
¨gumíts
. 
The
 
°ack
 
poöãr
 
poöts
 
to
 
™
 
em±y
 
•a˚


259 ! 
™d
 
ô
 
is
 
ªady
 
to
 
°‹e
 
m‹e
 
d©a
.

261 ! 
D1Ar1
 
is
 
ªady


262 ! 
AŒoˇã
 
°ack
 
•a˚
  
vÆue


263 
add
 
A0StP
, A0StP, #8

264 ! 
St‹e
 
ô
 
to
 
D0Ar2


265 
sub
 
D0Ar2
, 
A0StP
, #8

267 
sub
 
D1Ar3
, 
A0FrP
, #4

269 ! 
D1Ar3
 
c⁄èös
 
the
 
addªss
 
of
Åhê
‹igöÆ
 
D1Ar1
 
¨gumít


270 ! 
We
 
√ed
 
to
 
subåa˘
 #4 
œãr
 
⁄


272 ! 
Pªvîve
 
D0Ar2


273 
mov
 
D0
.5, 
D0Ar2


275 #ifde‡
__PIC__


276 
ˇŒr
 
D1RtP
, 
	`CNAME
(
ffi_˛osuª_SYSV_ö√r
@
PLT
)

278 
ˇŒr
 
D1RtP
, 
	$CNAME
(
ffi_˛osuª_SYSV_ö√r
)

281 ! 
Check
 
the
  
vÆue
 
™d
 
°‹e
 
ô
 
to
 
D0
.5

282 
cmp
 
D0Re0
, #FFI_TYPE_INT

283 
beq
 .
Lªtöt


284 
cmp
 
D0Re0
, #FFI_TYPE_DOUBLE

285 
beq
 .
LªtdoubÀ


286 .
L˛osuª_ïûogue
:

287 
sub
 
A0StP
, A0StP, #8

288 
RET_REGS
 "D1.5, D0.5"

289 
RET_ARGS


290 
sw≠
 
D1RtP
, 
PC


292 .
Lªtöt
:

293 
£td
 [
D0
.5], 
D0Re0


294 
b
 .
L˛osuª_ïûogue


295 .
LªtdoubÀ
:

296 
£é
 [
D0
.5++], 
D0Re0
, 
D1Re0


297 
b
 .
L˛osuª_ïûogue


298 .
ffi_˛osuª_SYSV_íd
:

299 .
size
 
	`CNAME
(
ffi_˛osuª_SYSV
),.
ffi_˛osuª_SYSV_íd
-
	$CNAME
(
ffi_˛osuª_SYSV
)

302 
	$ENTRY
(
ffi_mëag_åampﬁöe
)

303 
SAVE_ARGS


304 ! 
New
 
‰ame


305 
mov
 
A0FrP
, 
A0StP


306 
SAVE_REGS
 "D1.5, D0.5"

307 
mov
 
D0
.5, 
PC


308 ! 
Lﬂd
 
D1Ar1
 
the
 
vÆue
 
of
 
ffi_mëag_åampﬁöe


309 
gëd
 
D1Ar1
, [
D0
.5 + #8]

310 ! 
Jump
 
to
 
ffi_˛osuª_SYSV


311 
gëd
 
PC
, [
D0
.5 + #12]

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/microblaze/ffi.c

27 
	~<ffi.h
>

28 
	~<ffi_comm⁄.h
>

30 
ffi_ˇŒ_SYSV
((*)(*, 
exãnded_cif
*),Éxtended_cif*,

31 , , *, (*
‚
)(),

34 
	`ffi_˛osuª_SYSV
();

36 
	#WORD_SIZE
 ()

	)

37 
	#ARGS_REGISTER_SIZE
 (
WORD_SIZE
 * 6)

	)

38 
	#WORD_ALIGN
(
x
Ë
	`ALIGN
(x, 
WORD_SIZE
)

	)

42 
	$ffi_¥ï_¨gs
(* 
°ack
, 
exãnded_cif
* 
ecif
)

44 
i
;

45 
ffi_ty≥
** 
p_¨g
;

46 ** 
p_¨gv
;

47 * 
°ack_¨gs_p
 = 
°ack
;

49 
p_¨gv
 = 
ecif
->
avÆue
;

51 i‡(
ecif
 =
NULL
 ||Écif->
cif
 == NULL) {

55 i‡((
ecif
->
cif
->
πy≥
 !
NULL
) &&

56 (
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

61 * 
addr
 = 
°ack_¨gs_p
;

62 
	`mem˝y
(
addr
, &(
ecif
->
rvÆue
), 
WORD_SIZE
);

63 
°ack_¨gs_p
 +
WORD_SIZE
;

66 i‡(
ecif
->
avÆue
 =
NULL
) {

70 
i
 = 0, 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
; i <Écif->cif->
«rgs
;

71 
i
++, 
p_¨g
++)

73 
size_t
 
size
 = (*
p_¨g
)->size;

74 
ty≥
 = (*
p_¨g
)->type;

75 * 
vÆue
 = 
p_¨gv
[
i
];

76 * 
addr
 = 
°ack_¨gs_p
;

77 
Æig√d_size
 = 
	`WORD_ALIGN
(
size
);

80 
°ack_¨gs_p
 +
Æig√d_size
;

82 
ty≥
)

84 
FFI_TYPE_UINT8
:

85 *(*)
addr
 = ()*(
UINT8
*)(
vÆue
);

87 
FFI_TYPE_SINT8
:

88 *(sig√d *)
addr
 = (sig√d )*(
SINT8
*)(
vÆue
);

90 
FFI_TYPE_UINT16
:

91 *(*)
addr
 = ()*(
UINT16
*)(
vÆue
);

93 
FFI_TYPE_SINT16
:

94 *(sig√d *)
addr
 = (sig√d )*(
SINT16
*)(
vÆue
);

96 
FFI_TYPE_STRUCT
:

97 #i‡
__BIG_ENDIAN__


120 i‡(
size
 < 
WORD_SIZE
)

122 
	`mem˝y
 (
addr
 + (
WORD_SIZE
 - 
size
), 
vÆue
, size);

126 
FFI_TYPE_SINT32
:

127 
FFI_TYPE_UINT32
:

128 
FFI_TYPE_FLOAT
:

129 
FFI_TYPE_SINT64
:

130 
FFI_TYPE_UINT64
:

131 
FFI_TYPE_DOUBLE
:

133 
	`mem˝y
(
addr
, 
vÆue
, 
Æig√d_size
);

136 
	}
}

138 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
* 
cif
)

141 
cif
->
abi
)

143 
FFI_SYSV
:

146  
FFI_BAD_ABI
;

148  
FFI_OK
;

149 
	}
}

151 
ffi_ˇŒ
(
ffi_cif
* 
cif
, (*
‚
)(), * 
rvÆue
, ** 
avÆue
)

153 
exãnded_cif
 
ecif
;

154 
ecif
.
cif
 = cif;

155 
ecif
.
avÆue
 =ávalue;

159 i‡((
rvÆue
 =
NULL
Ë&& (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)) {

160 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

162 
ecif
.
rvÆue
 =Ñvalue;

165 
cif
->
abi
)

167 
FFI_SYSV
:

168 
	`ffi_ˇŒ_SYSV
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
, cif->
Êags
,

169 
ecif
.
rvÆue
, 
‚
, 
cif
->
πy≥
->
ty≥
, cif->πy≥->
size
);

172 
	`FFI_ASSERT
(0);

175 
	}
}

177 
	$ffi_˛osuª_ˇŒ_SYSV
(* 
ªgi°î_¨gs
, * 
°ack_¨gs
,

178 
ffi_˛osuª
* 
˛osuª
, * 
rvÆue
,

179 * 
πy≥
, * 
rsize
)

182 
ffi_cif
* 
cif
 = 
˛osuª
->cif;

183 
ffi_ty≥
** 
¨g_ty≥s
 = 
cif
->arg_types;

190 * 
°ack˛⁄e
 = 
	`Æloˇ
(
cif
->
byãs
);

191 ** 
avÆue
 = 
	`Æloˇ
(
cif
->
«rgs
 * (*));

192 * 
°ru˘_rvÆue
 = 
NULL
;

193 * 
±r
 = 
°ack˛⁄e
;

194 
i
;

197 
ªgi°îs_u£d
 = 
cif
->
byãs
;

198 i‡(
ªgi°îs_u£d
 > 
ARGS_REGISTER_SIZE
) {

199 
ªgi°îs_u£d
 = 
ARGS_REGISTER_SIZE
;

201 
	`mem˝y
(
°ack˛⁄e
, 
ªgi°î_¨gs
, 
ªgi°îs_u£d
);

204 i‡(
cif
->
byãs
 > 
ARGS_REGISTER_SIZE
) {

205 
°ack_u£d
 = 
cif
->
byãs
 - 
ARGS_REGISTER_SIZE
;

206 
	`mem˝y
(
°ack˛⁄e
 + 
ARGS_REGISTER_SIZE
, 
°ack_¨gs
, 
°ack_u£d
);

210 i‡((
cif
->
πy≥
 !
NULL
Ë&& (cif->πy≥->
ty≥
 =
FFI_TYPE_STRUCT
)) {

211 
°ru˘_rvÆue
 = *((**)
±r
);

212 
±r
 +
WORD_SIZE
;

216 
i
 = 0; i < 
cif
->
«rgs
; i++)

218 
¨g_ty≥s
[
i
]->
ty≥
)

220 
FFI_TYPE_SINT8
:

221 
FFI_TYPE_UINT8
:

222 #ifde‡
__BIG_ENDIAN__


223 
avÆue
[
i
] = 
±r
 + 3;

225 
avÆue
[
i
] = 
±r
;

228 
FFI_TYPE_SINT16
:

229 
FFI_TYPE_UINT16
:

230 #ifde‡
__BIG_ENDIAN__


231 
avÆue
[
i
] = 
±r
 + 2;

233 
avÆue
[
i
] = 
±r
;

236 
FFI_TYPE_STRUCT
:

237 #i‡
__BIG_ENDIAN__


242 i‡(
¨g_ty≥s
[
i
]->
size
 < 
WORD_SIZE
)

244 
	`mem˝y
 (
±r
,Öå + (
WORD_SIZE
 - 
¨g_ty≥s
[
i
]->
size
),árg_types[i]->size);

247 
avÆue
[
i
] = (*)
±r
;

249 
FFI_TYPE_UINT64
:

250 
FFI_TYPE_SINT64
:

251 
FFI_TYPE_DOUBLE
:

252 
avÆue
[
i
] = 
±r
;

254 
FFI_TYPE_SINT32
:

255 
FFI_TYPE_UINT32
:

256 
FFI_TYPE_FLOAT
:

259 
avÆue
[
i
] = 
±r
;

262 
±r
 +
	`WORD_ALIGN
(
¨g_ty≥s
[
i
]->
size
);

266 *
rsize
 = 
cif
->
πy≥
->
size
;

267 *
πy≥
 = 
cif
->πy≥->
ty≥
;

268 i‡(
°ru˘_rvÆue
 !
NULL
) {

269 
˛osuª
->
	`fun
(
cif
, 
°ru˘_rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

271 *((**)
rvÆue
Ë
°ru˘_rvÆue
;

273 
˛osuª
->
	`fun
(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

275 
	}
}

277 
ffi_°©us
 
ffi_¥ï_˛osuª_loc
(

278 
ffi_˛osuª
* 
˛osuª
, 
ffi_cif
* 
cif
,

279 (*
fun
)(
ffi_cif
*, *, **, *),

280 * 
u£r_d©a
, * 
codñoc
)

282 * 
åamp
 = (*)&(
˛osuª
->tramp[0]);

283 
˛s
 = ()
codñoc
;

284 
‚
 = 0;

285 
‚_˛osuª_ˇŒ_sysv
 = ()
ffi_˛osuª_ˇŒ_SYSV
;

287 
˛osuª
->
cif
 = cif;

288 
˛osuª
->
fun
 = fun;

289 
˛osuª
->
u£r_d©a
 = user_data;

291 
cif
->
abi
)

293 
FFI_SYSV
:

294 
‚
 = ()
ffi_˛osuª_SYSV
;

298 
åamp
[0] = 0xb0000000 | ((
‚
 >> 16) & 0xffff);

300 
åamp
[1] = 0x31600000 | (
‚
 & 0xffff);

304 
åamp
[2] = 0xb0000000 | ((
˛s
 >> 16) & 0xffff);

306 
åamp
[3] = 0x31800000 | (
˛s
 & 0xffff);

310 
åamp
[4] = 0xb0000000 | ((
‚_˛osuª_ˇŒ_sysv
 >> 16) & 0xffff);

312 
åamp
[5] = 0x30600000 | (
‚_˛osuª_ˇŒ_sysv
 & 0xffff);

314 
åamp
[6] = 0x98085800;

318  
FFI_BAD_ABI
;

320  
FFI_OK
;

321 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/microblaze/ffitarget.h

27 #i‚de‡
LIBFFI_TARGET_H


28 
	#LIBFFI_TARGET_H


	)

30 #i‚de‡
LIBFFI_H


34 #i‚de‡
LIBFFI_ASM


35 
	tffi_¨g
;

36 sig√d 
	tffi_ßrg
;

38 
	effi_abi
 {

39 
	mFFI_FIRST_ABI
 = 0,

40 
	mFFI_SYSV
,

41 
	mFFI_LAST_ABI
,

42 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


43 } 
	tffi_abi
;

48 
	#FFI_CLOSURES
 1

	)

49 
	#FFI_NATIVE_RAW_API
 0

	)

51 
	#FFI_TRAMPOLINE_SIZE
 (4*8)

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/microblaze/sysv.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

41 .
	gãxt


42 .
globl
 
	gffi_ˇŒ_SYSV


43 .
ty≥
 
	gffi_ˇŒ_SYSV
, @
fun˘i⁄


44 
	gffi_ˇŒ_SYSV
:

46 
addik
 
r1
, 
	gr1
, -20

47 
swi
 
	gr19
, 
	gr1
, 0

48 
swi
 
	gr20
, 
	gr1
, 4

49 
swi
 
	gr21
, 
	gr1
, 8

50 
swi
 
	gr22
, 
	gr1
, 12

51 
swi
 
	gr23
, 
	gr1
, 16

54 
addik
 
	gr1
,Ñ1, -24

55 
swi
 
	gr5
, 
	gr1
, 0

56 
swi
 
	gr6
, 
	gr1
, 4

57 
swi
 
	gr7
, 
	gr1
, 8

58 
swi
 
	gr8
, 
	gr1
, 12

59 
swi
 
	gr9
, 
	gr1
, 16

60 
swi
 
	gr10
, 
	gr1
, 20

63 
addik
 
	gr3
, 
	gr5
, 0

64 
addik
 
	gr22
, 
	gr1
, 0

65 
addik
 
	gr23
, 
	gr10
, 0

68 
rsub
 
	gr1
, 
	gr7
, 
r1


71 
addik
 
	gr5
, 
	gr1
, 0

75 
addik
 
	gr1
,Ñ1, -4

76 
swi
 
	gr15
, 
	gr1
, 0

77 
bøld
 
	gr15
, 
r3


78 
n›


79 
lwi
 
	gr15
, 
	gr1
, 0

80 
addik
 
	gr1
,Ñ1, 4

84 
lwi
 
	gr5
, 
	gr1
, 0

85 
lwi
 
	gr6
, 
	gr1
, 4

86 
lwi
 
	gr7
, 
	gr1
, 8

87 
lwi
 
	gr8
, 
	gr1
, 12

88 
lwi
 
	gr9
, 
	gr1
, 16

89 
lwi
 
	gr10
, 
	gr1
, 20

92 
addik
 
	gr1
,Ñ1, -4

93 
swi
 
	gr15
, 
	gr1
, 0

94 
bøld
 
	gr15
, 
r23


95 
n›


96 
lwi
 
	gr15
, 
	gr1
, 0

97 
addik
 
	gr1
,Ñ1, 4

100 
addik
 
	gr1
, 
	gr22
, 0

103 
lwi
 
	gr5
, 
	gr1
, 0

104 
lwi
 
	gr6
, 
	gr1
, 4

105 
lwi
 
	gr7
, 
	gr1
, 8

106 
lwi
 
	gr8
, 
	gr1
, 12

107 
lwi
 
	gr9
, 
	gr1
, 16

108 
lwi
 
	gr10
, 
	gr1
, 20

109 
addik
 
	gr1
,Ñ1, 24

112 
beqi
 
	gr9
, 
ffi_ˇŒ_SYSV_íd


114 
lwi
 
	gr22
, 
	gr1
, 48

115 
lwi
 
	gr23
, 
	gr1
, 52

118 
rsubi
 
	gr11
, 
	gr22
, 
FFI_TYPE_STRUCT


119 
beqi
 
	gr11
, 
ffi_ˇŒ_SYSV_íd


122 
rsubi
 
	gr11
, 
	gr23
, 1

123 
beqi
 
	gr11
, 
ffi_ˇŒ_SYSV_°‹e8


126 
rsubi
 
	gr11
, 
	gr23
, 2

127 
beqi
 
	gr11
, 
ffi_ˇŒ_SYSV_°‹e16


130 
rsubi
 
	gr11
, 
	gr23
, 4

131 
beqi
 
	gr11
, 
ffi_ˇŒ_SYSV_°‹e32


134 
rsubi
 
	gr11
, 
	gr23
, 8

135 
beqi
 
	gr11
, 
ffi_ˇŒ_SYSV_°‹e64


138 
bri
 
ffi_ˇŒ_SYSV_íd


140 
	gffi_ˇŒ_SYSV_°‹e64
:

141 
swi
 
r3
, 
	gr9
, 0

142 
swi
 
	gr4
, 
	gr9
, 4

143 
bri
 
ffi_ˇŒ_SYSV_íd


145 
	gffi_ˇŒ_SYSV_°‹e32
:

146 
swi
 
r3
, 
	gr9
, 0

147 
bri
 
ffi_ˇŒ_SYSV_íd


149 
	gffi_ˇŒ_SYSV_°‹e16
:

150 #ifde‡
__BIG_ENDIAN__


151 
shi
 
r3
, 
	gr9
, 2

153 
shi
 
	gr3
, 
	gr9
, 0

155 
bri
 
ffi_ˇŒ_SYSV_íd


157 
	gffi_ˇŒ_SYSV_°‹e8
:

158 #ifde‡
__BIG_ENDIAN__


159 
sbi
 
r3
, 
	gr9
, 3

161 
sbi
 
	gr3
, 
	gr9
, 0

163 
bri
 
ffi_ˇŒ_SYSV_íd


165 
	gffi_ˇŒ_SYSV_íd
:

167 
lwi
 
r19
, 
	gr1
, 0

168 
lwi
 
	gr20
, 
	gr1
, 4

169 
lwi
 
	gr21
, 
	gr1
, 8

170 
lwi
 
	gr22
, 
	gr1
, 12

171 
lwi
 
	gr23
, 
	gr1
, 16

172 
addik
 
	gr1
,Ñ1, 20

175 
πsd
 
	gr15
, 8

176 
	gn›


178 .
size
 
	gffi_ˇŒ_SYSV
, . - ffi_call_SYSV

187 .
	gãxt


188 .
globl
 
	gffi_˛osuª_SYSV


189 .
ty≥
 
	gffi_˛osuª_SYSV
, @
fun˘i⁄


190 
	gffi_˛osuª_SYSV
:

192 
addik
 
r11
, 
	gr1
, 28

193 
addik
 
	gr1
,Ñ1, -12

194 
swi
 
	gr19
, 
	gr1
, 0

195 
swi
 
	gr20
, 
	gr1
, 4

196 
swi
 
	gr21
, 
	gr1
, 8

199 
addik
 
	gr1
,Ñ1, -24

200 
swi
 
	gr5
, 
	gr1
, 0

201 
swi
 
	gr6
, 
	gr1
, 4

202 
swi
 
	gr7
, 
	gr1
, 8

203 
swi
 
	gr8
, 
	gr1
, 12

204 
swi
 
	gr9
, 
	gr1
, 16

205 
swi
 
	gr10
, 
	gr1
, 20

208 
addik
 
	gr5
, 
	gr1
, 0

209 
addik
 
	gr6
, 
	gr11
, 0

210 
addik
 
	gr7
, 
	gr12
, 0

211 
addik
 
	gr1
,Ñ1, -8

212 
addik
 
	gr8
, 
	gr1
, 0

213 
addik
 
	gr1
,Ñ1, -8

214 
addik
 
	gr9
, 
	gr1
, 0

215 
addik
 
	gr10
, 
	gr1
, 4

218 
addik
 
	gr1
,Ñ1, -28

219 
swi
 
	gr15
, 
	gr1
, 0

220 
bøld
 
	gr15
, 
r3


221 
n›


222 
lwi
 
	gr15
, 
	gr1
, 0

223 
addik
 
	gr1
,Ñ1, 28

225 
	gffi_˛osuª_SYSV_¥ï¨e_ªtu∫
:

226 
lwi
 
r9
, 
	gr1
, 0

227 
lwi
 
	gr10
, 
	gr1
, 4

228 
addik
 
	gr1
,Ñ1, 8

231 
rsubi
 
	gr11
, 
	gr9
, 
FFI_TYPE_STRUCT


232 
beqi
 
	gr11
, 
ffi_˛osuª_SYSV_°‹e32


235 
rsubi
 
	gr11
, 
	gr10
, 1

236 
beqi
 
	gr11
, 
ffi_˛osuª_SYSV_°‹e8


239 
rsubi
 
	gr11
, 
	gr10
, 2

240 
beqi
 
	gr11
, 
ffi_˛osuª_SYSV_°‹e16


243 
rsubi
 
	gr11
, 
	gr10
, 4

244 
beqi
 
	gr11
, 
ffi_˛osuª_SYSV_°‹e32


247 
rsubi
 
	gr11
, 
	gr10
, 8

248 
beqi
 
	gr11
, 
ffi_˛osuª_SYSV_°‹e64


251 
bri
 
ffi_˛osuª_SYSV_íd


253 
	gffi_˛osuª_SYSV_°‹e64
:

254 
lwi
 
r3
, 
	gr1
, 0

255 
lwi
 
	gr4
, 
	gr1
, 4

257 
bri
 
ffi_˛osuª_SYSV_íd


259 
	gffi_˛osuª_SYSV_°‹e32
:

260 
lwi
 
r3
, 
	gr1
, 0

262 
bri
 
ffi_˛osuª_SYSV_íd


264 
	gffi_˛osuª_SYSV_°‹e16
:

265 #ifde‡
__BIG_ENDIAN__


266 
lhui
 
r3
, 
	gr1
, 2

268 
lhui
 
	gr3
, 
	gr1
, 0

270 
rsubi
 
	gr11
, 
	gr9
, 
FFI_TYPE_SINT16


271 
b√i
 
	gr11
, 
ffi_˛osuª_SYSV_íd


272 
£xt16
 
	gr3
, 
r3


273 
bri
 
ffi_˛osuª_SYSV_íd


275 
	gffi_˛osuª_SYSV_°‹e8
:

276 #ifde‡
__BIG_ENDIAN__


277 
lbui
 
r3
, 
	gr1
, 3

279 
lbui
 
	gr3
, 
	gr1
, 0

281 
rsubi
 
	gr11
, 
	gr9
, 
FFI_TYPE_SINT8


282 
b√i
 
	gr11
, 
ffi_˛osuª_SYSV_íd


283 
£xt8
 
	gr3
, 
r3


284 
bri
 
ffi_˛osuª_SYSV_íd


286 
	gffi_˛osuª_SYSV_íd
:

287 
addik
 
r1
, 
	gr1
, 8

290 
addik
 
	gr1
,Ñ1, 24

293 
lwi
 
	gr19
, 
	gr1
, 0

294 
lwi
 
	gr20
, 
	gr1
, 4

295 
lwi
 
	gr21
, 
	gr1
, 8

296 
addik
 
	gr1
,Ñ1, 12

299 
πsd
 
	gr15
, 8

300 
	gn›


302 .
size
 
	gffi_˛osuª_SYSV
, . - ffi_closure_SYSV

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/mips/ffi.c

29 
	~<ffi.h
>

30 
	~<ffi_comm⁄.h
>

32 
	~<°dlib.h
>

34 #ifde‡
__GNUC__


35 #i‡(
__GNUC__
 > 4Ë|| ((__GNUC__ =4Ë&& (
__GNUC_MINOR__
 >= 3))

36 
	#USE__BUILTIN___CLEAR_CACHE
 1

	)

40 #i‚de‡
USE__BUILTIN___CLEAR_CACHE


41 #i‡
deföed
(
__O≥nBSD__
)

42 
	~<mùs64/syßrch.h
>

44 
	~<sys/ˇche˘l.h
>

48 #ifde‡
FFI_DEBUG


49 
	#FFI_MIPS_STOP_HERE
(Ë
	`ffi_°›_hîe
()

	)

51 
	#FFI_MIPS_STOP_HERE
(Ëdÿ{} 0)

	)

54 #ifde‡
FFI_MIPS_N32


55 
	#FIX_ARGP
 \

56 
	`FFI_ASSERT
(
¨gp
 <&
°ack
[
byãs
]); \

57 i‡(
¨gp
 =&
°ack
[
byãs
]) \

59 
¨gp
 = 
°ack
; \

60 
	`FFI_MIPS_STOP_HERE
(); \

61 }

	)

63 
	#FIX_ARGP


	)

70 
	$ffi_¥ï_¨gs
(*
°ack
,

71 
exãnded_cif
 *
ecif
,

72 
byãs
,

73 
Êags
)

75 
i
;

76 **
p_¨gv
;

77 *
¨gp
;

78 
ffi_ty≥
 **
p_¨g
;

80 #ifde‡
FFI_MIPS_N32


84 i‡(
byãs
 > 8 * (
ffi_¨g
))

85 
¨gp
 = &
°ack
[
byãs
 - (8 * (
ffi_¨g
))];

87 
¨gp
 = 
°ack
;

89 
¨gp
 = 
°ack
;

92 
	`mem£t
(
°ack
, 0, 
byãs
);

94 #ifde‡
FFI_MIPS_N32


95 i‡–
ecif
->
cif
->
r°ru˘_Êag
 != 0 )

97 i‡–
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 )

100 *(
ffi_¨g
 *Ë
¨gp
 = (ffi_¨gË
ecif
->
rvÆue
;

101 
¨gp
 +(
ffi_¨g
);

102 
FIX_ARGP
;

105 
p_¨gv
 = 
ecif
->
avÆue
;

107 
i
 = 0, 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
; i <Écif->cif->
«rgs
; i++,Ö_arg++)

109 
size_t
 
z
;

110 
a
;

113 
a
 = (*
p_¨g
)->
Æignmít
;

114 i‡(
a
 < (
ffi_¨g
))

115 
a
 = (
ffi_¨g
);

117 i‡((
a
 - 1Ë& (Ë
¨gp
)

119 
¨gp
 = (*Ë
	`ALIGN
◊rgp, 
a
);

120 
FIX_ARGP
;

123 
z
 = (*
p_¨g
)->
size
;

124 i‡(
z
 <(
ffi_¨g
))

126 
ty≥
 = (*
p_¨g
)->type;

127 
z
 = (
ffi_¨g
);

130 i‡(
ty≥
 =
FFI_TYPE_POINTER
)

131 
ty≥
 = (
ecif
->
cif
->
abi
 =
FFI_N64


132 || 
ecif
->
cif
->
abi
 =
FFI_N64_SOFT_FLOAT
)

133 ? 
FFI_TYPE_SINT64
 : 
FFI_TYPE_SINT32
;

135 i‡(
i
 < 8 && (
ecif
->
cif
->
abi
 =
FFI_N32_SOFT_FLOAT


136 || 
ecif
->
cif
->
abi
 =
FFI_N64_SOFT_FLOAT
))

138 
ty≥
)

140 
FFI_TYPE_FLOAT
:

141 
ty≥
 = 
FFI_TYPE_UINT32
;

143 
FFI_TYPE_DOUBLE
:

144 
ty≥
 = 
FFI_TYPE_UINT64
;

150 
ty≥
)

152 
FFI_TYPE_SINT8
:

153 *(
ffi_¨g
 *)
¨gp
 = *(
SINT8
 *)(* 
p_¨gv
);

156 
FFI_TYPE_UINT8
:

157 *(
ffi_¨g
 *)
¨gp
 = *(
UINT8
 *)(* 
p_¨gv
);

160 
FFI_TYPE_SINT16
:

161 *(
ffi_¨g
 *)
¨gp
 = *(
SINT16
 *)(* 
p_¨gv
);

164 
FFI_TYPE_UINT16
:

165 *(
ffi_¨g
 *)
¨gp
 = *(
UINT16
 *)(* 
p_¨gv
);

168 
FFI_TYPE_SINT32
:

169 *(
ffi_¨g
 *)
¨gp
 = *(
SINT32
 *)(* 
p_¨gv
);

172 
FFI_TYPE_UINT32
:

173 #ifde‡
FFI_MIPS_N32


177 *(
ffi_¨g
 *)
¨gp
 = *(
SINT32
 *)(* 
p_¨gv
);

179 *(
ffi_¨g
 *)
¨gp
 = *(
UINT32
 *)(* 
p_¨gv
);

184 
FFI_TYPE_FLOAT
:

185 *(*Ë
¨gp
 = *(*)(* 
p_¨gv
);

190 
	`mem˝y
(
¨gp
, *
p_¨gv
, (*
p_¨g
)->
size
);

196 #ifde‡
FFI_MIPS_O32


197 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

200 
íd
 = (Ë
¨gp
 + 
z
;

201 
ˇp
 = (Ë
°ack
 + 
byãs
;

206 i‡(
íd
 <
ˇp
)

207 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

210 
p‹ti⁄
 = 
ˇp
 - ()
¨gp
;

212 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
p‹ti⁄
);

213 
¨gp
 = 
°ack
;

214 
z
 -
p‹ti⁄
;

215 
	`mem˝y
(
¨gp
, (*)(()(*
p_¨gv
Ë+ 
p‹ti⁄
),

216 
z
);

221 
p_¨gv
++;

222 
¨gp
 +
z
;

223 
FIX_ARGP
;

225 
	}
}

227 #ifde‡
FFI_MIPS_N32


236 
	$ˇlc_n32_°ru˘_Êags
(
so·_Êﬂt
, 
ffi_ty≥
 *
¨g
,

237 *
loc
, *
¨g_ªg
)

239 
Êags
 = 0;

240 
ödex
 = 0;

242 
ffi_ty≥
 *
e
;

244 i‡(
so·_Êﬂt
)

247 (
e
 = 
¨g
->
ñemíts
[
ödex
]))

250 *
loc
 = 
	`ALIGN
(*loc, 
e
->
Æignmít
);

251 i‡(
e
->
ty≥
 =
FFI_TYPE_DOUBLE
)

254 *
¨g_ªg
 = *
loc
 / 
FFI_SIZEOF_ARG
;

255 i‡(*
¨g_ªg
 > 7)

257 
Êags
 +(
FFI_TYPE_DOUBLE
 << (*
¨g_ªg
 * 
FFI_FLAG_BITS
));

258 *
loc
 +
e
->
size
;

261 *
loc
 +
e
->
size
;

262 
ödex
++;

265 *
¨g_ªg
 = 
	`ALIGN
(*
loc
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

267  
Êags
;

268 
	}
}

271 
	$ˇlc_n32_ªtu∫_°ru˘_Êags
(
so·_Êﬂt
, 
ffi_ty≥
 *
¨g
)

273 
Êags
 = 0;

274 
smÆl
 = 
FFI_TYPE_SMALLSTRUCT
;

275 
ffi_ty≥
 *
e
;

284 i‡(
¨g
->
size
 > 16)

287 i‡(
¨g
->
size
 > 8)

288 
smÆl
 = 
FFI_TYPE_SMALLSTRUCT2
;

290 
e
 = 
¨g
->
ñemíts
[0];

292 i‡(
e
->
ty≥
 =
FFI_TYPE_DOUBLE
)

293 
Êags
 = 
FFI_TYPE_DOUBLE
;

294 i‡(
e
->
ty≥
 =
FFI_TYPE_FLOAT
)

295 
Êags
 = 
FFI_TYPE_FLOAT
;

297 i‡(
Êags
 && (
e
 = 
¨g
->
ñemíts
[1]))

299 i‡(
e
->
ty≥
 =
FFI_TYPE_DOUBLE
)

300 
Êags
 +
FFI_TYPE_DOUBLE
 << 
FFI_FLAG_BITS
;

301 i‡(
e
->
ty≥
 =
FFI_TYPE_FLOAT
)

302 
Êags
 +
FFI_TYPE_FLOAT
 << 
FFI_FLAG_BITS
;

304  
smÆl
;

306 i‡(
Êags
 && (
¨g
->
ñemíts
[2]))

310  
smÆl
;

312 i‡(
so·_Êﬂt
)

313 
Êags
 +
FFI_TYPE_STRUCT_SOFT
;

316 i‡(!
Êags
)

317  
smÆl
;

319  
Êags
;

320 
	}
}

325 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

327 
cif
->
Êags
 = 0;

329 #ifde‡
FFI_MIPS_O32


334 i‡(
cif
->
πy≥
->
ty≥
 !
FFI_TYPE_STRUCT
 && cif->
abi
 =
FFI_O32
)

336 i‡(
cif
->
«rgs
 > 0)

338 (
cif
->
¨g_ty≥s
)[0]->
ty≥
)

340 
FFI_TYPE_FLOAT
:

341 
FFI_TYPE_DOUBLE
:

342 
cif
->
Êags
 +(cif->
¨g_ty≥s
)[0]->
ty≥
;

349 i‡(
cif
->
«rgs
 > 1)

353 i‡(
cif
->
Êags
)

355 (
cif
->
¨g_ty≥s
)[1]->
ty≥
)

357 
FFI_TYPE_FLOAT
:

358 
FFI_TYPE_DOUBLE
:

359 
cif
->
Êags
 +(cif->
¨g_ty≥s
)[1]->
ty≥
 << 
FFI_FLAG_BITS
;

372 i‡(
cif
->
abi
 =
FFI_O32_SOFT_FLOAT
)

374 
cif
->
πy≥
->
ty≥
)

376 
FFI_TYPE_VOID
:

377 
FFI_TYPE_STRUCT
:

378 
cif
->
Êags
 +cif->
πy≥
->
ty≥
 << (
FFI_FLAG_BITS
 * 2);

381 
FFI_TYPE_SINT64
:

382 
FFI_TYPE_UINT64
:

383 
FFI_TYPE_DOUBLE
:

384 
cif
->
Êags
 +
FFI_TYPE_UINT64
 << (
FFI_FLAG_BITS
 * 2);

387 
FFI_TYPE_FLOAT
:

389 
cif
->
Êags
 +
FFI_TYPE_INT
 << (
FFI_FLAG_BITS
 * 2);

396 
cif
->
πy≥
->
ty≥
)

398 
FFI_TYPE_VOID
:

399 
FFI_TYPE_STRUCT
:

400 
FFI_TYPE_FLOAT
:

401 
FFI_TYPE_DOUBLE
:

402 
cif
->
Êags
 +cif->
πy≥
->
ty≥
 << (
FFI_FLAG_BITS
 * 2);

405 
FFI_TYPE_SINT64
:

406 
FFI_TYPE_UINT64
:

407 
cif
->
Êags
 +
FFI_TYPE_UINT64
 << (
FFI_FLAG_BITS
 * 2);

411 
cif
->
Êags
 +
FFI_TYPE_INT
 << (
FFI_FLAG_BITS
 * 2);

417 #ifde‡
FFI_MIPS_N32


420 
ty≥
;

421 
¨g_ªg
 = 0;

422 
loc
 = 0;

423 
cou¡
 = (
cif
->
«rgs
 < 8) ? cif->nargs : 8;

424 
ödex
 = 0;

426 
°ru˘_Êags
 = 0;

427 
so·_Êﬂt
 = (
cif
->
abi
 =
FFI_N32_SOFT_FLOAT


428 || 
cif
->
abi
 =
FFI_N64_SOFT_FLOAT
);

430 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

432 
°ru˘_Êags
 = 
	`ˇlc_n32_ªtu∫_°ru˘_Êags
(
so·_Êﬂt
, 
cif
->
πy≥
);

434 i‡(
°ru˘_Êags
 == 0)

439 
¨g_ªg
 = 1;

440 
cou¡
 = (
cif
->
«rgs
 < 7) ? cif->nargs : 7;

442 
cif
->
r°ru˘_Êag
 = !0;

445 
cif
->
r°ru˘_Êag
 = 0;

448 
cif
->
r°ru˘_Êag
 = 0;

450 
cou¡
-- > 0 && 
¨g_ªg
 < 8)

452 
ty≥
 = (
cif
->
¨g_ty≥s
)[
ödex
]->type;

453 i‡(
so·_Êﬂt
)

455 
ty≥
)

457 
FFI_TYPE_FLOAT
:

458 
ty≥
 = 
FFI_TYPE_UINT32
;

460 
FFI_TYPE_DOUBLE
:

461 
ty≥
 = 
FFI_TYPE_UINT64
;

467 
ty≥
)

469 
FFI_TYPE_FLOAT
:

470 
FFI_TYPE_DOUBLE
:

471 
cif
->
Êags
 +=

472 ((
cif
->
¨g_ty≥s
)[
ödex
]->
ty≥
 << (
¨g_ªg
 * 
FFI_FLAG_BITS
));

473 
¨g_ªg
++;

475 
FFI_TYPE_LONGDOUBLE
:

477 
¨g_ªg
 = 
	`ALIGN
(arg_reg, 2);

479 i‡(
so·_Êﬂt
)

481 
¨g_ªg
 += 2;

485 
cif
->
Êags
 +=

486 (
FFI_TYPE_DOUBLE
 << (
¨g_ªg
 * 
FFI_FLAG_BITS
));

487 
¨g_ªg
++;

488 
cif
->
Êags
 +=

489 (
FFI_TYPE_DOUBLE
 << (
¨g_ªg
 * 
FFI_FLAG_BITS
));

490 
¨g_ªg
++;

494 
FFI_TYPE_STRUCT
:

495 
loc
 = 
¨g_ªg
 * 
FFI_SIZEOF_ARG
;

496 
cif
->
Êags
 +
	`ˇlc_n32_°ru˘_Êags
(
so·_Êﬂt
,

497 (
cif
->
¨g_ty≥s
)[
ödex
],

498 &
loc
, &
¨g_ªg
);

502 
¨g_ªg
++;

506 
ödex
++;

510 
cif
->
πy≥
->
ty≥
)

512 
FFI_TYPE_STRUCT
:

514 i‡(
°ru˘_Êags
 == 0)

524 
cif
->
Êags
 +
FFI_TYPE_STRUCT
 << (
FFI_FLAG_BITS
 * 8);

525 
cif
->
Êags
 +
°ru˘_Êags
 << (4 + (
FFI_FLAG_BITS
 * 8));

530 
FFI_TYPE_VOID
:

534 
FFI_TYPE_POINTER
:

535 i‡(
cif
->
abi
 =
FFI_N32_SOFT_FLOAT
 || cif->abò=
FFI_N32
)

536 
cif
->
Êags
 +
FFI_TYPE_SINT32
 << (
FFI_FLAG_BITS
 * 8);

538 
cif
->
Êags
 +
FFI_TYPE_INT
 << (
FFI_FLAG_BITS
 * 8);

541 
FFI_TYPE_FLOAT
:

542 i‡(
so·_Êﬂt
)

544 
cif
->
Êags
 +
FFI_TYPE_SINT32
 << (
FFI_FLAG_BITS
 * 8);

548 
FFI_TYPE_DOUBLE
:

549 i‡(
so·_Êﬂt
)

550 
cif
->
Êags
 +
FFI_TYPE_INT
 << (
FFI_FLAG_BITS
 * 8);

552 
cif
->
Êags
 +cif->
πy≥
->
ty≥
 << (
FFI_FLAG_BITS
 * 8);

555 
FFI_TYPE_LONGDOUBLE
:

558 i‡(
so·_Êﬂt
)

560 
cif
->
Êags
 +
FFI_TYPE_STRUCT
 << (
FFI_FLAG_BITS
 * 8);

561 
cif
->
Êags
 +
FFI_TYPE_SMALLSTRUCT2
 << (4 + (
FFI_FLAG_BITS
 * 8));

565 
cif
->
Êags
 +
FFI_TYPE_STRUCT
 << (
FFI_FLAG_BITS
 * 8);

566 
cif
->
Êags
 +(
FFI_TYPE_DOUBLE


567 + (
FFI_TYPE_DOUBLE
 << 
FFI_FLAG_BITS
))

568 << (4 + (
FFI_FLAG_BITS
 * 8));

572 
cif
->
Êags
 +
FFI_TYPE_INT
 << (
FFI_FLAG_BITS
 * 8);

578  
FFI_OK
;

579 
	}
}

582 
ffi_ˇŒ_O32
((*)(*, 
exãnded_cif
 *, , ),

583 
exãnded_cif
 *, ,

587 
	`ffi_ˇŒ_N32
((*)(*, 
exãnded_cif
 *, , ),

588 
exãnded_cif
 *, ,

591 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

593 
exãnded_cif
 
ecif
;

595 
ecif
.
cif
 = cif;

596 
ecif
.
avÆue
 =ávalue;

601 i‡((
rvÆue
 =
NULL
) &&

602 (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

603 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

605 
ecif
.
rvÆue
 =Ñvalue;

607 
cif
->
abi
)

609 #ifde‡
FFI_MIPS_O32


610 
FFI_O32
:

611 
FFI_O32_SOFT_FLOAT
:

612 
	`ffi_ˇŒ_O32
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
,

613 
cif
->
Êags
, 
ecif
.
rvÆue
, 
‚
);

617 #ifde‡
FFI_MIPS_N32


618 
FFI_N32
:

619 
FFI_N32_SOFT_FLOAT
:

620 
FFI_N64
:

621 
FFI_N64_SOFT_FLOAT
:

623 
c›y_rvÆue
 = 0;

624 
c›y_off£t
 = 0;

625 *
rvÆue_c›y
 = 
ecif
.
rvÆue
;

626 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 && cif->πy≥->
size
 < 16)

631 
rvÆue_c›y
 = 
	`Æloˇ
(16);

632 
c›y_rvÆue
 = 1;

634 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_FLOAT


635 && (
cif
->
abi
 =
FFI_N64_SOFT_FLOAT


636 || 
cif
->
abi
 =
FFI_N32_SOFT_FLOAT
))

638 
rvÆue_c›y
 = 
	`Æloˇ
 (8);

639 
c›y_rvÆue
 = 1;

640 #i‡
	`deföed
(
__MIPSEB__
Ë|| deföed(
_MIPSEB
)

641 
c›y_off£t
 = 4;

644 
	`ffi_ˇŒ_N32
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
,

645 
cif
->
Êags
, 
rvÆue_c›y
, 
‚
);

646 i‡(
c›y_rvÆue
)

647 
	`mem˝y
(
ecif
.
rvÆue
, 
rvÆue_c›y
 + 
c›y_off£t
, 
cif
->
πy≥
->
size
);

653 
	`FFI_ASSERT
(0);

656 
	}
}

658 #i‡
FFI_CLOSURES


659 #i‡
deföed
(
FFI_MIPS_O32
)

660 
ffi_˛osuª_O32
();

662 
ffi_˛osuª_N32
();

665 
ffi_°©us


666 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
 *
˛osuª
,

667 
ffi_cif
 *
cif
,

668 (*
fun
)(
ffi_cif
*,*,**,*),

669 *
u£r_d©a
,

670 *
codñoc
)

672 *
åamp
 = (*Ë&
˛osuª
->tramp[0];

673 * 
‚
;

674 *
˛ór_loˇti⁄
 = (*Ë
codñoc
;

676 #i‡
	`deföed
(
FFI_MIPS_O32
)

677 i‡(
cif
->
abi
 !
FFI_O32
 && cif->abò!
FFI_O32_SOFT_FLOAT
)

678  
FFI_BAD_ABI
;

679 
‚
 = 
ffi_˛osuª_O32
;

681 #i‡
_MIPS_SIM
 ==
_ABIN32


682 i‡(
cif
->
abi
 !
FFI_N32


683 && 
cif
->
abi
 !
FFI_N32_SOFT_FLOAT
)

684  
FFI_BAD_ABI
;

686 i‡(
cif
->
abi
 !
FFI_N64


687 && 
cif
->
abi
 !
FFI_N64_SOFT_FLOAT
)

688  
FFI_BAD_ABI
;

690 
‚
 = 
ffi_˛osuª_N32
;

693 #i‡
	`deföed
(
FFI_MIPS_O32
Ë|| (
_MIPS_SIM
 ==
_ABIN32
)

695 
åamp
[0] = 0x3c190000 | (()
‚
 >> 16);

697 
åamp
[1] = 0x37390000 | (()
‚
 & 0xffff);

699 
åamp
[2] = 0x3c0c0000 | (()
codñoc
 >> 16);

701 
åamp
[3] = 0x03200008;

703 
åamp
[4] = 0x358c0000 | (()
codñoc
 & 0xffff);

707 
åamp
[0] = 0x3c190000 | (()
‚
 >> 48);

709 
åamp
[1] = 0x3c0c0000 | (()
codñoc
 >> 48);

711 
åamp
[2] = 0x37390000 | ((()
‚
 >> 32 ) & 0xffff);

713 
åamp
[3] = 0x358c0000 | ((()
codñoc
 >> 32) & 0xffff);

715 
åamp
[4] = 0x0019cc38;

717 
åamp
[5] = 0x000c6438;

719 
åamp
[6] = 0x37390000 | ((()
‚
 >> 16 ) & 0xffff);

721 
åamp
[7] = 0x358c0000 | ((()
codñoc
 >> 16) & 0xffff);

723 
åamp
[8] = 0x0019cc38;

725 
åamp
[9] = 0x000c6438;

727 
åamp
[10] = 0x37390000 | (()
‚
 & 0xffff);

729 
åamp
[11] = 0x03200008;

731 
åamp
[12] = 0x358c0000 | (()
codñoc
 & 0xffff);

735 
˛osuª
->
cif
 = cif;

736 
˛osuª
->
fun
 = fun;

737 
˛osuª
->
u£r_d©a
 = user_data;

739 #ifde‡
USE__BUILTIN___CLEAR_CACHE


740 
	`__buûtö___˛ór_ˇche
(
˛ór_loˇti⁄
, cÀ¨_loˇti⁄ + 
FFI_TRAMPOLINE_SIZE
);

742 
	`ˇcheÊush
 (
˛ór_loˇti⁄
, 
FFI_TRAMPOLINE_SIZE
, 
ICACHE
);

744  
FFI_OK
;

745 
	}
}

765 
	$ffi_˛osuª_mùs_ö√r_O32
 (
ffi_˛osuª
 *
˛osuª
,

766 *
rvÆue
, 
ffi_¨g
 *
¨
,

767 *
Âr
)

769 
ffi_cif
 *
cif
;

770 **
avÆuï
;

771 
ffi_¨g
 *
avÆue
;

772 
ffi_ty≥
 **
¨g_ty≥s
;

773 
i
, 
avn
, 
¨gn
, 
£í_öt
;

775 
cif
 = 
˛osuª
->cif;

776 
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 *  (
ffi_¨g
));

777 
avÆuï
 = 
	`Æloˇ
 (
cif
->
«rgs
 *  (
ffi_¨g
));

779 
£í_öt
 = (
cif
->
abi
 =
FFI_O32_SOFT_FLOAT
);

780 
¨gn
 = 0;

782 i‡((
cif
->
Êags
 >> (
FFI_FLAG_BITS
 * 2)Ë=
FFI_TYPE_STRUCT
)

784 
rvÆue
 = (*)(
UINT32
)
¨
[0];

785 
¨gn
 = 1;

788 
i
 = 0;

789 
avn
 = 
cif
->
«rgs
;

790 
¨g_ty≥s
 = 
cif
->arg_types;

792 
i
 < 
avn
)

794 i‡(
i
 < 2 && !
£í_öt
 &&

795 (
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_FLOAT
 ||

796 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_DOUBLE
 ||

797 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_LONGDOUBLE
))

799 #i‡
	`deföed
(
__MIPSEB__
Ë|| deföed(
_MIPSEB
)

800 i‡(
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_FLOAT
)

801 
avÆuï
[
i
] = ((*Ë&
Âr
[i]) +  ();

804 
avÆuï
[
i
] = (*Ë&
Âr
[i];

808 i‡(
¨g_ty≥s
[
i
]->
Æignmít
 =8 && (
¨gn
 & 0x1))

809 
¨gn
++;

810 
¨g_ty≥s
[
i
]->
ty≥
)

812 
FFI_TYPE_SINT8
:

813 
avÆuï
[
i
] = &
avÆue
[i];

814 *(
SINT8
 *Ë&
avÆue
[
i
] = (SINT8Ë
¨
[
¨gn
];

817 
FFI_TYPE_UINT8
:

818 
avÆuï
[
i
] = &
avÆue
[i];

819 *(
UINT8
 *Ë&
avÆue
[
i
] = (UINT8Ë
¨
[
¨gn
];

822 
FFI_TYPE_SINT16
:

823 
avÆuï
[
i
] = &
avÆue
[i];

824 *(
SINT16
 *Ë&
avÆue
[
i
] = (SINT16Ë
¨
[
¨gn
];

827 
FFI_TYPE_UINT16
:

828 
avÆuï
[
i
] = &
avÆue
[i];

829 *(
UINT16
 *Ë&
avÆue
[
i
] = (UINT16Ë
¨
[
¨gn
];

833 
avÆuï
[
i
] = (*Ë&
¨
[
¨gn
];

836 
£í_öt
 = 1;

838 
¨gn
 +
	`ALIGN
(
¨g_ty≥s
[
i
]->
size
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

839 
i
++;

843 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆuï
, closuª->
u£r_d©a
);

845 i‡(
cif
->
abi
 =
FFI_O32_SOFT_FLOAT
)

847 
cif
->
πy≥
->
ty≥
)

849 
FFI_TYPE_FLOAT
:

850  
FFI_TYPE_INT
;

851 
FFI_TYPE_DOUBLE
:

852  
FFI_TYPE_UINT64
;

854  
cif
->
πy≥
->
ty≥
;

859  
cif
->
πy≥
->
ty≥
;

861 
	}
}

863 #i‡
deföed
(
FFI_MIPS_N32
)

866 
	$c›y_°ru˘_N32
(*
èrgë
, 
off£t
, 
ffi_abi
 
abi
, 
ffi_ty≥
 *
ty≥
,

867 
¨gn
, 
¨g_off£t
, 
ffi_¨g
 *
¨
,

868 
ffi_¨g
 *
Âr
, 
so·_Êﬂt
)

870 
ffi_ty≥
 **
ñt_ty≥p
 = 
ty≥
->
ñemíts
;

871 *
ñt_ty≥p
)

873 
ffi_ty≥
 *
ñt_ty≥
 = *
ñt_ty≥p
;

874 
o
;

875 *
ç
;

876 *
¨gp
;

877 *
Âp
;

879 
o
 = 
	`ALIGN
(
off£t
, 
ñt_ty≥
->
Æignmít
);

880 
¨g_off£t
 +
o
 - 
off£t
;

881 
off£t
 = 
o
;

882 
¨gn
 +
¨g_off£t
 / (
ffi_¨g
);

883 
¨g_off£t
 =árg_off£à% (
ffi_¨g
);

885 
¨gp
 = (*)(
¨
 + 
¨gn
);

886 
Âp
 = (*)(
¨gn
 >8 ? 
¨
 +árg¿: 
Âr
 +árgn);

888 
ç
 = 
èrgë
 + 
off£t
;

890 i‡(
ñt_ty≥
->
ty≥
 =
FFI_TYPE_DOUBLE
 && !
so·_Êﬂt
)

891 *(*)
ç
 = *(*)
Âp
;

893 
	`mem˝y
(
ç
, 
¨gp
 + 
¨g_off£t
, 
ñt_ty≥
->
size
);

895 
off£t
 +
ñt_ty≥
->
size
;

896 
¨g_off£t
 +
ñt_ty≥
->
size
;

897 
ñt_ty≥p
++;

898 
¨gn
 +
¨g_off£t
 / (
ffi_¨g
);

899 
¨g_off£t
 =árg_off£à% (
ffi_¨g
);

901 
	}
}

919 
	$ffi_˛osuª_mùs_ö√r_N32
 (
ffi_˛osuª
 *
˛osuª
,

920 *
rvÆue
, 
ffi_¨g
 *
¨
,

921 
ffi_¨g
 *
Âr
)

923 
ffi_cif
 *
cif
;

924 **
avÆuï
;

925 
ffi_¨g
 *
avÆue
;

926 
ffi_ty≥
 **
¨g_ty≥s
;

927 
i
, 
avn
, 
¨gn
;

928 
so·_Êﬂt
;

929 
ffi_¨g
 *
¨gp
;

931 
cif
 = 
˛osuª
->cif;

932 
so·_Êﬂt
 = 
cif
->
abi
 =
FFI_N64_SOFT_FLOAT


933 || 
cif
->
abi
 =
FFI_N32_SOFT_FLOAT
;

934 
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 *  (
ffi_¨g
));

935 
avÆuï
 = 
	`Æloˇ
 (
cif
->
«rgs
 *  (
ffi_¨g
));

937 
¨gn
 = 0;

939 i‡(
cif
->
r°ru˘_Êag
)

941 #i‡
_MIPS_SIM
==
_ABIN32


942 
rvÆue
 = (*)(
UINT32
)
¨
[0];

944 
rvÆue
 = (*)
¨
[0];

946 
¨gn
 = 1;

949 
i
 = 0;

950 
avn
 = 
cif
->
«rgs
;

951 
¨g_ty≥s
 = 
cif
->arg_types;

953 
i
 < 
avn
)

955 i‡(
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_FLOAT


956 || 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_DOUBLE


957 || 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_LONGDOUBLE
)

959 
¨gp
 = (
¨gn
 >8 || 
so·_Êﬂt
Ë? 
¨
 +árg¿: 
Âr
 +árgn;

960 i‡((
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_LONGDOUBLE
Ë&& (()
¨gp
 & (¨g_ty≥s[i]->
Æignmít
-1)))

962 
¨gp
=(
ffi_¨g
*)
	`ALIGN
◊rgp,
¨g_ty≥s
[
i
]->
Æignmít
);

963 
¨gn
++;

965 #i‡
	`deföed
(
__MIPSEB__
Ë|| deföed(
_MIPSEB
)

966 i‡(
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_FLOAT
 && 
¨gn
 < 8)

967 
avÆuï
[
i
] = ((*Ë
¨gp
) +  ();

970 
avÆuï
[
i
] = (*Ë
¨gp
;

974 
ty≥
 = 
¨g_ty≥s
[
i
]->type;

976 i‡(
¨g_ty≥s
[
i
]->
Æignmít
 > (
ffi_¨g
))

977 
¨gn
 = 
	`ALIGN
◊rgn, 
¨g_ty≥s
[
i
]->
Æignmít
 / (
ffi_¨g
));

979 
¨gp
 = 
¨
 + 
¨gn
;

982 i‡(
ty≥
 =
FFI_TYPE_POINTER
)

983 
ty≥
 = (
cif
->
abi
 =
FFI_N64
 || cif->abò=
FFI_N64_SOFT_FLOAT
)

984 ? 
FFI_TYPE_SINT64
 : 
FFI_TYPE_SINT32
;

986 i‡(
so·_Êﬂt
 && 
ty≥
 =
FFI_TYPE_FLOAT
)

987 
ty≥
 = 
FFI_TYPE_UINT32
;

989 
ty≥
)

991 
FFI_TYPE_SINT8
:

992 
avÆuï
[
i
] = &
avÆue
[i];

993 *(
SINT8
 *Ë&
avÆue
[
i
] = (SINT8Ë*
¨gp
;

996 
FFI_TYPE_UINT8
:

997 
avÆuï
[
i
] = &
avÆue
[i];

998 *(
UINT8
 *Ë&
avÆue
[
i
] = (UINT8Ë*
¨gp
;

1001 
FFI_TYPE_SINT16
:

1002 
avÆuï
[
i
] = &
avÆue
[i];

1003 *(
SINT16
 *Ë&
avÆue
[
i
] = (SINT16Ë*
¨gp
;

1006 
FFI_TYPE_UINT16
:

1007 
avÆuï
[
i
] = &
avÆue
[i];

1008 *(
UINT16
 *Ë&
avÆue
[
i
] = (UINT16Ë*
¨gp
;

1011 
FFI_TYPE_SINT32
:

1012 
avÆuï
[
i
] = &
avÆue
[i];

1013 *(
SINT32
 *Ë&
avÆue
[
i
] = (SINT32Ë*
¨gp
;

1016 
FFI_TYPE_UINT32
:

1017 
avÆuï
[
i
] = &
avÆue
[i];

1018 *(
UINT32
 *Ë&
avÆue
[
i
] = (UINT32Ë*
¨gp
;

1021 
FFI_TYPE_STRUCT
:

1022 i‡(
¨gn
 < 8)

1026 
avÆuï
[
i
] = 
	`Æloˇ
(
¨g_ty≥s
[i]->
size
);

1027 
	`c›y_°ru˘_N32
(
avÆuï
[
i
], 0, 
cif
->
abi
, 
¨g_ty≥s
[i],

1028 
¨gn
, 0, 
¨
, 
Âr
, 
so·_Êﬂt
);

1034 
avÆuï
[
i
] = (*Ë
¨gp
;

1038 
¨gn
 +
	`ALIGN
(
¨g_ty≥s
[
i
]->
size
, (
ffi_¨g
)) / (ffi_arg);

1039 
i
++;

1043 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆuï
, closuª->
u£r_d©a
);

1045  
cif
->
Êags
 >> (
FFI_FLAG_BITS
 * 8);

1046 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/mips/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


35 #ifde‡
löux


36 
	~<asm/sgidefs.h
>

37 #ñi‡
deföed
(
__πems__
)

41 
	#_MIPS_SIM_ABI32
 1

	)

42 
	#_MIPS_SIM_NABI32
 2

	)

43 
	#_MIPS_SIM_ABI64
 3

	)

44 #ñi‡!
deföed
(
__O≥nBSD__
)

45 
	~<sgidefs.h
>

48 #i‚de‡
_ABIN32


49 
	#_ABIN32
 
_MIPS_SIM_NABI32


	)

51 #i‚de‡
_ABI64


52 
	#_ABI64
 
_MIPS_SIM_ABI64


	)

54 #i‚de‡
_ABIO32


55 
	#_ABIO32
 
_MIPS_SIM_ABI32


	)

58 #i‡!
deföed
(
_MIPS_SIM
)

59 #îr‹ -- 
somëhög
 
is
 
vîy
 
wr⁄g
 --

61 #i‡(
_MIPS_SIM
==
_ABIN32
 && 
deföed
(_ABIN32)Ë|| (_MIPS_SIM==
_ABI64
 && defined(_ABI64))

62 
	#FFI_MIPS_N32


	)

64 #i‡(
_MIPS_SIM
==
_ABIO32
 && 
deföed
(_ABIO32))

65 
	#FFI_MIPS_O32


	)

67 #îr‹ -- 
this
 
is
 
™
 
unsuµ‹ãd
 
∂©f‹m
 --

72 #ifde‡
FFI_MIPS_O32


74 
	#FFI_SIZEOF_ARG
 4

	)

77 
	#FFI_SIZEOF_ARG
 8

	)

78 #i‡
_MIPS_SIM
 =
_ABIN32


79 
	#FFI_SIZEOF_JAVA_RAW
 4

	)

83 
	#FFI_FLAG_BITS
 2

	)

88 
	#FFI_ARGS_D
 
FFI_TYPE_DOUBLE


	)

89 
	#FFI_ARGS_F
 
FFI_TYPE_FLOAT


	)

90 
	#FFI_ARGS_DD
 
FFI_TYPE_DOUBLE
 * 4 + 
	)
FFI_TYPE_DOUBLE

91 
	#FFI_ARGS_FF
 
FFI_TYPE_FLOAT
 * 4 + 
	)
FFI_TYPE_FLOAT

92 
	#FFI_ARGS_FD
 
FFI_TYPE_DOUBLE
 * 4 + 
FFI_TYPE_FLOAT


	)

93 
	#FFI_ARGS_DF
 
FFI_TYPE_FLOAT
 * 4 + 
FFI_TYPE_DOUBLE


	)

96 
	#FFI_TYPE_SMALLSTRUCT
 
FFI_TYPE_UINT8


	)

97 
	#FFI_TYPE_SMALLSTRUCT2
 
FFI_TYPE_SINT8


	)

101 
	#FFI_TYPE_STRUCT_DD
 (–
FFI_ARGS_DD
 ) << 4Ë+ 
FFI_TYPE_STRUCT


	)

105 
	#FFI_TYPE_STRUCT_D
 61

	)

106 
	#FFI_TYPE_STRUCT_F
 45

	)

107 
	#FFI_TYPE_STRUCT_DD
 253

	)

108 
	#FFI_TYPE_STRUCT_FF
 173

	)

109 
	#FFI_TYPE_STRUCT_FD
 237

	)

110 
	#FFI_TYPE_STRUCT_DF
 189

	)

111 
	#FFI_TYPE_STRUCT_SMALL
 93

	)

112 
	#FFI_TYPE_STRUCT_SMALL2
 109

	)

115 
	#FFI_TYPE_STRUCT_D_SOFT
 317

	)

116 
	#FFI_TYPE_STRUCT_F_SOFT
 301

	)

117 
	#FFI_TYPE_STRUCT_DD_SOFT
 509

	)

118 
	#FFI_TYPE_STRUCT_FF_SOFT
 429

	)

119 
	#FFI_TYPE_STRUCT_FD_SOFT
 493

	)

120 
	#FFI_TYPE_STRUCT_DF_SOFT
 445

	)

121 
	#FFI_TYPE_STRUCT_SOFT
 16

	)

124 #ifde‡
LIBFFI_ASM


125 
	#v0
 
$2


	)

126 
	#v1
 
$3


	)

127 
	#a0
 
$4


	)

128 
	#a1
 
$5


	)

129 
	#a2
 
$6


	)

130 
	#a3
 
$7


	)

131 
	#a4
 
$8


	)

132 
	#a5
 
$9


	)

133 
	#a6
 
$10


	)

134 
	#a7
 
$11


	)

135 
	#t0
 
$8


	)

136 
	#t1
 
$9


	)

137 
	#t2
 
$10


	)

138 
	#t3
 
$11


	)

139 
	#t4
 
$12


	)

140 
	#t5
 
$13


	)

141 
	#t6
 
$14


	)

142 
	#t7
 
$15


	)

143 
	#t8
 
$24


	)

144 
	#t9
 
$25


	)

145 
	#ø
 
$31


	)

147 #ifde‡
FFI_MIPS_O32


148 
	#REG_L
 
lw


	)

149 
	#REG_S
 
sw


	)

150 
	#SUBU
 
subu


	)

151 
	#ADDU
 
addu


	)

152 
	#SRL
 
§l


	)

153 
	#LI
 
li


	)

155 
	#REG_L
 
ld


	)

156 
	#REG_S
 
sd


	)

157 
	#SUBU
 
dsubu


	)

158 
	#ADDU
 
daddu


	)

159 
	#SRL
 
d§l


	)

160 
	#LI
 
dli


	)

161 #i‡(
_MIPS_SIM
==
_ABI64
)

162 
	#LA
 
dœ


	)

163 
	#EH_FRAME_ALIGN
 3

	)

164 
	#FDE_ADDR_BYTES
 .8b
yã


	)

166 
	#LA
 
œ


	)

167 
	#EH_FRAME_ALIGN
 2

	)

168 
	#FDE_ADDR_BYTES
 .4b
yã


	)

172 #ifde‡
__GNUC__


173 #ifde‡
FFI_MIPS_O32


175 
	tffi_¨g
 
	t__©åibuã__
((
	t__mode__
(
	t__SI__
)));

176 sig√d 
	tffi_ßrg
 
	t__©åibuã__
((
	t__mode__
(
	t__SI__
)));

179 
	tffi_¨g
 
	t__©åibuã__
((
	t__mode__
(
	t__DI__
)));

180 sig√d 
	tffi_ßrg
 
	t__©åibuã__
((
	t__mode__
(
	t__DI__
)));

183 #ifde‡
FFI_MIPS_O32


185 
__uöt32_t
 
	tffi_¨g
;

186 
__öt32_t
 
	tffi_ßrg
;

189 
__uöt64_t
 
	tffi_¨g
;

190 
__öt64_t
 
	tffi_ßrg
;

194 
	effi_abi
 {

195 
	mFFI_FIRST_ABI
 = 0,

196 
	mFFI_O32
,

197 
	mFFI_N32
,

198 
	mFFI_N64
,

199 
	mFFI_O32_SOFT_FLOAT
,

200 
	mFFI_N32_SOFT_FLOAT
,

201 
	mFFI_N64_SOFT_FLOAT
,

202 
	mFFI_LAST_ABI
,

204 #ifde‡
FFI_MIPS_O32


205 #ifde‡
__mùs_so·_Êﬂt


206 
	mFFI_DEFAULT_ABI
 = 
FFI_O32_SOFT_FLOAT


208 
FFI_DEFAULT_ABI
 = 
FFI_O32


211 #i‡
_MIPS_SIM
==
_ABI64


212 #ifde‡
__mùs_so·_Êﬂt


213 
FFI_DEFAULT_ABI
 = 
FFI_N64_SOFT_FLOAT


215 
FFI_DEFAULT_ABI
 = 
FFI_N64


218 #ifde‡
__mùs_so·_Êﬂt


219 
FFI_DEFAULT_ABI
 = 
FFI_N32_SOFT_FLOAT


221 
FFI_DEFAULT_ABI
 = 
FFI_N32


225 } 
	tffi_abi
;

227 
	#FFI_EXTRA_CIF_FIELDS
 
r°ru˘_Êag


	)

232 #i‡
deföed
(
FFI_MIPS_O32
)

233 
	#FFI_CLOSURES
 1

	)

234 
	#FFI_TRAMPOLINE_SIZE
 20

	)

237 
	#FFI_CLOSURES
 1

	)

238 #i‡
_MIPS_SIM
==
_ABI64


239 
	#FFI_TRAMPOLINE_SIZE
 52

	)

241 
	#FFI_TRAMPOLINE_SIZE
 20

	)

244 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/mips/n32.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

33 #i‡
deföed
(
FFI_MIPS_N32
)

35 
	#ˇŒback
 
a0


	)

36 
	#byãs
 
a2


	)

37 
	#Êags
 
a3


	)

38 
	#øddr
 
a4


	)

39 
	#‚
 
a5


	)

41 
	#SIZEOF_FRAME
 ( 8 * 
FFI_SIZEOF_ARG
 )

	)

43 #ifde‡
__GNUC__


44 .
	gabiˇŒs


46 .
£t
 
	gmùs4


47 .
	gãxt


48 .
	gÆign
 2

49 .
globl
 
	gffi_ˇŒ_N32


50 .
ít
 
ffi_ˇŒ_N32


51 
	gffi_ˇŒ_N32
:

52 .
LFB3
:

53 .
‰ame
 
$Â
, 
	gSIZEOF_FRAME
, 
	gø


54 .
	gmask
 0xc0000000,-
	gFFI_SIZEOF_ARG


55 .
	gfmask
 0x00000000,0

58 
SUBU
 
	g$•
, 
	gSIZEOF_FRAME
 #Fømê
	gsize


59 .
	gLCFI0
:

60 
REG_S
 
$Â
, 
	gSIZEOF_FRAME
 - 2*
	$FFI_SIZEOF_ARG
(
$•
Ë#Savê
‰ame
 
poöãr


61 
REG_S
 
ø
, 
SIZEOF_FRAME
 - 1*
	$FFI_SIZEOF_ARG
(
$•
Ë#Savê 
addªss


62 .
LCFI1
:

63 
move
 
$Â
, 
$•


64 .
LCFI3
:

65 
move
 
t9
, 
ˇŒback
 #ˇŒback 
fun˘i⁄
 
poöãr


66 
REG_S
 
byãs
, 2*
	$FFI_SIZEOF_ARG
(
$Â
) #bytes

67 
REG_S
 
Êags
, 3*
	$FFI_SIZEOF_ARG
(
$Â
) #flags

68 
REG_S
 
øddr
, 4*
	$FFI_SIZEOF_ARG
(
$Â
) #raddr

69 
REG_S
 
‚
, 5*
	$FFI_SIZEOF_ARG
(
$Â
) #fn

71 #AŒoˇã 
©
 
Àa°
 4 
w‹ds
 
ö
 
the
 
¨g°ack


72 
move
 
v0
, 
byãs


73 
bge
 
byãs
, 4 * 
FFI_SIZEOF_ARG
, 
biggî


74 
LI
 
v0
, 4 * 
FFI_SIZEOF_ARG


75 
b
 
sixãí


77 
biggî
:

78 
ADDU
 
t4
, 
v0
, 2 * 
FFI_SIZEOF_ARG
 -1 #makê
suª
 
ô
 
is
 
Æig√d


79 
™d
 
v0
, 
t4
, -2 * 
FFI_SIZEOF_ARG
 #tÿ
a
 
¥›î
 
boundry
.

81 
sixãí
:

82 
SUBU
 
$•
, $•, 
v0
 #movê
the
 
°ack
 
poöãr
 
to
 
ªÊe˘
Åhe

83 #¨g 
•a˚


85 
move
 
a0
, 
$•
 #4 * 
FFI_SIZEOF_ARG


86 
ADDU
 
a3
, 
$Â
, 3 * 
FFI_SIZEOF_ARG


88 #CÆ»
ffi_¥ï_¨gs


89 
jÆ
 
t9


91 #C›y 
the
 
°ack
 
poöãr
 
to
 
t9


92 
move
 
t9
, 
$•


94 #Fix 
the
 
°ack
 
thîe
 
¨e
 
m‹e
 
th™
 8 64b
ô
 
¶Ÿs
 
w‹th


95 #o‡
¨gumíts
.

97 #Lﬂd 
the
 
numbî
 
of
 
byãs


98 
REG_L
 
t6
, 2*
	$FFI_SIZEOF_ARG
(
$Â
)

100 #I†
ô
 
biggî
 
th™
 8 * 
FFI_SIZEOF_ARG
?

101 
daddiu
 
t8
, 
t6
, -(8 * 
FFI_SIZEOF_ARG
)

102 
b…z
 
t8
, 
lﬂdªgs


104 
ADDU
 
t9
,Å9, 
t8


106 
lﬂdªgs
:

108 
REG_L
 
t6
, 3*
	$FFI_SIZEOF_ARG
(
$Â
Ë#lﬂd 
the
 
Êags
 
w‹d
 
öto
 
t6
.

110 
™d
 
t4
, 
t6
, ((1<<
FFI_FLAG_BITS
)-1)

111 
REG_L
 
a0
, 0*
	$FFI_SIZEOF_ARG
(
t9
)

112 
beqz
 
t4
, 
¨g1_√xt


113 
b√
 
t4
, 
FFI_TYPE_FLOAT
, 
¨g1_doubÀp


114 
l
.
s
 
$f12
, 0*
	$FFI_SIZEOF_ARG
(
t9
)

115 
b
 
¨g1_√xt


116 
¨g1_doubÀp
:

117 
l
.
d
 
$f12
, 0*
	$FFI_SIZEOF_ARG
(
t9
)

118 
¨g1_√xt
:

120 
SRL
 
t4
, 
t6
, 1*
FFI_FLAG_BITS


121 
™d
 
t4
, ((1<<
FFI_FLAG_BITS
)-1)

122 
REG_L
 
a1
, 1*
	$FFI_SIZEOF_ARG
(
t9
)

123 
beqz
 
t4
, 
¨g2_√xt


124 
b√
 
t4
, 
FFI_TYPE_FLOAT
, 
¨g2_doubÀp


125 
l
.
s
 
$f13
, 1*
	$FFI_SIZEOF_ARG
(
t9
)

126 
b
 
¨g2_√xt


127 
¨g2_doubÀp
:

128 
l
.
d
 
$f13
, 1*
	$FFI_SIZEOF_ARG
(
t9
)

129 
¨g2_√xt
:

131 
SRL
 
t4
, 
t6
, 2*
FFI_FLAG_BITS


132 
™d
 
t4
, ((1<<
FFI_FLAG_BITS
)-1)

133 
REG_L
 
a2
, 2*
	$FFI_SIZEOF_ARG
(
t9
)

134 
beqz
 
t4
, 
¨g3_√xt


135 
b√
 
t4
, 
FFI_TYPE_FLOAT
, 
¨g3_doubÀp


136 
l
.
s
 
$f14
, 2*
	$FFI_SIZEOF_ARG
(
t9
)

137 
b
 
¨g3_√xt


138 
¨g3_doubÀp
:

139 
l
.
d
 
$f14
, 2*
	$FFI_SIZEOF_ARG
(
t9
)

140 
¨g3_√xt
:

142 
SRL
 
t4
, 
t6
, 3*
FFI_FLAG_BITS


143 
™d
 
t4
, ((1<<
FFI_FLAG_BITS
)-1)

144 
REG_L
 
a3
, 3*
	$FFI_SIZEOF_ARG
(
t9
)

145 
beqz
 
t4
, 
¨g4_√xt


146 
b√
 
t4
, 
FFI_TYPE_FLOAT
, 
¨g4_doubÀp


147 
l
.
s
 
$f15
, 3*
	$FFI_SIZEOF_ARG
(
t9
)

148 
b
 
¨g4_√xt


149 
¨g4_doubÀp
:

150 
l
.
d
 
$f15
, 3*
	$FFI_SIZEOF_ARG
(
t9
)

151 
¨g4_√xt
:

153 
SRL
 
t4
, 
t6
, 4*
FFI_FLAG_BITS


154 
™d
 
t4
, ((1<<
FFI_FLAG_BITS
)-1)

155 
REG_L
 
a4
, 4*
	$FFI_SIZEOF_ARG
(
t9
)

156 
beqz
 
t4
, 
¨g5_√xt


157 
b√
 
t4
, 
FFI_TYPE_FLOAT
, 
¨g5_doubÀp


158 
l
.
s
 
$f16
, 4*
	$FFI_SIZEOF_ARG
(
t9
)

159 
b
 
¨g5_√xt


160 
¨g5_doubÀp
:

161 
l
.
d
 
$f16
, 4*
	$FFI_SIZEOF_ARG
(
t9
)

162 
¨g5_√xt
:

164 
SRL
 
t4
, 
t6
, 5*
FFI_FLAG_BITS


165 
™d
 
t4
, ((1<<
FFI_FLAG_BITS
)-1)

166 
REG_L
 
a5
, 5*
	$FFI_SIZEOF_ARG
(
t9
)

167 
beqz
 
t4
, 
¨g6_√xt


168 
b√
 
t4
, 
FFI_TYPE_FLOAT
, 
¨g6_doubÀp


169 
l
.
s
 
$f17
, 5*
	$FFI_SIZEOF_ARG
(
t9
)

170 
b
 
¨g6_√xt


171 
¨g6_doubÀp
:

172 
l
.
d
 
$f17
, 5*
	$FFI_SIZEOF_ARG
(
t9
)

173 
¨g6_√xt
:

175 
SRL
 
t4
, 
t6
, 6*
FFI_FLAG_BITS


176 
™d
 
t4
, ((1<<
FFI_FLAG_BITS
)-1)

177 
REG_L
 
a6
, 6*
	$FFI_SIZEOF_ARG
(
t9
)

178 
beqz
 
t4
, 
¨g7_√xt


179 
b√
 
t4
, 
FFI_TYPE_FLOAT
, 
¨g7_doubÀp


180 
l
.
s
 
$f18
, 6*
	$FFI_SIZEOF_ARG
(
t9
)

181 
b
 
¨g7_√xt


182 
¨g7_doubÀp
:

183 
l
.
d
 
$f18
, 6*
	$FFI_SIZEOF_ARG
(
t9
)

184 
¨g7_√xt
:

186 
SRL
 
t4
, 
t6
, 7*
FFI_FLAG_BITS


187 
™d
 
t4
, ((1<<
FFI_FLAG_BITS
)-1)

188 
REG_L
 
a7
, 7*
	$FFI_SIZEOF_ARG
(
t9
)

189 
beqz
 
t4
, 
¨g8_√xt


190 
b√
 
t4
, 
FFI_TYPE_FLOAT
, 
¨g8_doubÀp


191 
l
.
s
 
$f19
, 7*
	$FFI_SIZEOF_ARG
(
t9
)

192 
b
 
¨g8_√xt


193 
¨g8_doubÀp
:

194 
l
.
d
 
$f19
, 7*
	$FFI_SIZEOF_ARG
(
t9
)

195 
¨g8_√xt
:

197 
ˇŒô
:

198 #Lﬂd 
the
 
fun˘i⁄
 
poöãr


199 
REG_L
 
t9
, 5*
	$FFI_SIZEOF_ARG
(
$Â
)

201 #I‡
the
  
vÆue
 
poöãr
 
is
 
NULL
, 
assume
 
no
  value.

202 
REG_L
 
t5
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

203 
beqz
 
t5
, 
n‹ëvÆ


205 #Shi· 
the
  
ty≥
 
Êag
 
ovî


206 
SRL
 
t6
, 8*
FFI_FLAG_BITS


208 
beq
 
t6
, 
FFI_TYPE_SINT32
, 
ªtöt


209 
b√
 
t6
, 
FFI_TYPE_INT
, 
ªtÊﬂt


210 
ªtöt
:

211 
jÆ
 
t9


212 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

213 
REG_S
 
v0
, 0(
t4
)

214 
b
 
ïûogue


216 
ªtÊﬂt
:

217 
b√
 
t6
, 
FFI_TYPE_FLOAT
, 
ªtdoubÀ


218 
jÆ
 
t9


219 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

220 
s
.†
$f0
, 0(
t4
)

221 
b
 
ïûogue


223 
ªtdoubÀ
:

224 
b√
 
t6
, 
FFI_TYPE_DOUBLE
, 
ªt°ru˘_d


225 
jÆ
 
t9


226 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

227 
s
.
d
 
$f0
, 0(
t4
)

228 
b
 
ïûogue


230 
ªt°ru˘_d
:

231 
b√
 
t6
, 
FFI_TYPE_STRUCT_D
, 
ªt°ru˘_f


232 
jÆ
 
t9


233 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

234 
s
.
d
 
$f0
, 0(
t4
)

235 
b
 
ïûogue


237 
ªt°ru˘_f
:

238 
b√
 
t6
, 
FFI_TYPE_STRUCT_F
, 
ªt°ru˘_d_d


239 
jÆ
 
t9


240 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

241 
s
.†
$f0
, 0(
t4
)

242 
b
 
ïûogue


244 
ªt°ru˘_d_d
:

245 
b√
 
t6
, 
FFI_TYPE_STRUCT_DD
, 
ªt°ru˘_f_f


246 
jÆ
 
t9


247 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

248 
s
.
d
 
$f0
, 0(
t4
)

249 
s
.
d
 
$f2
, 8(
t4
)

250 
b
 
ïûogue


252 
ªt°ru˘_f_f
:

253 
b√
 
t6
, 
FFI_TYPE_STRUCT_FF
, 
ªt°ru˘_d_f


254 
jÆ
 
t9


255 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

256 
s
.†
$f0
, 0(
t4
)

257 
s
.†
$f2
, 4(
t4
)

258 
b
 
ïûogue


260 
ªt°ru˘_d_f
:

261 
b√
 
t6
, 
FFI_TYPE_STRUCT_DF
, 
ªt°ru˘_f_d


262 
jÆ
 
t9


263 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

264 
s
.
d
 
$f0
, 0(
t4
)

265 
s
.†
$f2
, 8(
t4
)

266 
b
 
ïûogue


268 
ªt°ru˘_f_d
:

269 
b√
 
t6
, 
FFI_TYPE_STRUCT_FD
, 
ªt°ru˘_d_so·


270 
jÆ
 
t9


271 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

272 
s
.†
$f0
, 0(
t4
)

273 
s
.
d
 
$f2
, 8(
t4
)

274 
b
 
ïûogue


276 
ªt°ru˘_d_so·
:

277 
b√
 
t6
, 
FFI_TYPE_STRUCT_D_SOFT
, 
ªt°ru˘_f_so·


278 
jÆ
 
t9


279 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

280 
sd
 
v0
, 0(
t4
)

281 
b
 
ïûogue


283 
ªt°ru˘_f_so·
:

284 
b√
 
t6
, 
FFI_TYPE_STRUCT_F_SOFT
, 
ªt°ru˘_d_d_so·


285 
jÆ
 
t9


286 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

287 
sw
 
v0
, 0(
t4
)

288 
b
 
ïûogue


290 
ªt°ru˘_d_d_so·
:

291 
b√
 
t6
, 
FFI_TYPE_STRUCT_DD_SOFT
, 
ªt°ru˘_f_f_so·


292 
jÆ
 
t9


293 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

294 
sd
 
v0
, 0(
t4
)

295 
sd
 
v1
, 8(
t4
)

296 
b
 
ïûogue


298 
ªt°ru˘_f_f_so·
:

299 
b√
 
t6
, 
FFI_TYPE_STRUCT_FF_SOFT
, 
ªt°ru˘_d_f_so·


300 
jÆ
 
t9


301 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

302 
sw
 
v0
, 0(
t4
)

303 
sw
 
v1
, 4(
t4
)

304 
b
 
ïûogue


306 
ªt°ru˘_d_f_so·
:

307 
b√
 
t6
, 
FFI_TYPE_STRUCT_DF_SOFT
, 
ªt°ru˘_f_d_so·


308 
jÆ
 
t9


309 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

310 
sd
 
v0
, 0(
t4
)

311 
sw
 
v1
, 8(
t4
)

312 
b
 
ïûogue


314 
ªt°ru˘_f_d_so·
:

315 
b√
 
t6
, 
FFI_TYPE_STRUCT_FD_SOFT
, 
ªt°ru˘_smÆl


316 
jÆ
 
t9


317 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

318 
sw
 
v0
, 0(
t4
)

319 
sd
 
v1
, 8(
t4
)

320 
b
 
ïûogue


322 
ªt°ru˘_smÆl
:

323 
b√
 
t6
, 
FFI_TYPE_STRUCT_SMALL
, 
ªt°ru˘_smÆl2


324 
jÆ
 
t9


325 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

326 
REG_S
 
v0
, 0(
t4
)

327 
b
 
ïûogue


329 
ªt°ru˘_smÆl2
:

330 
b√
 
t6
, 
FFI_TYPE_STRUCT_SMALL2
, 
ªt°ru˘


331 
jÆ
 
t9


332 
REG_L
 
t4
, 4*
	$FFI_SIZEOF_ARG
(
$Â
)

333 
REG_S
 
v0
, 0(
t4
)

334 
REG_S
 
v1
, 8(
t4
)

335 
b
 
ïûogue


337 
ªt°ru˘
:

338 
n‹ëvÆ
:

339 
jÆ
 
t9


342 
ïûogue
:

343 
move
 
$•
, 
$Â


344 
REG_L
 
$Â
, 
SIZEOF_FRAME
 - 2*
	$FFI_SIZEOF_ARG
(
$•
Ë#Re°‹ê
‰ame
 
poöãr


345 
REG_L
 
ø
, 
SIZEOF_FRAME
 - 1*
	$FFI_SIZEOF_ARG
(
$•
Ë#Re°‹ê 
addªss


346 
ADDU
 
$•
, 
SIZEOF_FRAME
 #Fix 
°ack
 
poöãr


347 
j
 
ø


349 .
LFE3
:

350 .
íd
 
ffi_ˇŒ_N32


382 
	#SIZEOF_FRAME2
 (20 * 
FFI_SIZEOF_ARG
)

	)

384 
	#A7_OFF2
 (19 * 
FFI_SIZEOF_ARG
)

	)

385 
	#A6_OFF2
 (18 * 
FFI_SIZEOF_ARG
)

	)

386 
	#A5_OFF2
 (17 * 
FFI_SIZEOF_ARG
)

	)

387 
	#A4_OFF2
 (16 * 
FFI_SIZEOF_ARG
)

	)

388 
	#A3_OFF2
 (15 * 
FFI_SIZEOF_ARG
)

	)

389 
	#A2_OFF2
 (14 * 
FFI_SIZEOF_ARG
)

	)

390 
	#A1_OFF2
 (13 * 
FFI_SIZEOF_ARG
)

	)

391 
	#A0_OFF2
 (12 * 
FFI_SIZEOF_ARG
)

	)

393 
	#F19_OFF2
 (11 * 
FFI_SIZEOF_ARG
)

	)

394 
	#F18_OFF2
 (10 * 
FFI_SIZEOF_ARG
)

	)

395 
	#F17_OFF2
 (9 * 
FFI_SIZEOF_ARG
)

	)

396 
	#F16_OFF2
 (8 * 
FFI_SIZEOF_ARG
)

	)

397 
	#F15_OFF2
 (7 * 
FFI_SIZEOF_ARG
)

	)

398 
	#F14_OFF2
 (6 * 
FFI_SIZEOF_ARG
)

	)

399 
	#F13_OFF2
 (5 * 
FFI_SIZEOF_ARG
)

	)

400 
	#F12_OFF2
 (4 * 
FFI_SIZEOF_ARG
)

	)

402 
	#V1_OFF2
 (3 * 
FFI_SIZEOF_ARG
)

	)

403 
	#V0_OFF2
 (2 * 
FFI_SIZEOF_ARG
)

	)

405 
	#RA_OFF2
 (1 * 
FFI_SIZEOF_ARG
)

	)

406 
	#GP_OFF2
 (0 * 
FFI_SIZEOF_ARG
)

	)

408 .
Æign
 2

409 .
globl
 
ffi_˛osuª_N32


410 .
ít
 
ffi_˛osuª_N32


411 
ffi_˛osuª_N32
:

412 .
LFB2
:

413 .
‰ame
 
$•
, 
SIZEOF_FRAME2
, 
ø


414 .
mask
 0x90000000,-(
SIZEOF_FRAME2
 - 
RA_OFF2
)

415 .
fmask
 0x00000000,0

416 
SUBU
 
$•
, 
SIZEOF_FRAME2


417 .
LCFI5
:

418 .
˝£tup
 
t9
, 
GP_OFF2
, 
ffi_˛osuª_N32


419 
REG_S
 
ø
, 
	$RA_OFF2
(
$•
Ë#Savê 
addªss


420 .
LCFI6
:

421 #St‹ê
Æl
 
possibÀ
 
¨gumít
 
ªgi°îs
. 
If
 
thîe
 
¨e
 
m‹e
 
th™


422 #fô 
ö
 
ªgi°îs
, 
thí
 
they
 
wîe
 
°‹ed
 
⁄
 
the
 
°ack
.

423 
REG_S
 
a0
, 
	$A0_OFF2
(
$•
)

424 
REG_S
 
a1
, 
	$A1_OFF2
(
$•
)

425 
REG_S
 
a2
, 
	$A2_OFF2
(
$•
)

426 
REG_S
 
a3
, 
	$A3_OFF2
(
$•
)

427 
REG_S
 
a4
, 
	$A4_OFF2
(
$•
)

428 
REG_S
 
a5
, 
	$A5_OFF2
(
$•
)

429 
REG_S
 
a6
, 
	$A6_OFF2
(
$•
)

430 
REG_S
 
a7
, 
	$A7_OFF2
(
$•
)

432 #St‹ê
Æl
 
possibÀ
 /
ªgi°îs
.

433 
s
.
d
 
$f12
, 
	$F12_OFF2
(
$•
)

434 
s
.
d
 
$f13
, 
	$F13_OFF2
(
$•
)

435 
s
.
d
 
$f14
, 
	$F14_OFF2
(
$•
)

436 
s
.
d
 
$f15
, 
	$F15_OFF2
(
$•
)

437 
s
.
d
 
$f16
, 
	$F16_OFF2
(
$•
)

438 
s
.
d
 
$f17
, 
	$F17_OFF2
(
$•
)

439 
s
.
d
 
$f18
, 
	$F18_OFF2
(
$•
)

440 
s
.
d
 
$f19
, 
	$F19_OFF2
(
$•
)

442 #CÆ»
ffi_˛osuª_mùs_ö√r_N32
 
to
 dÿ
the
 
ªÆ
 
w‹k
.

443 
LA
 
t9
, 
ffi_˛osuª_mùs_ö√r_N32


444 
move
 
a0
, 
$12
 #Poöã∏
to
 
the
 
ffi_˛osuª


445 
ADDU
 
a1
, 
$•
, 
V0_OFF2


446 
ADDU
 
a2
, 
$•
, 
A0_OFF2


447 
ADDU
 
a3
, 
$•
, 
F12_OFF2


448 
jÆr
 
t9


450 #Rëu∫ 
Êags
 
¨e
 
ö
 
v0


451 
b√
 
v0
, 
FFI_TYPE_SINT32
, 
˛s_ªtöt


452 
lw
 
v0
, 
	$V0_OFF2
(
$•
)

453 
b
 
˛s_ïûogue


455 
˛s_ªtöt
:

456 
b√
 
v0
, 
FFI_TYPE_INT
, 
˛s_ªtÊﬂt


457 
REG_L
 
v0
, 
	$V0_OFF2
(
$•
)

458 
b
 
˛s_ïûogue


460 
˛s_ªtÊﬂt
:

461 
b√
 
v0
, 
FFI_TYPE_FLOAT
, 
˛s_ªtdoubÀ


462 
l
.
s
 
$f0
, 
	$V0_OFF2
(
$•
)

463 
b
 
˛s_ïûogue


465 
˛s_ªtdoubÀ
:

466 
b√
 
v0
, 
FFI_TYPE_DOUBLE
, 
˛s_ªt°ru˘_d


467 
l
.
d
 
$f0
, 
	$V0_OFF2
(
$•
)

468 
b
 
˛s_ïûogue


470 
˛s_ªt°ru˘_d
:

471 
b√
 
v0
, 
FFI_TYPE_STRUCT_D
, 
˛s_ªt°ru˘_f


472 
l
.
d
 
$f0
, 
	$V0_OFF2
(
$•
)

473 
b
 
˛s_ïûogue


475 
˛s_ªt°ru˘_f
:

476 
b√
 
v0
, 
FFI_TYPE_STRUCT_F
, 
˛s_ªt°ru˘_d_d


477 
l
.
s
 
$f0
, 
	$V0_OFF2
(
$•
)

478 
b
 
˛s_ïûogue


480 
˛s_ªt°ru˘_d_d
:

481 
b√
 
v0
, 
FFI_TYPE_STRUCT_DD
, 
˛s_ªt°ru˘_f_f


482 
l
.
d
 
$f0
, 
	$V0_OFF2
(
$•
)

483 
l
.
d
 
$f2
, 
	$V1_OFF2
(
$•
)

484 
b
 
˛s_ïûogue


486 
˛s_ªt°ru˘_f_f
:

487 
b√
 
v0
, 
FFI_TYPE_STRUCT_FF
, 
˛s_ªt°ru˘_d_f


488 
l
.
s
 
$f0
, 
	$V0_OFF2
(
$•
)

489 
l
.
s
 
$f2
, 
	$V1_OFF2
(
$•
)

490 
b
 
˛s_ïûogue


492 
˛s_ªt°ru˘_d_f
:

493 
b√
 
v0
, 
FFI_TYPE_STRUCT_DF
, 
˛s_ªt°ru˘_f_d


494 
l
.
d
 
$f0
, 
	$V0_OFF2
(
$•
)

495 
l
.
s
 
$f2
, 
	$V1_OFF2
(
$•
)

496 
b
 
˛s_ïûogue


498 
˛s_ªt°ru˘_f_d
:

499 
b√
 
v0
, 
FFI_TYPE_STRUCT_FD
, 
˛s_ªt°ru˘_smÆl2


500 
l
.
s
 
$f0
, 
	$V0_OFF2
(
$•
)

501 
l
.
d
 
$f2
, 
	$V1_OFF2
(
$•
)

502 
b
 
˛s_ïûogue


504 
˛s_ªt°ru˘_smÆl2
:

505 
REG_L
 
v0
, 
	$V0_OFF2
(
$•
)

506 
REG_L
 
v1
, 
	$V1_OFF2
(
$•
)

509 
˛s_ïûogue
:

510 
REG_L
 
ø
, 
	$RA_OFF2
(
$•
Ë#Re°‹ê 
addªss


511 .
˝ªtu∫


512 
ADDU
 
$•
, 
SIZEOF_FRAME2


513 
j
 
ø


514 .
LFE2
:

515 .
íd
 
ffi_˛osuª_N32


517 #ifde‡
__GNUC__


518 .
£˘i⁄
 .
eh_‰ame
,"aw",@
¥ogbôs


519 .
L‰ame1
:

520 .4b
yã
 .
LECIE1
-.
LSCIE1
 #length

521 .
LSCIE1
:

522 .4b
yã
 0x0 #CIE

523 .
byã
 0x1 #Version 1

524 .
ascii
 "\000" #Augmentation

525 .
uÀb128
 0x1 #Codê
Æignmít
 1

526 .
¶eb128
 -4 #D©®
Æignmít
 -4

527 .
byã
 0x1‡#Rëu∫ 
Addªss
 
$31


528 .
byã
 0xc #DW_CFA_def_cfa

529 .
uÀb128
 0x1d #ö 
$•


530 .
uÀb128
 0x0 #offset 0

531 .
Æign
 
EH_FRAME_ALIGN


532 .
LECIE1
:

534 .
LSFDE1
:

535 .4b
yã
 .
LEFDE1
-.
LASFDE1
 #length.

536 .
LASFDE1
:

537 .4b
yã
 .
LASFDE1
-.
L‰ame1
 #CIE_pointer.

538 
FDE_ADDR_BYTES
 .
LFB3
 #initial_location.

539 
FDE_ADDR_BYTES
 .
LFE3
-.
LFB3
 #address_range.

540 .
byã
 0x4 #DW_CFA_advance_loc4

541 .4b
yã
 .
LCFI0
-.
LFB3
 #to .LCFI0

542 .
byã
 0xe #DW_CFA_def_cfa_offset

543 .
uÀb128
 
SIZEOF_FRAME
 #adju° 
°ack
.
by
 SIZEOF_FRAME

544 .
byã
 0x4 #DW_CFA_advance_loc4

545 .4b
yã
 .
LCFI1
-.
LCFI0
 #to .LCFI1

546 .
byã
 0x9ê#DW_CFA_off£à
of
 
$Â


547 .
uÀb128
 2*
FFI_SIZEOF_ARG
/4 #
.
byã
 0x9‡#DW_CFA_off£à
of
 
ø


549 .
uÀb128
 1*
FFI_SIZEOF_ARG
/4 #
.
byã
 0x4 #DW_CFA_advance_loc4

551 .4b
yã
 .
LCFI3
-.
LCFI1
 #to .LCFI3

552 .
byã
 0xd #DW_CFA_def_cfa_register

553 .
uÀb128
 0x1ê#ö 
$Â


554 .
Æign
 
EH_FRAME_ALIGN


555 .
LEFDE1
:

556 .
LSFDE3
:

557 .4b
yã
 .
LEFDE3
-.
LASFDE3
 #length

558 .
LASFDE3
:

559 .4b
yã
 .
LASFDE3
-.
L‰ame1
 #CIE_pointer.

560 
FDE_ADDR_BYTES
 .
LFB2
 #initial_location.

561 
FDE_ADDR_BYTES
 .
LFE2
-.
LFB2
 #address_range.

562 .
byã
 0x4 #DW_CFA_advance_loc4

563 .4b
yã
 .
LCFI5
-.
LFB2
 #to .LCFI5

564 .
byã
 0xe #DW_CFA_def_cfa_offset

565 .
uÀb128
 
SIZEOF_FRAME2
 #adju° 
°ack
.
by
 
SIZEOF_FRAME


566 .
byã
 0x4 #DW_CFA_advance_loc4

567 .4b
yã
 .
LCFI6
-.
LCFI5
 #to .LCFI6

568 .
byã
 0x9¯#DW_CFA_off£à
of
 
	`$gp
 (
$28
)

569 .
	`uÀb128
 (
SIZEOF_FRAME2
 - 
GP_OFF2
)/4

570 .
byã
 0x9‡#DW_CFA_off£à
of
 
	`ø
 (
$31
)

571 .
	`uÀb128
 (
SIZEOF_FRAME2
 - 
RA_OFF2
)/4

572 .
Æign
 
EH_FRAME_ALIGN


573 .
LEFDE3
:

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/mips/o32.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

33 #i‡
deföed
(
FFI_MIPS_O32
)

35 
	#ˇŒback
 
a0


	)

36 
	#byãs
 
a2


	)

37 
	#Êags
 
a3


	)

39 
	#SIZEOF_FRAME
 (4 * 
FFI_SIZEOF_ARG
 + 2 * FFI_SIZEOF_ARG)

	)

40 
	#A3_OFF
 (
SIZEOF_FRAME
 + 3 * 
FFI_SIZEOF_ARG
)

	)

41 
	#FP_OFF
 (
SIZEOF_FRAME
 - 2 * 
FFI_SIZEOF_ARG
)

	)

42 
	#RA_OFF
 (
SIZEOF_FRAME
 - 1 * 
FFI_SIZEOF_ARG
)

	)

44 .
	gabiˇŒs


45 .
	gãxt


46 .
	gÆign
 2

47 .
globl
 
	gffi_ˇŒ_O32


48 .
ít
 
ffi_ˇŒ_O32


49 
	gffi_ˇŒ_O32
:

50 
$LFB0
:

52 
SUBU
 
$•
, 
	gSIZEOF_FRAME
 #Fømê
size


53 
	g$LCFI0
:

54 
REG_S
 
$Â
, 
	$FP_OFF
(
$•
Ë#Savê
‰ame
 
poöãr


55 
$LCFI1
:

56 
REG_S
 
ø
, 
	$RA_OFF
(
$•
Ë#Savê 
addªss


57 
$LCFI2
:

58 
move
 
$Â
, 
$•


60 
$LCFI3
:

61 
move
 
t9
, 
ˇŒback
 #ˇŒback 
fun˘i⁄
 
poöãr


62 
REG_S
 
Êags
, 
	$A3_OFF
(
$Â
) #flags

64 #AŒoˇã 
©
 
Àa°
 4 
w‹ds
 
ö
 
the
 
¨g°ack


65 
LI
 
v0
, 4 * 
FFI_SIZEOF_ARG


66 
b…
 
byãs
, 
v0
, 
sixãí


68 
ADDU
 
v0
, 
byãs
, 7 #makê
suª
 
ô
 
is
 
Æig√d


69 
™d
 
v0
, -8 #tÿ
™
 8 
byã
 
boundry


71 
sixãí
:

72 
SUBU
 
$•
, 
v0
 #movê
the
 
°ack
 
poöãr
 
to
 
ªÊe˘
Åhe

73 #¨g 
•a˚


75 
ADDU
 
a0
, 
$•
, 4 * 
FFI_SIZEOF_ARG


77 
jÆr
 
t9


79 
REG_L
 
t0
, 
	$A3_OFF
(
$Â
Ë#lﬂd 
the
 
Êags
 
w‹d


80 
SRL
 
t2
, 
t0
, 4 #shi· 
our
 
¨g
 
öfo


81 
™d
 
t0
, ((1<<4)-1Ë#mask 
out
 
the
  
ty≥


83 
ADDU
 
$•
, 4 * 
FFI_SIZEOF_ARG
 #adju° $• 
to
 
√w
 
¨gs


85 
b√z
 
t0
, 
∑ss_d
 #makê
ô
 
quick
 

86 
REG_L
 
a0
, 0*
	$FFI_SIZEOF_ARG
(
$•
Ë#ju° 
go
 
ahód
 
™d
 
lﬂd
 
the


87 
REG_L
 
a1
, 1*
	$FFI_SIZEOF_ARG
(
$•
Ë#fou∏
ªgs
.

88 
REG_L
 
a2
, 2*
	$FFI_SIZEOF_ARG
(
$•
)

89 
REG_L
 
a3
, 3*
	$FFI_SIZEOF_ARG
(
$•
)

90 
b
 
ˇŒ_ô


92 
∑ss_d
:

93 
b√
 
t0
, 
FFI_ARGS_D
, 
∑ss_f


94 
l
.
d
 
$f12
, 0*
	$FFI_SIZEOF_ARG
(
$•
Ë#lﬂd 
$Â
 
ªgs
 
‰om
 
¨gs


95 
REG_L
 
a2
, 2*
	$FFI_SIZEOF_ARG
(
$•
Ë#∑ssög 
a
 

96 
REG_L
 
a3
, 3*
	$FFI_SIZEOF_ARG
(
$•
)

97 
b
 
ˇŒ_ô


99 
∑ss_f
:

100 
b√
 
t0
, 
FFI_ARGS_F
, 
∑ss_d_d


101 
l
.
s
 
$f12
, 0*
	$FFI_SIZEOF_ARG
(
$•
Ë#lﬂd 
$Â
 
ªgs
 
‰om
 
¨gs


102 
REG_L
 
a1
, 1*
	$FFI_SIZEOF_ARG
(
$•
Ë#∑ssög 
a
 

103 
REG_L
 
a2
, 2*
	$FFI_SIZEOF_ARG
(
$•
)

104 
REG_L
 
a3
, 3*
	$FFI_SIZEOF_ARG
(
$•
)

105 
b
 
ˇŒ_ô


107 
∑ss_d_d
:

108 
b√
 
t0
, 
FFI_ARGS_DD
, 
∑ss_f_f


109 
l
.
d
 
$f12
, 0*
	$FFI_SIZEOF_ARG
(
$•
Ë#lﬂd 
$Â
 
ªgs
 
‰om
 
¨gs


110 
l
.
d
 
$f14
, 2*
	$FFI_SIZEOF_ARG
(
$•
Ë#∑ssög 
two
 
doubÀs


111 
b
 
ˇŒ_ô


113 
∑ss_f_f
:

114 
b√
 
t0
, 
FFI_ARGS_FF
, 
∑ss_d_f


115 
l
.
s
 
$f12
, 0*
	$FFI_SIZEOF_ARG
(
$•
Ë#lﬂd 
$Â
 
ªgs
 
‰om
 
¨gs


116 
l
.
s
 
$f14
, 1*
	$FFI_SIZEOF_ARG
(
$•
Ë#∑ssög 
two
 
Êﬂts


117 
REG_L
 
a2
, 2*
	$FFI_SIZEOF_ARG
(
$•
)

118 
REG_L
 
a3
, 3*
	$FFI_SIZEOF_ARG
(
$•
)

119 
b
 
ˇŒ_ô


121 
∑ss_d_f
:

122 
b√
 
t0
, 
FFI_ARGS_DF
, 
∑ss_f_d


123 
l
.
d
 
$f12
, 0*
	$FFI_SIZEOF_ARG
(
$•
Ë#lﬂd 
$Â
 
ªgs
 
‰om
 
¨gs


124 
l
.
s
 
$f14
, 2*
	$FFI_SIZEOF_ARG
(
$•
Ë#∑ssög 
™d
 

125 
REG_L
 
a3
, 3*
	$FFI_SIZEOF_ARG
(
$•
)

126 
b
 
ˇŒ_ô


128 
∑ss_f_d
:

129 #assumê
th©
 
the
 
⁄ly
 
Ÿhî
 
combö©i⁄
 
mu°
 
be
 
thí
 

130 #b√ 
t0
, 
FFI_ARGS_F_D
, 
ˇŒ_ô


131 
l
.
s
 
$f12
, 0*
	$FFI_SIZEOF_ARG
(
$•
Ë#lﬂd 
$Â
 
ªgs
 
‰om
 
¨gs


132 
l
.
d
 
$f14
, 2*
	$FFI_SIZEOF_ARG
(
$•
Ë#∑ssög 
™d
 

134 
ˇŒ_ô
:

135 #Lﬂd 
the
 
fun˘i⁄
 
poöãr


136 
REG_L
 
t9
, 
SIZEOF_FRAME
 + 5*
	$FFI_SIZEOF_ARG
(
$Â
)

138 #I‡
the
  
vÆue
 
poöãr
 
is
 
NULL
, 
assume
 
no
  value.

139 
REG_L
 
t1
, 
SIZEOF_FRAME
 + 4*
	$FFI_SIZEOF_ARG
(
$Â
)

140 
beqz
 
t1
, 
n‹ëvÆ


142 
b√
 
t2
, 
FFI_TYPE_INT
, 
ªé⁄gl⁄g


143 
jÆr
 
t9


144 
REG_L
 
t0
, 
SIZEOF_FRAME
 + 4*
	$FFI_SIZEOF_ARG
(
$Â
)

145 
REG_S
 
v0
, 0(
t0
)

146 
b
 
ïûogue


148 
ªé⁄gl⁄g
:

149 #RóŒy 
™y
 64-
bô
 , sig√d 
‹
 
nŸ
.

150 
b√
 
t2
, 
FFI_TYPE_UINT64
, 
ªtÊﬂt


151 
jÆr
 
t9


152 
REG_L
 
t0
, 
SIZEOF_FRAME
 + 4*
	$FFI_SIZEOF_ARG
(
$Â
)

153 
REG_S
 
v1
, 4(
t0
)

154 
REG_S
 
v0
, 0(
t0
)

155 
b
 
ïûogue


157 
ªtÊﬂt
:

158 
b√
 
t2
, 
FFI_TYPE_FLOAT
, 
ªtdoubÀ


159 
jÆr
 
t9


160 
REG_L
 
t0
, 
SIZEOF_FRAME
 + 4*
	$FFI_SIZEOF_ARG
(
$Â
)

161 
s
.†
$f0
, 0(
t0
)

162 
b
 
ïûogue


164 
ªtdoubÀ
:

165 
b√
 
t2
, 
FFI_TYPE_DOUBLE
, 
n‹ëvÆ


166 
jÆr
 
t9


167 
REG_L
 
t0
, 
SIZEOF_FRAME
 + 4*
	$FFI_SIZEOF_ARG
(
$Â
)

168 
s
.
d
 
$f0
, 0(
t0
)

169 
b
 
ïûogue


171 
n‹ëvÆ
:

172 
jÆr
 
t9


175 
ïûogue
:

176 
move
 
$•
, 
$Â


177 
REG_L
 
$Â
, 
	$FP_OFF
(
$•
Ë#Re°‹ê
‰ame
 
poöãr


178 
REG_L
 
ø
, 
	$RA_OFF
(
$•
Ë#Re°‹ê 
addªss


179 
ADDU
 
$•
, 
SIZEOF_FRAME
 #Fix 
°ack
 
poöãr


180 
j
 
ø


182 
$LFE0
:

183 .
íd
 
ffi_ˇŒ_O32


213 
	#SIZEOF_FRAME2
 (14 * 
FFI_SIZEOF_ARG
)

	)

214 
	#A3_OFF2
 (
SIZEOF_FRAME2
 + 3 * 
FFI_SIZEOF_ARG
)

	)

215 
	#A2_OFF2
 (
SIZEOF_FRAME2
 + 2 * 
FFI_SIZEOF_ARG
)

	)

216 
	#A1_OFF2
 (
SIZEOF_FRAME2
 + 1 * 
FFI_SIZEOF_ARG
)

	)

217 
	#A0_OFF2
 (
SIZEOF_FRAME2
 + 0 * 
FFI_SIZEOF_ARG
)

	)

218 
	#RA_OFF2
 (
SIZEOF_FRAME2
 - 1 * 
FFI_SIZEOF_ARG
)

	)

219 
	#FP_OFF2
 (
SIZEOF_FRAME2
 - 2 * 
FFI_SIZEOF_ARG
)

	)

220 
	#S0_OFF2
 (
SIZEOF_FRAME2
 - 3 * 
FFI_SIZEOF_ARG
)

	)

221 
	#GP_OFF2
 (
SIZEOF_FRAME2
 - 4 * 
FFI_SIZEOF_ARG
)

	)

222 
	#V1_OFF2
 (
SIZEOF_FRAME2
 - 5 * 
FFI_SIZEOF_ARG
)

	)

223 
	#V0_OFF2
 (
SIZEOF_FRAME2
 - 6 * 
FFI_SIZEOF_ARG
)

	)

224 
	#FA_1_1_OFF2
 (
SIZEOF_FRAME2
 - 7 * 
FFI_SIZEOF_ARG
)

	)

225 
	#FA_1_0_OFF2
 (
SIZEOF_FRAME2
 - 8 * 
FFI_SIZEOF_ARG
)

	)

226 
	#FA_0_1_OFF2
 (
SIZEOF_FRAME2
 - 9 * 
FFI_SIZEOF_ARG
)

	)

227 
	#FA_0_0_OFF2
 (
SIZEOF_FRAME2
 - 10 * 
FFI_SIZEOF_ARG
)

	)

229 .
ãxt


230 .
Æign
 2

231 .
globl
 
ffi_˛osuª_O32


232 .
ít
 
ffi_˛osuª_O32


233 
ffi_˛osuª_O32
:

234 
$LFB1
:

236 .
‰ame
 
$Â
, 
SIZEOF_FRAME2
, 
ø


237 .
£t
 
n‹e‹dî


238 .
˝lﬂd
 
t9


239 .
£t
 
ª‹dî


240 
SUBU
 
$•
, 
SIZEOF_FRAME2


241 .
˝ª°‹e
 
GP_OFF2


242 
$LCFI4
:

243 
REG_S
 
$16
, 
	$S0_OFF2
(
$•
Ë#Savê
s0


244 
REG_S
 
$Â
, 
	$FP_OFF2
(
$•
Ë#Savê
‰ame
 
poöãr


245 
REG_S
 
ø
, 
	$RA_OFF2
(
$•
Ë#Savê 
addªss


246 
$LCFI6
:

247 
move
 
$Â
, 
$•


249 
$LCFI7
:

250 #St‹ê
Æl
 
possibÀ
 
¨gumít
 
ªgi°îs
. 
If
 
thîe
 
¨e
 
m‹e
 
th™


251 #fou∏
¨gumíts
, 
thí
 
they
 
¨e
 
°‹ed
 
above
 
whîe
 
we
 
put
 
a3
.

252 
REG_S
 
a0
, 
	$A0_OFF2
(
$Â
)

253 
REG_S
 
a1
, 
	$A1_OFF2
(
$Â
)

254 
REG_S
 
a2
, 
	$A2_OFF2
(
$Â
)

255 
REG_S
 
a3
, 
	$A3_OFF2
(
$Â
)

257 #Lﬂd 
ABI
 
to
 
s0


258 
REG_L
 
$16
, 20(
$12
Ë#ci‡
poöãr
 
fﬁlows
 
åamp
.

259 
REG_L
 
$16
, 0($16Ë#abò
is
 
fú°
 
membî
.

261 
li
 
$13
, 1 #FFI_O32

262 
b√
 
$16
, 
$13
, 1‡#Skù 
Â
 
ßve
 
FFI_O32_SOFT_FLOAT


264 #St‹ê
Æl
 
possibÀ
 /
ªgi°îs
.

265 
s
.
d
 
$f12
, 
	$FA_0_0_OFF2
(
$Â
)

266 
s
.
d
 
$f14
, 
	`FA_1_0_OFF2
(
$Â
)

268 #CÆ»
ffi_˛osuª_mùs_ö√r_O32
 
to
 dÿ
the
 
w‹k
.

269 
œ
 
t9
, 
ffi_˛osuª_mùs_ö√r_O32


270 
move
 
a0
, 
$12
 #Poöã∏
to
 
the
 
ffi_˛osuª


271 
addu
 
a1
, 
$Â
, 
V0_OFF2


272 
addu
 
a2
, 
$Â
, 
A0_OFF2


273 
addu
 
a3
, 
$Â
, 
FA_0_0_OFF2


274 
jÆr
 
t9


276 #Lﬂd 
the
  
vÆue
 
öto
Åhê
≠¥›rüã
 .

277 
move
 
$8
, 
$2


278 
li
 
$9
, 
FFI_TYPE_VOID


279 
beq
 
$8
, 
$9
, 
˛osuª_d⁄e


281 
li
 
$13
, 1 #FFI_O32

282 
b√
 
$16
, 
$13
, 1‡#Skù 
Â
 
ª°‹e
 
FFI_O32_SOFT_FLOAT


284 
li
 
$9
, 
FFI_TYPE_FLOAT


285 
l
.
s
 
$f0
, 
	$V0_OFF2
(
$Â
)

286 
beq
 
$8
, 
$9
, 
˛osuª_d⁄e


288 
li
 
$9
, 
FFI_TYPE_DOUBLE


289 
l
.
d
 
$f0
, 
	$V0_OFF2
(
$Â
)

290 
beq
 
$8
, 
$9
, 
˛osuª_d⁄e


292 
REG_L
 
$3
, 
	$V1_OFF2
(
$Â
)

293 
REG_L
 
$2
, 
	$V0_OFF2
(
$Â
)

295 
˛osuª_d⁄e
:

297 
move
 
$•
, 
$Â


298 
REG_L
 
$16
, 
	$S0_OFF2
(
$•
Ë#Re°‹ê
s0


299 
REG_L
 
$Â
, 
	$FP_OFF2
(
$•
Ë#Re°‹ê
‰ame
 
poöãr


300 
REG_L
 
ø
, 
	$RA_OFF2
(
$•
Ë#Re°‹ê 
addªss


301 
ADDU
 
$•
, 
SIZEOF_FRAME2


302 
j
 
ø


303 
$LFE1
:

304 .
íd
 
ffi_˛osuª_O32


308 .
£˘i⁄
 .
eh_‰ame
,"a",@
¥ogbôs


309 
$L‰ame0
:

310 .4b
yã
 
$LECIE0
-
$LSCIE0
 #Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


311 
$LSCIE0
:

312 .4b
yã
 0x0 #CIE 
Idítifõr
 
Tag


313 .
byã
 0x1 #CIE 
Vîsi⁄


314 .
ascii
 "zR\0" #CIE 
Augmíèti⁄


315 .
uÀb128
 0x1 #CIE 
Code
 
Alignmít
 
Fa˘‹


316 .
¶eb128
 4 #CIE 
D©a
 
Alignmít
 
Fa˘‹


317 .
byã
 0x1‡#CIE 
RA
 
Cﬁumn


318 .
uÀb128
 0x1 #Augmíèti⁄ 
size


319 .
byã
 0x00 #FDE 
	`Encodög
 (
ab•å
)

320 .
byã
 0xc #DW_CFA_def_cfa

321 .
uÀb128
 0x1d

322 .
uÀb128
 0x0

323 .
Æign
 2

324 
$LECIE0
:

325 
$LSFDE0
:

326 .4b
yã
 
$LEFDE0
-
$LASFDE0
 #FDE 
Lígth


327 
$LASFDE0
:

328 .4b
yã
 
$LASFDE0
-
$L‰ame0
 #FDE 
CIE
 
off£t


329 .4b
yã
 
$LFB0
 #FDE 
öôül
 
loˇti⁄


330 .4b
yã
 
$LFE0
-
$LFB0
 #FDE 
addªss
 
ønge


331 .
uÀb128
 0x0 #Augmíèti⁄ 
size


332 .
byã
 0x4 #DW_CFA_advance_loc4

333 .4b
yã
 
$LCFI0
-
$LFB0


334 .
byã
 0xe #DW_CFA_def_cfa_offset

335 .
uÀb128
 0x18

336 .
byã
 0x4 #DW_CFA_advance_loc4

337 .4b
yã
 
$LCFI2
-
$LCFI0


338 .
byã
 0x11 #DW_CFA_offset_extended_sf

339 .
uÀb128
 0x1e #$fp

340 .
¶eb128
 -2 #SIZEOF_FRAME2 - 2*
	`FFI_SIZEOF_ARG
(
$•
)

341 .
byã
 0x11 #DW_CFA_offset_extended_sf

342 .
uÀb128
 0x1f #$ra

343 .
¶eb128
 -1 #SIZEOF_FRAME2 - 1*
	`FFI_SIZEOF_ARG
(
$•
)

344 .
byã
 0x4 #DW_CFA_advance_loc4

345 .4b
yã
 
$LCFI3
-
$LCFI2


346 .
byã
 0xc #DW_CFA_def_cfa

347 .
uÀb128
 0x1e

348 .
uÀb128
 0x18

349 .
Æign
 2

350 
$LEFDE0
:

351 
$LSFDE1
:

352 .4b
yã
 
$LEFDE1
-
$LASFDE1
 #FDE 
Lígth


353 
$LASFDE1
:

354 .4b
yã
 
$LASFDE1
-
$L‰ame0
 #FDE 
CIE
 
off£t


355 .4b
yã
 
$LFB1
 #FDE 
öôül
 
loˇti⁄


356 .4b
yã
 
$LFE1
-
$LFB1
 #FDE 
addªss
 
ønge


357 .
uÀb128
 0x0 #Augmíèti⁄ 
size


358 .
byã
 0x4 #DW_CFA_advance_loc4

359 .4b
yã
 
$LCFI4
-
$LFB1


360 .
byã
 0xe #DW_CFA_def_cfa_offset

361 .
uÀb128
 0x38

362 .
byã
 0x4 #DW_CFA_advance_loc4

363 .4b
yã
 
$LCFI6
-
$LCFI4


364 .
byã
 0x11 #DW_CFA_offset_extended_sf

365 .
uÀb128
 0x10 #$16

366 .
¶eb128
 -3 #SIZEOF_FRAME2 - 3*
	`FFI_SIZEOF_ARG
(
$•
)

367 .
byã
 0x11 #DW_CFA_offset_extended_sf

368 .
uÀb128
 0x1e #$fp

369 .
¶eb128
 -2 #SIZEOF_FRAME2 - 2*
	`FFI_SIZEOF_ARG
(
$•
)

370 .
byã
 0x11 #DW_CFA_offset_extended_sf

371 .
uÀb128
 0x1f #$ra

372 .
¶eb128
 -1 #SIZEOF_FRAME2 - 1*
	`FFI_SIZEOF_ARG
(
$•
)

373 .
byã
 0x4 #DW_CFA_advance_loc4

374 .4b
yã
 
$LCFI7
-
$LCFI6


375 .
byã
 0xc #DW_CFA_def_cfa

376 .
uÀb128
 0x1e

377 .
uÀb128
 0x38

378 .
Æign
 2

379 
$LEFDE1
:

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/moxie/eabi.S

26 
	#LIBFFI_ASM


	)

27 
	~<ffic⁄fig.h
>

28 
	~<ffi.h
>

30 .
globl
 
	gffi_¥ï_¨gs_EABI


32 .
	gãxt


33 .
	gp2Æign
 4

34 .
globl
 
	gffi_ˇŒ_EABI


35 .
ty≥
 
	gffi_ˇŒ_EABI
, @
	gfun˘i⁄


37 #$r0 : 
ffi_¥ï_¨gs


38 #$r1 : &
ecif


39 #$r2 : 
cif
->
byãs


40 #$r3 : 
fig
->
Êags


41 #$r4 : 
ecif
.
rvÆue


42 #$r5 : 
‚


44 
	gffi_ˇŒ_EABI
:

45 
push
 
$•
, 
$r6


46 
push
 
	g$•
, 
$r7


47 
push
 
	g$•
, 
$r8


48 
dec
 
	g$•
, 24

51 
	g°o
.
	gl
 0(
	g$•
), 
$r0


52 
	g°o
.
	gl
 4(
	g$•
), 
$r1


53 
	g°o
.
	gl
 8(
	g$•
), 
$r2


54 
	g°o
.
	gl
 12(
	g$•
), 
$r3


55 
	g°o
.
	gl
 16(
	g$•
), 
$r4


56 
	g°o
.
	gl
 20(
	g$•
), 
$r5


59 
mov
 
	g$r6
, 
$r4


60 
mov
 
	g$r7
, 
$r5


61 
mov
 
	g$r8
, 
$r3


62 
	gsub
.
l
 
	g$•
, 
$r2


63 
mov
 
	g$r0
, 
$•


65 
j§a
 
ffi_¥ï_¨gs


68 
	gldo
.
l
 
	g$r0
, 0(
	g$•
)

69 
	gldo
.
l
 
	g$r1
, 4(
	g$•
)

70 
	gldo
.
l
 
	g$r2
, 8(
	g$•
)

71 
	gldo
.
l
 
	g$r3
, 12(
	g$•
)

72 
	gldo
.
l
 
	g$r4
, 16(
	g$•
)

73 
	gldo
.
l
 
	g$r5
, 20(
	g$•
)

76 
j§
 
$r7


78 
	gldi
.
l
 
	g$r7
, 0xffffffff

79 
cmp
 
	g$r8
, 
$r7


80 
beq
 
ªt°ru˘


82 
	gldi
.
l
 
	g$r7
, 4

83 
cmp
 
	g$r8
, 
$r7


84 
bgt
 
ªt2ªg


86 
	g°
.
l
 (
$r6
), 
$r0


87 
jm∑
 
ªtd⁄e


89 
	gªt2ªg
:

90 
°
.
l
 (
$r6
), 
$r0


91 
	g°o
.
	gl
 4(
	g$r6
), 
$r1


93 
	gªt°ru˘
:

94 
ªtd⁄e
:

96 
ldo
.
l
 
$r6
, -4(
	g$Â
)

97 
	gldo
.
l
 
	g$r7
, -8(
	g$Â
)

98 
	gldo
.
l
 
	g$r8
, -12(
	g$Â
)

99 
	gªt


100 .
size
 
	gffi_ˇŒ_EABI
, .-ffi_call_EABI

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/moxie/ffi.c

27 
	~<ffi.h
>

28 
	~<ffi_comm⁄.h
>

30 
	~<°dlib.h
>

35 *
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

37 
i
;

38 **
p_¨gv
;

39 *
¨gp
;

40 
ffi_ty≥
 **
p_¨g
;

41 
cou¡
 = 0;

43 
p_¨gv
 = 
ecif
->
avÆue
;

44 
¨gp
 = 
°ack
;

46 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

48 *(**Ë
¨gp
 = 
ecif
->
rvÆue
;

49 
¨gp
 += 4;

52 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

53 (
i
 != 0);

54 
i
--, 
p_¨g
++)

56 
size_t
 
z
;

58 
z
 = (*
p_¨g
)->
size
;

60 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT
)

62 
z
 = (*);

63 *(**Ë
¨gp
 = *
p_¨gv
;

65 i‡(
z
 < ())

67 
z
 = ();

68 (*
p_¨g
)->
ty≥
)

70 
FFI_TYPE_SINT8
:

71 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT8
 *)(* 
p_¨gv
);

74 
FFI_TYPE_UINT8
:

75 *(*Ë
¨gp
 = ()*(
UINT8
 *)(* 
p_¨gv
);

78 
FFI_TYPE_SINT16
:

79 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT16
 *)(* 
p_¨gv
);

82 
FFI_TYPE_UINT16
:

83 *(*Ë
¨gp
 = ()*(
UINT16
 *)(* 
p_¨gv
);

87 
	`FFI_ASSERT
(0);

90 i‡(
z
 == ())

92 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

96 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

98 
p_¨gv
++;

99 
¨gp
 +
z
;

100 
cou¡
 +
z
;

103  (
°ack
 + ((
cou¡
 > 24Ë? 24 : 
	`ALIGN_DOWN
(count, 8)));

104 
	}
}

107 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

109 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

110 
cif
->
Êags
 = -1;

112 
cif
->
Êags
 = cif->
πy≥
->
size
;

114 
cif
->
byãs
 = 
	`ALIGN
 (cif->bytes, 8);

116  
FFI_OK
;

117 
	}
}

119 
ffi_ˇŒ_EABI
(*(*)(*, 
exãnded_cif
 *),

120 
exãnded_cif
 *,

123 (*
‚
)());

125 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
,

126 (*
‚
)(),

127 *
rvÆue
,

128 **
avÆue
)

130 
exãnded_cif
 
ecif
;

132 
ecif
.
cif
 = cif;

133 
ecif
.
avÆue
 =ávalue;

138 i‡((
rvÆue
 =
NULL
) &&

139 (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

141 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

144 
ecif
.
rvÆue
 =Ñvalue;

146 
cif
->
abi
)

148 
FFI_EABI
:

149 
	`ffi_ˇŒ_EABI
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
,

150 
cif
->
Êags
, 
ecif
.
rvÆue
, 
‚
);

153 
	`FFI_ASSERT
(0);

156 
	}
}

158 
	$ffi_˛osuª_óbi
 (
¨g1
, 
¨g2
, 
¨g3
,

159 
¨g4
, 
¨g5
, 
¨g6
)

164 
ffi_˛osuª
 *
¸eg
 
	`__asm__
 ("$r12");

165 
ffi_˛osuª
 *
˛osuª
 = 
¸eg
;

169 *
‰ame_poöãr
 
	`__asm__
 ("$fp");

172 *
°ru˘_rvÆue
 = (*Ë
¨g1
;

175 *
°ack_¨gs
 = 
‰ame_poöãr
 + 9*4;

178 
ªgi°î_¨gs
[6] =

179 { 
¨g1
, 
¨g2
, 
¨g3
, 
¨g4
, 
¨g5
, 
¨g6
 };

180 *
ªgi°î_¨gs_±r
 = (*Ë
ªgi°î_¨gs
;

182 
ffi_cif
 *
cif
 = 
˛osuª
->cif;

183 
ffi_ty≥
 **
¨g_ty≥s
 = 
cif
->arg_types;

184 **
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 * (*));

185 *
±r
 = (*Ë
ªgi°î_¨gs
;

186 
i
;

189 i‡((
cif
->
πy≥
 !
NULL
Ë&& (cif->πy≥->
ty≥
 =
FFI_TYPE_STRUCT
)) {

190 
±r
 += 4;

191 
ªgi°î_¨gs_±r
 = (*)&
ªgi°î_¨gs
[1];

195 
i
 = 0; i < 
cif
->
«rgs
; i++)

197 
¨g_ty≥s
[
i
]->
ty≥
)

199 
FFI_TYPE_SINT8
:

200 
FFI_TYPE_UINT8
:

201 
avÆue
[
i
] = 
±r
 + 3;

203 
FFI_TYPE_SINT16
:

204 
FFI_TYPE_UINT16
:

205 
avÆue
[
i
] = 
±r
 + 2;

207 
FFI_TYPE_SINT32
:

208 
FFI_TYPE_UINT32
:

209 
FFI_TYPE_FLOAT
:

210 
FFI_TYPE_POINTER
:

211 
avÆue
[
i
] = 
±r
;

213 
FFI_TYPE_STRUCT
:

214 
avÆue
[
i
] = *(**)
±r
;

218 
avÆue
[
i
] = 
±r
;

219 
±r
 += 4;

222 
±r
 += 4;

226 i‡(
±r
 =&
ªgi°î_¨gs
[6])

227 
±r
 = 
°ack_¨gs
;

231 i‡(
cif
->
πy≥
 && (cif->πy≥->
ty≥
 =
FFI_TYPE_STRUCT
))

233 (
˛osuª
->
fun
Ë(
cif
, 
°ru˘_rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

238 
rvÆue
;

239 (
˛osuª
->
fun
Ë(
cif
, &
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

240 
	`asm
 ("mov $r12, %0\¿ld.»$r0, ($r12)\¿ldo.»$r1, 4($r12)" : : "r" (&
rvÆue
));

242 
	}
}

244 
ffi_°©us


245 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

246 
ffi_cif
* 
cif
,

247 (*
fun
)(
ffi_cif
*, *, **, *),

248 *
u£r_d©a
,

249 *
codñoc
)

251 *
åamp
 = (*Ë&
˛osuª
->tramp[0];

252 
‚
 = (Ë
ffi_˛osuª_óbi
;

253 
˛s
 = (Ë
codñoc
;

255 i‡(
cif
->
abi
 !
FFI_EABI
)

256  
FFI_BAD_ABI
;

258 
‚
 = (Ë
ffi_˛osuª_óbi
;

260 
åamp
[0] = 0x01e0;

261 
åamp
[1] = 
˛s
 >> 16;

262 
åamp
[2] = 
˛s
 & 0xffff;

263 
åamp
[3] = 0x1a00;

264 
åamp
[4] = 
‚
 >> 16;

265 
åamp
[5] = 
‚
 & 0xffff;

267 
˛osuª
->
cif
 = cif;

268 
˛osuª
->
fun
 = fun;

269 
˛osuª
->
u£r_d©a
 = user_data;

271  
FFI_OK
;

272 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/moxie/ffitarget.h

27 #i‚de‡
LIBFFI_TARGET_H


28 
	#LIBFFI_TARGET_H


	)

32 #i‚de‡
LIBFFI_ASM


33 
	tffi_¨g
;

34 sig√d 
	tffi_ßrg
;

36 
	effi_abi
 {

37 
	mFFI_FIRST_ABI
 = 0,

38 
	mFFI_EABI
,

39 
	mFFI_DEFAULT_ABI
 = 
FFI_EABI
,

40 
	mFFI_LAST_ABI
 = 
FFI_DEFAULT_ABI
 + 1

41 } 
	tffi_abi
;

46 
	#FFI_CLOSURES
 1

	)

47 
	#FFI_NATIVE_RAW_API
 0

	)

50 
	#FFI_TRAMPOLINE_SIZE
 (12)

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/nios2/ffi.c

25 
	~<ffi.h
>

26 
	~<ffi_comm⁄.h
>

28 
	~<°dlib.h
>

52 
UINT64
 
ffi_ˇŒ_sysv
 ((*Ë(*, 
exãnded_cif
 *),

53 
exãnded_cif
 *,

55 (*
‚
) ());

56 
	`ffi_˛osuª_sysv
 ();

60 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

66 i‡(
cif
->
byãs
 < 16)

67 
cif
->
byãs
 = 16;

69 
cif
->
byãs
 = (cif->bytes + 3) & ~3;

71  
FFI_OK
;

72 
	}
}

81 
	$ffi_¥ï_¨gs
 (*
°ack
, 
exãnded_cif
 *
ecif
)

83 *
¨gp
 = 
°ack
;

84 
i
;

88 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


89 && 
ecif
->
cif
->
πy≥
->
size
 > 8)

91 (*(**Ë
¨gp
Ë
ecif
->
rvÆue
;

92 
¨gp
 += 4;

95 
i
 = 0; i < 
ecif
->
cif
->
«rgs
; i++)

97 *
avÆue
 = 
ecif
->avÆue[
i
];

98 
ffi_ty≥
 *
©y≥
 = 
ecif
->
cif
->
¨g_ty≥s
[
i
];

99 
size_t
 
size
 = 
©y≥
->size;

100 
size_t
 
Æignmít
 = 
©y≥
->alignment;

103 i‡((
Æignmít
 - 1Ë& (Ë
¨gp
)

104 
¨gp
 = (*Ë
	`ALIGN
 (¨gp, 
Æignmít
);

108 i‡(
size
 <  ())

110 
size
 =  ();

111 
©y≥
->
ty≥
)

113 
FFI_TYPE_SINT8
:

114 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT8
 *Ë
avÆue
;

117 
FFI_TYPE_UINT8
:

118 *(*Ë
¨gp
 = (Ë*(
UINT8
 *Ë
avÆue
;

121 
FFI_TYPE_SINT16
:

122 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT16
 *Ë
avÆue
;

125 
FFI_TYPE_UINT16
:

126 *(*Ë
¨gp
 = (Ë*(
UINT16
 *Ë
avÆue
;

129 
FFI_TYPE_STRUCT
:

130 
	`mem˝y
 (
¨gp
, 
avÆue
, 
©y≥
->
size
);

134 
	`FFI_ASSERT
(0);

137 i‡(
size
 ==  ())

138 *(*Ë
¨gp
 = (Ë*(
UINT32
 *Ë
avÆue
;

140 
	`mem˝y
 (
¨gp
, 
avÆue
, 
size
);

141 
¨gp
 +
size
;

143 
	}
}

150 
ffi_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
Ë(), *
rvÆue
, **
avÆue
)

153 
exãnded_cif
 
ecif
;

154 
UINT64
 
ªsu…
;

159 
bigªt
 = (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


160 && 
cif
->
πy≥
->
size
 > 8);

162 
ecif
.
cif
 = cif;

163 
ecif
.
avÆue
 =ávalue;

167 i‡(
rvÆue
 =
NULL
 && 
bigªt
)

168 
ecif
.
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

170 
ecif
.
rvÆue
 =Ñvalue;

172 
ªsu…
 = 
	`ffi_ˇŒ_sysv
 (
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
, 
‚
);

177 i‡(
rvÆue
 && !
bigªt
)

178 
cif
->
πy≥
->
size
)

181 *(
UINT8
 *)
rvÆue
 = (UINT8Ë
ªsu…
;

184 *(
UINT16
 *)
rvÆue
 = (UINT16Ë
ªsu…
;

187 *(
UINT32
 *)
rvÆue
 = (UINT32Ë
ªsu…
;

190 *(
UINT64
 *)
rvÆue
 = (UINT64Ë
ªsu…
;

193 
	`mem˝y
 (
rvÆue
, (*)&
ªsu…
, 
cif
->
πy≥
->
size
);

196 
	}
}

202 
UINT64


203 
	$ffi_˛osuª_hñ≥r
 (*
¨gs
,

204 
ffi_˛osuª
 *
˛osuª
)

206 
ffi_cif
 *
cif
 = 
˛osuª
->cif;

207 *
¨gp
 = 
¨gs
;

208 **
∑r£d_¨gs
 = 
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

209 
UINT64
 
ªsu…
;

210 *
ªçå
;

211 
i
;

216 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


217 && 
cif
->
πy≥
->
size
 > 8)

219 
ªçå
 = *((**Ë
¨gp
);

220 
¨gp
 += 4;

223 
ªçå
 = (*Ë&
ªsu…
;

226 
i
 = 0; i < 
cif
->
«rgs
; i++)

228 
size_t
 
size
 = 
cif
->
¨g_ty≥s
[
i
]->size;

229 
size_t
 
Æignmít
 = 
cif
->
¨g_ty≥s
[
i
]->alignment;

232 i‡((
Æignmít
 - 1Ë& (Ë
¨gp
)

233 
¨gp
 = (*Ë
	`ALIGN
 (¨gp, 
Æignmít
);

236 i‡(
size
 <  ())

237 
size
 =  ();

240 
∑r£d_¨gs
[
i
] = 
¨gp
;

241 
¨gp
 +
size
;

245 (
˛osuª
->
fun
Ë(
cif
, 
ªçå
, 
∑r£d_¨gs
, closuª->
u£r_d©a
);

246  
ªsu…
;

247 
	}
}

252 
ffi_°©us


253 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

254 
ffi_cif
* 
cif
,

255 (*
fun
Ë(
ffi_cif
*, *, **, *),

256 *
u£r_d©a
,

257 *
codñoc
)

259 *
åamp
 = (*Ë&
˛osuª
->tramp[0];

260 
i
;

262 i‡(
cif
->
abi
 !
FFI_SYSV
)

263  
FFI_BAD_ABI
;

280 
	#HI
(
x
Ë((((Ë(x)Ë>> 16Ë& 0xffff)

	)

281 
	#LO
(
x
Ë(((Ë(x)Ë& 0xffff)

	)

282 
åamp
[0] = (0 << 27Ë| (8 << 22Ë| (
	`HI
 (
ffi_˛osuª_sysv
) << 6) | 0x34;

283 
åamp
[1] = (8 << 27Ë| (8 << 22Ë| (
	`LO
 (
ffi_˛osuª_sysv
) << 6) | 0x14;

284 
åamp
[2] = (0 << 27Ë| (9 << 22Ë| (
	`HI
 (
ffi_˛osuª_hñ≥r
) << 6) | 0x34;

285 
åamp
[3] = (9 << 27Ë| (9 << 22Ë| (
	`LO
 (
ffi_˛osuª_hñ≥r
) << 6) | 0x14;

286 
åamp
[4] = (0 << 27Ë| (10 << 22Ë| (
	`HI
 (
˛osuª
) << 6) | 0x34;

287 
åamp
[5] = (10 << 27Ë| (10 << 22Ë| (
	`LO
 (
˛osuª
) << 6) | 0x14;

288 
åamp
[6] = (8 << 27) | (0x0d << 11) | 0x3a;

289 #unde‡
HI


290 #unde‡
LO


294 
i
 = 0; i < 7; i++)

295 
asm
 vﬁ©ûê("Êushd 0(%0); flushò%0" :: "r"(
åamp
 + 
i
) : "memory");

296 
asm
 volatile ("flushp" ::: "memory");

298 
˛osuª
->
cif
 = cif;

299 
˛osuª
->
fun
 = fun;

300 
˛osuª
->
u£r_d©a
 = user_data;

302  
FFI_OK
;

303 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/nios2/ffitarget.h

25 #i‚de‡
LIBFFI_TARGET_H


26 
	#LIBFFI_TARGET_H


	)

28 #i‚de‡
LIBFFI_H


32 #i‚de‡
LIBFFI_ASM


33 
	tffi_¨g
;

34 sig√d 
	tffi_ßrg
;

36 
	effi_abi
 {

37 
	mFFI_FIRST_ABI
 = 0,

38 
	mFFI_SYSV
,

39 
	mFFI_LAST_ABI
,

40 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


41 } 
	tffi_abi
;

46 
	#FFI_AGGREGATE_ALIGNMENT
 4

	)

48 
	#FFI_CLOSURES
 1

	)

49 
	#FFI_TRAMPOLINE_SIZE
 28

	)

50 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/nios2/sysv.S

38 .
	g£˘i⁄
 .
	gãxt


39 .
	gÆign
 2

40 .
globÆ
 
	gffi_ˇŒ_sysv


41 .
ty≥
 
	gffi_ˇŒ_sysv
, @
fun˘i⁄


43 
	gffi_ˇŒ_sysv
:

44 .
cfi_°¨çroc


47 
addi
 
•
, 
	g•
, -12

48 .
	gcfi_def_cÁ_off£t
 12

49 
°w
 
	gø
, 8(
	g•
)

50 
°w
 
	gÂ
, 4(
	g•
)

51 
°w
 
	gr16
, 0(
	g•
)

52 .
	gcfi_off£t
 31, -4

53 .
	gcfi_off£t
 28, -8

54 .
	gcfi_off£t
 16, -12

55 
mov
 
	gÂ
, 
	g•


56 .
	gcfi_def_cÁ_ªgi°î
 28

57 
mov
 
	gr16
, 
r7


61 
sub
 
	g•
, sp, 
r6


64 
mov
 
	gr2
, 
r4


65 
mov
 
	gr4
, 
•


66 
ˇŒr
 
r2


70 
ldw
 
	gr4
, 0(
	g•
)

71 
ldw
 
	gr5
, 4(
	g•
)

72 
ldw
 
	gr6
, 8(
	g•
)

73 
ldw
 
	gr7
, 12(
	g•
)

74 
addi
 
	g•
, sp, 16

77 
ˇŒr
 
r16


80 
mov
 
	g•
, 
Â


81 
ldw
 
	gø
, 8(
	g•
)

82 
ldw
 
	gÂ
, 4(
	g•
)

83 
ldw
 
	gr16
, 0(
	g•
)

84 
addi
 
	g•
, sp, 12

85 
	gªt


86 .
	gcfi_íd¥oc


87 .
size
 
	gffi_ˇŒ_sysv
, .-ffi_call_sysv

96 .
	g£˘i⁄
 .
	gãxt


97 .
	gÆign
 2

98 .
globÆ
 
	gffi_˛osuª_sysv


99 .
ty≥
 
	gffi_˛osuª_sysv
, @
fun˘i⁄


101 
	gffi_˛osuª_sysv
:

102 .
cfi_°¨çroc


108 
addi
 
•
, 
	g•
, -20

109 .
	gcfi_def_cÁ_off£t
 20

110 
°w
 
	gø
, 0(
	g•
)

111 .
	gcfi_off£t
 31, -20

112 
°w
 
	gr4
, 4(
	g•
)

113 .
	gcfi_off£t
 4, -16

114 
°w
 
	gr5
, 8(
	g•
)

115 .
	gcfi_off£t
 5, -12

116 
°w
 
	gr6
, 12(
	g•
)

117 .
	gcfi_off£t
 6, -8

118 
°w
 
	gr7
, 16(
	g•
)

119 .
	gcfi_off£t
 7, -4

125 
addi
 
	gr4
, 
	g•
, 4

126 
mov
 
	gr5
, 
r10


127 
ˇŒr
 
r9


130 
ldw
 
	gø
, 0(
	g•
)

131 
addi
 
	g•
, sp, 20

132 .
	gcfi_def_cÁ_off£t
 -20

133 
	gªt


134 .
	gcfi_íd¥oc


135 .
size
 
	gffi_˛osuª_sysv
, .-ffi_closure_sysv

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/or1k/ffi.c

27 
	~<ffi.h
>

28 
	~"ffi_comm⁄.h
"

33 * 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

35 *
°ackãmp
 = 
°ack
;

36 
i
, 
s
;

37 
ffi_ty≥
 **
¨g
;

38 
cou¡
 = 0;

39 
nfixed¨gs
;

41 
nfixed¨gs
 = 
ecif
->
cif
->nfixedargs;

42 
¨g
 = 
ecif
->
cif
->
¨g_ty≥s
;

43 **
¨gv
 = 
ecif
->
avÆue
;

45 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

47 *(**Ë
°ack
 = 
ecif
->
rvÆue
;

48 
°ack
 += 4;

49 
cou¡
 = 4;

51 
i
=0; i<
ecif
->
cif
->
«rgs
; i++)

55 i‡((
nfixed¨gs
 =0Ë&& (
cou¡
 < 24))

57 
cou¡
 = 24;

58 
°ack
 = 
°ackãmp
 + 24;

60 
nfixed¨gs
--;

62 
s
 = 4;

63 (*
¨g
)->
ty≥
)

65 
FFI_TYPE_STRUCT
:

66 *(**)
°ack
 = *
¨gv
;

69 
FFI_TYPE_SINT8
:

70 *(sig√d *Ë
°ack
 = (sig√d )*(
SINT8
 *)(* 
¨gv
);

73 
FFI_TYPE_UINT8
:

74 *(*Ë
°ack
 = ()*(
UINT8
 *)(* 
¨gv
);

77 
FFI_TYPE_SINT16
:

78 *(sig√d *Ë
°ack
 = (sig√d )*(
SINT16
 *)(* 
¨gv
);

81 
FFI_TYPE_UINT16
:

82 *(*Ë
°ack
 = ()*(
UINT16
 *)(* 
¨gv
);

85 
FFI_TYPE_SINT32
:

86 
FFI_TYPE_UINT32
:

87 
FFI_TYPE_FLOAT
:

88 
FFI_TYPE_POINTER
:

89 *(*)
°ack
 = *(*)(*
¨gv
);

93 i‡(
cou¡
 == 20)

95 
°ack
 += 4;

96 
cou¡
 += 4;

98 
s
 = (*
¨g
)->
size
;

99 
	`mem˝y
(
°ack
, *
¨gv
, 
s
);

103 
°ack
 +
s
;

104 
cou¡
 +
s
;

105 
¨gv
++;

106 
¨g
++;

108  
°ackãmp
 + ((
cou¡
>24)?24:0);

109 
	}
}

111 
ffi_ˇŒ_SYSV
(,

112 
exãnded_cif
 *,

113 *(*)(*, 
exãnded_cif
 *),

115 (*
‚
)(),

119 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

121 
i
;

122 
size
;

123 
ffi_ty≥
 **
¨g
;

127 
i
 = 0, 
¨g
 = 
cif
->
¨g_ty≥s
, 
size
=0; i < cif->
«rgs
; i++,árg++)

129 i‡((*
¨g
)->
ty≥
 =
FFI_TYPE_STRUCT
)

130 
size
 += 4;

132 i‡((*
¨g
)->
size
 <= 4)

133 
size
 += 4;

135 
size
 += 8;

139 i‡(
cif
->
«rgs
 !cif->
nfixed¨gs
)

140 
size
 += 24;

142 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

143 
size
 += 4;

146 
exãnded_cif
 
ecif
;

147 
ecif
.
cif
 = cif;

148 
ecif
.
avÆue
 =ávalue;

149 
ecif
.
rvÆue
 =Ñvalue;

151 
cif
->
abi
)

153 
FFI_SYSV
:

154 
	`ffi_ˇŒ_SYSV
(
size
, &
ecif
, 
ffi_¥ï_¨gs
, 
rvÆue
, 
‚
, 
cif
->
Êags
);

157 
	`FFI_ASSERT
(0);

160 
	}
}

163 
	$ffi_˛osuª_SYSV
(
r3
, 
r4
, 
r5
,

164 
r6
, 
r7
, 
r8
)

166 *
•
 
	`__asm__
 ("r17");

167 *
r13
 
	`__asm__
 ("r13");

169 
ffi_˛osuª
* 
˛osuª
 = (ffi_˛osuª*Ë
r13
;

170 *
°ack_¨gs
 = 
•
;

173 
ªgi°î_¨gs
[6] =

174 { 
r3
, 
r4
, 
r5
, 
r6
, 
r7
, 
r8
 };

177 *
°ru˘_rvÆue
 = (*Ë
r3
;

179 
ffi_cif
 *
cif
 = 
˛osuª
->cif;

180 
ffi_ty≥
 **
¨g_ty≥s
 = 
cif
->arg_types;

181 **
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 * (*));

182 *
±r
 = (*Ë
ªgi°î_¨gs
;

183 
cou¡
 = 0;

184 
nfixed¨gs
 = 
cif
->nfixedargs;

185 
i
;

189 i‡((
cif
->
πy≥
 !
NULL
Ë&& (cif->πy≥->
ty≥
 =
FFI_TYPE_STRUCT
))

191 
±r
 += 4;

192 
cou¡
 = 4;

196 
i
 = 0; i < 
cif
->
«rgs
; i++)

200 i‡((
nfixed¨gs
 =0Ë&& (
cou¡
 < 24))

202 
±r
 = 
°ack_¨gs
;

203 
cou¡
 = 24;

205 
nfixed¨gs
--;

207 
¨g_ty≥s
[
i
]->
ty≥
)

209 
FFI_TYPE_SINT8
:

210 
FFI_TYPE_UINT8
:

211 
avÆue
[
i
] = 
±r
 + 3;

214 
FFI_TYPE_SINT16
:

215 
FFI_TYPE_UINT16
:

216 
avÆue
[
i
] = 
±r
 + 2;

219 
FFI_TYPE_SINT32
:

220 
FFI_TYPE_UINT32
:

221 
FFI_TYPE_FLOAT
:

222 
FFI_TYPE_POINTER
:

223 
avÆue
[
i
] = 
±r
;

226 
FFI_TYPE_STRUCT
:

227 
avÆue
[
i
] = *(**)
±r
;

234 i‡(
±r
 =&
ªgi°î_¨gs
[5])

235 
±r
 = 
°ack_¨gs
;

236 
avÆue
[
i
] = 
±r
;

237 
±r
 += 4;

238 
cou¡
 += 4;

241 
±r
 += 4;

242 
cou¡
 += 4;

247 i‡(
cou¡
 == 24)

248 
±r
 = 
°ack_¨gs
;

251 i‡(
cif
->
πy≥
 && (cif->πy≥->
ty≥
 =
FFI_TYPE_STRUCT
))

253 (
˛osuª
->
fun
Ë(
cif
, 
°ru˘_rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

256 
rvÆue
;

257 (
˛osuª
->
fun
Ë(
cif
, &
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

258 i‡(
cif
->
πy≥
)

259 
	`asm
 ("l.‹òr12, %0, 0x0\¿l.lwzÑ11, 0‘12)\¿l.lwzÑ12, 4‘12)" : : "r" (&
rvÆue
));

261 
	}
}

264 
ffi_°©us


265 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

266 
ffi_cif
* 
cif
,

267 (*
fun
)(
ffi_cif
*,*,**,*),

268 *
u£r_d©a
,

269 *
codñoc
)

271 *
åamp
 = (*Ë
˛osuª
->tramp;

272 
‚
 = (Ë
ffi_˛osuª_SYSV
;

273 
˛s
 = (Ë
codñoc
;

275 i‡(
cif
->
abi
 !
FFI_SYSV
)

276  
FFI_BAD_ABI
;

278 
˛osuª
->
cif
 = cif;

279 
˛osuª
->
u£r_d©a
 = user_data;

280 
˛osuª
->
fun
 = fun;

283 
åamp
[0] = (0x6 << 10) | (13 << 5);

284 
åamp
[1] = 
˛s
 >> 16;

285 
åamp
[2] = (0x2a << 10) | (13 << 5) | 13;

286 
åamp
[3] = 
˛s
 & 0xFFFF;

288 
åamp
[4] = (0x6 << 10) | (15 << 5);

289 
åamp
[5] = 
‚
 >> 16;

290 
åamp
[6] = (0x2a << 10) | (15 << 5) | 15;

291 
åamp
[7] = 
‚
 & 0xFFFF;

293 
åamp
[8] = (0x11 << 10);

294 
åamp
[9] = 15 << 11;

296 
åamp
[10] = (0x2a << 10) | (17 << 5) | 1;

297 
åamp
[11] = 0x0;

299  
FFI_OK
;

300 
	}
}

303 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

305 
cif
->
Êags
 = 0;

308 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

309 
cif
->
Êags
 = 
FFI_TYPE_STRUCT
;

311 i‡(
cif
->
πy≥
->
size
 > 4)

312 
cif
->
Êags
 = 
FFI_TYPE_UINT64
;

314 
cif
->
nfixed¨gs
 = cif->
«rgs
;

316  
FFI_OK
;

317 
	}
}

320 
ffi_°©us
 
	$ffi_¥ï_cif_machdï_v¨
(
ffi_cif
 *
cif
,

321 
nfixed¨gs
, 
¡ŸÆ¨gs
)

323 
ffi_°©us
 
°©us
;

325 
°©us
 = 
	`ffi_¥ï_cif_machdï
 (
cif
);

326 
cif
->
nfixed¨gs
 =Çfixedargs;

327  
°©us
;

328 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/or1k/ffitarget.h

27 #i‚de‡
LIBFFI_TARGET_H


28 
	#LIBFFI_TARGET_H


	)

30 #i‚de‡
LIBFFI_H


36 #i‚de‡
LIBFFI_ASM


37 
	tffi_¨g
;

38 sig√d 
	tffi_ßrg
;

40 
	effi_abi
 {

41 
	mFFI_FIRST_ABI
 = 0,

42 
	mFFI_SYSV
,

43 
	mFFI_LAST_ABI
,

44 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


45 } 
	tffi_abi
;

50 
	#FFI_CLOSURES
 1

	)

51 
	#FFI_NATIVE_RAW_API
 0

	)

52 
	#FFI_TRAMPOLINE_SIZE
 (24)

	)

54 
	#FFI_TARGET_SPECIFIC_VARIADIC
 1

	)

55 
	#FFI_EXTRA_CIF_FIELDS
 
nfixed¨gs
;

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/or1k/sysv.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

31 .
	gãxt


32 .
globl
 
	gffi_ˇŒ_SYSV


33 .
ty≥
 
	gffi_ˇŒ_SYSV
, @
fun˘i⁄


43 
	gffi_ˇŒ_SYSV
:

45 
l
.
sw
 -4(
r1
), 
r9


46 
	gl
.
	gsw
 -8(
	gr1
), 
r1


47 
	gl
.
	gsw
 -12(
	gr1
), 
r14


48 
	gl
.
	gsw
 -16(
	gr1
), 
r16


49 
	gl
.
	gsw
 -20(
	gr1
), 
r18


50 
	gl
.
	gsw
 -24(
	gr1
), 
r20


52 
	gl
.
‹i
 
	gr14
, 
	gr1
, 0x0

53 
	gl
.
addi
 
	gr1
,Ñ1, -24

55 
	gl
.
‹i
 
	gr16
, 
	gr7
, 0x0

56 
	gl
.
‹i
 
	gr18
, 
	gr6
, 0x0

57 
	gl
.
‹i
 
	gr20
, 
	gr8
, 0x0

59 
	gl
.
sub
 
	gr1
,Ñ1, 
r3


62 
	gl
.
‹i
 
	gr3
, 
	gr1
, 0x0

63 
	gl
.
jÆr
 
r5


64 
	gl
.
n›


68 
	gl
.
lwz
 
	gr3
, 0(
	gr1
)

69 
	gl
.
lwz
 
	gr4
, 4(
	gr1
)

70 
	gl
.
lwz
 
	gr5
, 8(
	gr1
)

71 
	gl
.
lwz
 
	gr6
, 12(
	gr1
)

72 
	gl
.
lwz
 
	gr7
, 16(
	gr1
)

73 
	gl
.
lwz
 
	gr8
, 20(
	gr1
)

74 
	gl
.
‹i
 
	gr1
, 
	gr11
, 0x0

75 
	gl
.
jÆr
 
r16


76 
	gl
.
n›


80 
	gl
.
s„qi
 
	gr20
, 
FFI_TYPE_STRUCT


81 
	gl
.
bf
 
ªt


82 
	gl
.
n›


86 
	gl
.
s„qi
 
	gr20
, 
FFI_TYPE_UINT64


87 
	gl
.
bnf
 
four_byã_ªt


88 
	gl
.
n›


90 
	gl
.
	gsw
 4(
	gr18
), 
r12


92 
	gfour_byã_ªt
:

93 
l
.
sw
 0(
r18
), 
r11


95 
	gªt
:

97 
l
.
‹i
 
r1
, 
	gr14
, 0x0

98 
	gl
.
lwz
 
	gr9
, -4(
	gr1
)

99 
	gl
.
lwz
 
	gr1
, -8(r1)

100 
	gl
.
lwz
 
	gr14
, -12(
	gr1
)

101 
	gl
.
lwz
 
	gr16
, -16(
	gr1
)

102 
	gl
.
lwz
 
	gr18
, -20(
	gr1
)

103 
	gl
.
lwz
 
	gr20
, -24(
	gr1
)

104 
	gl
.
jr
 
r9


105 
	gl
.
	gn›


107 .
size
 
	gffi_ˇŒ_SYSV
, .-ffi_call_SYSV

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/pa/ffi.c

31 
	~<ffi.h
>

32 
	~<ffi_comm⁄.h
>

34 
	~<°dlib.h
>

35 
	~<°dio.h
>

37 
	#ROUND_UP
(
v
, 
a
Ë(((
size_t
)(vË+ (aË- 1Ë& ~(◊Ë- 1))

	)

39 
	#MIN_STACK_SIZE
 64

	)

40 
	#FIRST_ARG_SLOT
 9

	)

41 
	#DEBUG_LEVEL
 0

	)

43 
	#Êdw
(
addr
, 
Âªg
) \

44 
__asm__
 vﬁ©ûê("Êdw 0(%0), %%" #Âªg "L" : : "r"(
addr
Ë: #Âªg)

	)

45 
	#f°w
(
Âªg
, 
addr
) \

46 
__asm__
 vﬁ©ûê("f°w %%" #Âªg "L, 0(%0)" : : "r"(
addr
))

	)

47 
	#Êdd
(
addr
, 
Âªg
) \

48 
__asm__
 vﬁ©ûê("Êdd 0(%0), %%" #Âªg : : "r"(
addr
Ë: #Âªg)

	)

49 
	#f°d
(
Âªg
, 
addr
) \

50 
__asm__
 vﬁ©ûê("f°d %%" #Âªg "L, 0(%0)" : : "r"(
addr
))

	)

52 
	#debug
(
lvl
, 
x
...Ëdÿ{ i‡÷v»<
DEBUG_LEVEL
Ë{ 
	`¥ötf
(x); } } 0)

	)

54 
ölöe
 
	$ffi_°ru˘_ty≥
(
ffi_ty≥
 *
t
)

56 
size_t
 
sz
 = 
t
->
size
;

64 i‡(
sz
 <= 1)

65  
FFI_TYPE_UINT8
;

66 i‡(
sz
 == 2)

67  
FFI_TYPE_SMALL_STRUCT2
;

68 i‡(
sz
 == 3)

69  
FFI_TYPE_SMALL_STRUCT3
;

70 i‡(
sz
 == 4)

71  
FFI_TYPE_SMALL_STRUCT4
;

72 i‡(
sz
 == 5)

73  
FFI_TYPE_SMALL_STRUCT5
;

74 i‡(
sz
 == 6)

75  
FFI_TYPE_SMALL_STRUCT6
;

76 i‡(
sz
 == 7)

77  
FFI_TYPE_SMALL_STRUCT7
;

78 i‡(
sz
 <= 8)

79  
FFI_TYPE_SMALL_STRUCT8
;

81  
FFI_TYPE_STRUCT
;

82 
	}
}

142 
	$ffi_¥ï_¨gs_∑32
(
UINT32
 *
°ack
, 
exãnded_cif
 *
ecif
, 
byãs
)

144 
i
;

145 
ffi_ty≥
 **
p_¨g
;

146 **
p_¨gv
;

147 
¶Ÿ
 = 
FIRST_ARG_SLOT
;

148 *
de°_˝y
;

149 
size_t
 
Àn
;

151 
	`debug
(1, "%s: sèck = %p,Éci‡%p, byã†%u\n", 
__FUNCTION__
, 
°ack
,

152 
ecif
, 
byãs
);

154 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
;

155 
p_¨gv
 = 
ecif
->
avÆue
;

157 
i
 = 0; i < 
ecif
->
cif
->
«rgs
; i++)

159 
ty≥
 = (*
p_¨g
)->type;

161 
ty≥
)

163 
FFI_TYPE_SINT8
:

164 *(
SINT32
 *)(
°ack
 - 
¶Ÿ
Ë*(
SINT8
 *)(*
p_¨gv
);

167 
FFI_TYPE_UINT8
:

168 *(
UINT32
 *)(
°ack
 - 
¶Ÿ
Ë*(
UINT8
 *)(*
p_¨gv
);

171 
FFI_TYPE_SINT16
:

172 *(
SINT32
 *)(
°ack
 - 
¶Ÿ
Ë*(
SINT16
 *)(*
p_¨gv
);

175 
FFI_TYPE_UINT16
:

176 *(
UINT32
 *)(
°ack
 - 
¶Ÿ
Ë*(
UINT16
 *)(*
p_¨gv
);

179 
FFI_TYPE_UINT32
:

180 
FFI_TYPE_SINT32
:

181 
FFI_TYPE_POINTER
:

182 
	`debug
(3, "St‹ög UINT32 %u i¿¶Ÿ %u\n", *(
UINT32
 *)(*
p_¨gv
),

183 
¶Ÿ
);

184 *(
UINT32
 *)(
°ack
 - 
¶Ÿ
Ë*(UINT32 *)(*
p_¨gv
);

187 
FFI_TYPE_UINT64
:

188 
FFI_TYPE_SINT64
:

190 
¶Ÿ
 += (slot & 1) ? 1 : 2;

191 *(
UINT64
 *)(
°ack
 - 
¶Ÿ
Ë*(UINT64 *)(*
p_¨gv
);

194 
FFI_TYPE_FLOAT
:

196 
	`debug
(3, "St‹ög UINT32(ÊﬂtËö slŸ %u\n", 
¶Ÿ
);

197 *(
UINT32
 *)(
°ack
 - 
¶Ÿ
Ë*(UINT32 *)(*
p_¨gv
);

198 
¶Ÿ
 - 
FIRST_ARG_SLOT
)

201 0: 
	`Êdw
(
°ack
 - 
¶Ÿ
, 
‰4
); ;

202 1: 
	`Êdw
(
°ack
 - 
¶Ÿ
, 
‰5
); ;

203 2: 
	`Êdw
(
°ack
 - 
¶Ÿ
, 
‰6
); ;

204 3: 
	`Êdw
(
°ack
 - 
¶Ÿ
, 
‰7
); ;

208 
FFI_TYPE_DOUBLE
:

210 
¶Ÿ
 += (slot & 1) ? 1 : 2;

211 
	`debug
(3, "St‹ög UINT64(doubÀË© slŸ %u\n", 
¶Ÿ
);

212 *(
UINT64
 *)(
°ack
 - 
¶Ÿ
Ë*(UINT64 *)(*
p_¨gv
);

213 
¶Ÿ
 - 
FIRST_ARG_SLOT
)

216 1: 
	`Êdd
(
°ack
 - 
¶Ÿ
, 
‰5
); ;

217 3: 
	`Êdd
(
°ack
 - 
¶Ÿ
, 
‰7
); ;

221 #ifde‡
PA_HPUX


222 
FFI_TYPE_LONGDOUBLE
:

225 *(
UINT32
 *)(
°ack
 - 
¶Ÿ
Ë(UINT32)(*
p_¨gv
);

229 
FFI_TYPE_STRUCT
:

235 
Àn
 = (*
p_¨g
)->
size
;

236 i‡(
Àn
 <= 4)

238 
de°_˝y
 = (*)(
°ack
 - 
¶Ÿ
Ë+ 4 - 
Àn
;

239 
	`mem˝y
(
de°_˝y
, (*)*
p_¨gv
, 
Àn
);

241 i‡(
Àn
 <= 8)

243 
¶Ÿ
 += (slot & 1) ? 1 : 2;

244 
de°_˝y
 = (*)(
°ack
 - 
¶Ÿ
Ë+ 8 - 
Àn
;

245 
	`mem˝y
(
de°_˝y
, (*)*
p_¨gv
, 
Àn
);

248 *(
UINT32
 *)(
°ack
 - 
¶Ÿ
Ë(UINT32)(*
p_¨gv
);

252 
	`FFI_ASSERT
(0);

255 
¶Ÿ
++;

256 
p_¨g
++;

257 
p_¨gv
++;

262 
n
;

264 
	`debug
(5, "Stack setup:\n");

265 
n
 = 0;Ç < (
byãs
 + 3) / 4;Ç++)

267 i‡((
n
%4Ë=0Ë{ 
	`debug
(5, "\n%08x: ", ()(
°ack
 -Ç)); }

268 
	`debug
(5, "%08x ", *(
°ack
 - 
n
));

270 
	`debug
(5, "\n");

273 
	`FFI_ASSERT
(
¶Ÿ
 * 4 <
byãs
);

276 
	}
}

278 
	$ffi_size_°ack_∑32
(
ffi_cif
 *
cif
)

280 
ffi_ty≥
 **
±r
;

281 
i
;

282 
z
 = 0;

284 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = 0; i < cif->
«rgs
;Ötr++, i++)

286 
ty≥
 = (*
±r
)->type;

288 
ty≥
)

290 
FFI_TYPE_DOUBLE
:

291 
FFI_TYPE_UINT64
:

292 
FFI_TYPE_SINT64
:

293 
z
 += 2 + (z & 1);

296 #ifde‡
PA_HPUX


297 
FFI_TYPE_LONGDOUBLE
:

299 
FFI_TYPE_STRUCT
:

300 
z
 += 1;

304 
z
++;

310 i‡(
z
 <= 6)

311 
cif
->
byãs
 = 
MIN_STACK_SIZE
;

313 
cif
->
byãs
 = 64 + 
	`ROUND_UP
((
z
 - 6Ë* (
UINT32
), 
MIN_STACK_SIZE
);

315 
	`debug
(3, "CÆcuœãd sèck sizêi†%u byãs\n", 
cif
->
byãs
);

316 
	}
}

319 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

322 
cif
->
πy≥
->
ty≥
)

324 
FFI_TYPE_VOID
:

325 
FFI_TYPE_FLOAT
:

326 
FFI_TYPE_DOUBLE
:

327 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

330 #ifde‡
PA_HPUX


331 
FFI_TYPE_LONGDOUBLE
:

333 
cif
->
Êags
 = 
FFI_TYPE_STRUCT
;

337 
FFI_TYPE_STRUCT
:

343 
cif
->
Êags
 = 
	`ffi_°ru˘_ty≥
(cif->
πy≥
);

346 
FFI_TYPE_UINT64
:

347 
FFI_TYPE_SINT64
:

348 
cif
->
Êags
 = 
FFI_TYPE_UINT64
;

352 
cif
->
Êags
 = 
FFI_TYPE_INT
;

358 
cif
->
abi
)

360 
FFI_PA32
:

361 
	`ffi_size_°ack_∑32
(
cif
);

365 
	`FFI_ASSERT
(0);

369  
FFI_OK
;

370 
	}
}

372 
ffi_ˇŒ_∑32
((*)(
UINT32
 *, 
exãnded_cif
 *, ),

373 
exãnded_cif
 *, , , *,

374 (*
‚
)());

376 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

378 
exãnded_cif
 
ecif
;

380 
ecif
.
cif
 = cif;

381 
ecif
.
avÆue
 =ávalue;

386 i‡(
rvÆue
 =
NULL


387 #ifde‡
PA_HPUX


388 && (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


389 || 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_LONGDOUBLE
))

391 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

394 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

397 
ecif
.
rvÆue
 =Ñvalue;

400 
cif
->
abi
)

402 
FFI_PA32
:

403 
	`debug
(3, "CÆlög ffi_ˇŒ_∑32:Écif=%p, byãs=%u, fœgs=%u,ÑvÆue=%p, fn=%p\n", &
ecif
, 
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
, (*)
‚
);

404 
	`ffi_ˇŒ_∑32
(
ffi_¥ï_¨gs_∑32
, &
ecif
, 
cif
->
byãs
,

405 
cif
->
Êags
, 
ecif
.
rvÆue
, 
‚
);

409 
	`FFI_ASSERT
(0);

412 
	}
}

414 #i‡
FFI_CLOSURES


419 
ffi_°©us
 
	$ffi_˛osuª_ö√r_∑32
(
ffi_˛osuª
 *
˛osuª
, 
UINT32
 *
°ack
)

421 
ffi_cif
 *
cif
;

422 **
avÆue
;

423 *
rvÆue
;

424 
UINT32
 
ªt
[2];

425 
ffi_ty≥
 **
p_¨g
;

426 *
tmp
;

427 
i
, 
avn
;

428 
¶Ÿ
 = 
FIRST_ARG_SLOT
;

429 
UINT32
 
r28
 
	`asm
("r28");

431 
cif
 = 
˛osuª
->cif;

434 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

435 
rvÆue
 = (*)
r28
;

437 
rvÆue
 = &
ªt
[0];

439 
avÆue
 = (**)
	`Æloˇ
(
cif
->
«rgs
 * 
FFI_SIZEOF_ARG
);

440 
avn
 = 
cif
->
«rgs
;

441 
p_¨g
 = 
cif
->
¨g_ty≥s
;

443 
i
 = 0; i < 
avn
; i++)

445 
ty≥
 = (*
p_¨g
)->type;

447 
ty≥
)

449 
FFI_TYPE_SINT8
:

450 
FFI_TYPE_UINT8
:

451 
FFI_TYPE_SINT16
:

452 
FFI_TYPE_UINT16
:

453 
FFI_TYPE_SINT32
:

454 
FFI_TYPE_UINT32
:

455 
FFI_TYPE_POINTER
:

456 
avÆue
[
i
] = (*)(
°ack
 - 
¶Ÿ
Ë+ (
UINT32
Ë- (*
p_¨g
)->
size
;

459 
FFI_TYPE_SINT64
:

460 
FFI_TYPE_UINT64
:

461 
¶Ÿ
 += (slot & 1) ? 1 : 2;

462 
avÆue
[
i
] = (*)(
°ack
 - 
¶Ÿ
);

465 
FFI_TYPE_FLOAT
:

466 #ifde‡
PA_LINUX


473 
¶Ÿ
 - 
FIRST_ARG_SLOT
)

475 0: 
	`f°w
(
‰4
, (*)(
°ack
 - 
¶Ÿ
)); ;

476 1: 
	`f°w
(
‰5
, (*)(
°ack
 - 
¶Ÿ
)); ;

477 2: 
	`f°w
(
‰6
, (*)(
°ack
 - 
¶Ÿ
)); ;

478 3: 
	`f°w
(
‰7
, (*)(
°ack
 - 
¶Ÿ
)); ;

481 
avÆue
[
i
] = (*)(
°ack
 - 
¶Ÿ
);

484 
FFI_TYPE_DOUBLE
:

485 
¶Ÿ
 += (slot & 1) ? 1 : 2;

486 #ifde‡
PA_LINUX


488 
¶Ÿ
 - 
FIRST_ARG_SLOT
)

490 1: 
	`f°d
(
‰5
, (*)(
°ack
 - 
¶Ÿ
)); ;

491 3: 
	`f°d
(
‰7
, (*)(
°ack
 - 
¶Ÿ
)); ;

494 
avÆue
[
i
] = (*)(
°ack
 - 
¶Ÿ
);

497 #ifde‡
PA_HPUX


498 
FFI_TYPE_LONGDOUBLE
:

500 
avÆue
[
i
] = (*Ë*(
°ack
 - 
¶Ÿ
);

504 
FFI_TYPE_STRUCT
:

508 if((*
p_¨g
)->
size
 <= 4)

510 
avÆue
[
i
] = (*)(
°ack
 - 
¶Ÿ
Ë+ (
UINT32
) -

511 (*
p_¨g
)->
size
;

513 i‡((*
p_¨g
)->
size
 <= 8)

515 
¶Ÿ
 += (slot & 1) ? 1 : 2;

516 
avÆue
[
i
] = (*)(
°ack
 - 
¶Ÿ
Ë+ (
UINT64
) -

517 (*
p_¨g
)->
size
;

520 
avÆue
[
i
] = (*Ë*(
°ack
 - 
¶Ÿ
);

524 
	`FFI_ASSERT
(0);

527 
¶Ÿ
++;

528 
p_¨g
++;

532 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

534 
	`debug
(3, "a·î cÆlög fun˘i⁄,Ñë[0] = %08x,Ñë[1] = %08x\n", 
ªt
[0],

535 
ªt
[1]);

538 
cif
->
Êags
)

540 
FFI_TYPE_UINT8
:

541 *(
°ack
 - 
FIRST_ARG_SLOT
Ë(
UINT8
)(
ªt
[0] >> 24);

543 
FFI_TYPE_SINT8
:

544 *(
°ack
 - 
FIRST_ARG_SLOT
Ë(
SINT8
)(
ªt
[0] >> 24);

546 
FFI_TYPE_UINT16
:

547 *(
°ack
 - 
FIRST_ARG_SLOT
Ë(
UINT16
)(
ªt
[0] >> 16);

549 
FFI_TYPE_SINT16
:

550 *(
°ack
 - 
FIRST_ARG_SLOT
Ë(
SINT16
)(
ªt
[0] >> 16);

552 
FFI_TYPE_INT
:

553 
FFI_TYPE_SINT32
:

554 
FFI_TYPE_UINT32
:

555 *(
°ack
 - 
FIRST_ARG_SLOT
Ë
ªt
[0];

557 
FFI_TYPE_SINT64
:

558 
FFI_TYPE_UINT64
:

559 *(
°ack
 - 
FIRST_ARG_SLOT
Ë
ªt
[0];

560 *(
°ack
 - 
FIRST_ARG_SLOT
 - 1Ë
ªt
[1];

563 
FFI_TYPE_DOUBLE
:

564 
	`Êdd
(
rvÆue
, 
‰4
);

567 
FFI_TYPE_FLOAT
:

568 
	`Êdw
(
rvÆue
, 
‰4
);

571 
FFI_TYPE_STRUCT
:

575 
FFI_TYPE_SMALL_STRUCT2
:

576 
FFI_TYPE_SMALL_STRUCT3
:

577 
FFI_TYPE_SMALL_STRUCT4
:

578 
tmp
 = (*)(
°ack
 - 
FIRST_ARG_SLOT
);

579 
tmp
 +4 - 
cif
->
πy≥
->
size
;

580 
	`mem˝y
((*)
tmp
, &
ªt
[0], 
cif
->
πy≥
->
size
);

583 
FFI_TYPE_SMALL_STRUCT5
:

584 
FFI_TYPE_SMALL_STRUCT6
:

585 
FFI_TYPE_SMALL_STRUCT7
:

586 
FFI_TYPE_SMALL_STRUCT8
:

588 
ªt2
[2];

589 
off
;

592 
cif
->
Êags
)

594 
FFI_TYPE_SMALL_STRUCT5
: 
off
 = 3; ;

595 
FFI_TYPE_SMALL_STRUCT6
: 
off
 = 2; ;

596 
FFI_TYPE_SMALL_STRUCT7
: 
off
 = 1; ;

597 : 
off
 = 0; ;

600 
	`mem£t
 (
ªt2
, 0,  (ret2));

601 
	`mem˝y
 ((*)
ªt2
 + 
off
, 
ªt
, 8 - off);

603 *(
°ack
 - 
FIRST_ARG_SLOT
Ë
ªt2
[0];

604 *(
°ack
 - 
FIRST_ARG_SLOT
 - 1Ë
ªt2
[1];

608 
FFI_TYPE_POINTER
:

609 
FFI_TYPE_VOID
:

613 
	`debug
(0, "as£π wôh cif->Êags: %d\n",
cif
->
Êags
);

614 
	`FFI_ASSERT
(0);

617  
FFI_OK
;

618 
	}
}

624 
ffi_˛osuª_∑32
();

626 
ffi_°©us


627 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

628 
ffi_cif
* 
cif
,

629 (*
fun
)(
ffi_cif
*,*,**,*),

630 *
u£r_d©a
,

631 *
codñoc
)

633 
UINT32
 *
åamp
 = (UINT32 *)(
˛osuª
->tramp);

634 #ifde‡
PA_HPUX


635 
UINT32
 *
tmp
;

638 i‡(
cif
->
abi
 !
FFI_PA32
)

639  
FFI_BAD_ABI
;

644 #ifde‡
PA_LINUX


645 
åamp
[0] = 0xeaa00000;

646 
åamp
[1] = 0xd6a01c1e;

647 
åamp
[2] = 0x4aa10028;

648 
åamp
[3] = 0x36b53ff1;

649 
åamp
[4] = 0x0c201096;

650 
åamp
[5] = 0xeac0c000;

651 
åamp
[6] = 0x0c281093;

652 
åamp
[7] = ((
UINT32
)(
ffi_˛osuª_∑32
) & ~2);

656 
__asm__
 volatile(

670 : "r"(()
åamp
 & ~31),

675 #ifde‡
PA_HPUX


676 
åamp
[0] = 0xeaa00000;

677 
åamp
[1] = 0xd6a01c1e;

678 
åamp
[2] = 0x4aa10038;

679 
åamp
[3] = 0x36b53ff1;

680 
åamp
[4] = 0x0c201096;

681 
åamp
[5] = 0x02c010b4;

682 
åamp
[6] = 0x00141820;

683 
åamp
[7] = 0xe2c00000;

684 
åamp
[8] = 0x0c281093;

685 
åamp
[9] = ((
UINT32
)(
ffi_˛osuª_∑32
) & ~2);

688 
__asm__
 volatile(

707 : "=&r" (()
tmp
)

708 : "r" (()
åamp
 & ~31),

713 
˛osuª
->
cif
 = cif;

714 
˛osuª
->
u£r_d©a
 = user_data;

715 
˛osuª
->
fun
 = fun;

717  
FFI_OK
;

718 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/pa/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


37 #i‚de‡
LIBFFI_ASM


38 
	tffi_¨g
;

39 sig√d 
	tffi_ßrg
;

41 
	effi_abi
 {

42 
	mFFI_FIRST_ABI
 = 0,

44 #ifde‡
PA_LINUX


45 
	mFFI_PA32
,

46 
	mFFI_LAST_ABI
,

47 
	mFFI_DEFAULT_ABI
 = 
FFI_PA32


50 #ifde‡
PA_HPUX


51 
FFI_PA32
,

52 
	mFFI_LAST_ABI
,

53 
	mFFI_DEFAULT_ABI
 = 
FFI_PA32


56 #ifde‡
PA64_HPUX


58 
FFI_PA64
,

59 
	mFFI_LAST_ABI
,

60 
	mFFI_DEFAULT_ABI
 = 
FFI_PA64


62 } 
	tffi_abi
;

65 
	#FFI_TARGET_SPECIFIC_STACK_SPACE_ALLOCATION


	)

69 
	#FFI_CLOSURES
 1

	)

70 
	#FFI_NATIVE_RAW_API
 0

	)

72 #ifde‡
PA_LINUX


73 
	#FFI_TRAMPOLINE_SIZE
 32

	)

75 
	#FFI_TRAMPOLINE_SIZE
 40

	)

78 
	#FFI_TYPE_SMALL_STRUCT2
 -1

	)

79 
	#FFI_TYPE_SMALL_STRUCT3
 -2

	)

80 
	#FFI_TYPE_SMALL_STRUCT4
 -3

	)

81 
	#FFI_TYPE_SMALL_STRUCT5
 -4

	)

82 
	#FFI_TYPE_SMALL_STRUCT6
 -5

	)

83 
	#FFI_TYPE_SMALL_STRUCT7
 -6

	)

84 
	#FFI_TYPE_SMALL_STRUCT8
 -7

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/pa/hpux32.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

32 .
	gLEVEL
 1.1

33 .
SPACE
 
	g$PRIVATE$


34 .
IMPORT
 
	g$globÆ$
,
	gDATA


35 .
IMPORT
 
	g$$dynˇŒ
,
	gMILLICODE


36 .
SUBSPA
 
	g$DATA$


37 .
	gÆign
 4

47 .
exp‹t
 
	gffi_ˇŒ_∑32
,
	gENTRY
,
	gPRIV_LEV
=3

48 .
imp‹t
 
ffi_¥ï_¨gs_∑32
,
	gCODE


50 .
SPACE
 
	g$TEXT$


51 .
SUBSPA
 
	g$CODE$


52 .
	gÆign
 4

54 
L$FB1


55 
	gffi_ˇŒ_∑32


56 .
	g¥oc


57 .
ˇŒöfo
 
	gFRAME
=64,
	gCALLS
,
	gSAVE_RP
,
	gSAVE_SP
,
	gENTRY_GR
=4

58 .
íåy


59 
°w
 %
Ω
, -20(%
	g•
)

60 
	gc›y
 %
	gr3
, %
r1


61 
L$CFI11


62 
	gc›y
 %
	g•
, %
r3


63 
L$CFI12


78 
	g°wm
 %
	gr1
, 64(%
	g•
)

79 
	g°w
 %
	gr4
, 12(%
	gr3
)

80 
L$CFI13


81 
	gc›y
 %
	g•
, %
r4


83 
	gaddl
 %
	g¨g2
, %
	gr4
, %
	g¨g0
 ; 
¨g
 
°ack


84 
	g°w
 %
	g¨g3
, -48(%
	gr3
Ë; 
ßve
 
Êags
 
we
 
√ed
 
ô
 
œãr


90 
bl
 
	gffi_¥ï_¨gs_∑32
,%
r2


91 
	gldo
 64(%
	g¨g0
), %
•


92 
	gldo
 -64(%
	g•
), %
•


98 
	gldw
 -36(%
	g•
), %
¨g0


99 
	gldw
 -40(%
	g•
), %
¨g1


100 
	gldw
 -44(%
	g•
), %
¨g2


101 
	gldw
 -48(%
	g•
), %
¨g3


105 
	gldw
 -52(%
	gr3
), %
	gªt0
 ; %ªt0 <- 
rvÆue


106 
	gldw
 -56(%
	gr3
), %
	gr22
 ; %r22 <- 
fun˘i⁄
 
to
 
ˇŒ


107 
bl
 
	g$$dynˇŒ
, %
	gr31
 ; 
CÆl
 
the
 
u£r
 
fun˘i⁄


108 
	gc›y
 %
	gr31
, %
Ω


111 
	gldw
 -48(%
	gr3
), %
	gr21
 ;Ñ21 <- 
Êags


112 
	gldw
 -52(%
	gr3
), %
	gr20
 ;Ñ20 <- 
rvÆue


117 
L$checköt


118 
	gcomib
,<>,
n
 
	gFFI_TYPE_INT
, %
	gr21
, 
L$checköt8


119 
b
 
L$d⁄e


120 
	g°w
 %
	gªt0
, 0(%
	gr20
)

122 
L$checköt8


123 
	gcomib
,<>,
n
 
	gFFI_TYPE_UINT8
, %
	gr21
, 
L$checköt16


124 
b
 
L$d⁄e


125 
	g°b
 %
	gªt0
, 0(%
	gr20
)

127 
L$checköt16


128 
	gcomib
,<>,
n
 
	gFFI_TYPE_UINT16
, %
	gr21
, 
L$checkdbl


129 
b
 
L$d⁄e


130 
	g°h
 %
	gªt0
, 0(%
	gr20
)

132 
L$checkdbl


133 
	gcomib
,<>,
n
 
	gFFI_TYPE_DOUBLE
, %
	gr21
, 
L$checkÊﬂt


134 
b
 
L$d⁄e


135 
	gf°d
 %
	g‰4
,0(%
	gr20
)

137 
L$checkÊﬂt


138 
	gcomib
,<>,
n
 
	gFFI_TYPE_FLOAT
, %
	gr21
, 
L$checkŒ


139 
b
 
L$d⁄e


140 
	gf°w
 %
	g‰4L
,0(%
	gr20
)

142 
L$checkŒ


143 
	gcomib
,<>,
n
 
	gFFI_TYPE_UINT64
, %
	gr21
, 
L$checksm°2


144 
	g°w
 %
	gªt0
, 0(%
	gr20
)

145 
b
 
L$d⁄e


146 
	g°w
 %
	gªt1
, 4(%
	gr20
)

148 
L$checksm°2


149 
	gcomib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT2
, %
	gr21
, 
L$checksm°3


151 
	gexåu
 %
	gªt0
, 23, 8, %
r22


152 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

153 
b
 
L$d⁄e


154 
	g°b
 %
	gªt0
, 0(%
	gr20
)

156 
L$checksm°3


157 
	gcomib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT3
, %
	gr21
, 
L$checksm°4


159 
	gexåu
 %
	gªt0
, 15, 8, %
r22


160 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

161 
	gexåu
 %
	gªt0
, 23, 8, %
r22


162 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

163 
b
 
L$d⁄e


164 
	g°b
 %
	gªt0
, 0(%
	gr20
)

166 
L$checksm°4


167 
	gcomib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT4
, %
	gr21
, 
L$checksm°5


169 
	gexåu
 %
	gªt0
, 7, 8, %
r22


170 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

171 
	gexåu
 %
	gªt0
, 15, 8, %
r22


172 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

173 
	gexåu
 %
	gªt0
, 23, 8, %
r22


174 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

175 
b
 
L$d⁄e


176 
	g°b
 %
	gªt0
, 0(%
	gr20
)

178 
L$checksm°5


179 
	gcomib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT5
, %
	gr21
, 
L$checksm°6


183 
	g°bs
,
	gma
 %
	gªt0
, 1(%
	gr20
)

184 
	gexåu
 %
	gªt1
, 7, 8, %
r22


185 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

186 
	gexåu
 %
	gªt1
, 15, 8, %
r22


187 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

188 
	gexåu
 %
	gªt1
, 23, 8, %
r22


189 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

190 
b
 
L$d⁄e


191 
	g°b
 %
	gªt1
, 0(%
	gr20
)

193 
L$checksm°6


194 
	gcomib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT6
, %
	gr21
, 
L$checksm°7


198 
	gexåu
 %
	gªt0
, 23, 8, %
r22


199 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

200 
	g°bs
,
	gma
 %
	gªt0
, 1(%
	gr20
)

201 
	gexåu
 %
	gªt1
, 7, 8, %
r22


202 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

203 
	gexåu
 %
	gªt1
, 15, 8, %
r22


204 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

205 
	gexåu
 %
	gªt1
, 23, 8, %
r22


206 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

207 
b
 
L$d⁄e


208 
	g°b
 %
	gªt1
, 0(%
	gr20
)

210 
L$checksm°7


211 
	gcomib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT7
, %
	gr21
, 
L$checksm°8


215 
	gexåu
 %
	gªt0
, 15, 8, %
r22


216 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

217 
	gexåu
 %
	gªt0
, 23, 8, %
r22


218 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

219 
	g°bs
,
	gma
 %
	gªt0
, 1(%
	gr20
)

220 
	gexåu
 %
	gªt1
, 7, 8, %
r22


221 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

222 
	gexåu
 %
	gªt1
, 15, 8, %
r22


223 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

224 
	gexåu
 %
	gªt1
, 23, 8, %
r22


225 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

226 
b
 
L$d⁄e


227 
	g°b
 %
	gªt1
, 0(%
	gr20
)

229 
L$checksm°8


230 
	gcomib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT8
, %
	gr21
, 
L$d⁄e


234 
	gexåu
 %
	gªt0
, 7, 8, %
r22


235 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

236 
	gexåu
 %
	gªt0
, 15, 8, %
r22


237 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

238 
	gexåu
 %
	gªt0
, 23, 8, %
r22


239 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

240 
	g°bs
,
	gma
 %
	gªt0
, 1(%
	gr20
)

241 
	gexåu
 %
	gªt1
, 7, 8, %
r22


242 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

243 
	gexåu
 %
	gªt1
, 15, 8, %
r22


244 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

245 
	gexåu
 %
	gªt1
, 23, 8, %
r22


246 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

247 
	g°b
 %
	gªt1
, 0(%
	gr20
)

249 
L$d⁄e


251 
	gc›y
 %
	gr4
, %
	g•
 ; 
p›
 
¨g
 
°ack


252 
	gldw
 12(%
	gr3
), %
r4


253 
	gldwm
 -64(%
	g•
), %
	gr3
 ; .. 
™d
 
p›
 
°ack


254 
	gldw
 -20(%
	g•
), %
Ω


255 
	gbv
 %
r0
(%
Ω
)

256 
	gn›


257 .
	gexô


258 .
¥o˚nd


259 
	gL$FE1


264 .
SPACE
 
	g$TEXT$


265 .
SUBSPA
 
	g$CODE$


266 .
exp‹t
 
	gffi_˛osuª_∑32
,
	gENTRY
,
	gPRIV_LEV
=3,
	gRTNVAL
=
GR


267 .
imp‹t
 
ffi_˛osuª_ö√r_∑32
,
	gCODE


268 .
	gÆign
 4

269 
L$FB2


270 
	gffi_˛osuª_∑32


271 .
	g¥oc


272 .
ˇŒöfo
 
	gFRAME
=64,
	gCALLS
,
	gSAVE_RP
,
	gSAVE_SP
,
	gENTRY_GR
=3

273 .
íåy


275 
°w
 %
Ω
, -20(%
	g•
)

276 
	gc›y
 %
	gr3
, %
r1


277 
L$CFI21


278 
	gc›y
 %
	g•
, %
r3


279 
L$CFI22


280 
	g°wm
 %
	gr1
, 64(%
	g•
)

283 
	g°w
 %
	g¨g0
, -36(%
	gr3
)

284 
	g°w
 %
	g¨g1
, -40(%
	gr3
)

285 
	g°w
 %
	g¨g2
, -44(%
	gr3
)

286 
	g°w
 %
	g¨g3
, -48(%
	gr3
)

288 
	gc›y
 %
	gr21
, %
¨g0


289 
bl
 
	gffi_˛osuª_ö√r_∑32
, %
r2


290 
	gc›y
 %
	gr3
, %
¨g1


291 
	gldwm
 -64(%
	g•
), %
r3


292 
	gldw
 -20(%
	g•
), %
Ω


293 
	gldw
 -36(%
	g•
), %
ªt0


294 
	gbv
 %
r0
(%
Ω
)

295 
	gldw
 -40(%
	g•
), %
	gªt1


296 .
	gexô


297 .
¥o˚nd


298 
	gL$FE2
:

300 .
SPACE
 
$PRIVATE$


301 .
SUBSPA
 
$DATA$


303 .
Æign
 4

304 .
EXPORT
 
_GLOBAL__F_ffi_ˇŒ_∑32
,
DATA


305 
_GLOBAL__F_ffi_ˇŒ_∑32


306 
	gL$‰ame1
:

307 .
w‹d
 
L$ECIE1
-
L$SCIE1
 ;#Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


308 
	gL$SCIE1
:

309 .
w‹d
 0x0 ;#CIE 
Idítifõr
 
	gTag


310 .
	gbyã
 0x1 ;#CIE 
	gVîsi⁄


311 .
	gascii
 "\0" ;#CIE 
	gAugmíèti⁄


312 .
	guÀb128
 0x1 ;#CIE 
Code
 
Alignmít
 
	gFa˘‹


313 .
	g¶eb128
 4 ;#CIE 
D©a
 
Alignmít
 
	gFa˘‹


314 .
	gbyã
 0x2 ;#CIE 
RA
 
	gCﬁumn


315 .
	gbyã
 0xc ;#DW_CFA_def_cfa

316 .
	guÀb128
 0x1e

317 .
	guÀb128
 0x0

318 .
	gÆign
 4

319 
	gL$ECIE1
:

320 
L$SFDE1
:

321 .
w‹d
 
L$EFDE1
-
L$ASFDE1
 ;#FDE 
Lígth


322 
	gL$ASFDE1
:

323 .
w‹d
 
L$ASFDE1
-
L$‰ame1
 ;#FDE 
CIE
 
	goff£t


324 .
w‹d
 
	gL$FB1
 ;#FDE 
öôül
 
	gloˇti⁄


325 .
w‹d
 
	gL$FE1
-
	gL$FB1
 ;#FDE 
addªss
 
	gønge


327 .
	gbyã
 0x4 ;#DW_CFA_advance_loc4

328 .
w‹d
 
	gL$CFI11
-
	gL$FB1


329 .
	gbyã
 0x83 ;#DW_CFA_off£t, 
	gcﬁumn
 0x3

330 .
	guÀb128
 0x0

331 .
	gbyã
 0x11 ;#DW_CFA_off£t_exãnded_sf; 
ßve
 
r2
 
	g©
 [
r30
-20]

332 .
	guÀb128
 0x2

333 .
	g¶eb128
 -5

335 .
	gbyã
 0x4 ;#DW_CFA_advance_loc4

336 .
w‹d
 
	gL$CFI12
-
	gL$CFI11


337 .
	gbyã
 0xd ;#DW_CFA_def_cÁ_ªgi°î = 
r3


338 .
uÀb128
 0x3

340 .
byã
 0x4 ;#DW_CFA_advance_loc4

341 .
w‹d
 
	gL$CFI13
-
	gL$CFI12


342 .
	gbyã
 0x84 ;#DW_CFA_off£t, 
	gcﬁumn
 0x4

343 .
	guÀb128
 0x3

345 .
	gÆign
 4

346 
	gL$EFDE1
:

348 
L$SFDE2
:

349 .
w‹d
 
L$EFDE2
-
L$ASFDE2
 ;#FDE 
Lígth


350 
	gL$ASFDE2
:

351 .
w‹d
 
L$ASFDE2
-
L$‰ame1
 ;#FDE 
CIE
 
	goff£t


352 .
w‹d
 
	gL$FB2
 ;#FDE 
öôül
 
	gloˇti⁄


353 .
w‹d
 
	gL$FE2
-
	gL$FB2
 ;#FDE 
addªss
 
	gønge


354 .
	gbyã
 0x4 ;#DW_CFA_advance_loc4

355 .
w‹d
 
	gL$CFI21
-
	gL$FB2


356 .
	gbyã
 0x83 ;#DW_CFA_off£t, 
	gcﬁumn
 0x3

357 .
	guÀb128
 0x0

358 .
	gbyã
 0x11 ;#DW_CFA_offset_extended_sf

359 .
	guÀb128
 0x2

360 .
	g¶eb128
 -5

362 .
	gbyã
 0x4 ;#DW_CFA_advance_loc4

363 .
w‹d
 
	gL$CFI22
-
	gL$CFI21


364 .
	gbyã
 0xd ;#DW_CFA_def_cÁ_ªgi°î = 
r3


365 .
uÀb128
 0x3

367 .
Æign
 4

368 
L$EFDE2
:

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/pa/linux.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

31 .
	gãxt


32 .
	gÀvñ
 1.1

33 .
	gÆign
 4

43 .
exp‹t
 
	gffi_ˇŒ_∑32
,
	gcode


44 .
imp‹t
 
	gffi_¥ï_¨gs_∑32
,
	gcode


46 .
ty≥
 
	gffi_ˇŒ_∑32
, @
	gfun˘i⁄


47 .
	gLFB1
:

48 
ffi_ˇŒ_∑32
:

49 .
¥oc


50 .
ˇŒöfo
 
FRAME
=64,
	gCALLS
,
	gSAVE_RP
,
	gSAVE_SP
,
	gENTRY_GR
=4

51 .
íåy


52 
°w
 %
Ω
, -20(%
	g•
)

53 
	gc›y
 %
	gr3
, %
	gr1


54 .
	gLCFI11
:

56 
c›y
 %
•
, %
	gr3


57 .
	gLCFI12
:

72 
°wm
 %
r1
, 64(%
	g•
)

73 
	g°w
 %
	gr4
, 12(%
	gr3
)

74 .
	gLCFI13
:

75 
c›y
 %
•
, %
r4


77 
	gaddl
 %
	g¨g2
, %
	gr4
, %
¨g0


78 
	g°w
 %
	g¨g3
, -48(%
	gr3
)

84 
bl
 
	gffi_¥ï_¨gs_∑32
,%
r2


85 
	gldo
 64(%
	g¨g0
), %
•


86 
	gldo
 -64(%
	g•
), %
•


92 
	gldw
 -36(%
	g•
), %
¨g0


93 
	gldw
 -40(%
	g•
), %
¨g1


94 
	gldw
 -44(%
	g•
), %
¨g2


95 
	gldw
 -48(%
	g•
), %
¨g3


99 
	gldw
 -52(%
	gr3
), %
ªt0


100 
	gldw
 -56(%
	gr3
), %
r22


101 
bl
 
	g$$dynˇŒ
, %
r31


102 
	gc›y
 %
	gr31
, %
Ω


105 
	gldw
 -48(%
	gr3
), %
r21


106 
	gldw
 -52(%
	gr3
), %
	gr20


110 .
	gLchecköt
:

111 
comib
,<>,
n
 
	gFFI_TYPE_INT
, %
	gr21
, .
Lchecköt8


112 
	gb
 .
Ld⁄e


113 
	g°w
 %
	gªt0
, 0(%
	gr20
)

115 .
	gLchecköt8
:

116 
comib
,<>,
n
 
	gFFI_TYPE_UINT8
, %
	gr21
, .
Lchecköt16


117 
	gb
 .
Ld⁄e


118 
	g°b
 %
	gªt0
, 0(%
	gr20
)

120 .
	gLchecköt16
:

121 
comib
,<>,
n
 
	gFFI_TYPE_UINT16
, %
	gr21
, .
Lcheckdbl


122 
	gb
 .
Ld⁄e


123 
	g°h
 %
	gªt0
, 0(%
	gr20
)

125 .
	gLcheckdbl
:

126 
comib
,<>,
n
 
	gFFI_TYPE_DOUBLE
, %
	gr21
, .
LcheckÊﬂt


127 
	gb
 .
Ld⁄e


128 
	gf°d
 %
	g‰4
,0(%
	gr20
)

130 .
	gLcheckÊﬂt
:

131 
comib
,<>,
n
 
	gFFI_TYPE_FLOAT
, %
	gr21
, .
LcheckŒ


132 
	gb
 .
Ld⁄e


133 
	gf°w
 %
	g‰4L
,0(%
	gr20
)

135 .
	gLcheckŒ
:

136 
comib
,<>,
n
 
	gFFI_TYPE_UINT64
, %
	gr21
, .
Lchecksm°2


137 
	g°w
 %
	gªt0
, 0(%
	gr20
)

138 
	gb
 .
Ld⁄e


139 
	g°w
 %
	gªt1
, 4(%
	gr20
)

141 .
	gLchecksm°2
:

142 
comib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT2
, %
	gr21
, .
Lchecksm°3


144 
	gexåu
 %
	gªt0
, 23, 8, %
r22


145 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

146 
	gb
 .
Ld⁄e


147 
	g°b
 %
	gªt0
, 0(%
	gr20
)

149 .
	gLchecksm°3
:

150 
comib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT3
, %
	gr21
, .
Lchecksm°4


152 
	gexåu
 %
	gªt0
, 15, 8, %
r22


153 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

154 
	gexåu
 %
	gªt0
, 23, 8, %
r22


155 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

156 
	gb
 .
Ld⁄e


157 
	g°b
 %
	gªt0
, 0(%
	gr20
)

159 .
	gLchecksm°4
:

160 
comib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT4
, %
	gr21
, .
Lchecksm°5


162 
	gexåu
 %
	gªt0
, 7, 8, %
r22


163 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

164 
	gexåu
 %
	gªt0
, 15, 8, %
r22


165 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

166 
	gexåu
 %
	gªt0
, 23, 8, %
r22


167 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

168 
	gb
 .
Ld⁄e


169 
	g°b
 %
	gªt0
, 0(%
	gr20
)

171 .
	gLchecksm°5
:

172 
comib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT5
, %
	gr21
, .
Lchecksm°6


176 
	g°bs
,
	gma
 %
	gªt0
, 1(%
	gr20
)

177 
	gexåu
 %
	gªt1
, 7, 8, %
r22


178 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

179 
	gexåu
 %
	gªt1
, 15, 8, %
r22


180 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

181 
	gexåu
 %
	gªt1
, 23, 8, %
r22


182 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

183 
	gb
 .
Ld⁄e


184 
	g°b
 %
	gªt1
, 0(%
	gr20
)

186 .
	gLchecksm°6
:

187 
comib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT6
, %
	gr21
, .
Lchecksm°7


191 
	gexåu
 %
	gªt0
, 23, 8, %
r22


192 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

193 
	g°bs
,
	gma
 %
	gªt0
, 1(%
	gr20
)

194 
	gexåu
 %
	gªt1
, 7, 8, %
r22


195 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

196 
	gexåu
 %
	gªt1
, 15, 8, %
r22


197 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

198 
	gexåu
 %
	gªt1
, 23, 8, %
r22


199 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

200 
	gb
 .
Ld⁄e


201 
	g°b
 %
	gªt1
, 0(%
	gr20
)

203 .
	gLchecksm°7
:

204 
comib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT7
, %
	gr21
, .
Lchecksm°8


208 
	gexåu
 %
	gªt0
, 15, 8, %
r22


209 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

210 
	gexåu
 %
	gªt0
, 23, 8, %
r22


211 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

212 
	g°bs
,
	gma
 %
	gªt0
, 1(%
	gr20
)

213 
	gexåu
 %
	gªt1
, 7, 8, %
r22


214 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

215 
	gexåu
 %
	gªt1
, 15, 8, %
r22


216 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

217 
	gexåu
 %
	gªt1
, 23, 8, %
r22


218 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

219 
	gb
 .
Ld⁄e


220 
	g°b
 %
	gªt1
, 0(%
	gr20
)

222 .
	gLchecksm°8
:

223 
comib
,<>,
n
 
	gFFI_TYPE_SMALL_STRUCT8
, %
	gr21
, .
Ld⁄e


227 
	gexåu
 %
	gªt0
, 7, 8, %
r22


228 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

229 
	gexåu
 %
	gªt0
, 15, 8, %
r22


230 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

231 
	gexåu
 %
	gªt0
, 23, 8, %
r22


232 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

233 
	g°bs
,
	gma
 %
	gªt0
, 1(%
	gr20
)

234 
	gexåu
 %
	gªt1
, 7, 8, %
r22


235 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

236 
	gexåu
 %
	gªt1
, 15, 8, %
r22


237 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

238 
	gexåu
 %
	gªt1
, 23, 8, %
r22


239 
	g°bs
,
	gma
 %
	gr22
, 1(%
	gr20
)

240 
	g°b
 %
	gªt1
, 0(%
	gr20
)

242 .
	gLd⁄e
:

244 
c›y
 %
r4
, %
•


245 
	gldw
 12(%
	gr3
), %
r4


246 
	gldwm
 -64(%
	g•
), %
r3


247 
	gldw
 -20(%
	g•
), %
Ω


248 
	gbv
 %
r0
(%
Ω
)

249 
	gn›


250 .
	gexô


251 .
	g¥o˚nd


252 .
	gLFE1
:

256 .
exp‹t
 
ffi_˛osuª_∑32
,
	gcode


257 .
imp‹t
 
	gffi_˛osuª_ö√r_∑32
,
	gcode


259 .
ty≥
 
	gffi_˛osuª_∑32
, @
	gfun˘i⁄


260 .
	gLFB2
:

261 
ffi_˛osuª_∑32
:

262 .
¥oc


263 .
ˇŒöfo
 
FRAME
=64,
	gCALLS
,
	gSAVE_RP
,
	gSAVE_SP
,
	gENTRY_GR
=3

264 .
íåy


266 
°w
 %
Ω
, -20(%
	g•
)

267 .
	gLCFI20
:

268 
c›y
 %
r3
, %
	gr1


269 .
	gLCFI21
:

270 
c›y
 %
•
, %
	gr3


271 .
	gLCFI22
:

272 
°wm
 %
r1
, 64(%
	g•
)

275 
	g°w
 %
	g¨g0
, -36(%
	gr3
)

276 
	g°w
 %
	g¨g1
, -40(%
	gr3
)

277 
	g°w
 %
	g¨g2
, -44(%
	gr3
)

278 
	g°w
 %
	g¨g3
, -48(%
	gr3
)

280 
	gc›y
 %
	gr21
, %
¨g0


281 
bl
 
	gffi_˛osuª_ö√r_∑32
, %
r2


282 
	gc›y
 %
	gr3
, %
¨g1


284 
	gldwm
 -64(%
	g•
), %
r3


285 
	gldw
 -20(%
	g•
), %
Ω


286 
	gldw
 -36(%
	g•
), %
ªt0


287 
	gbv
 %
r0
(%
r2
)

288 
	gldw
 -40(%
	g•
), %
	gªt1


290 .
	gexô


291 .
	g¥o˚nd


292 .
	gLFE2
:

294 .
£˘i⁄
 ".eh_‰ame",
	gEH_FRAME_FLAGS
,@
	g¥ogbôs


295 .
	gL‰ame1
:

296 .
w‹d
 .
LECIE1
-.
LSCIE1
 ;#Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
	gE¡ry


297 .
	gLSCIE1
:

298 .
w‹d
 0x0 ;#CIE 
Idítifõr
 
	gTag


299 .
	gbyã
 0x1 ;#CIE 
	gVîsi⁄


300 .
	gascii
 "\0" ;#CIE 
	gAugmíèti⁄


301 .
	guÀb128
 0x1 ;#CIE 
Code
 
Alignmít
 
	gFa˘‹


302 .
	g¶eb128
 4 ;#CIE 
D©a
 
Alignmít
 
	gFa˘‹


303 .
	gbyã
 0x2 ;#CIE 
RA
 
	gCﬁumn


304 .
	gbyã
 0xc ;#DW_CFA_def_cfa

305 .
	guÀb128
 0x1e

306 .
	guÀb128
 0x0

307 .
	gÆign
 4

308 .
	gLECIE1
:

309 .
LSFDE1
:

310 .
w‹d
 .
LEFDE1
-.
LASFDE1
 ;#FDE 
	gLígth


311 .
	gLASFDE1
:

312 .
w‹d
 .
LASFDE1
-.
L‰ame1
 ;#FDE 
CIE
 
	goff£t


313 .
	gw‹d
 .
	gLFB1
 ;#FDE 
öôül
 
	gloˇti⁄


314 .
	gw‹d
 .
	gLFE1
-.
	gLFB1
 ;#FDE 
addªss
 
	gønge


316 .
	gbyã
 0x4 ;#DW_CFA_advance_loc4

317 .
	gw‹d
 .
	gLCFI11
-.
	gLFB1


318 .
	gbyã
 0x83 ;#DW_CFA_off£t, 
	gcﬁumn
 0x3

319 .
	guÀb128
 0x0

320 .
	gbyã
 0x11 ;#DW_CFA_off£t_exãnded_sf; 
ßve
 
r2
 
	g©
 [
r30
-20]

321 .
	guÀb128
 0x2

322 .
	g¶eb128
 -5

324 .
	gbyã
 0x4 ;#DW_CFA_advance_loc4

325 .
	gw‹d
 .
	gLCFI12
-.
	gLCFI11


326 .
	gbyã
 0xd ;#DW_CFA_def_cÁ_ªgi°î = 
r3


327 .
uÀb128
 0x3

329 .
byã
 0x4 ;#DW_CFA_advance_loc4

330 .
	gw‹d
 .
	gLCFI13
-.
	gLCFI12


331 .
	gbyã
 0x84 ;#DW_CFA_off£t, 
	gcﬁumn
 0x4

332 .
	guÀb128
 0x3

334 .
	gÆign
 4

335 .
	gLEFDE1
:

337 .
LSFDE2
:

338 .
w‹d
 .
LEFDE2
-.
LASFDE2
 ;#FDE 
	gLígth


339 .
	gLASFDE2
:

340 .
w‹d
 .
LASFDE2
-.
L‰ame1
 ;#FDE 
CIE
 
	goff£t


341 .
	gw‹d
 .
	gLFB2
 ;#FDE 
öôül
 
	gloˇti⁄


342 .
	gw‹d
 .
	gLFE2
-.
	gLFB2
 ;#FDE 
addªss
 
	gønge


343 .
	gbyã
 0x4 ;#DW_CFA_advance_loc4

344 .
	gw‹d
 .
	gLCFI21
-.
	gLFB2


345 .
	gbyã
 0x83 ;#DW_CFA_off£t, 
	gcﬁumn
 0x3

346 .
	guÀb128
 0x0

347 .
	gbyã
 0x11 ;#DW_CFA_offset_extended_sf

348 .
	guÀb128
 0x2

349 .
	g¶eb128
 -5

351 .
	gbyã
 0x4 ;#DW_CFA_advance_loc4

352 .
	gw‹d
 .
	gLCFI22
-.
	gLCFI21


353 .
	gbyã
 0xd ;#DW_CFA_def_cÁ_ªgi°î = 
r3


354 .
uÀb128
 0x3

356 .
Æign
 4

357 .
LEFDE2
:

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/aix.S

27 .
£t
 
	gr0
,0

28 .
£t
 
	gr1
,1

29 .
£t
 
	gr2
,2

30 .
£t
 
	gr3
,3

31 .
£t
 
	gr4
,4

32 .
£t
 
	gr5
,5

33 .
£t
 
	gr6
,6

34 .
£t
 
	gr7
,7

35 .
£t
 
	gr8
,8

36 .
£t
 
	gr9
,9

37 .
£t
 
	gr10
,10

38 .
£t
 
	gr11
,11

39 .
£t
 
	gr12
,12

40 .
£t
 
	gr13
,13

41 .
£t
 
	gr14
,14

42 .
£t
 
	gr15
,15

43 .
£t
 
	gr16
,16

44 .
£t
 
	gr17
,17

45 .
£t
 
	gr18
,18

46 .
£t
 
	gr19
,19

47 .
£t
 
	gr20
,20

48 .
£t
 
	gr21
,21

49 .
£t
 
	gr22
,22

50 .
£t
 
	gr23
,23

51 .
£t
 
	gr24
,24

52 .
£t
 
	gr25
,25

53 .
£t
 
	gr26
,26

54 .
£t
 
	gr27
,27

55 .
£t
 
	gr28
,28

56 .
£t
 
	gr29
,29

57 .
£t
 
	gr30
,30

58 .
£t
 
	gr31
,31

59 .
£t
 
	gf0
,0

60 .
£t
 
	gf1
,1

61 .
£t
 
	gf2
,2

62 .
£t
 
	gf3
,3

63 .
£t
 
	gf4
,4

64 .
£t
 
	gf5
,5

65 .
£t
 
	gf6
,6

66 .
£t
 
	gf7
,7

67 .
£t
 
	gf8
,8

68 .
£t
 
	gf9
,9

69 .
£t
 
	gf10
,10

70 .
£t
 
	gf11
,11

71 .
£t
 
	gf12
,12

72 .
£t
 
	gf13
,13

73 .
£t
 
	gf14
,14

74 .
£t
 
	gf15
,15

75 .
£t
 
	gf16
,16

76 .
£t
 
	gf17
,17

77 .
£t
 
	gf18
,18

78 .
£t
 
	gf19
,19

79 .
£t
 
	gf20
,20

80 .
£t
 
	gf21
,21

82 ..
ffi_¥ï_¨gs


84 
	#LIBFFI_ASM


	)

85 
	~<ffic⁄fig.h
>

86 
	~<ffi.h
>

87 
	#JUMPTARGET
(
«me
Ë
	)
name

88 
	#L
(
x
Ë
	)
x

89 .
fûe
 "aix.S"

90 .
toc


99 .
c£˘
 .
ãxt
[
PR
]

100 .
Æign
 2

101 .
globl
 
ffi_ˇŒ_AIX


102 .
globl
 .
ffi_ˇŒ_AIX


103 .
c£˘
 
ffi_ˇŒ_AIX
[
DS
]

104 
ffi_ˇŒ_AIX
:

105 #ifde‡
__64BIT__


106 .
Œ⁄g
 .
ffi_ˇŒ_AIX
, 
TOC
[
tc0
], 0

107 .
c£˘
 .
ãxt
[
PR
]

108 .
ffi_ˇŒ_AIX
:

110 
mÊr
 
r0


112 
°d
 
r28
,-32(
r1
)

113 
°d
 
r29
,-24(
r1
)

114 
°d
 
r30
,-16(
r1
)

115 
°d
 
r31
, -8(
r1
)

117 
°d
 
r0
, 16(
r1
)

118 
mr
 
r28
, 
r1


119 
°dux
 
r1
,Ñ1, 
r4


122 
mr
 
r31
, 
r5


123 
mr
 
r30
, 
r6


124 
mr
 
r29
, 
r7


125 
°d
 
r2
, 40(
r1
)

128 
mr
 
r4
, 
r1


129 
bl
 .
ffi_¥ï_¨gs


130 
n›


133 
ld
 
r0
, 0(
r29
)

134 
ld
 
r2
, 8(
r29
)

135 
ld
 
r11
, 16(
r29
)

137 
mt¸f
 0x40, 
r31


138 
mt˘r
 
r0


141 
ld
 
r3
, 40+(1*8)(
r1
)

142 
ld
 
r4
, 40+(2*8)(
r1
)

143 
ld
 
r5
, 40+(3*8)(
r1
)

144 
ld
 
r6
, 40+(4*8)(
r1
)

145 
n›


146 
ld
 
r7
, 40+(5*8)(
r1
)

147 
ld
 
r8
, 40+(6*8)(
r1
)

148 
ld
 
r9
, 40+(7*8)(
r1
)

149 
ld
 
r10
,40+(8*8)(
r1
)

151 
L1
:

153 
bf
 6,
L2


154 
lfd
 
f1
,-32-(13*8)(
r28
)

155 
lfd
 
f2
,-32-(12*8)(
r28
)

156 
lfd
 
f3
,-32-(11*8)(
r28
)

157 
lfd
 
f4
,-32-(10*8)(
r28
)

158 
n›


159 
lfd
 
f5
,-32-(9*8)(
r28
)

160 
lfd
 
f6
,-32-(8*8)(
r28
)

161 
lfd
 
f7
,-32-(7*8)(
r28
)

162 
lfd
 
f8
,-32-(6*8)(
r28
)

163 
n›


164 
lfd
 
f9
,-32-(5*8)(
r28
)

165 
lfd
 
f10
,-32-(4*8)(
r28
)

166 
lfd
 
f11
,-32-(3*8)(
r28
)

167 
lfd
 
f12
,-32-(2*8)(
r28
)

168 
n›


169 
lfd
 
f13
,-32-(1*8)(
r28
)

171 
L2
:

173 
b˘æ


174 
ld
 
r2
, 40(
r1
)

177 
mt¸f
 0x01, 
r31


179 
bt
 30, 
	$L
(
d⁄e_ªtu∫_vÆue
)

180 
bt
 29, 
	$L
(
Â_ªtu∫_vÆue
)

181 
°d
 
r3
, 0(
r30
)

185 
	$L
(
d⁄e_ªtu∫_vÆue
):

187 
mr
 
r1
, 
r28


188 
ld
 
r0
, 16(
r28
)

189 
ld
 
r28
, -32(
r1
)

190 
mér
 
r0


191 
ld
 
r29
, -24(
r1
)

192 
ld
 
r30
, -16(
r1
)

193 
ld
 
r31
, -8(
r1
)

194 
bÃ


196 
	$L
(
Â_ªtu∫_vÆue
):

197 
bf
 28, 
	$L
(
Êﬂt_ªtu∫_vÆue
)

198 
°fd
 
f1
, 0(
r30
)

199 
bf
 31, 
	$L
(
d⁄e_ªtu∫_vÆue
)

200 
°fd
 
f2
, 8(
r30
)

201 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

202 
	$L
(
Êﬂt_ªtu∫_vÆue
):

203 
°fs
 
f1
, 0(
r30
)

204 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

208 ..
ffi_ˇŒ_AIX
, 
TOC
[
tc0
], 0

209 .
c£˘
 .
ãxt
[
PR
]

210 .
ffi_ˇŒ_AIX
:

212 
mÊr
 
r0


214 
°w
 
r28
,-16(
r1
)

215 
°w
 
r29
,-12(
r1
)

216 
°w
 
r30
, -8(
r1
)

217 
°w
 
r31
, -4(
r1
)

219 
°w
 
r0
, 8(
r1
)

220 
mr
 
r28
, 
r1


221 
°wux
 
r1
,Ñ1, 
r4


224 
mr
 
r31
, 
r5


225 
mr
 
r30
, 
r6


226 
mr
 
r29
, 
r7


227 
°w
 
r2
, 20(
r1
)

230 
mr
 
r4
, 
r1


231 
bl
 .
ffi_¥ï_¨gs


232 
n›


235 
lwz
 
r0
, 0(
r29
)

236 
lwz
 
r2
, 4(
r29
)

237 
lwz
 
r11
, 8(
r29
)

239 
mt¸f
 0x40, 
r31


240 
mt˘r
 
r0


243 
lwz
 
r3
, 20+(1*4)(
r1
)

244 
lwz
 
r4
, 20+(2*4)(
r1
)

245 
lwz
 
r5
, 20+(3*4)(
r1
)

246 
lwz
 
r6
, 20+(4*4)(
r1
)

247 
n›


248 
lwz
 
r7
, 20+(5*4)(
r1
)

249 
lwz
 
r8
, 20+(6*4)(
r1
)

250 
lwz
 
r9
, 20+(7*4)(
r1
)

251 
lwz
 
r10
,20+(8*4)(
r1
)

253 
L1
:

255 
bf
 6,
L2


256 
lfd
 
f1
,-16-(13*8)(
r28
)

257 
lfd
 
f2
,-16-(12*8)(
r28
)

258 
lfd
 
f3
,-16-(11*8)(
r28
)

259 
lfd
 
f4
,-16-(10*8)(
r28
)

260 
n›


261 
lfd
 
f5
,-16-(9*8)(
r28
)

262 
lfd
 
f6
,-16-(8*8)(
r28
)

263 
lfd
 
f7
,-16-(7*8)(
r28
)

264 
lfd
 
f8
,-16-(6*8)(
r28
)

265 
n›


266 
lfd
 
f9
,-16-(5*8)(
r28
)

267 
lfd
 
f10
,-16-(4*8)(
r28
)

268 
lfd
 
f11
,-16-(3*8)(
r28
)

269 
lfd
 
f12
,-16-(2*8)(
r28
)

270 
n›


271 
lfd
 
f13
,-16-(1*8)(
r28
)

273 
L2
:

275 
b˘æ


276 
lwz
 
r2
, 20(
r1
)

279 
mt¸f
 0x01, 
r31


281 
bt
 30, 
	$L
(
d⁄e_ªtu∫_vÆue
)

282 
bt
 29, 
	$L
(
Â_ªtu∫_vÆue
)

283 
°w
 
r3
, 0(
r30
)

284 
bf
 28, 
	$L
(
d⁄e_ªtu∫_vÆue
)

285 
°w
 
r4
, 4(
r30
)

289 
	$L
(
d⁄e_ªtu∫_vÆue
):

291 
mr
 
r1
, 
r28


292 
lwz
 
r0
, 8(
r28
)

293 
lwz
 
r28
,-16(
r1
)

294 
mér
 
r0


295 
lwz
 
r29
,-12(
r1
)

296 
lwz
 
r30
, -8(
r1
)

297 
lwz
 
r31
, -4(
r1
)

298 
bÃ


300 
	$L
(
Â_ªtu∫_vÆue
):

301 
bf
 28, 
	$L
(
Êﬂt_ªtu∫_vÆue
)

302 
°fd
 
f1
, 0(
r30
)

303 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

304 
	$L
(
Êﬂt_ªtu∫_vÆue
):

305 
°fs
 
f1
, 0(
r30
)

306 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

309 .
byã
 0,0,0,1,128,4,0,0

312 .
c£˘
 .
ãxt
[
PR
]

313 .
Æign
 2

314 .
globl
 
ffi_ˇŒ_DARWIN


315 .
globl
 .
ffi_ˇŒ_DARWIN


316 .
c£˘
 
ffi_ˇŒ_DARWIN
[
DS
]

317 
ffi_ˇŒ_DARWIN
:

318 #ifde‡
__64BIT__


319 .
Œ⁄g
 .
ffi_ˇŒ_DARWIN
, 
TOC
[
tc0
], 0

321 ..
ffi_ˇŒ_DARWIN
, 
TOC
[
tc0
], 0

323 .
c£˘
 .
ãxt
[
PR
]

324 .
ffi_ˇŒ_DARWIN
:

325 
bÃ


327 .
byã
 0,0,0,0,0,0,0,0

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/aix_closure.S

27 .
£t
 
	gr0
,0

28 .
£t
 
	gr1
,1

29 .
£t
 
	gr2
,2

30 .
£t
 
	gr3
,3

31 .
£t
 
	gr4
,4

32 .
£t
 
	gr5
,5

33 .
£t
 
	gr6
,6

34 .
£t
 
	gr7
,7

35 .
£t
 
	gr8
,8

36 .
£t
 
	gr9
,9

37 .
£t
 
	gr10
,10

38 .
£t
 
	gr11
,11

39 .
£t
 
	gr12
,12

40 .
£t
 
	gr13
,13

41 .
£t
 
	gr14
,14

42 .
£t
 
	gr15
,15

43 .
£t
 
	gr16
,16

44 .
£t
 
	gr17
,17

45 .
£t
 
	gr18
,18

46 .
£t
 
	gr19
,19

47 .
£t
 
	gr20
,20

48 .
£t
 
	gr21
,21

49 .
£t
 
	gr22
,22

50 .
£t
 
	gr23
,23

51 .
£t
 
	gr24
,24

52 .
£t
 
	gr25
,25

53 .
£t
 
	gr26
,26

54 .
£t
 
	gr27
,27

55 .
£t
 
	gr28
,28

56 .
£t
 
	gr29
,29

57 .
£t
 
	gr30
,30

58 .
£t
 
	gr31
,31

59 .
£t
 
	gf0
,0

60 .
£t
 
	gf1
,1

61 .
£t
 
	gf2
,2

62 .
£t
 
	gf3
,3

63 .
£t
 
	gf4
,4

64 .
£t
 
	gf5
,5

65 .
£t
 
	gf6
,6

66 .
£t
 
	gf7
,7

67 .
£t
 
	gf8
,8

68 .
£t
 
	gf9
,9

69 .
£t
 
	gf10
,10

70 .
£t
 
	gf11
,11

71 .
£t
 
	gf12
,12

72 .
£t
 
	gf13
,13

73 .
£t
 
	gf14
,14

74 .
£t
 
	gf15
,15

75 .
£t
 
	gf16
,16

76 .
£t
 
	gf17
,17

77 .
£t
 
	gf18
,18

78 .
£t
 
	gf19
,19

79 .
£t
 
	gf20
,20

80 .
£t
 
	gf21
,21

82 ..
ffi_˛osuª_hñ≥r_DARWIN


84 
	#LIBFFI_ASM


	)

85 
	#JUMPTARGET
(
«me
Ë
	)
name

86 
	#L
(
x
Ë
	)
x

87 .
fûe
 "aix_closure.S"

88 .
toc


89 
LC
..60:

90 .
tc
 
L
..60[
TC
],L..60

91 .
c£˘
 .
ãxt
[
PR
]

92 .
Æign
 2

94 .
c£˘
 .
ãxt
[
PR
]

95 .
Æign
 2

96 .
globl
 
ffi_˛osuª_ASM


97 .
globl
 .
ffi_˛osuª_ASM


98 .
c£˘
 
ffi_˛osuª_ASM
[
DS
]

99 
ffi_˛osuª_ASM
:

100 #ifde‡
__64BIT__


101 .
Œ⁄g
 .
ffi_˛osuª_ASM
, 
TOC
[
tc0
], 0

102 .
c£˘
 .
ãxt
[
PR
]

103 .
ffi_˛osuª_ASM
:

109 
°d
 
r3
, 48+(0*8)(
r1
)

110 
°d
 
r4
, 48+(1*8)(
r1
)

111 
°d
 
r5
, 48+(2*8)(
r1
)

112 
°d
 
r6
, 48+(3*8)(
r1
)

113 
mÊr
 
r0


115 
°d
 
r7
, 48+(4*8)(
r1
)

116 
°d
 
r8
, 48+(5*8)(
r1
)

117 
°d
 
r9
, 48+(6*8)(
r1
)

118 
°d
 
r10
, 48+(7*8)(
r1
)

119 
°d
 
r0
, 16(
r1
)

129 
°du
 
r1
, -240(r1)

133 
°fd
 
f1
, 128+(0*8)(
r1
)

134 
°fd
 
f2
, 128+(1*8)(
r1
)

135 
°fd
 
f3
, 128+(2*8)(
r1
)

136 
°fd
 
f4
, 128+(3*8)(
r1
)

137 
°fd
 
f5
, 128+(4*8)(
r1
)

138 
°fd
 
f6
, 128+(5*8)(
r1
)

139 
°fd
 
f7
, 128+(6*8)(
r1
)

140 
°fd
 
f8
, 128+(7*8)(
r1
)

141 
°fd
 
f9
, 128+(8*8)(
r1
)

142 
°fd
 
f10
, 128+(9*8)(
r1
)

143 
°fd
 
f11
, 128+(10*8)(
r1
)

144 
°fd
 
f12
, 128+(11*8)(
r1
)

145 
°fd
 
f13
, 128+(12*8)(
r1
)

149 
mr
 
r3
, 
r11


152 
addi
 
r4
, 
r1
, 112

155 
addi
 
r5
, 
r1
, 288

158 
addi
 
r6
, 
r1
, 128

161 
bl
 .
ffi_˛osuª_hñ≥r_DARWIN


162 
n›


170 
lhz
 
r3
, 10(r3)

171 
ld
 
r4
, 
LC
..60(2)

172 
¶di
 
r3
,Ñ3, 4

173 
ld
 
r0
, 240+16(
r1
)

174 
add
 
r3
,Ñ3, 
r4


175 
mt˘r
 
r3


176 
b˘r


180 .
Æign
 4

182 
L
..60:

184 
mér
 
r0


185 
addi
 
r1
,Ñ1, 240

186 
bÃ


187 
n›


190 
lwa
 
r3
, 112+4(
r1
)

191 
mér
 
r0


192 
addi
 
r1
,Ñ1, 240

193 
bÃ


196 
lfs
 
f1
, 112+0(
r1
)

197 
mér
 
r0


198 
addi
 
r1
,Ñ1, 240

199 
bÃ


202 
lfd
 
f1
, 112+0(
r1
)

203 
mér
 
r0


204 
addi
 
r1
,Ñ1, 240

205 
bÃ


208 
lfd
 
f1
, 112+0(
r1
)

209 
mér
 
r0


210 
lfd
 
f2
, 112+8(
r1
)

211 
b
 
L
..
föish


214 
lbz
 
r3
, 112+7(
r1
)

215 
mér
 
r0


216 
addi
 
r1
,Ñ1, 240

217 
bÃ


220 
lbz
 
r3
, 112+7(
r1
)

221 
mér
 
r0


222 
extsb
 
r3
,Ñ3

223 
b
 
L
..
föish


226 
lhz
 
r3
, 112+6(
r1
)

227 
mér
 
r0


228 
L
..
föish
:

229 
addi
 
r1
,Ñ1, 240

230 
bÃ


233 
lha
 
r3
, 112+6(
r1
)

234 
mér
 
r0


235 
addi
 
r1
,Ñ1, 240

236 
bÃ


239 
lwz
 
r3
, 112+4(
r1
)

240 
mér
 
r0


241 
addi
 
r1
,Ñ1, 240

242 
bÃ


245 
lwa
 
r3
, 112+4(
r1
)

246 
mér
 
r0


247 
addi
 
r1
,Ñ1, 240

248 
bÃ


251 
ld
 
r3
, 112+0(
r1
)

252 
mér
 
r0


253 
addi
 
r1
,Ñ1, 240

254 
bÃ


257 
ld
 
r3
, 112+0(
r1
)

258 
mér
 
r0


259 
addi
 
r1
,Ñ1, 240

260 
bÃ


263 
mér
 
r0


264 
addi
 
r1
,Ñ1, 240

265 
bÃ


266 
n›


269 
ld
 
r3
, 112+0(
r1
)

270 
mér
 
r0


271 
addi
 
r1
,Ñ1, 240

272 
bÃ


276 ..
ffi_˛osuª_ASM
, 
TOC
[
tc0
], 0

277 .
c£˘
 .
ãxt
[
PR
]

278 .
ffi_˛osuª_ASM
:

284 
°w
 
r3
, 24+(0*4)(
r1
)

285 
°w
 
r4
, 24+(1*4)(
r1
)

286 
°w
 
r5
, 24+(2*4)(
r1
)

287 
°w
 
r6
, 24+(3*4)(
r1
)

288 
mÊr
 
r0


290 
°w
 
r7
, 24+(4*4)(
r1
)

291 
°w
 
r8
, 24+(5*4)(
r1
)

292 
°w
 
r9
, 24+(6*4)(
r1
)

293 
°w
 
r10
, 24+(7*4)(
r1
)

294 
°w
 
r0
, 8(
r1
)

302 
°wu
 
r1
, -176(r1)

306 
°fd
 
f1
, 72+(0*8)(
r1
)

307 
°fd
 
f2
, 72+(1*8)(
r1
)

308 
°fd
 
f3
, 72+(2*8)(
r1
)

309 
°fd
 
f4
, 72+(3*8)(
r1
)

310 
°fd
 
f5
, 72+(4*8)(
r1
)

311 
°fd
 
f6
, 72+(5*8)(
r1
)

312 
°fd
 
f7
, 72+(6*8)(
r1
)

313 
°fd
 
f8
, 72+(7*8)(
r1
)

314 
°fd
 
f9
, 72+(8*8)(
r1
)

315 
°fd
 
f10
, 72+(9*8)(
r1
)

316 
°fd
 
f11
, 72+(10*8)(
r1
)

317 
°fd
 
f12
, 72+(11*8)(
r1
)

318 
°fd
 
f13
, 72+(12*8)(
r1
)

322 
mr
 
r3
, 
r11


325 
addi
 
r4
, 
r1
, 56

328 
addi
 
r5
, 
r1
, 200

331 
addi
 
r6
, 
r1
, 72

334 
bl
 .
ffi_˛osuª_hñ≥r_DARWIN


335 
n›


343 
lhz
 
r3
, 6(r3)

344 
lwz
 
r4
, 
LC
..60(2)

345 
¶wi
 
r3
,Ñ3, 4

346 
lwz
 
r0
, 176+8(
r1
)

347 
add
 
r3
,Ñ3, 
r4


348 
mt˘r
 
r3


349 
b˘r


353 .
Æign
 4

355 
L
..60:

357 
mér
 
r0


358 
addi
 
r1
,Ñ1, 176

359 
bÃ


360 
n›


363 
lwz
 
r3
, 56+0(
r1
)

364 
mér
 
r0


365 
addi
 
r1
,Ñ1, 176

366 
bÃ


369 
lfs
 
f1
, 56+0(
r1
)

370 
mér
 
r0


371 
addi
 
r1
,Ñ1, 176

372 
bÃ


375 
lfd
 
f1
, 56+0(
r1
)

376 
mér
 
r0


377 
addi
 
r1
,Ñ1, 176

378 
bÃ


381 
lfd
 
f1
, 56+0(
r1
)

382 
mér
 
r0


383 
lfd
 
f2
, 56+8(
r1
)

384 
b
 
L
..
föish


387 
lbz
 
r3
, 56+3(
r1
)

388 
mér
 
r0


389 
addi
 
r1
,Ñ1, 176

390 
bÃ


393 
lbz
 
r3
, 56+3(
r1
)

394 
mér
 
r0


395 
extsb
 
r3
,Ñ3

396 
b
 
L
..
föish


399 
lhz
 
r3
, 56+2(
r1
)

400 
mér
 
r0


401 
addi
 
r1
,Ñ1, 176

402 
bÃ


405 
lha
 
r3
, 56+2(
r1
)

406 
mér
 
r0


407 
addi
 
r1
,Ñ1, 176

408 
bÃ


411 
lwz
 
r3
, 56+0(
r1
)

412 
mér
 
r0


413 
addi
 
r1
,Ñ1, 176

414 
bÃ


417 
lwz
 
r3
, 56+0(
r1
)

418 
mér
 
r0


419 
addi
 
r1
,Ñ1, 176

420 
bÃ


423 
lwz
 
r3
, 56+0(
r1
)

424 
mér
 
r0


425 
lwz
 
r4
, 56+4(
r1
)

426 
b
 
L
..
föish


429 
lwz
 
r3
, 56+0(
r1
)

430 
mér
 
r0


431 
lwz
 
r4
, 56+4(
r1
)

432 
b
 
L
..
föish


435 
mér
 
r0


436 
addi
 
r1
,Ñ1, 176

437 
bÃ


438 
n›


441 
lwz
 
r3
, 56+0(
r1
)

442 
mér
 
r0


443 
L
..
föish
:

444 
addi
 
r1
,Ñ1, 176

445 
bÃ


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/asm.h

26 
	#ASM_GLOBAL_DIRECTIVE
 .
globl


	)

29 
	#C_SYMBOL_NAME
(
«me
Ë
	)
name

31 #ifdef 
__STDC__


32 
	#C_LABEL
(
«me
Ë«me##:

	)

34 
	#C_LABEL
(
«me
Ë«mê:

	)

38 
	#ALIGNARG
(
log2
Ë
	)
log2

40 
	#ASM_TYPE_DIRECTIVE
(
«me
,
ty≥¨g
Ë.
ty≥
Çame,ty≥¨g;

	)

41 
	#ASM_SIZE_DIRECTIVE
(
«me
Ë.
size
Çame,.-
	)
name

44 #ifdef 
PROF


48 #ifde‡
PIC


49 
	#CALL_MCOUNT
 \

50 .
push£˘i⁄
; \

51 .
£˘i⁄
 ".data"; \

52 .
Æign
 
	`ALIGNARG
(2); \

54 .
¥evious
; \

55 
mÊr
 %
r0
; \

56 
°w
 %
r0
,4(%
r1
); \

57 
bl
 
_GLOBAL_OFFSET_TABLE_
@
loˇl
-4; \

58 
mÊr
 %
r11
; \

59 
lwz
 %
r0
,0b@
	`gŸ
(%
r11
); \

60 
bl
 
	`JUMPTARGET
(
_mcou¡
);

	)

62 
	#CALL_MCOUNT
 \

63 .
£˘i⁄
 ".data"; \

64 .
Æign
 
	`ALIGNARG
(2); \

66 .
¥evious
; \

67 
mÊr
 %
r0
; \

68 
lis
 %
r11
,0b@
ha
; \

69 
°w
 %
r0
,4(%
r1
); \

70 
addi
 %
r0
,%
r11
,0b@
l
; \

71 
bl
 
	`JUMPTARGET
(
_mcou¡
);

	)

74 
	#CALL_MCOUNT


	)

77 
	#ENTRY
(
«me
) \

78 
ASM_GLOBAL_DIRECTIVE
 
	`C_SYMBOL_NAME
(
«me
); \

79 
	`ASM_TYPE_DIRECTIVE
 (
	`C_SYMBOL_NAME
(
«me
),@
fun˘i⁄
) \

80 .
Æign
 
	`ALIGNARG
(2); \

81 
	`C_LABEL
(
«me
) \

82 
CALL_MCOUNT


	)

84 
	#EALIGN_W_0


	)

85 
	#EALIGN_W_1
 
n›


	)

86 
	#EALIGN_W_2
 
n›
;
	)
nop

87 
	#EALIGN_W_3
 
n›
;n›;
	)
nop

88 
	#EALIGN_W_4
 
EALIGN_W_3
;
n›


	)

89 
	#EALIGN_W_5
 
EALIGN_W_4
;
n›


	)

90 
	#EALIGN_W_6
 
EALIGN_W_5
;
n›


	)

91 
	#EALIGN_W_7
 
EALIGN_W_6
;
n›


	)

95 #ifde‡
PROF


96 
	#EALIGN
(
«me
, 
Æig¡
, 
w‹ds
) \

97 
ASM_GLOBAL_DIRECTIVE
 
	`C_SYMBOL_NAME
(
«me
); \

98 
	`ASM_TYPE_DIRECTIVE
 (
	`C_SYMBOL_NAME
(
«me
),@
fun˘i⁄
) \

99 .
Æign
 
	`ALIGNARG
(2); \

100 
	`C_LABEL
(
«me
) \

101 
CALL_MCOUNT
 \

102 
b
 0f; \

103 .
Æign
 
	`ALIGNARG
(
Æig¡
); \

104 
EALIGN_W_
##
w‹ds
; \

105 0:

	)

107 
	#EALIGN
(
«me
, 
Æig¡
, 
w‹ds
) \

108 
ASM_GLOBAL_DIRECTIVE
 
	`C_SYMBOL_NAME
(
«me
); \

109 
	`ASM_TYPE_DIRECTIVE
 (
	`C_SYMBOL_NAME
(
«me
),@
fun˘i⁄
) \

110 .
Æign
 
	`ALIGNARG
(
Æig¡
); \

111 
EALIGN_W_
##
w‹ds
; \

112 
	`C_LABEL
(
«me
)

	)

115 
	#END
(
«me
) \

116 
	`ASM_SIZE_DIRECTIVE
(
«me
)

	)

118 #ifde‡
PIC


119 
	#JUMPTARGET
(
«me
Ë«me##@
∂t


	)

121 
	#JUMPTARGET
(
«me
Ë
	)
name

125 
	#L
(
x
Ë.
L
##
	)
x

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/darwin.S

27 
	#LIBFFI_ASM


	)

28 #i‡
deföed
(
__µc64__
)

29 
	#MODE_CHOICE
(
x
, 
y
Ë
	)
y

31 
	#MODE_CHOICE
(
x
, 
y
Ë
	)
x

34 
	#machöe_choi˚
 
	`MODE_CHOICE
(
µc7400
,
µc64
)

	)

36 ; 
Deföe
 
some
 
	gp£udo
-
›codes
 
	gsize
-
ödïídít
 
	glﬂd
 & 
°‹e
 
of
 
	gGPRs
 ...

37 
	#lgu
 
	`MODE_CHOICE
(
lwzu
, 
ldu
)

	)

38 
	#lg
 
	`MODE_CHOICE
(
lwz
,
ld
)

	)

39 
	#sg
 
	`MODE_CHOICE
(
°w
,
°d
)

	)

40 
	#sgu
 
	`MODE_CHOICE
(
°wu
,
°du
)

	)

41 
	#sgux
 
	`MODE_CHOICE
(
°wux
,
°dux
)

	)

43 ; ... 
™d
 
the
 
size
 
of
 
GPRs
ánd 
theú
 
°‹age
 
	gödiˇt‹
.

44 
	#GPR_BYTES
 
	`MODE_CHOICE
(4,8)

	)

45 
	#LOG2_GPR_BYTES
 
	`MODE_CHOICE
(2,3Ë

	)

46 
	#g_l⁄g
 
	`MODE_CHOICE
(, 
quad
Ë

	)

48 ; 
From
 
the
 
ABI
 
	gdoc
: "Ma¯OS X ABI Fun˘i⁄ CÆ»Guide" 
Vîsi⁄
 2009-02-04.

49 
	#LINKAGE_SIZE
 
	`MODE_CHOICE
(24,48)

	)

50 
	#PARAM_AREA
 
	`MODE_CHOICE
(32,64)

	)

51 
	#SAVED_LR_OFFSET
 
	`MODE_CHOICE
(8,16Ë

	)

54 
	#SAVED_FPR_COUNT
 13

	)

55 
	#FPR_SIZE
 8

	)

56 
	#RESULT_BYTES
 16

	)

59 
	#ASM_NEEDS_REGISTERS
 4

	)

60 
	#SAVE_REGS_SIZE
 (
ASM_NEEDS_REGISTERS
 * 
GPR_BYTES
)

	)

62 
	~<ffic⁄fig.h
>

63 
	~<ffi.h
>

65 
	#JUMPTARGET
(
«me
Ë
	)
name

66 
	#L
(
x
Ë
	)
x

68 .
	gãxt


69 .
	gÆign
 2

70 .
globl
 
	g_ffi_¥ï_¨gs


72 .
	gÆign
 2

73 .
globl
 
_ffi_ˇŒ_DARWIN


84 
	g_ffi_ˇŒ_DARWIN
:

85 
L°¨tcode
:

86 
mr
 
r12
,
r8


88 
	gLFB1
:

90 
mr
 
r8
,
r1


91 
	gLCFI0
:

94 
sg
 
r9
,(
	gLINKAGE_SIZE
+6*
	gGPR_BYTES
)(
	gr8
)

97 
sgux
 
	gr1
,r1,
r4


100 
mÊr
 
r9


101 
sg
 
	gr9
,
	$SAVED_LR_OFFSET
(
r8
)

103 
sg
 
r28
,-(4 * 
GPR_BYTES
)(
r8
)

104 
sg
 
r29
,-(3 * 
GPR_BYTES
)(
r8
)

105 
sg
 
r30
,-(2 * 
GPR_BYTES
)(
r8
)

106 
sg
 
r31
,-–
GPR_BYTES
)(
r8
)

108 #i‡!
	`deföed
(
POWERPC_DARWIN
)

110 
sg
 
r2
,(5 * 
GPR_BYTES
)(
r1
)

113 
LCFI1
:

116 
mr
 
r31
,
r5


117 
mr
 
r30
,
r6


118 
mr
 
r29
,
r7


119 
mr
 
r28
,
r8


120 
LCFI2
:

122 
mr
 
r4
,
r1


123 
li
 
r9
,0

125 
mt˘r
 
r12


126 
b˘æ


128 #i‡!
	`deföed
(
POWERPC_DARWIN
)

130 
lg
 
r2
,(5 * 
GPR_BYTES
)(
r1
)

134 
mt¸f
 0x40,
r31


136 
mt˘r
 
r29


139 
lg
 
r3
, (
LINKAGE_SIZE
 )(
r1
)

140 
lg
 
r4
, (
LINKAGE_SIZE
 + 
GPR_BYTES
)(
r1
)

141 
lg
 
r5
, (
LINKAGE_SIZE
 + 2 * 
GPR_BYTES
)(
r1
)

142 
lg
 
r6
, (
LINKAGE_SIZE
 + 3 * 
GPR_BYTES
)(
r1
)

143 
n›


144 
lg
 
r7
, (
LINKAGE_SIZE
 + 4 * 
GPR_BYTES
)(
r1
)

145 
lg
 
r8
, (
LINKAGE_SIZE
 + 5 * 
GPR_BYTES
)(
r1
)

146 
lg
 
r9
, (
LINKAGE_SIZE
 + 6 * 
GPR_BYTES
)(
r1
)

147 
lg
 
r10
,(
LINKAGE_SIZE
 + 7 * 
GPR_BYTES
)(
r1
)

149 
L1
:

151 
bf
 6,
L2


152 
lfd
 
f1
, -
SAVE_REGS_SIZE
-(13*
FPR_SIZE
)(
r28
)

153 
lfd
 
f2
, -
SAVE_REGS_SIZE
-(12*
FPR_SIZE
)(
r28
)

154 
lfd
 
f3
, -
SAVE_REGS_SIZE
-(11*
FPR_SIZE
)(
r28
)

155 
lfd
 
f4
, -
SAVE_REGS_SIZE
-(10*
FPR_SIZE
)(
r28
)

156 
n›


157 
lfd
 
f5
, -
SAVE_REGS_SIZE
-–9*
FPR_SIZE
)(
r28
)

158 
lfd
 
f6
, -
SAVE_REGS_SIZE
-–8*
FPR_SIZE
)(
r28
)

159 
lfd
 
f7
, -
SAVE_REGS_SIZE
-–7*
FPR_SIZE
)(
r28
)

160 
lfd
 
f8
, -
SAVE_REGS_SIZE
-–6*
FPR_SIZE
)(
r28
)

161 
n›


162 
lfd
 
f9
, -
SAVE_REGS_SIZE
-–5*
FPR_SIZE
)(
r28
)

163 
lfd
 
f10
,-
SAVE_REGS_SIZE
-–4*
FPR_SIZE
)(
r28
)

164 
lfd
 
f11
,-
SAVE_REGS_SIZE
-–3*
FPR_SIZE
)(
r28
)

165 
lfd
 
f12
,-
SAVE_REGS_SIZE
-–2*
FPR_SIZE
)(
r28
)

166 
n›


167 
lfd
 
f13
,-
SAVE_REGS_SIZE
-–1*
FPR_SIZE
)(
r28
)

169 
L2
:

170 
mr
 
r12
,
r29


171 
mt˘r
 
r12


172 
n›


173 
n›


176 
b˘æ


185 
mt¸f
 0x03,
r31
 ; 
we
 
√ed
 
c6
 & 
¸7
 
now
.

186 ; 
FLAG_RETURNS_NOTHING
 
Æso
 
covîs
 
ªt
-
by
-
ªf
.

187 
bt
 30,
	`L
(
d⁄e_ªtu∫_vÆue
Ë; 
FLAG_RETURNS_NOTHING


188 
bf
 27,
	`L
(
sˇœr_ªtu∫_vÆue
Ë; 
nŸ
 
FLAG_RETURNS_STRUCT


191 #i‡
	`deföed
(
__µc64__
)

192 
bt
 31,
	`L
(
maybe_ªtu∫_128
Ë; 
FLAG_RETURNS_128BITS
, 
•ecül
 

197 
lg
 
r29
,(
LINKAGE_SIZE
 + 6 * 
GPR_BYTES
)(
r28
)

199 
sg
 
r3
, (
LINKAGE_SIZE
 )(
r28
)

200 
sg
 
r4
, (
LINKAGE_SIZE
 + 
GPR_BYTES
)(
r28
)

201 
sg
 
r5
, (
LINKAGE_SIZE
 + 2 * 
GPR_BYTES
)(
r28
)

202 
sg
 
r6
, (
LINKAGE_SIZE
 + 3 * 
GPR_BYTES
)(
r28
)

203 
n›


204 
sg
 
r7
, (
LINKAGE_SIZE
 + 4 * 
GPR_BYTES
)(
r28
)

205 
sg
 
r8
, (
LINKAGE_SIZE
 + 5 * 
GPR_BYTES
)(
r28
)

206 
sg
 
r9
, (
LINKAGE_SIZE
 + 6 * 
GPR_BYTES
)(
r28
)

207 
sg
 
r10
,(
LINKAGE_SIZE
 + 7 * 
GPR_BYTES
)(
r28
)

210 
mr
 
r3
,
r30
 ; 
de°


211 
addi
 
r4
,
r28
,
LINKAGE_SIZE
 ; 
sour˚


213 
lg
 
r5
,0(
r29
)

215 
cmpi
 0,
r5
,4

216 
bgt
 
L3
 ; 1, 2 
™d
 4 
byãs
 
have
 
•ecül
 
ruÀs
.

217 
cmpi
 0,
r5
,3

218 
beq
 
L3
 ; 
nŸ
 3

219 
addi
 
r4
,r4,8

220 
subf
 
r4
,
r5
,r4

221 
L3
:

222 
bl
 
_mem˝y


225 
mt¸f
 0x03,
r31
 ; 
we
 
√ed
 
c6
 & 
¸7
 
now
.

226 
bf
 29,
	$L
(
d⁄e_ªtu∫_vÆue
)

227 
°fd
 
f1
, -
SAVE_REGS_SIZE
-(13*
FPR_SIZE
)(
r28
)

228 
°fd
 
f2
, -
SAVE_REGS_SIZE
-(12*
FPR_SIZE
)(
r28
)

229 
°fd
 
f3
, -
SAVE_REGS_SIZE
-(11*
FPR_SIZE
)(
r28
)

230 
°fd
 
f4
, -
SAVE_REGS_SIZE
-(10*
FPR_SIZE
)(
r28
)

231 
n›


232 
°fd
 
f5
, -
SAVE_REGS_SIZE
-–9*
FPR_SIZE
)(
r28
)

233 
°fd
 
f6
, -
SAVE_REGS_SIZE
-–8*
FPR_SIZE
)(
r28
)

234 
°fd
 
f7
, -
SAVE_REGS_SIZE
-–7*
FPR_SIZE
)(
r28
)

235 
°fd
 
f8
, -
SAVE_REGS_SIZE
-–6*
FPR_SIZE
)(
r28
)

236 
n›


237 
°fd
 
f9
, -
SAVE_REGS_SIZE
-–5*
FPR_SIZE
)(
r28
)

238 
°fd
 
f10
,-
SAVE_REGS_SIZE
-–4*
FPR_SIZE
)(
r28
)

239 
°fd
 
f11
,-
SAVE_REGS_SIZE
-–3*
FPR_SIZE
)(
r28
)

240 
°fd
 
f12
,-
SAVE_REGS_SIZE
-–2*
FPR_SIZE
)(
r28
)

241 
n›


242 
°fd
 
f13
,-
SAVE_REGS_SIZE
-–1*
FPR_SIZE
)(
r28
)

244 
mr
 
r3
,
r29
 ; 
ffi_ty≥
 *

245 
mr
 
r4
,
r30
 ; 
de°


246 
addi
 
r5
,
r28
,-
SAVE_REGS_SIZE
-(13*
FPR_SIZE
Ë; 
Ârs


247 
x‹
 
r6
,r6,r6

248 
sg
 
r6
,(
LINKAGE_SIZE
 + 7 * 
GPR_BYTES
)(
r28
)

249 
addi
 
r6
,
r28
,(
LINKAGE_SIZE
 + 7 * 
GPR_BYTES
Ë; 
poöt
 
to
 
a
 
zî€d
 
cou¡î
.

250 
bl
 
_d¨wö64_°ru˘_Êﬂts_to_mem


252 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

254 
°w
 
r3
,0(
r30
Ë; 
m32
 
the
 
⁄ly
  
ö
 
ªg
 
is
 4 
byãs
.

256 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

258 
	$L
(
Â_ªtu∫_vÆue
):

260 
bf
 31,
	`L
(
fd_ªtu∫_vÆue
Ë; 
FLAG_RETURNS_128BITS


261 
°fd
 
f1
,0(
r30
)

262 
°fd
 
f2
,
	$FPR_SIZE
(
r30
)

263 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

265 
	$L
(
fd_ªtu∫_vÆue
):

267 
bf
 28,
	$L
(
Êﬂt_ªtu∫_vÆue
)

268 
°fd
 
f1
,0(
r30
)

269 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

271 
	$L
(
Êﬂt_ªtu∫_vÆue
):

273 
°fs
 
f1
,0(
r30
)

274 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

276 
	$L
(
sˇœr_ªtu∫_vÆue
):

277 
bt
 29,
	`L
(
Â_ªtu∫_vÆue
Ë; 
FLAG_RETURNS_FP


278 ; 
ffi_¨g
 
is
 
deföed
 
as
 .

279 
sg
 
r3
,0(
r30
Ë; 
Save
 
the
 
ªg
.

280 
bf
 28,
	`L
(
d⁄e_ªtu∫_vÆue
Ë; 
nŸ
 
FLAG_RETURNS_64BITS


282 #i‡
	`deföed
(
__µc64__
)

283 
	$L
(
maybe_ªtu∫_128
):

284 
°d
 
r3
,0(
r30
)

285 
bf
 31,
	`L
(
d⁄e_ªtu∫_vÆue
Ë; 
nŸ
 
FLAG_RETURNS_128BITS


286 
°d
 
r4
,8(
r30
)

288 
°w
 
r4
,4(
r30
)

294 
	$L
(
d⁄e_ªtu∫_vÆue
):

296 
lg
 
r29
,
	`SAVED_LR_OFFSET
(
r28
)

297 ; 
ïûog


298 
lg
 
r31
,-(1 * 
GPR_BYTES
)(
r28
)

299 
mér
 
r29


300 
lg
 
r30
,-(2 * 
GPR_BYTES
)(
r28
)

301 
lg
 
r29
,-(3 * 
GPR_BYTES
)(
r28
)

302 
lg
 
r28
,-(4 * 
GPR_BYTES
)(r28)

303 
lg
 
r1
,0(r1)

304 
bÃ


305 
LFE1
:

306 .
Æign
 1

310 .
ãxt


311 .
globl
 
_ffi_ˇŒ_AIX


312 .
Æign
 2

313 
_ffi_ˇŒ_AIX
:

314 
bÃ


319 
	#EH_DATA_ALIGN_FACT
 
	`MODE_CHOICE
(0x7c,0x78)

	)

321 .
£˘i⁄
 
__TEXT
,
__eh_‰ame
,
cﬂÀs˚d
,
no_toc
+
°rù_°©ic_syms
+
live_suµ‹t


322 
EH_‰ame1
:

323 .
£t
 
L$£t$0
,
LECIE1
-
LSCIE1


324 .
L$£t$0
 ; 
Lígth
 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


325 
LSCIE1
:

326 .0x0 ; 
CIE
 
Idítifõr
 
Tag


327 .
byã
 0x1 ; 
CIE
 
Vîsi⁄


328 .
ascii
 "zR\0" ; 
CIE
 
Augmíèti⁄


329 .
byã
 0x1 ; 
uÀb128
 0x1; 
CIE
 
Code
 
Alignmít
 
Fa˘‹


330 .
byã
 
EH_DATA_ALIGN_FACT
 ; 
¶eb128
 -4; 
CIE
 
D©a
 
Alignmít
 
Fa˘‹


331 .
byã
 0x41 ; 
CIE
 
RA
 
Cﬁumn


332 .
byã
 0x1 ; 
uÀb128
 0x1; 
Augmíèti⁄
 
size


333 .
byã
 0x10 ; 
FDE
 
	`Encodög
 (
p¸ñ
)

334 .
byã
 0x¯; 
DW_CFA_def_cÁ


335 .
byã
 0x1 ; 
uÀb128
 0x1

336 .
byã
 0x0 ; 
uÀb128
 0x0

337 .
Æign
 
LOG2_GPR_BYTES


338 
LECIE1
:

340 .
globl
 
_ffi_ˇŒ_DARWIN
.
eh


341 
_ffi_ˇŒ_DARWIN
.
eh
:

342 
LSFDE1
:

343 .
£t
 
L$£t$1
,
LEFDE1
-
LASFDE1


344 .
L$£t$1
 ; 
FDE
 
Lígth


345 
LASFDE1
:

346 .
LASFDE1
-
EH_‰ame1
 ; 
FDE
 
CIE
 
off£t


347 .
g_l⁄g
 
L°¨tcode
-. ; 
FDE
 
öôül
 
loˇti⁄


348 .
£t
 
L$£t$3
,
LFE1
-
L°¨tcode


349 .
g_l⁄g
 
L$£t$3
 ; 
FDE
 
addªss
 
ønge


350 .
byã
 0x0 ; 
uÀb128
 0x0; 
Augmíèti⁄
 
size


351 .
byã
 0x4 ; 
DW_CFA_adv™˚_loc4


352 .
£t
 
L$£t$4
,
LCFI0
-
L°¨tcode


353 .
L$£t$4


354 .
byã
 0xd ; 
DW_CFA_def_cÁ_ªgi°î


355 .
byã
 0x08 ; 
uÀb128
 0x08

356 .
byã
 0x4 ; 
DW_CFA_adv™˚_loc4


357 .
£t
 
L$£t$5
,
LCFI1
-
LCFI0


358 .
L$£t$5


359 .
byã
 0x11 ; 
DW_CFA_off£t_exãnded_sf


360 .
byã
 0x41 ; 
uÀb128
 0x41

361 .
byã
 0x7ê; 
¶eb128
 -2

362 .
byã
 0x9‡; 
DW_CFA_off£t
, 
cﬁumn
 0x1f

363 .
byã
 0x1 ; 
uÀb128
 0x1

364 .
byã
 0x9ê; 
DW_CFA_off£t
, 
cﬁumn
 0x1e

365 .
byã
 0x2 ; 
uÀb128
 0x2

366 .
byã
 0x9d ; 
DW_CFA_off£t
, 
cﬁumn
 0x1d

367 .
byã
 0x3 ; 
uÀb128
 0x3

368 .
byã
 0x9¯; 
DW_CFA_off£t
, 
cﬁumn
 0x1c

369 .
byã
 0x4 ; 
uÀb128
 0x4

370 .
byã
 0x4 ; 
DW_CFA_adv™˚_loc4


371 .
£t
 
L$£t$6
,
LCFI2
-
LCFI1


372 .
L$£t$6


373 .
byã
 0xd ; 
DW_CFA_def_cÁ_ªgi°î


374 .
byã
 0x1¯; 
uÀb128
 0x1c

375 .
Æign
 
LOG2_GPR_BYTES


376 
LEFDE1
:

377 .
Æign
 1

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/darwin_closure.S

28 
	#LIBFFI_ASM


	)

29 
	#L
(
x
Ë
	)
x

31 #i‡
deföed
(
__µc64__
)

32 
	#MODE_CHOICE
(
x
, 
y
Ë
	)
y

34 
	#MODE_CHOICE
(
x
, 
y
Ë
	)
x

37 
	#machöe_choi˚
 
	`MODE_CHOICE
(
µc7400
,
µc64
)

	)

39 ; 
Deföe
 
some
 
	gp£udo
-
›codes
 
	gsize
-
ödïídít
 
	glﬂd
 & 
°‹e
 
of
 
	gGPRs
 ...

40 
	#lgu
 
	`MODE_CHOICE
(
lwzu
, 
ldu
)

	)

41 
	#lg
 
	`MODE_CHOICE
(
lwz
,
ld
)

	)

42 
	#sg
 
	`MODE_CHOICE
(
°w
,
°d
)

	)

43 
	#sgu
 
	`MODE_CHOICE
(
°wu
,
°du
)

	)

45 ; ... 
™d
 
the
 
size
 
of
 
GPRs
ánd 
theú
 
°‹age
 
	gödiˇt‹
.

46 
	#GPR_BYTES
 
	`MODE_CHOICE
(4,8)

	)

47 
	#LOG2_GPR_BYTES
 
	`MODE_CHOICE
(2,3Ë

	)

48 
	#g_l⁄g
 
	`MODE_CHOICE
(, 
quad
Ë

	)

50 ; 
From
 
the
 
ABI
 
	gdoc
: "Ma¯OS X ABI Fun˘i⁄ CÆ»Guide" 
Vîsi⁄
 2009-02-04.

51 
	#LINKAGE_SIZE
 
	`MODE_CHOICE
(24,48)

	)

52 
	#PARAM_AREA
 
	`MODE_CHOICE
(32,64)

	)

54 
	#SAVED_CR_OFFSET
 
	`MODE_CHOICE
(4,8Ë

	)

55 
	#SAVED_LR_OFFSET
 
	`MODE_CHOICE
(8,16Ë

	)

59 
	#FFI_TYPE_TYPE
 
	`MODE_CHOICE
(6,10)

	)

60 
	#FFI_TYPE_ELEM
 
	`MODE_CHOICE
(8,16)

	)

62 
	#SAVED_FPR_COUNT
 13

	)

63 
	#FPR_SIZE
 8

	)

65 
	#RESULT_BYTES
 
	`MODE_CHOICE
(16,176)

	)

67 ; 
The
 
whﬁe
 
°ack
 
‰ame
 **
MUST
** 
	gbe
 16b
	gyã
-
	gÆig√d
.

68 
	#SAVE_SIZE
 (((
LINKAGE_SIZE
+
PARAM_AREA
+
SAVED_FPR_COUNT
*
FPR_SIZE
+
RESULT_BYTES
)+15Ë& -16LL)

	)

69 
	#PAD_SIZE
 (
SAVE_SIZE
-(
LINKAGE_SIZE
+
PARAM_AREA
+
SAVED_FPR_COUNT
*
FPR_SIZE
+
RESULT_BYTES
))

	)

71 
	#PARENT_PARM_BASE
 (
SAVE_SIZE
+
LINKAGE_SIZE
)

	)

72 
	#FP_SAVE_BASE
 (
LINKAGE_SIZE
+
PARAM_AREA
)

	)

74 #i‡
deföed
(
__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__
) && __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ >= 1050

75 ; 
We
 
no
 
l⁄gî
 
√ed
 
the
 
pic
 
symbﬁ
 
°ub
 
	gD¨wö
 >= 9.

76 
	#BLCLS_HELP
 
_ffi_˛osuª_hñ≥r_DARWIN


	)

77 
	#STRUCT_RETVALUE_P
 
_d¨wö64_°ru˘_ªt_by_vÆue_p


	)

78 
	#PASS_STR_FLOATS
 
_d¨wö64_∑ss_°ru˘_Êﬂts


	)

79 #unde‡
WANT_STUB


81 
	#BLCLS_HELP
 
L_ffi_˛osuª_hñ≥r_DARWIN$°ub


	)

82 
	#STRUCT_RETVALUE_P
 
L_d¨wö64_°ru˘_ªt_by_vÆue_p$°ub


	)

83 
	#PASS_STR_FLOATS
 
L_d¨wö64_∑ss_°ru˘_Êﬂts$°ub


	)

84 
	#WANT_STUB


	)

127 .
fûe
 "darwin_closure.S"

129 .
machöe
 
machöe_choi˚


131 .
ãxt


132 .
globl
 
_ffi_˛osuª_ASM


133 .
Æign
 
LOG2_GPR_BYTES


134 
_ffi_˛osuª_ASM
:

135 
LFB1
:

136 
L°¨tcode
:

137 
mÊr
 
r0


138 
sg
 
r0
,
	$SAVED_LR_OFFSET
(
r1
)

139 
LCFI0
:

140 
sgu
 
r1
,-
	$SAVE_SIZE
(
r1
)

142 
LCFI1
:

149 
sg
 
r3
, (
PARENT_PARM_BASE
 )(
r1
)

150 
sg
 
r4
, (
PARENT_PARM_BASE
 + 
GPR_BYTES
 )(
r1
)

151 
sg
 
r5
, (
PARENT_PARM_BASE
 + 
GPR_BYTES
 * 2)(
r1
)

152 
sg
 
r6
, (
PARENT_PARM_BASE
 + 
GPR_BYTES
 * 3)(
r1
)

153 
sg
 
r7
, (
PARENT_PARM_BASE
 + 
GPR_BYTES
 * 4)(
r1
)

154 
sg
 
r8
, (
PARENT_PARM_BASE
 + 
GPR_BYTES
 * 5)(
r1
)

155 
sg
 
r9
, (
PARENT_PARM_BASE
 + 
GPR_BYTES
 * 6)(
r1
)

156 
sg
 
r10
,(
PARENT_PARM_BASE
 + 
GPR_BYTES
 * 7)(
r1
)

159 
°fd
 
f1
, (
FP_SAVE_BASE
 )(
r1
)

160 
°fd
 
f2
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 )(
r1
)

161 
°fd
 
f3
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 2 )(
r1
)

162 
°fd
 
f4
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 3 )(
r1
)

163 
°fd
 
f5
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 4 )(
r1
)

164 
°fd
 
f6
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 5 )(
r1
)

165 
°fd
 
f7
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 6 )(
r1
)

166 
°fd
 
f8
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 7 )(
r1
)

167 
°fd
 
f9
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 8 )(
r1
)

168 
°fd
 
f10
,(
FP_SAVE_BASE
 + 
FPR_SIZE
 * 9 )(
r1
)

169 
°fd
 
f11
,(
FP_SAVE_BASE
 + 
FPR_SIZE
 * 10)(
r1
)

170 
°fd
 
f12
,(
FP_SAVE_BASE
 + 
FPR_SIZE
 * 11)(
r1
)

171 
°fd
 
f13
,(
FP_SAVE_BASE
 + 
FPR_SIZE
 * 12)(
r1
)

175 
mr
 
r3
,
r11


178 
addi
 
r4
,
r1
,(
SAVE_SIZE
-
RESULT_BYTES
)

181 
addi
 
r5
,
r1
,
PARENT_PARM_BASE


184 
addi
 
r6
,
r1
,
FP_SAVE_BASE


187 
bl
 
BLCLS_HELP


191 
sg
 
r3
,
	`LINKAGE_SIZE
(
r1
Ë; 
ffi_ty≥
 * 
ªsu…_ty≥


192 
lg
 
r0
,0(
r3
Ë; 
size
 =>Ñ0

193 
lhz
 
r3
,
	`FFI_TYPE_TYPE
‘3Ë; 
ty≥
 =>Ñ3

201 
addi
 
r5
,
r1
,(
SAVE_SIZE
-
RESULT_BYTES
)

202 
bl
 
Lgë_ªt_ty≥0_addr


203 
mÊr
 
r4


204 
¶wi
 
r3
,r3,4

205 
add
 
r3
,r3,
r4


206 
mt˘r
 
r3


207 
b˘r


208 
LFE1
:

213 .
Æign
 4

215 
n›


216 
n›


217 
n›


218 
Lgë_ªt_ty≥0_addr
:

219 
bÃl


222 
Lªt_ty≥0
:

223 
b
 
Lföish


224 
n›


225 
n›


226 
n›


229 
Lªt_ty≥1
:

230 
lg
 
r3
,0(
r5
)

231 
b
 
Lföish


232 
n›


233 
n›


236 
Lªt_ty≥2
:

237 
lfs
 
f1
,0(
r5
)

238 
b
 
Lföish


239 
n›


240 
n›


243 
Lªt_ty≥3
:

244 
lfd
 
f1
,0(
r5
)

245 
b
 
Lföish


246 
n›


247 
n›


250 
Lªt_ty≥4
:

251 
lfd
 
f1
,0(
r5
)

252 
lfd
 
f2
,8(
r5
)

253 
b
 
Lföish


254 
n›


257 
Lªt_ty≥5
:

258 #i‡
	`deföed
(
__µc64__
)

259 
lbz
 
r3
,7(
r5
)

261 
lbz
 
r3
,3(
r5
)

263 
b
 
Lföish


264 
n›


265 
n›


268 
Lªt_ty≥6
:

269 #i‡
	`deföed
(
__µc64__
)

270 
lbz
 
r3
,7(
r5
)

272 
lbz
 
r3
,3(
r5
)

274 
extsb
 
r3
,r3

275 
b
 
Lföish


276 
n›


279 
Lªt_ty≥7
:

280 #i‡
	`deföed
(
__µc64__
)

281 
lhz
 
r3
,6(
r5
)

283 
lhz
 
r3
,2(
r5
)

285 
b
 
Lföish


286 
n›


287 
n›


290 
Lªt_ty≥8
:

291 #i‡
	`deföed
(
__µc64__
)

292 
lha
 
r3
,6(
r5
)

294 
lha
 
r3
,2(
r5
)

296 
b
 
Lföish


297 
n›


298 
n›


301 
Lªt_ty≥9
:

302 #i‡
	`deföed
(
__µc64__
)

303 
lwz
 
r3
,4(
r5
)

305 
lwz
 
r3
,0(
r5
)

307 
b
 
Lföish


308 
n›


309 
n›


312 
Lªt_ty≥10
:

313 #i‡
	`deföed
(
__µc64__
)

314 
lwz
 
r3
,4(
r5
)

316 
lwz
 
r3
,0(
r5
)

318 
b
 
Lföish


319 
n›


320 
n›


323 
Lªt_ty≥11
:

324 #i‡
	`deföed
(
__µc64__
)

325 
lg
 
r3
,0(
r5
)

326 
b
 
Lföish


327 
n›


329 
lwz
 
r3
,0(
r5
)

330 
lwz
 
r4
,4(
r5
)

331 
b
 
Lföish


333 
n›


336 
Lªt_ty≥12
:

337 #i‡
	`deföed
(
__µc64__
)

338 
lg
 
r3
,0(
r5
)

339 
b
 
Lföish


340 
n›


342 
lwz
 
r3
,0(
r5
)

343 
lwz
 
r4
,4(
r5
)

344 
b
 
Lföish


346 
n›


349 
Lªt_ty≥13
:

350 #i‡
	`deföed
(
__µc64__
)

351 
lg
 
r3
,0(
r5
Ë; 
we
 
√ed
 
©
 
Àa°
 
this
...

352 
cmpi
 0,
r0
,4

353 
bgt
 
L°ru˘íd
 ; 
nŸ
 
a
 
•ecül
 
smÆl
 

354 
b
 
LsmÆl°ru˘
 ; 
£e
 
we
 
√ed
 
m‹e
.

356 
cmpi
 0,
r0
,4

357 
bgt
 
Lföish
 ; 
nŸ
 
by
 
vÆue


358 
lg
 
r3
,0(
r5
)

359 
b
 
Lföish


362 
Lªt_ty≥14
:

363 
lg
 
r3
,0(
r5
)

364 
b
 
Lföish


365 
n›


366 
n›


368 #i‡
	`deföed
(
__µc64__
)

369 
LsmÆl°ru˘
:

370 
beq
 
Lfour
 ; 
c⁄töu©i⁄
 
of
 
Lªt13
.

371 
cmpi
 0,
r0
,3

372 
beq
 
Lföish
 ; 
d⁄
`
t
 
adju°
 
this
 - 
ˇn
`à
be
 
™y
 
Êﬂts
 
hîe
...

373 
§di
 
r3
,r3,48

374 
cmpi
 0,
r0
,2

375 
beq
 
Lföish
 ; .. 
‹
 
hîe
 ..

376 
§di
 
r3
,r3,8

377 
b
 
Lföish
 ; .. 
‹
 
hîe
.

379 
Lfour
:

380 
lg
 
r6
,
	`LINKAGE_SIZE
(
r1
Ë; 
gë
 
the
 
ªsu…
 
ty≥


381 
lg
 
r6
,
	`FFI_TYPE_ELEM
‘6Ë; 
ñemíts
 
¨øy
 
poöãr


382 
lg
 
r6
,0‘6Ë; 
fú°
 
ñemít


383 
lhz
 
r0
,
	`FFI_TYPE_TYPE
(
r6
Ë; 
OK
 
go
 
the
 
ty≥


384 
cmpi
 0,
r0
,2 ; 
FFI_TYPE_FLOAT


385 
b√
 
Lfouröt


386 
lfs
 
f1
,0(
r5
Ë; 
ju°
 
⁄e
 
ö
 
the
 .

387 
b
 
Lföish


389 
Lfouröt
:

390 
§di
 
r3
,r3,32 ; 
four
 
byãs
.

391 
b
 
Lföish


393 
L°ru˘íd
:

394 
lg
 
r3
,
	`LINKAGE_SIZE
(
r1
Ë; 
gë
 
the
 
ªsu…
 
ty≥


395 
bl
 
STRUCT_RETVALUE_P


396 
cmpi
 0,
r3
,0

397 
beq
 
Lföish
 ; 
n›e
.

399 
addi
 
r11
,
r1
,(
SAVE_SIZE
-
RESULT_BYTES
)

400 
lg
 
r3
,0(
r11
Ë; 
we
 
√ed
 
©
 
Àa°
 
this
...

401 
lg
 
r4
,8(
r11
)

402 
cmpi
 0,
r0
,16

403 
beq
 
Lföish
 ; 
•ecül
 16 
byãs
 
we
 
d⁄
't consider floats.

412 
x‹
 
r6
,r6,r6

413 
addi
 
r5
,
r1
,
PARENT_PARM_BASE
 ; 
some
 
•a˚


414 
sg
 
r6
,0(
r5
Ë; *
nÂr
 
zî€d
.

415 
addi
 
r6
,
r5
,8 ; **
Ârs


416 
addi
 
r3
,
r1
,
FP_SAVE_BASE
 ; 
poöãr
 
to
 
FPRs
 
•a˚


417 
sg
 
r3
,0(
r6
)

418 
mr
 
r4
,
r11
 ; 
the
 
is
 
hîe
...

419 
lg
 
r3
,
	`LINKAGE_SIZE
(
r1
Ë; 
ffi_ty≥
 * 
ªsu…_ty≥
.

420 
bl
 
PASS_STR_FLOATS
 ; 
gë
 
Êﬂts
 
öto
 
FPR
 
ßve
 
•a˚
.

422 
lwz
 
r0
,(
SAVE_SIZE
-
RESULT_BYTES
)(
r1
)

423 
cmpi
 0,
r0
,0

424 
beq
 
L°ru˘öts
 ; 
n›e
.

426 
lfd
 
f1
, (
FP_SAVE_BASE
 )(
r1
)

427 
lfd
 
f2
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 )(
r1
)

428 
lfd
 
f3
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 2 )(
r1
)

429 
lfd
 
f4
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 3 )(
r1
)

430 
lfd
 
f5
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 4 )(
r1
)

431 
lfd
 
f6
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 5 )(
r1
)

432 
lfd
 
f7
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 6 )(
r1
)

433 
lfd
 
f8
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 7 )(
r1
)

434 
lfd
 
f9
, (
FP_SAVE_BASE
 + 
FPR_SIZE
 * 8 )(
r1
)

435 
lfd
 
f10
,(
FP_SAVE_BASE
 + 
FPR_SIZE
 * 9 )(
r1
)

436 
lfd
 
f11
,(
FP_SAVE_BASE
 + 
FPR_SIZE
 * 10)(
r1
)

437 
lfd
 
f12
,(
FP_SAVE_BASE
 + 
FPR_SIZE
 * 11)(
r1
)

438 
lfd
 
f13
,(
FP_SAVE_BASE
 + 
FPR_SIZE
 * 12)(
r1
)

441 
L°ru˘öts
:

442 
addi
 
r11
,
r1
,(
SAVE_SIZE
-
RESULT_BYTES
)

443 
lg
 
r3
,0(
r11
Ë; 
we
 
íd
 
up
 
pickög
 
the


444 
lg
 
r4
,8(
r11
Ë; 
fú°
 
two
 
agaö
.

445 
lg
 
r5
,16(
r11
)

446 
lg
 
r6
,24(
r11
)

447 
lg
 
r7
,32(
r11
)

448 
lg
 
r8
,40(
r11
)

449 
lg
 
r9
,48(
r11
)

450 
lg
 
r10
,56(
r11
)

454 
Lföish
:

455 
addi
 
r1
,r1,
SAVE_SIZE


456 
lg
 
r0
,
	$SAVED_LR_OFFSET
(
r1
)

457 
mér
 
r0


458 
bÃ


459 
Lídcode
:

460 .
Æign
 1

465 
	#EH_DATA_ALIGN_FACT
 
	`MODE_CHOICE
(0x7c,0x78)

	)

467 
	#EH_FRAME_OFFSETA
 
	`MODE_CHOICE
(176,0x90)

	)

468 
	#EH_FRAME_OFFSETB
 
	`MODE_CHOICE
(1,3)

	)

470 .
£˘i⁄
 
__TEXT
,
__eh_‰ame
,
cﬂÀs˚d
,
no_toc
+
°rù_°©ic_syms
+
live_suµ‹t


471 
EH_‰ame1
:

472 .
£t
 
L$£t$0
,
LECIE1
-
LSCIE1


473 .
L$£t$0
 ; 
Lígth
 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


474 
LSCIE1
:

475 .0x0 ; 
CIE
 
Idítifõr
 
Tag


476 .
byã
 0x1 ; 
CIE
 
Vîsi⁄


477 .
ascii
 "zR\0" ; 
CIE
 
Augmíèti⁄


478 .
byã
 0x1 ; 
uÀb128
 0x1; 
CIE
 
Code
 
Alignmít
 
Fa˘‹


479 .
byã
 
EH_DATA_ALIGN_FACT
 ; 
¶eb128
 -4; 
CIE
 
D©a
 
Alignmít
 
Fa˘‹


480 .
byã
 0x41 ; 
CIE
 
RA
 
Cﬁumn


481 .
byã
 0x1 ; 
uÀb128
 0x1; 
Augmíèti⁄
 
size


482 .
byã
 0x10 ; 
FDE
 
	`Encodög
 (
p¸ñ
)

483 .
byã
 0x¯; 
DW_CFA_def_cÁ


484 .
byã
 0x1 ; 
uÀb128
 0x1

485 .
byã
 0x0 ; 
uÀb128
 0x0

486 .
Æign
 
LOG2_GPR_BYTES


487 
LECIE1
:

488 .
globl
 
_ffi_˛osuª_ASM
.
eh


489 
_ffi_˛osuª_ASM
.
eh
:

490 
LSFDE1
:

491 .
£t
 
L$£t$1
,
LEFDE1
-
LASFDE1


492 .
L$£t$1
 ; 
FDE
 
Lígth


494 
LASFDE1
:

495 .
LASFDE1
-
EH_‰ame1
 ; 
FDE
 
CIE
 
off£t


496 .
g_l⁄g
 
L°¨tcode
-. ; 
FDE
 
öôül
 
loˇti⁄


497 .
£t
 
L$£t$3
,
LFE1
-
L°¨tcode


498 .
g_l⁄g
 
L$£t$3
 ; 
FDE
 
addªss
 
ønge


499 .
byã
 0x0 ; 
uÀb128
 0x0; 
Augmíèti⁄
 
size


500 .
byã
 0x4 ; 
DW_CFA_adv™˚_loc4


501 .
£t
 
L$£t$3
,
LCFI1
-
LCFI0


502 .
L$£t$3


503 .
byã
 0xê; 
DW_CFA_def_cÁ_off£t


504 .
byã
 
EH_FRAME_OFFSETA
,
EH_FRAME_OFFSETB
 ; 
uÀb128
 176,1/190,3

505 .
byã
 0x4 ; 
DW_CFA_adv™˚_loc4


506 .
£t
 
L$£t$4
,
LCFI0
-
L°¨tcode


507 .
L$£t$4


508 .
byã
 0x11 ; 
DW_CFA_off£t_exãnded_sf


509 .
byã
 0x41 ; 
uÀb128
 0x41

510 .
byã
 0x7ê; 
¶eb128
 -2

511 .
Æign
 
LOG2_GPR_BYTES


512 
LEFDE1
:

513 .
Æign
 1

515 #ifde‡
WANT_STUB


516 .
£˘i⁄
 
__TEXT
,
__picsymbﬁ°ub1
,
symbﬁ_°ubs
,
puª_ö°ru˘i⁄s
,32

517 .
Æign
 5

518 
L_ffi_˛osuª_hñ≥r_DARWIN$°ub
:

519 .
ödúe˘_symbﬁ
 
_ffi_˛osuª_hñ≥r_DARWIN


520 
mÊr
 
r0


521 
b˛
 20,31,"L1$spb"

523 
mÊr
 
r11


524 
addis
 
r11
,r11,
	`ha16
(
L_ffi_˛osuª_hñ≥r_DARWIN$œzy_±r
-"L1$spb")

525 
mér
 
r0


526 
lwzu
 
r12
,
	`lo16
(
L_ffi_˛osuª_hñ≥r_DARWIN$œzy_±r
-"L1$•b")(
r11
)

527 
mt˘r
 
r12


528 
b˘r


529 .
œzy_symbﬁ_poöãr


530 
L_ffi_˛osuª_hñ≥r_DARWIN$œzy_±r
:

531 .
ödúe˘_symbﬁ
 
_ffi_˛osuª_hñ≥r_DARWIN


532 .
g_l⁄g
 
dyld_°ub_bödög_hñ≥r


534 #i‡
	`deföed
(
__µc64__
)

535 .
£˘i⁄
 
__TEXT
,
__picsymbﬁ°ub1
,
symbﬁ_°ubs
,
puª_ö°ru˘i⁄s
,32

536 .
Æign
 5

537 
L_d¨wö64_°ru˘_ªt_by_vÆue_p$°ub
:

538 .
ödúe˘_symbﬁ
 
_d¨wö64_°ru˘_ªt_by_vÆue_p


539 
mÊr
 
r0


540 
b˛
 20,31,"L2$spb"

542 
mÊr
 
r11


543 
addis
 
r11
,r11,
	`ha16
(
L_d¨wö64_°ru˘_ªt_by_vÆue_p$œzy_±r
-"L2$spb")

544 
mér
 
r0


545 
lwzu
 
r12
,
	`lo16
(
L_d¨wö64_°ru˘_ªt_by_vÆue_p$œzy_±r
-"L2$•b")(
r11
)

546 
mt˘r
 
r12


547 
b˘r


548 .
œzy_symbﬁ_poöãr


549 
L_d¨wö64_°ru˘_ªt_by_vÆue_p$œzy_±r
:

550 .
ödúe˘_symbﬁ
 
_d¨wö64_°ru˘_ªt_by_vÆue_p


551 .
g_l⁄g
 
dyld_°ub_bödög_hñ≥r


553 .
£˘i⁄
 
__TEXT
,
__picsymbﬁ°ub1
,
symbﬁ_°ubs
,
puª_ö°ru˘i⁄s
,32

554 .
Æign
 5

555 
L_d¨wö64_∑ss_°ru˘_Êﬂts$°ub
:

556 .
ödúe˘_symbﬁ
 
_d¨wö64_∑ss_°ru˘_Êﬂts


557 
mÊr
 
r0


558 
b˛
 20,31,"L3$spb"

560 
mÊr
 
r11


561 
addis
 
r11
,r11,
	`ha16
(
L_d¨wö64_∑ss_°ru˘_Êﬂts$œzy_±r
-"L3$spb")

562 
mér
 
r0


563 
lwzu
 
r12
,
	`lo16
(
L_d¨wö64_∑ss_°ru˘_Êﬂts$œzy_±r
-"L3$•b")(
r11
)

564 
mt˘r
 
r12


565 
b˘r


566 .
œzy_symbﬁ_poöãr


567 
L_d¨wö64_∑ss_°ru˘_Êﬂts$œzy_±r
:

568 .
ödúe˘_symbﬁ
 
_d¨wö64_∑ss_°ru˘_Êﬂts


569 .
g_l⁄g
 
dyld_°ub_bödög_hñ≥r


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi.c

31 
	~"ffi.h
"

32 
	~"ffi_comm⁄.h
"

33 
	~"ffi_powîpc.h
"

35 #i‡
HAVE_LONG_DOUBLE_VARIANT


37 
FFI_HIDDEN


38 
	$ffi_¥ï_ty≥s
 (
ffi_abi
 
abi
)

40 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


41 #ifde‡
POWERPC64


42 
	`ffi_¥ï_ty≥s_löux64
 (
abi
);

44 
	`ffi_¥ï_ty≥s_sysv
 (
abi
);

47 
	}
}

51 
ffi_°©us
 
FFI_HIDDEN


52 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

54 #ifde‡
POWERPC64


55  
	`ffi_¥ï_cif_löux64
 (
cif
);

57  
	`ffi_¥ï_cif_sysv
 (
cif
);

59 
	}
}

61 
ffi_°©us
 
FFI_HIDDEN


62 
	$ffi_¥ï_cif_machdï_v¨
 (
ffi_cif
 *
cif
,

63 
nfixed¨gs
 
MAYBE_UNUSED
,

64 
¡ŸÆ¨gs
 
MAYBE_UNUSED
)

66 #ifde‡
POWERPC64


67  
	`ffi_¥ï_cif_löux64_v¨
 (
cif
, 
nfixed¨gs
, 
¡ŸÆ¨gs
);

69  
	`ffi_¥ï_cif_sysv
 (
cif
);

71 
	}
}

74 
ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

85 
sm°_buf„r
[8];

86 
exãnded_cif
 
ecif
;

88 
ecif
.
cif
 = cif;

89 
ecif
.
avÆue
 =ávalue;

91 
ecif
.
rvÆue
 =Ñvalue;

92 i‡((
cif
->
Êags
 & 
FLAG_RETURNS_SMST
) != 0)

93 
ecif
.
rvÆue
 = 
sm°_buf„r
;

96 i‡(!
rvÆue
 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

97 
ecif
.
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

99 #ifde‡
POWERPC64


100 
	`ffi_ˇŒ_LINUX64
 (&
ecif
, -(Ë
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
, 
‚
);

102 
	`ffi_ˇŒ_SYSV
 (&
ecif
, -
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
, 
‚
);

106 i‡(
rvÆue
 && 
ecif
.rvÆuê=
sm°_buf„r
)

108 
rsize
 = 
cif
->
πy≥
->
size
;

109 #i‚de‡
__LITTLE_ENDIAN__


112 #i‚de‡
POWERPC64


113 i‡(
rsize
 <= 4)

114 
	`mem˝y
 (
rvÆue
, (*Ë
sm°_buf„r
 + 4 - 
rsize
,Ñsize);

120 i‡(
rsize
 <= 8)

121 
	`mem˝y
 (
rvÆue
, (*Ë
sm°_buf„r
 + 8 - 
rsize
,Ñsize);

124 
	`mem˝y
 (
rvÆue
, 
sm°_buf„r
, 
rsize
);

126 
	}
}

129 
ffi_°©us


130 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
 *
˛osuª
,

131 
ffi_cif
 *
cif
,

132 (*
fun
Ë(
ffi_cif
 *, *, **, *),

133 *
u£r_d©a
,

134 *
codñoc
)

136 #ifde‡
POWERPC64


137  
	`ffi_¥ï_˛osuª_loc_löux64
 (
˛osuª
, 
cif
, 
fun
, 
u£r_d©a
, 
codñoc
);

139  
	`ffi_¥ï_˛osuª_loc_sysv
 (
˛osuª
, 
cif
, 
fun
, 
u£r_d©a
, 
codñoc
);

141 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi_darwin.c

30 
	~<ffi.h
>

31 
	~<ffi_comm⁄.h
>

33 
	~<°dlib.h
>

35 
ffi_˛osuª_ASM
 ();

43 
	mFLAG_RETURNS_128BITS
 = 1 << (31-31),

44 
	mFLAG_RETURNS_NOTHING
 = 1 << (31-30),

45 
	mFLAG_RETURNS_FP
 = 1 << (31-29),

46 
	mFLAG_RETURNS_64BITS
 = 1 << (31-28),

48 
	mFLAG_RETURNS_STRUCT
 = 1 << (31-27),

50 
	mFLAG_ARG_NEEDS_COPY
 = 1 << (31- 7),

51 
	mFLAG_FP_ARGUMENTS
 = 1 << (31- 6),

52 
	mFLAG_4_GPR_ARGUMENTS
 = 1 << (31- 5),

53 
	mFLAG_RETVAL_REFERENCE
 = 1 << (31- 4)

58 
	mNUM_GPR_ARG_REGISTERS
 = 8,

59 
	mNUM_FPR_ARG_REGISTERS
 = 13,

60 
	mLINKAGE_AREA_GPRS
 = 6

63 íum { 
	mASM_NEEDS_REGISTERS
 = 4 };

97 #i‡
deföed
(
POWERPC_DARWIN64
)

99 
	gd¨wö64_∑ss_°ru˘_by_vÆue


100 (
	gffi_ty≥
 *, *, , *, **, **);

106 
	$ffi_¥ï_¨gs
 (
exãnded_cif
 *
ecif
, *c⁄° 
°ack
)

108 c⁄° 
byãs
 = 
ecif
->
cif
->bytes;

109 c⁄° 
Êags
 = 
ecif
->
cif
->flags;

110 c⁄° 
«rgs
 = 
ecif
->
cif
->nargs;

111 #i‡!
	`deföed
(
POWERPC_DARWIN64
)

112 c⁄° 
ffi_abi
 
abi
 = 
ecif
->
cif
->abi;

116 *c⁄° 
°ackt›
 = 
°ack
 + (
byãs
 / ());

120 *
Âr_ba£
 = (*Ë(
°ackt›
 - 
ASM_NEEDS_REGISTERS
Ë- 
NUM_FPR_ARG_REGISTERS
;

121 
gp_cou¡
 = 0, 
Â¨g_cou¡
 = 0;

124 *
√xt_¨g
 = 
°ack
 + 
LINKAGE_AREA_GPRS
;

126 
i
;

127 
doubÀ_tmp
;

128 **
p_¨gv
 = 
ecif
->
avÆue
;

129 
g¥vÆue
;

130 
ffi_ty≥
** 
±r
 = 
ecif
->
cif
->
¨g_ty≥s
;

131 #i‡!
	`deföed
(
POWERPC_DARWIN64
)

132 *
de°_˝y
;

134 
size_Æ
 = 0;

137 
	`FFI_ASSERT
(((Ë(*Ë
°ack
 & 0xF) == 0);

138 
	`FFI_ASSERT
(((Ë(*Ë
°ackt›
 & 0xF) == 0);

139 
	`FFI_ASSERT
((
byãs
 & 0xF) == 0);

145 i‡(
Êags
 & 
FLAG_RETVAL_REFERENCE
)

146 *
√xt_¨g
++ = (Ë(*Ë
ecif
->
rvÆue
;

149 
i
 = 
«rgs
; i > 0; i--, 
±r
++, 
p_¨gv
++)

151 (*
±r
)->
ty≥
)

156 
FFI_TYPE_FLOAT
:

157 
doubÀ_tmp
 = *(*Ë*
p_¨gv
;

158 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS
)

159 *
Âr_ba£
++ = 
doubÀ_tmp
;

160 #i‡
	`deföed
(
POWERPC_DARWIN
)

161 *(*)
√xt_¨g
 = *(*Ë*
p_¨gv
;

163 *(*)
√xt_¨g
 = 
doubÀ_tmp
;

165 
√xt_¨g
++;

166 
gp_cou¡
++;

167 
Â¨g_cou¡
++;

168 
	`FFI_ASSERT
(
Êags
 & 
FLAG_FP_ARGUMENTS
);

171 
FFI_TYPE_DOUBLE
:

172 
doubÀ_tmp
 = *(*Ë*
p_¨gv
;

173 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS
)

174 *
Âr_ba£
++ = 
doubÀ_tmp
;

175 *(*)
√xt_¨g
 = 
doubÀ_tmp
;

176 #ifde‡
POWERPC64


177 
√xt_¨g
++;

178 
gp_cou¡
++;

180 
√xt_¨g
 += 2;

181 
gp_cou¡
 += 2;

183 
Â¨g_cou¡
++;

184 
	`FFI_ASSERT
(
Êags
 & 
FLAG_FP_ARGUMENTS
);

187 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


189 
FFI_TYPE_LONGDOUBLE
:

190 #i‡
	`deföed
(
POWERPC64
Ë&& !deföed(
POWERPC_DARWIN64
)

193 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS
)

194 *(*Ë
Âr_ba£
++ = *(*Ë*
p_¨gv
;

196 *(*Ë
√xt_¨g
 = *(*Ë*
p_¨gv
;

197 
√xt_¨g
 += 2;

198 
Â¨g_cou¡
 += 2;

200 
doubÀ_tmp
 = ((*Ë*
p_¨gv
)[0];

201 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS
)

202 *
Âr_ba£
++ = 
doubÀ_tmp
;

203 *(*Ë
√xt_¨g
 = 
doubÀ_tmp
;

204 #i‡
	`deföed
(
POWERPC_DARWIN64
)

205 
√xt_¨g
++;

206 
gp_cou¡
++;

208 
√xt_¨g
 += 2;

209 
gp_cou¡
 += 2;

211 
Â¨g_cou¡
++;

212 
doubÀ_tmp
 = ((*Ë*
p_¨gv
)[1];

213 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS
)

214 *
Âr_ba£
++ = 
doubÀ_tmp
;

215 *(*Ë
√xt_¨g
 = 
doubÀ_tmp
;

216 #i‡
	`deföed
(
POWERPC_DARWIN64
)

217 
√xt_¨g
++;

218 
gp_cou¡
++;

220 
√xt_¨g
 += 2;

221 
gp_cou¡
 += 2;

223 
Â¨g_cou¡
++;

225 
	`FFI_ASSERT
(
Êags
 & 
FLAG_FP_ARGUMENTS
);

228 
FFI_TYPE_UINT64
:

229 
FFI_TYPE_SINT64
:

230 #ifde‡
POWERPC64


231 
g¥vÆue
 = *(*Ë*
p_¨gv
;

232 
putg¥
;

234 *(*Ë
√xt_¨g
 = *(*Ë*
p_¨gv
;

235 
√xt_¨g
 += 2;

236 
gp_cou¡
 += 2;

239 
FFI_TYPE_POINTER
:

240 
g¥vÆue
 = *(*Ë*
p_¨gv
;

241 
putg¥
;

242 
FFI_TYPE_UINT8
:

243 
g¥vÆue
 = *(*Ë*
p_¨gv
;

244 
putg¥
;

245 
FFI_TYPE_SINT8
:

246 
g¥vÆue
 = *(sig√d *Ë*
p_¨gv
;

247 
putg¥
;

248 
FFI_TYPE_UINT16
:

249 
g¥vÆue
 = *(*Ë*
p_¨gv
;

250 
putg¥
;

251 
FFI_TYPE_SINT16
:

252 
g¥vÆue
 = *(sig√d *Ë*
p_¨gv
;

253 
putg¥
;

255 
FFI_TYPE_STRUCT
:

256 
size_Æ
 = (*
±r
)->
size
;

257 #i‡
	`deföed
(
POWERPC_DARWIN64
)

258 
√xt_¨g
 = (*)
	`ALIGN
((*Íext_¨g, (*
±r
)->
Æignmít
);

259 
	`d¨wö64_∑ss_°ru˘_by_vÆue
 (*
±r
, (*Ë*
p_¨gv
,

260 (Ë
size_Æ
,

261 (*Ë&
Â¨g_cou¡
,

262 &
Âr_ba£
, &
√xt_¨g
);

264 
de°_˝y
 = (*Ë
√xt_¨g
;

268 i‡((*
±r
)->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_DOUBLE
)

269 
size_Æ
 = 
	`ALIGN
((*
±r
)->
size
, 8);

271 #i‡
	`deföed
(
POWERPC64
)

272 
	`FFI_ASSERT
 (
abi
 !
FFI_DARWIN
);

273 
	`mem˝y
 ((*Ë
de°_˝y
, (*Ë*
p_¨gv
, 
size_Æ
);

274 
√xt_¨g
 +(
size_Æ
 + 7) / 8;

279 i‡(
size_Æ
 < 3 && 
abi
 =
FFI_DARWIN
)

280 
de°_˝y
 +4 - 
size_Æ
;

282 
	`mem˝y
((*Ë
de°_˝y
, (*Ë*
p_¨gv
, 
size_Æ
);

283 
√xt_¨g
 +(
size_Æ
 + 3) / 4;

288 
FFI_TYPE_INT
:

289 
FFI_TYPE_SINT32
:

290 
g¥vÆue
 = *(sig√d *Ë*
p_¨gv
;

291 
putg¥
;

293 
FFI_TYPE_UINT32
:

294 
g¥vÆue
 = *(*Ë*
p_¨gv
;

295 
putg¥
:

296 *
√xt_¨g
++ = 
g¥vÆue
;

297 
gp_cou¡
++;

309 
	}
}

311 #i‡
deföed
(
POWERPC_DARWIN64
)

317 
	$d¨wö64_sˇn_°ru˘_f‹_Êﬂts
 (
ffi_ty≥
 *
s
, *
nÂr
)

319 
i
;

321 
	`FFI_ASSERT
 (
s
->
ty≥
 =
FFI_TYPE_STRUCT
)

323 
i
 = 0; 
s
->
ñemíts
[i] !
NULL
; i++)

325 
ffi_ty≥
 *
p
 = 
s
->
ñemíts
[
i
];

326 
p
->
ty≥
)

328 
FFI_TYPE_STRUCT
:

329 
	`d¨wö64_sˇn_°ru˘_f‹_Êﬂts
 (
p
, 
nÂr
);

331 
FFI_TYPE_LONGDOUBLE
:

332 (*
nÂr
) += 2;

334 
FFI_TYPE_DOUBLE
:

335 
FFI_TYPE_FLOAT
:

336 (*
nÂr
) += 1;

342 
	}
}

345 
	$d¨wö64_°ru˘_size_ex˚eds_g¥s_p
 (
ffi_ty≥
 *
s
, *
§c
, *
nÂr
)

347 
°ru˘_off£t
=0, 
i
;

349 
i
 = 0; 
s
->
ñemíts
[i] !
NULL
; i++)

351 *
ôem_ba£
;

352 
ffi_ty≥
 *
p
 = 
s
->
ñemíts
[
i
];

354 i‡(
i
 > 0)

355 
°ru˘_off£t
 = 
	`ALIGN
(°ru˘_off£t, 
p
->
Æignmít
);

357 
ôem_ba£
 = 
§c
 + 
°ru˘_off£t
;

359 
p
->
ty≥
)

361 
FFI_TYPE_STRUCT
:

362 i‡(
	`d¨wö64_°ru˘_size_ex˚eds_g¥s_p
 (
p
, 
ôem_ba£
, 
nÂr
))

365 
FFI_TYPE_LONGDOUBLE
:

366 i‡(*
nÂr
 >
NUM_FPR_ARG_REGISTERS
)

368 (*
nÂr
) += 1;

369 
ôem_ba£
 += 8;

371 
FFI_TYPE_DOUBLE
:

372 i‡(*
nÂr
 >
NUM_FPR_ARG_REGISTERS
)

374 (*
nÂr
) += 1;

376 
FFI_TYPE_FLOAT
:

377 i‡(*
nÂr
 >
NUM_FPR_ARG_REGISTERS
)

379 (*
nÂr
) += 1;

384 i‡(()
ôem_ba£
 >= 8*8)

389 
°ru˘_off£t
 +
p
->
size
;

392 
	}
}

396 
	$d¨wö64_°ru˘_ªt_by_vÆue_p
 (
ffi_ty≥
 *
s
)

398 
nÂ
 = 0;

400 
	`FFI_ASSERT
 (
s
 && s->
ty≥
 =
FFI_TYPE_STRUCT
);

403 i‡(
s
->
size
 > 168)

407 
	`d¨wö64_sˇn_°ru˘_f‹_Êﬂts
 (
s
, &
nÂ
);

408 i‡(
nÂ
 > 13)

413 i‡(
s
->
size
 <= 64)

417 
nÂ
 = 0;

418 i‡(
	`d¨wö64_°ru˘_size_ex˚eds_g¥s_p
 (
s
, 
NULL
, &
nÂ
))

422 
	}
}

425 
	$d¨wö64_∑ss_°ru˘_Êﬂts
 (
ffi_ty≥
 *
s
, *
§c
,

426 *
nÂr
, **
Ârs
)

428 
i
;

429 *
Âr_ba£
 = *
Ârs
;

430 
°ru˘_off£t
 = 0;

433 
i
 = 0; 
s
->
ñemíts
[i] !
NULL
; i++)

435 *
ôem_ba£
;

436 
ffi_ty≥
 *
p
 = 
s
->
ñemíts
[
i
];

438 i‡(
i
 > 0)

439 
°ru˘_off£t
 = 
	`ALIGN
(°ru˘_off£t, 
p
->
Æignmít
);

440 
ôem_ba£
 = 
§c
 + 
°ru˘_off£t
;

442 
p
->
ty≥
)

444 
FFI_TYPE_STRUCT
:

445 
	`d¨wö64_∑ss_°ru˘_Êﬂts
 (
p
, 
ôem_ba£
, 
nÂr
,

446 &
Âr_ba£
);

448 
FFI_TYPE_LONGDOUBLE
:

449 i‡(*
nÂr
 < 
NUM_FPR_ARG_REGISTERS
)

450 *
Âr_ba£
++ = *(*)
ôem_ba£
;

451 (*
nÂr
) += 1;

452 
ôem_ba£
 += 8;

454 
FFI_TYPE_DOUBLE
:

455 i‡(*
nÂr
 < 
NUM_FPR_ARG_REGISTERS
)

456 *
Âr_ba£
++ = *(*)
ôem_ba£
;

457 (*
nÂr
) += 1;

459 
FFI_TYPE_FLOAT
:

460 i‡(*
nÂr
 < 
NUM_FPR_ARG_REGISTERS
)

461 *
Âr_ba£
++ = (Ë*(*)
ôem_ba£
;

462 (*
nÂr
) += 1;

468 
°ru˘_off£t
 +
p
->
size
;

471 *
Ârs
 = 
Âr_ba£
;

472 
	}
}

477 
	$d¨wö64_∑ss_°ru˘_by_vÆue
 (
ffi_ty≥
 *
s
, *
§c
, 
size
,

478 *
nÂr
, **
Ârs
, **
¨g
)

480 *
√xt_¨g
 = *
¨g
;

481 *
de°_˝y
 = (*)
√xt_¨g
;

483 
	`FFI_ASSERT
 (
s
->
ty≥
 =
FFI_TYPE_STRUCT
)

485 i‡(!
size
)

489 i‡(
size
 < 3

490 || (
size
 == 4

491 && 
s
->
ñemíts
[0]

492 && 
s
->
ñemíts
[0]->
ty≥
 !
FFI_TYPE_FLOAT
))

496 *
√xt_¨g
 = 0UL;

497 
de°_˝y
 +8 - 
size
;

498 
	`mem˝y
 ((*Ë
de°_˝y
, 
§c
, 
size
);

499 
√xt_¨g
++;

501 i‡(
size
 == 16)

503 
	`mem˝y
 ((*Ë
de°_˝y
, 
§c
, 
size
);

504 
√xt_¨g
 += 2;

509 
	`mem˝y
 ((*Ë
de°_˝y
, 
§c
, 
size
);

510 
	`d¨wö64_∑ss_°ru˘_Êﬂts
 (
s
, 
§c
, 
nÂr
, 
Ârs
);

511 
√xt_¨g
 +(
size
+7)/8;

514 *
¨g
 = 
√xt_¨g
;

515 
	}
}

518 
	$d¨wö64_°ru˘_Êﬂts_to_mem
 (
ffi_ty≥
 *
s
, *
de°
, *
Ârs
, *
nf
)

520 
i
;

521 
°ru˘_off£t
 = 0;

524 
i
 = 0; 
s
->
ñemíts
[i] !
NULL
; i++)

526 *
ôem_ba£
;

527 
ffi_ty≥
 *
p
 = 
s
->
ñemíts
[
i
];

529 i‡(
i
 > 0)

530 
°ru˘_off£t
 = 
	`ALIGN
(°ru˘_off£t, 
p
->
Æignmít
);

531 
ôem_ba£
 = 
de°
 + 
°ru˘_off£t
;

533 
p
->
ty≥
)

535 
FFI_TYPE_STRUCT
:

536 
Ârs
 = 
	`d¨wö64_°ru˘_Êﬂts_to_mem
 (
p
, 
ôem_ba£
, f¥s, 
nf
);

538 
FFI_TYPE_LONGDOUBLE
:

539 i‡(*
nf
 < 
NUM_FPR_ARG_REGISTERS
)

541 *(*)
ôem_ba£
 = *
Ârs
++ ;

542 (*
nf
) += 1;

544 
ôem_ba£
 += 8;

546 
FFI_TYPE_DOUBLE
:

547 i‡(*
nf
 < 
NUM_FPR_ARG_REGISTERS
)

549 *(*)
ôem_ba£
 = *
Ârs
++ ;

550 (*
nf
) += 1;

553 
FFI_TYPE_FLOAT
:

554 i‡(*
nf
 < 
NUM_FPR_ARG_REGISTERS
)

556 *(*)
ôem_ba£
 = (Ë*
Ârs
++ ;

557 (*
nf
) += 1;

564 
°ru˘_off£t
 +
p
->
size
;

566  
Ârs
;

567 
	}
}

576 
	$d¨wö_adju°_aggªg©e_sizes
 (
ffi_ty≥
 *
s
)

578 
i
;

580 i‡(
s
->
ty≥
 !
FFI_TYPE_STRUCT
)

583 
s
->
size
 = 0;

584 
i
 = 0; 
s
->
ñemíts
[i] !
NULL
; i++)

586 
ffi_ty≥
 *
p
;

587 
Æign
;

589 
p
 = 
s
->
ñemíts
[
i
];

590 i‡(
p
->
ty≥
 =
FFI_TYPE_STRUCT
)

591 
	`d¨wö_adju°_aggªg©e_sizes
 (
p
);

592 #i‡
	`deföed
(
POWERPC_DARWIN64
)

594 
Æign
 = 
p
->
Æignmít
;

597 i‡(
i
 == 0)

598 
Æign
 = 
p
->
Æignmít
;

599 i‡(
p
->
Æignmít
 == 16 ||Ö->alignment < 4)

601 
Æign
 = 
p
->
Æignmít
;

604 
Æign
 = 4;

607 
s
->
size
 = 
	`ALIGN
(s->size, 
Æign
Ë+ 
p
->size;

610 
s
->
size
 = 
	`ALIGN
(s->size, s->
Æignmít
);

613 i‡(
s
->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_UINT64


614 || 
s
->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_SINT64


615 || 
s
->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_DOUBLE


616 || 
s
->
ñemíts
[0]->
Æignmít
 == 8)

617 
s
->
Æignmít
 = s->alignment > 8 ? s->alignment : 8;

619 
	}
}

625 
	$aix_adju°_aggªg©e_sizes
 (
ffi_ty≥
 *
s
)

627 
i
;

629 i‡(
s
->
ty≥
 !
FFI_TYPE_STRUCT
)

632 
s
->
size
 = 0;

633 
i
 = 0; 
s
->
ñemíts
[i] !
NULL
; i++)

635 
ffi_ty≥
 *
p
;

636 
Æign
;

638 
p
 = 
s
->
ñemíts
[
i
];

639 
	`aix_adju°_aggªg©e_sizes
 (
p
);

640 
Æign
 = 
p
->
Æignmít
;

641 i‡(
i
 !0 && 
p
->
ty≥
 =
FFI_TYPE_DOUBLE
)

642 
Æign
 = 4;

643 
s
->
size
 = 
	`ALIGN
(s->size, 
Æign
Ë+ 
p
->size;

646 
s
->
size
 = 
	`ALIGN
(s->size, s->
Æignmít
);

648 i‡(
s
->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_UINT64


649 || 
s
->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_SINT64


650 || 
s
->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_DOUBLE


651 || 
s
->
ñemíts
[0]->
Æignmít
 == 8)

652 
s
->
Æignmít
 = s->alignment > 8 ? s->alignment : 8;

654 
	}
}

657 
ffi_°©us


658 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

661 
i
;

662 
ffi_ty≥
 **
±r
;

663 
byãs
;

664 
Â¨g_cou¡
 = 0, 
öèrg_cou¡
 = 0;

665 
Êags
 = 0;

666 
size_Æ
 = 0;

672 i‡(
cif
->
abi
 =
FFI_DARWIN
)

674 
	`d¨wö_adju°_aggªg©e_sizes
 (
cif
->
πy≥
);

675 
i
 = 0; i < 
cif
->
«rgs
; i++)

676 
	`d¨wö_adju°_aggªg©e_sizes
 (
cif
->
¨g_ty≥s
[
i
]);

679 i‡(
cif
->
abi
 =
FFI_AIX
)

681 
	`aix_adju°_aggªg©e_sizes
 (
cif
->
πy≥
);

682 
i
 = 0; i < 
cif
->
«rgs
; i++)

683 
	`aix_adju°_aggªg©e_sizes
 (
cif
->
¨g_ty≥s
[
i
]);

689 
byãs
 = (
LINKAGE_AREA_GPRS
 + 
ASM_NEEDS_REGISTERS
) * ();

710 
cif
->
πy≥
->
ty≥
)

713 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


714 
FFI_TYPE_LONGDOUBLE
:

715 
Êags
 |
FLAG_RETURNS_128BITS
;

716 
Êags
 |
FLAG_RETURNS_FP
;

720 
FFI_TYPE_DOUBLE
:

721 
Êags
 |
FLAG_RETURNS_64BITS
;

723 
FFI_TYPE_FLOAT
:

724 
Êags
 |
FLAG_RETURNS_FP
;

727 
FFI_TYPE_UINT64
:

728 
FFI_TYPE_SINT64
:

729 #ifde‡
POWERPC64


730 
FFI_TYPE_POINTER
:

732 
Êags
 |
FLAG_RETURNS_64BITS
;

735 
FFI_TYPE_STRUCT
:

736 #i‡
	`deföed
(
POWERPC_DARWIN64
)

739 i‡(
	`d¨wö64_°ru˘_ªt_by_vÆue_p
 (
cif
->
πy≥
))

741 
nÂr
 = 0;

742 
Êags
 |
FLAG_RETURNS_STRUCT
;

743 i‡(
cif
->
πy≥
->
size
 != 16)

744 
	`d¨wö64_sˇn_°ru˘_f‹_Êﬂts
 (
cif
->
πy≥
, &
nÂr
) ;

746 
Êags
 |
FLAG_RETURNS_128BITS
;

748 i‡(
nÂr
)

749 
Êags
 |
FLAG_RETURNS_FP
;

753 
Êags
 |
FLAG_RETVAL_REFERENCE
;

754 
Êags
 |
FLAG_RETURNS_NOTHING
;

755 
öèrg_cou¡
++;

758 #ñi‡
	`deföed
(
DARWIN_PPC
)

759 i‡(
cif
->
πy≥
->
size
 <= 4)

760 
Êags
 |
FLAG_RETURNS_STRUCT
;

763 
Êags
 |
FLAG_RETVAL_REFERENCE
;

764 
Êags
 |
FLAG_RETURNS_NOTHING
;

765 
öèrg_cou¡
++;

768 
Êags
 |
FLAG_RETVAL_REFERENCE
;

769 
Êags
 |
FLAG_RETURNS_NOTHING
;

770 
öèrg_cou¡
++;

773 
FFI_TYPE_VOID
:

774 
Êags
 |
FLAG_RETURNS_NOTHING
;

788 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = cif->
«rgs
; i > 0; i--,Ötr++)

790 
Æign_w‹ds
;

791 (*
±r
)->
ty≥
)

793 
FFI_TYPE_FLOAT
:

794 
FFI_TYPE_DOUBLE
:

795 
Â¨g_cou¡
++;

796 #i‡!
	`deföed
(
POWERPC_DARWIN64
)

799 i‡(
Â¨g_cou¡
 > 
NUM_FPR_ARG_REGISTERS


800 && (
öèrg_cou¡
 & 0x01) != 0)

801 
öèrg_cou¡
++;

805 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


806 
FFI_TYPE_LONGDOUBLE
:

807 
Â¨g_cou¡
 += 2;

810 i‡(
Â¨g_cou¡
 >
NUM_FPR_ARG_REGISTERS
)

811 #i‡
	`deföed
 (
POWERPC64
)

812 
öèrg_cou¡
 = 
	`ALIGN
(intarg_count, 2);

814 
öèrg_cou¡
 = 
	`ALIGN
(intarg_count, 4);

819 
FFI_TYPE_UINT64
:

820 
FFI_TYPE_SINT64
:

821 #i‡
	`deföed
(
POWERPC64
)

822 
öèrg_cou¡
++;

828 i‡(
öèrg_cou¡
 =
NUM_GPR_ARG_REGISTERS
-1

829 || (
öèrg_cou¡
 >
NUM_GPR_ARG_REGISTERS


830 && (
öèrg_cou¡
 & 0x01) != 0))

831 
öèrg_cou¡
++;

832 
öèrg_cou¡
 += 2;

836 
FFI_TYPE_STRUCT
:

837 
size_Æ
 = (*
±r
)->
size
;

838 #i‡
	`deföed
(
POWERPC_DARWIN64
)

839 
Æign_w‹ds
 = (*
±r
)->
Æignmít
 >> 3;

840 i‡(
Æign_w‹ds
)

841 
öèrg_cou¡
 = 
	`ALIGN
(öèrg_cou¡, 
Æign_w‹ds
);

843 
öèrg_cou¡
 +(
size_Æ
 + 7) / 8;

845 i‡(
size_Æ
 != 16)

847 
	`d¨wö64_sˇn_°ru˘_f‹_Êﬂts
 (*
±r
, &
Â¨g_cou¡
) ;

849 
Æign_w‹ds
 = (*
±r
)->
Æignmít
 >> 2;

850 i‡(
Æign_w‹ds
)

851 
öèrg_cou¡
 = 
	`ALIGN
(öèrg_cou¡, 
Æign_w‹ds
);

856 #ifde‡
POWERPC64


857 
öèrg_cou¡
 +(
size_Æ
 + 7) / 8;

859 
öèrg_cou¡
 +(
size_Æ
 + 3) / 4;

867 
öèrg_cou¡
++;

872 i‡(
Â¨g_cou¡
 != 0)

873 
Êags
 |
FLAG_FP_ARGUMENTS
;

875 #i‡
	`deföed
(
POWERPC_DARWIN64
)

878 i‡(
Â¨g_cou¡
 != 0

879 || ((
Êags
 & 
FLAG_RETURNS_STRUCT
)

880 && (
Êags
 & 
FLAG_RETURNS_FP
)))

881 
byãs
 +
NUM_FPR_ARG_REGISTERS
 * ();

884 i‡(
Â¨g_cou¡
 != 0)

885 
byãs
 +
NUM_FPR_ARG_REGISTERS
 * ();

889 #ifde‡
POWERPC64


890 i‡((
öèrg_cou¡
 + 
Â¨g_cou¡
Ë> 
NUM_GPR_ARG_REGISTERS
)

891 
byãs
 +(
öèrg_cou¡
 + 
Â¨g_cou¡
) * ();

893 i‡((
öèrg_cou¡
 + 2 * 
Â¨g_cou¡
Ë> 
NUM_GPR_ARG_REGISTERS
)

894 
byãs
 +(
öèrg_cou¡
 + 2 * 
Â¨g_cou¡
) * ();

897 
byãs
 +
NUM_GPR_ARG_REGISTERS
 * ();

900 
byãs
 = 
	`ALIGN
(bytes, 16) ;

902 
cif
->
Êags
 = flags;

903 
cif
->
byãs
 = bytes;

905  
FFI_OK
;

906 
	}
}

908 
ffi_ˇŒ_AIX
(
exãnded_cif
 *, , , *,

909 (*
‚
)(), (*
‚2
)());

911 
	`ffi_ˇŒ_DARWIN
(
exãnded_cif
 *, , , *,

912 (*
‚
)(), (*
‚2
)(), 
ffi_ty≥
*);

915 
	`ffi_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

917 
exãnded_cif
 
ecif
;

919 
ecif
.
cif
 = cif;

920 
ecif
.
avÆue
 =ávalue;

925 i‡((
rvÆue
 =
NULL
) &&

926 (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

928 
ecif
.
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

931 
ecif
.
rvÆue
 =Ñvalue;

933 
cif
->
abi
)

935 
FFI_AIX
:

936 
	`ffi_ˇŒ_AIX
(&
ecif
, -()
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
, 
‚
,

937 
	`FFI_FN
(
ffi_¥ï_¨gs
));

939 
FFI_DARWIN
:

940 
	`ffi_ˇŒ_DARWIN
(&
ecif
, -()
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
, 
‚
,

941 
	`FFI_FN
(
ffi_¥ï_¨gs
), 
cif
->
πy≥
);

944 
	`FFI_ASSERT
(0);

947 
	}
}

949 
Êush_iˇche
(*);

950 
Êush_ønge
(*, );

955 
	saix_fd_°ru˘
 {

956 *
	mcode_poöãr
;

957 *
	mtoc
;

958 } 
	taix_fd
;

1003 
ffi_°©us


1004 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

1005 
ffi_cif
* 
cif
,

1006 (*
fun
)(
ffi_cif
*, *, **, *),

1007 *
u£r_d©a
,

1008 *
codñoc
)

1010 *
åamp
;

1011 
ffi_aix_åampﬁöe_°ru˘
 *
åamp_aix
;

1012 
aix_fd
 *
fd
;

1014 
cif
->
abi
)

1016 
FFI_DARWIN
:

1018 
	`FFI_ASSERT
 (
cif
->
abi
 =
FFI_DARWIN
);

1020 
åamp
 = (*Ë&
˛osuª
->tramp[0];

1021 #i‡
	`deföed
(
POWERPC_DARWIN64
)

1022 
åamp
[0] = 0x7c0802a6;

1023 
åamp
[1] = 0x429f0015;

1025 
åamp
[6] = 0x7d6802a6;

1026 
åamp
[7] = 0xe98b0000;

1027 
åamp
[8] = 0x7c0803a6;

1028 
åamp
[9] = 0x7d8903a6;

1029 
åamp
[10] = 0xe96b0008;

1030 
åamp
[11] = 0x4e800420;

1032 *((*)&
åamp
[2]Ë(Ë
ffi_˛osuª_ASM
;

1033 *((*)&
åamp
[4]Ë(Ë
codñoc
;

1035 
åamp
[0] = 0x7c0802a6;

1036 
åamp
[1] = 0x429f000d;

1037 
åamp
[4] = 0x7d6802a6;

1038 
åamp
[5] = 0x818b0000;

1039 
åamp
[6] = 0x7c0803a6;

1040 
åamp
[7] = 0x7d8903a6;

1041 
åamp
[8] = 0x816b0004;

1042 
åamp
[9] = 0x4e800420;

1043 
åamp
[2] = (Ë
ffi_˛osuª_ASM
;

1044 
åamp
[3] = (Ë
codñoc
;

1046 
˛osuª
->
cif
 = cif;

1047 
˛osuª
->
fun
 = fun;

1048 
˛osuª
->
u£r_d©a
 = user_data;

1051 
	`Êush_ønge
(
codñoc
, 
FFI_TRAMPOLINE_SIZE
);

1055 
FFI_AIX
:

1057 
åamp_aix
 = (
ffi_aix_åampﬁöe_°ru˘
 *Ë(
˛osuª
->
åamp
);

1058 
fd
 = (
aix_fd
 *)(*)
ffi_˛osuª_ASM
;

1060 
	`FFI_ASSERT
 (
cif
->
abi
 =
FFI_AIX
);

1062 
åamp_aix
->
code_poöãr
 = 
fd
->code_pointer;

1063 
åamp_aix
->
toc
 = 
fd
->toc;

1064 
åamp_aix
->
°©ic_chaö
 = 
codñoc
;

1065 
˛osuª
->
cif
 = cif;

1066 
˛osuª
->
fun
 = fun;

1067 
˛osuª
->
u£r_d©a
 = user_data;

1071  
FFI_BAD_ABI
;

1074  
FFI_OK
;

1075 
	}
}

1078 
	$Êush_iˇche
(*
addr
)

1080 #i‚de‡
_AIX


1081 
__asm__
 volatile (

1087 : : "r"(
addr
) : "memory");

1089 
	}
}

1092 
	$Êush_ønge
(* 
addr1
, 
size
)

1094 
	#MIN_LINE_SIZE
 32

	)

1095 
i
;

1096 
i
 = 0; i < 
size
; i +
MIN_LINE_SIZE
)

1097 
	`Êush_iˇche
(
addr1
+
i
);

1098 
	`Êush_iˇche
(
addr1
+
size
-1);

1099 
	}
}

1103 
	mf
;

1104 
	md
;

1105 } 
	tffi_dblÊ
;

1107 
ffi_ty≥
 *

1108 
ffi_˛osuª_hñ≥r_DARWIN
 (
ffi_˛osuª
 *, *,

1109 *, 
ffi_dblÊ
 *);

1118 
ffi_ty≥
 *

1119 
	$ffi_˛osuª_hñ≥r_DARWIN
 (
ffi_˛osuª
 *
˛osuª
, *
rvÆue
,

1120 *
pgr
, 
ffi_dblÊ
 *
p‰
)

1126 
	tldbôs
[2];

1128 
	uldu


1130 
ldbôs
 
lb
;

1131 
ld
;

1134 ** 
avÆue
;

1135 
ffi_ty≥
 ** 
¨g_ty≥s
;

1136 
i
, 
avn
;

1137 
ffi_cif
 * 
cif
;

1138 
ffi_dblÊ
 * 
íd_p‰
 = 
p‰
 + 
NUM_FPR_ARG_REGISTERS
;

1139 
size_Æ
;

1140 #i‡
	`deföed
(
POWERPC_DARWIN64
)

1141 
Âsu£d
 = 0;

1144 
cif
 = 
˛osuª
->cif;

1145 
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 * (*));

1147 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

1149 #i‡
	`deföed
(
POWERPC_DARWIN64
)

1150 i‡(!
	`d¨wö64_°ru˘_ªt_by_vÆue_p
 (
cif
->
πy≥
))

1153 
rvÆue
 = (*Ë*
pgr
;

1154 
pgr
++;

1156 #ñi‡
	`deföed
(
DARWIN_PPC
)

1157 i‡(
cif
->
πy≥
->
size
 > 4)

1159 
rvÆue
 = (*Ë*
pgr
;

1160 
pgr
++;

1163 
rvÆue
 = (*Ë*
pgr
;

1164 
pgr
++;

1168 
i
 = 0;

1169 
avn
 = 
cif
->
«rgs
;

1170 
¨g_ty≥s
 = 
cif
->arg_types;

1173 
i
 < 
avn
)

1175 
¨g_ty≥s
[
i
]->
ty≥
)

1177 
FFI_TYPE_SINT8
:

1178 
FFI_TYPE_UINT8
:

1179 #i‡ 
	`deföed
(
POWERPC64
)

1180 
avÆue
[
i
] = (*Ë
pgr
 + 7;

1182 
avÆue
[
i
] = (*Ë
pgr
 + 3;

1184 
pgr
++;

1187 
FFI_TYPE_SINT16
:

1188 
FFI_TYPE_UINT16
:

1189 #i‡ 
	`deföed
(
POWERPC64
)

1190 
avÆue
[
i
] = (*Ë
pgr
 + 6;

1192 
avÆue
[
i
] = (*Ë
pgr
 + 2;

1194 
pgr
++;

1197 
FFI_TYPE_SINT32
:

1198 
FFI_TYPE_UINT32
:

1199 #i‡ 
	`deföed
(
POWERPC64
)

1200 
avÆue
[
i
] = (*Ë
pgr
 + 4;

1202 
FFI_TYPE_POINTER
:

1203 
avÆue
[
i
] = 
pgr
;

1205 
pgr
++;

1208 
FFI_TYPE_STRUCT
:

1209 
size_Æ
 = 
¨g_ty≥s
[
i
]->
size
;

1210 #i‡
	`deföed
(
POWERPC_DARWIN64
)

1211 
pgr
 = (*)
	`ALIGN
((*Ìgr, 
¨g_ty≥s
[
i
]->
Æignmít
);

1212 i‡(
size_Æ
 < 3 || size_al == 4)

1214 
avÆue
[
i
] = ((*)
pgr
)+8-
size_Æ
;

1215 i‡(
¨g_ty≥s
[
i
]->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_FLOAT


1216 && 
Âsu£d
 < 
NUM_FPR_ARG_REGISTERS
)

1218 *(*)
pgr
 = (Ë*(*)
p‰
;

1219 
p‰
++;

1220 
Âsu£d
++;

1225 i‡(
size_Æ
 != 16)

1226 
p‰
 = (
ffi_dblÊ
 *)

1227 
	`d¨wö64_°ru˘_Êﬂts_to_mem
 (
¨g_ty≥s
[
i
], (*)
pgr
,

1228 (*)
p‰
, &
Âsu£d
);

1229 
avÆue
[
i
] = 
pgr
;

1231 
pgr
 +(
size_Æ
 + 7) / 8;

1235 i‡(
¨g_ty≥s
[
i
]->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_DOUBLE
)

1236 
size_Æ
 = 
	`ALIGN
(
¨g_ty≥s
[
i
]->
size
, 8);

1237 #i‡
	`deföed
(
POWERPC64
)

1238 
	`FFI_ASSERT
 (
cif
->
abi
 !
FFI_DARWIN
);

1239 
avÆue
[
i
] = 
pgr
;

1240 
pgr
 +(
size_Æ
 + 7) / 8;

1244 i‡(
size_Æ
 < 3 && 
cif
->
abi
 =
FFI_DARWIN
)

1245 
avÆue
[
i
] = (*Ë
pgr
 + 4 - 
size_Æ
;

1247 
avÆue
[
i
] = 
pgr
;

1248 
pgr
 +(
size_Æ
 + 3) / 4;

1253 
FFI_TYPE_SINT64
:

1254 
FFI_TYPE_UINT64
:

1255 #i‡ 
	`deföed
(
POWERPC64
)

1256 
FFI_TYPE_POINTER
:

1257 
avÆue
[
i
] = 
pgr
;

1258 
pgr
++;

1262 
avÆue
[
i
] = 
pgr
;

1263 
pgr
 += 2;

1267 
FFI_TYPE_FLOAT
:

1270 i‡(
p‰
 < 
íd_p‰
)

1272 
ãmp
 = 
p‰
->
d
;

1273 
p‰
->
f
 = (Ë
ãmp
;

1274 
avÆue
[
i
] = 
p‰
;

1275 
p‰
++;

1279 
avÆue
[
i
] = 
pgr
;

1281 
pgr
++;

1284 
FFI_TYPE_DOUBLE
:

1287 i‡(
p‰
 < 
íd_p‰
)

1289 
avÆue
[
i
] = 
p‰
;

1290 
p‰
++;

1294 
avÆue
[
i
] = 
pgr
;

1296 #ifde‡
POWERPC64


1297 
pgr
++;

1299 
pgr
 += 2;

1303 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


1305 
FFI_TYPE_LONGDOUBLE
:

1306 #ifde‡
POWERPC64


1307 i‡(
p‰
 + 1 < 
íd_p‰
)

1309 
avÆue
[
i
] = 
p‰
;

1310 
p‰
 += 2;

1314 i‡(
p‰
 < 
íd_p‰
)

1316 *
pgr
 = *(*Ë
p‰
;

1317 
p‰
++;

1319 
avÆue
[
i
] = 
pgr
;

1321 
pgr
 += 2;

1325 i‡(
p‰
 + 1 < 
íd_p‰
)

1327 
avÆue
[
i
] = 
p‰
;

1328 
p‰
 += 2;

1333 i‡(
p‰
 + 1 =
íd_p‰
)

1335 
ldu
 
ãmp_ld
;

1336 
	`mem˝y
 (&
ãmp_ld
.
lb
[0], 
p‰
, (
ldbôs
));

1337 
	`mem˝y
 (&
ãmp_ld
.
lb
[1], 
pgr
 + 2, (
ldbôs
));

1338 
avÆue
[
i
] = &
ãmp_ld
.
ld
;

1339 
p‰
++;

1343 
avÆue
[
i
] = 
pgr
;

1345 
pgr
 += 4;

1350 
	`FFI_ASSERT
(0);

1352 
i
++;

1355 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

1358  
cif
->
πy≥
;

1359 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi_linux64.c

31 
	~"ffi.h
"

33 #ifde‡
POWERPC64


34 
	~"ffi_comm⁄.h
"

35 
	~"ffi_powîpc.h
"

40 
	mNUM_GPR_ARG_REGISTERS64
 = 8,

41 
	mNUM_FPR_ARG_REGISTERS64
 = 13

43 íum { 
	mASM_NEEDS_REGISTERS64
 = 4 };

46 #i‡
HAVE_LONG_DOUBLE_VARIANT
 && 
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


48 
FFI_HIDDEN


49 
	$ffi_¥ï_ty≥s_löux64
 (
ffi_abi
 
abi
)

51 i‡((
abi
 & (
FFI_LINUX
 | 
FFI_LINUX_LONG_DOUBLE_128
)) == FFI_LINUX)

53 
ffi_ty≥_l⁄gdoubÀ
.
size
 = 8;

54 
ffi_ty≥_l⁄gdoubÀ
.
Æignmít
 = 8;

58 
ffi_ty≥_l⁄gdoubÀ
.
size
 = 16;

59 
ffi_ty≥_l⁄gdoubÀ
.
Æignmít
 = 16;

61 
	}
}

65 #i‡
_CALL_ELF
 == 2

67 
	$discovî_homogíeous_aggªg©e
 (c⁄° 
ffi_ty≥
 *
t
, *
ñnum
)

69 
t
->
ty≥
)

71 
FFI_TYPE_FLOAT
:

72 
FFI_TYPE_DOUBLE
:

73 *
ñnum
 = 1;

74  (Ë
t
->
ty≥
;

76 
FFI_TYPE_STRUCT
:;

78 
ba£_ñt
 = 0, 
tŸÆ_ñnum
 = 0;

79 
ffi_ty≥
 **
ñ
 = 
t
->
ñemíts
;

80 *
ñ
)

82 
ñ_ñt
, 
ñ_ñnum
 = 0;

83 
ñ_ñt
 = 
	`discovî_homogíeous_aggªg©e
 (*
ñ
, &
ñ_ñnum
);

84 i‡(
ñ_ñt
 == 0

85 || (
ba£_ñt
 && ba£_ñà!
ñ_ñt
))

87 
ba£_ñt
 = 
ñ_ñt
;

88 
tŸÆ_ñnum
 +
ñ_ñnum
;

89 i‡(
tŸÆ_ñnum
 > 8)

91 
ñ
++;

93 *
ñnum
 = 
tŸÆ_ñnum
;

94  
ba£_ñt
;

100 
	}
}

105 
ffi_°©us


106 
	$ffi_¥ï_cif_löux64_c‹e
 (
ffi_cif
 *
cif
)

108 
ffi_ty≥
 **
±r
;

109 
byãs
;

110 
i
, 
Â¨g_cou¡
 = 0, 
öèrg_cou¡
 = 0;

111 
Êags
 = 
cif
->flags;

112 #i‡
_CALL_ELF
 == 2

113 
ñt
, 
ñnum
;

116 #i‡
FFI_TYPE_LONGDOUBLE
 =
FFI_TYPE_DOUBLE


118 i‡((
cif
->
abi
 & 
FFI_LINUX_LONG_DOUBLE_128
) != 0)

119  
FFI_BAD_ABI
;

124 #i‡
_CALL_ELF
 == 2

126 
byãs
 = (4 + 
ASM_NEEDS_REGISTERS64
) *  ();

129 
byãs
 +
NUM_GPR_ARG_REGISTERS64
 *  ();

133 
byãs
 = (6 + 
ASM_NEEDS_REGISTERS64
) *  ();

136 
byãs
 +2 * 
NUM_GPR_ARG_REGISTERS64
 *  ();

140 
cif
->
πy≥
->
ty≥
)

142 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


143 
FFI_TYPE_LONGDOUBLE
:

144 i‡((
cif
->
abi
 & 
FFI_LINUX_LONG_DOUBLE_128
) != 0)

145 
Êags
 |
FLAG_RETURNS_128BITS
;

148 
FFI_TYPE_DOUBLE
:

149 
Êags
 |
FLAG_RETURNS_64BITS
;

151 
FFI_TYPE_FLOAT
:

152 
Êags
 |
FLAG_RETURNS_FP
;

155 
FFI_TYPE_UINT128
:

156 
Êags
 |
FLAG_RETURNS_128BITS
;

158 
FFI_TYPE_UINT64
:

159 
FFI_TYPE_SINT64
:

160 
Êags
 |
FLAG_RETURNS_64BITS
;

163 
FFI_TYPE_STRUCT
:

164 #i‡
_CALL_ELF
 == 2

165 
ñt
 = 
	`discovî_homogíeous_aggªg©e
 (
cif
->
πy≥
, &
ñnum
);

166 i‡(
ñt
)

168 i‡(
ñt
 =
FFI_TYPE_DOUBLE
)

169 
Êags
 |
FLAG_RETURNS_64BITS
;

170 
Êags
 |
FLAG_RETURNS_FP
 | 
FLAG_RETURNS_SMST
;

173 i‡(
cif
->
πy≥
->
size
 <= 16)

175 
Êags
 |
FLAG_RETURNS_SMST
;

179 
öèrg_cou¡
++;

180 
Êags
 |
FLAG_RETVAL_REFERENCE
;

182 
FFI_TYPE_VOID
:

183 
Êags
 |
FLAG_RETURNS_NOTHING
;

191 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = cif->
«rgs
; i > 0; i--,Ötr++)

193 
Æign
;

195 (*
±r
)->
ty≥
)

197 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


198 
FFI_TYPE_LONGDOUBLE
:

199 i‡((
cif
->
abi
 & 
FFI_LINUX_LONG_DOUBLE_128
) != 0)

201 
Â¨g_cou¡
++;

202 
öèrg_cou¡
++;

206 
FFI_TYPE_DOUBLE
:

207 
FFI_TYPE_FLOAT
:

208 
Â¨g_cou¡
++;

209 
öèrg_cou¡
++;

210 i‡(
Â¨g_cou¡
 > 
NUM_FPR_ARG_REGISTERS64
)

211 
Êags
 |
FLAG_ARG_NEEDS_PSAVE
;

214 
FFI_TYPE_STRUCT
:

215 i‡((
cif
->
abi
 & 
FFI_LINUX_STRUCT_ALIGN
) != 0)

217 
Æign
 = (*
±r
)->
Æignmít
;

218 i‡(
Æign
 > 16)

219 
Æign
 = 16;

220 
Æign
 =álign / 8;

221 i‡(
Æign
 > 1)

222 
öèrg_cou¡
 = 
	`ALIGN
 (öèrg_cou¡, 
Æign
);

224 
öèrg_cou¡
 +((*
±r
)->
size
 + 7) / 8;

225 #i‡
_CALL_ELF
 == 2

226 
ñt
 = 
	`discovî_homogíeous_aggªg©e
 (*
±r
, &
ñnum
);

227 i‡(
ñt
)

229 
Â¨g_cou¡
 +
ñnum
;

230 i‡(
Â¨g_cou¡
 > 
NUM_FPR_ARG_REGISTERS64
)

231 
Êags
 |
FLAG_ARG_NEEDS_PSAVE
;

236 i‡(
öèrg_cou¡
 > 
NUM_GPR_ARG_REGISTERS64
)

237 
Êags
 |
FLAG_ARG_NEEDS_PSAVE
;

241 
FFI_TYPE_POINTER
:

242 
FFI_TYPE_UINT64
:

243 
FFI_TYPE_SINT64
:

244 
FFI_TYPE_INT
:

245 
FFI_TYPE_UINT32
:

246 
FFI_TYPE_SINT32
:

247 
FFI_TYPE_UINT16
:

248 
FFI_TYPE_SINT16
:

249 
FFI_TYPE_UINT8
:

250 
FFI_TYPE_SINT8
:

253 
öèrg_cou¡
++;

254 i‡(
öèrg_cou¡
 > 
NUM_GPR_ARG_REGISTERS64
)

255 
Êags
 |
FLAG_ARG_NEEDS_PSAVE
;

258 
	`FFI_ASSERT
 (0);

262 i‡(
Â¨g_cou¡
 != 0)

263 
Êags
 |
FLAG_FP_ARGUMENTS
;

264 i‡(
öèrg_cou¡
 > 4)

265 
Êags
 |
FLAG_4_GPR_ARGUMENTS
;

268 i‡(
Â¨g_cou¡
 != 0)

269 
byãs
 +
NUM_FPR_ARG_REGISTERS64
 *  ();

272 #i‡
_CALL_ELF
 == 2

273 i‡((
Êags
 & 
FLAG_ARG_NEEDS_PSAVE
) != 0)

274 
byãs
 +
öèrg_cou¡
 *  ();

276 i‡(
öèrg_cou¡
 > 
NUM_GPR_ARG_REGISTERS64
)

277 
byãs
 +(
öèrg_cou¡
 - 
NUM_GPR_ARG_REGISTERS64
) *  ();

281 
byãs
 = (bytes + 15) & ~0xF;

283 
cif
->
Êags
 = flags;

284 
cif
->
byãs
 = bytes;

286  
FFI_OK
;

287 
	}
}

289 
ffi_°©us
 
FFI_HIDDEN


290 
	$ffi_¥ï_cif_löux64
 (
ffi_cif
 *
cif
)

292 i‡((
cif
->
abi
 & 
FFI_LINUX
) != 0)

293 
cif
->
nfixed¨gs
 = cif->
«rgs
;

294 #i‡
_CALL_ELF
 != 2

295 i‡(
cif
->
abi
 =
FFI_COMPAT_LINUX64
)

299 
cif
->
Êags
 |
FLAG_COMPAT
;

301 
cif
->
abi
 = 
FFI_LINUX
 | 
FFI_LINUX_LONG_DOUBLE_128
;

305  
FFI_BAD_ABI
;

306  
	`ffi_¥ï_cif_löux64_c‹e
 (
cif
);

307 
	}
}

309 
ffi_°©us
 
FFI_HIDDEN


310 
	$ffi_¥ï_cif_löux64_v¨
 (
ffi_cif
 *
cif
,

311 
nfixed¨gs
,

312 
¡ŸÆ¨gs
 
MAYBE_UNUSED
)

314 i‡((
cif
->
abi
 & 
FFI_LINUX
) != 0)

315 
cif
->
nfixed¨gs
 =Çfixedargs;

316 #i‡
_CALL_ELF
 != 2

317 i‡(
cif
->
abi
 =
FFI_COMPAT_LINUX64
)

321 
cif
->
Êags
 |
FLAG_COMPAT
;

323 
cif
->
abi
 = 
FFI_LINUX
 | 
FFI_LINUX_LONG_DOUBLE_128
;

327  
FFI_BAD_ABI
;

328 #i‡
_CALL_ELF
 == 2

329 
cif
->
Êags
 |
FLAG_ARG_NEEDS_PSAVE
;

331  
	`ffi_¥ï_cif_löux64_c‹e
 (
cif
);

332 
	}
}

369 
FFI_HIDDEN


370 
	$ffi_¥ï_¨gs64
 (
exãnded_cif
 *
ecif
, *c⁄° 
°ack
)

372 c⁄° 
byãs
 = 
ecif
->
cif
->bytes;

373 c⁄° 
Êags
 = 
ecif
->
cif
->flags;

377 *
c
;

378 *
ul
;

379 *
f
;

380 *
d
;

381 
size_t
 
p
;

382 } 
	tvÆp
;

385 
vÆp
 
°ackt›
;

389 
vÆp
 
g¥_ba£
;

390 
vÆp
 
g¥_íd
;

391 
vÆp
 
ª°
;

392 
vÆp
 
√xt_¨g
;

396 
vÆp
 
Âr_ba£
;

397 
Â¨g_cou¡
;

399 
i
, 
w‹ds
, 
«rgs
, 
nfixed¨gs
;

400 
ffi_ty≥
 **
±r
;

401 
doubÀ_tmp
;

404 **
v
;

405 **
c
;

406 sig√d **
sc
;

407 **
uc
;

408 sig√d **
ss
;

409 **
us
;

410 sig√d **
si
;

411 **
ui
;

412 **
ul
;

413 **
f
;

414 **
d
;

415 } 
p_¨gv
;

416 
g¥vÆue
;

417 
Æign
;

419 
°ackt›
.
c
 = (*Ë
°ack
 + 
byãs
;

420 
g¥_ba£
.
ul
 = 
°ackt›
.u»- 
ASM_NEEDS_REGISTERS64
 - 
NUM_GPR_ARG_REGISTERS64
;

421 
g¥_íd
.
ul
 = 
g¥_ba£
.u»+ 
NUM_GPR_ARG_REGISTERS64
;

422 #i‡
_CALL_ELF
 == 2

423 
ª°
.
ul
 = 
°ack
 + 4 + 
NUM_GPR_ARG_REGISTERS64
;

425 
ª°
.
ul
 = 
°ack
 + 6 + 
NUM_GPR_ARG_REGISTERS64
;

427 
Âr_ba£
.
d
 = 
g¥_ba£
.d - 
NUM_FPR_ARG_REGISTERS64
;

428 
Â¨g_cou¡
 = 0;

429 
√xt_¨g
.
ul
 = 
g¥_ba£
.ul;

432 
	`FFI_ASSERT
 (((Ë(*Ë
°ack
 & 0xF) == 0);

433 
	`FFI_ASSERT
 (((Ë
°ackt›
.
c
 & 0xF) == 0);

434 
	`FFI_ASSERT
 ((
byãs
 & 0xF) == 0);

437 i‡(
Êags
 & 
FLAG_RETVAL_REFERENCE
)

438 *
√xt_¨g
.
ul
++ = (Ë(*Ë
ecif
->
rvÆue
;

441 
p_¨gv
.
v
 = 
ecif
->
avÆue
;

442 
«rgs
 = 
ecif
->
cif
->nargs;

443 #i‡
_CALL_ELF
 != 2

444 
nfixed¨gs
 = () -1;

445 i‡((
Êags
 & 
FLAG_COMPAT
) == 0)

447 
nfixed¨gs
 = 
ecif
->
cif
->nfixedargs;

448 
±r
 = 
ecif
->
cif
->
¨g_ty≥s
, 
i
 = 0;

449 
i
 < 
«rgs
;

450 
i
++, 
±r
++, 
p_¨gv
.
v
++)

452 #i‡
_CALL_ELF
 == 2

453 
ñt
, 
ñnum
;

456 (*
±r
)->
ty≥
)

458 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


459 
FFI_TYPE_LONGDOUBLE
:

460 i‡((
ecif
->
cif
->
abi
 & 
FFI_LINUX_LONG_DOUBLE_128
) != 0)

462 
doubÀ_tmp
 = (*
p_¨gv
.
d
)[0];

463 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS64
 && 
i
 < 
nfixed¨gs
)

465 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

466 #i‡
_CALL_ELF
 != 2

467 i‡((
Êags
 & 
FLAG_COMPAT
) != 0)

468 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

472 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

473 i‡(++
√xt_¨g
.
ul
 =
g¥_íd
.ul)

474 
√xt_¨g
.
ul
 = 
ª°
.ul;

475 
Â¨g_cou¡
++;

476 
doubÀ_tmp
 = (*
p_¨gv
.
d
)[1];

477 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS64
 && 
i
 < 
nfixed¨gs
)

479 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

480 #i‡
_CALL_ELF
 != 2

481 i‡((
Êags
 & 
FLAG_COMPAT
) != 0)

482 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

486 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

487 i‡(++
√xt_¨g
.
ul
 =
g¥_íd
.ul)

488 
√xt_¨g
.
ul
 = 
ª°
.ul;

489 
Â¨g_cou¡
++;

490 
	`FFI_ASSERT
 (
__LDBL_MANT_DIG__
 == 106);

491 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_FP_ARGUMENTS
);

496 
FFI_TYPE_DOUBLE
:

497 
doubÀ_tmp
 = **
p_¨gv
.
d
;

498 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS64
 && 
i
 < 
nfixed¨gs
)

500 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

501 #i‡
_CALL_ELF
 != 2

502 i‡((
Êags
 & 
FLAG_COMPAT
) != 0)

503 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

507 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

508 i‡(++
√xt_¨g
.
ul
 =
g¥_íd
.ul)

509 
√xt_¨g
.
ul
 = 
ª°
.ul;

510 
Â¨g_cou¡
++;

511 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_FP_ARGUMENTS
);

514 
FFI_TYPE_FLOAT
:

515 
doubÀ_tmp
 = **
p_¨gv
.
f
;

516 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS64
 && 
i
 < 
nfixed¨gs
)

518 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

519 #i‡
_CALL_ELF
 != 2

520 i‡((
Êags
 & 
FLAG_COMPAT
) != 0)

521 *
√xt_¨g
.
f
 = (Ë
doubÀ_tmp
;

525 *
√xt_¨g
.
f
 = (Ë
doubÀ_tmp
;

526 i‡(++
√xt_¨g
.
ul
 =
g¥_íd
.ul)

527 
√xt_¨g
.
ul
 = 
ª°
.ul;

528 
Â¨g_cou¡
++;

529 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_FP_ARGUMENTS
);

532 
FFI_TYPE_STRUCT
:

533 i‡((
ecif
->
cif
->
abi
 & 
FFI_LINUX_STRUCT_ALIGN
) != 0)

535 
Æign
 = (*
±r
)->
Æignmít
;

536 i‡(
Æign
 > 16)

537 
Æign
 = 16;

538 i‡(
Æign
 > 1)

539 
√xt_¨g
.
p
 = 
	`ALIGN
 (√xt_¨g.p, 
Æign
);

541 #i‡
_CALL_ELF
 == 2

542 
ñt
 = 
	`discovî_homogíeous_aggªg©e
 (*
±r
, &
ñnum
);

543 i‡(
ñt
)

546 *
v
;

547 *
f
;

548 *
d
;

549 } 
¨g
;

551 
¨g
.
v
 = *
p_¨gv
.v;

552 i‡(
ñt
 =
FFI_TYPE_FLOAT
)

556 
doubÀ_tmp
 = *
¨g
.
f
++;

557 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS64


558 && 
i
 < 
nfixed¨gs
)

559 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

561 *
√xt_¨g
.
f
 = (Ë
doubÀ_tmp
;

562 i‡(++
√xt_¨g
.
f
 =
g¥_íd
.f)

563 
√xt_¨g
.
f
 = 
ª°
.f;

564 
Â¨g_cou¡
++;

566 --
ñnum
 != 0);

567 i‡((
√xt_¨g
.
p
 & 3) != 0)

569 i‡(++
√xt_¨g
.
f
 =
g¥_íd
.f)

570 
√xt_¨g
.
f
 = 
ª°
.f;

576 
doubÀ_tmp
 = *
¨g
.
d
++;

577 i‡(
Â¨g_cou¡
 < 
NUM_FPR_ARG_REGISTERS64
 && 
i
 < 
nfixed¨gs
)

578 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

580 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

581 i‡(++
√xt_¨g
.
d
 =
g¥_íd
.d)

582 
√xt_¨g
.
d
 = 
ª°
.d;

583 
Â¨g_cou¡
++;

585 --
ñnum
 != 0);

590 
w‹ds
 = ((*
±r
)->
size
 + 7) / 8;

591 i‡(
√xt_¨g
.
ul
 >
g¥_ba£
.u»&&Çext_¨g.u»+ 
w‹ds
 > 
g¥_íd
.ul)

593 
size_t
 
fú°
 = 
g¥_íd
.
c
 - 
√xt_¨g
.c;

594 
	`mem˝y
 (
√xt_¨g
.
c
, *
p_¨gv
.c, 
fú°
);

595 
	`mem˝y
 (
ª°
.
c
, *
p_¨gv
.¯+ 
fú°
, (*
±r
)->
size
 - first);

596 
√xt_¨g
.
c
 = 
ª°
.¯+ 
w‹ds
 * 8 - 
fú°
;

600 *
whîe
 = 
√xt_¨g
.
c
;

602 #i‚de‡
__LITTLE_ENDIAN__


605 i‡((*
±r
)->
size
 < 8)

606 
whîe
 +8 - (*
±r
)->
size
;

608 
	`mem˝y
 (
whîe
, *
p_¨gv
.
c
, (*
±r
)->
size
);

609 
√xt_¨g
.
ul
 +
w‹ds
;

610 i‡(
√xt_¨g
.
ul
 =
g¥_íd
.ul)

611 
√xt_¨g
.
ul
 = 
ª°
.ul;

616 
FFI_TYPE_UINT8
:

617 
g¥vÆue
 = **
p_¨gv
.
uc
;

618 
putg¥
;

619 
FFI_TYPE_SINT8
:

620 
g¥vÆue
 = **
p_¨gv
.
sc
;

621 
putg¥
;

622 
FFI_TYPE_UINT16
:

623 
g¥vÆue
 = **
p_¨gv
.
us
;

624 
putg¥
;

625 
FFI_TYPE_SINT16
:

626 
g¥vÆue
 = **
p_¨gv
.
ss
;

627 
putg¥
;

628 
FFI_TYPE_UINT32
:

629 
g¥vÆue
 = **
p_¨gv
.
ui
;

630 
putg¥
;

631 
FFI_TYPE_INT
:

632 
FFI_TYPE_SINT32
:

633 
g¥vÆue
 = **
p_¨gv
.
si
;

634 
putg¥
;

636 
FFI_TYPE_UINT64
:

637 
FFI_TYPE_SINT64
:

638 
FFI_TYPE_POINTER
:

639 
g¥vÆue
 = **
p_¨gv
.
ul
;

640 
putg¥
:

641 *
√xt_¨g
.
ul
++ = 
g¥vÆue
;

642 i‡(
√xt_¨g
.
ul
 =
g¥_íd
.ul)

643 
√xt_¨g
.
ul
 = 
ª°
.ul;

648 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_4_GPR_ARGUMENTS


649 || (
√xt_¨g
.
ul
 >
g¥_ba£
.ul

650 && 
√xt_¨g
.
ul
 <
g¥_ba£
.ul + 4));

651 
	}
}

654 #i‡
_CALL_ELF
 == 2

655 
	#MIN_CACHE_LINE_SIZE
 8

	)

658 
	$Êush_iˇche
 (*
wøddr
, *
xaddr
, 
size
)

660 
i
;

661 
i
 = 0; i < 
size
; i +
MIN_CACHE_LINE_SIZE
)

662 
__asm__
 volatile ("icbi 0,%0;" "dcbf 0,%1;"

663 : : "r" (
xaddr
 + 
i
), "r" (
wøddr
 + i) : "memory");

664 
__asm__
 volatile ("icbi 0,%0;" "dcbf 0,%1;" "sync;" "isync;"

665 : : "r"(
xaddr
 + 
size
 - 1), "r"(
wøddr
 + size - 1)

667 
	}
}

670 
ffi_°©us


671 
ffi_¥ï_˛osuª_loc_löux64
 (
ffi_˛osuª
 *
˛osuª
,

672 
ffi_cif
 *
cif
,

673 (*
fun
Ë(
ffi_cif
 *, *, **, *),

674 *
u£r_d©a
,

675 *
codñoc
)

677 #i‡
_CALL_ELF
 == 2

678 *
åamp
 = (*Ë&
˛osuª
->tramp[0];

680 i‡(
cif
->
abi
 < 
FFI_LINUX
 || cif->abò>
FFI_LAST_ABI
)

681  
FFI_BAD_ABI
;

683 
åamp
[0] = 0xe96c0018;

684 
åamp
[1] = 0xe98c0010;

685 
åamp
[2] = 0x7d8903a6;

686 
åamp
[3] = 0x4e800420;

689 *(**Ë&
åamp
[4] = (*Ë
ffi_˛osuª_LINUX64
;

690 *(**Ë&
åamp
[6] = 
codñoc
;

691 
	`Êush_iˇche
 ((*)
åamp
, (*)
codñoc
, 
FFI_TRAMPOLINE_SIZE
);

693 **
åamp
 = (**Ë&
˛osuª
->tramp[0];

695 i‡(
cif
->
abi
 < 
FFI_LINUX
 || cif->abò>
FFI_LAST_ABI
)

696  
FFI_BAD_ABI
;

699 
	`mem˝y
 (
åamp
, (*Ë
ffi_˛osuª_LINUX64
, 16);

700 
åamp
[2] =Åramp[1];

701 
åamp
[1] = 
codñoc
;

704 
˛osuª
->
cif
 = cif;

705 
˛osuª
->
fun
 = fun;

706 
˛osuª
->
u£r_d©a
 = user_data;

708  
FFI_OK
;

709 
	}
}

712 
FFI_HIDDEN


713 
	$ffi_˛osuª_hñ≥r_LINUX64
 (
ffi_˛osuª
 *
˛osuª
, *
rvÆue
,

714 *
p°
, 
ffi_dblÊ
 *
p‰
)

721 **
avÆue
;

722 
ffi_ty≥
 **
¨g_ty≥s
;

723 
i
, 
avn
, 
nfixed¨gs
;

724 
ffi_cif
 *
cif
;

725 
ffi_dblÊ
 *
íd_p‰
 = 
p‰
 + 
NUM_FPR_ARG_REGISTERS64
;

726 
Æign
;

728 
cif
 = 
˛osuª
->cif;

729 
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

733 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


734 && (
cif
->
Êags
 & 
FLAG_RETURNS_SMST
) == 0)

736 
rvÆue
 = (*Ë*
p°
;

737 
p°
++;

740 
i
 = 0;

741 
avn
 = 
cif
->
«rgs
;

742 #i‡
_CALL_ELF
 != 2

743 
nfixed¨gs
 = () -1;

744 i‡((
cif
->
Êags
 & 
FLAG_COMPAT
) == 0)

746 
nfixed¨gs
 = 
cif
->nfixedargs;

747 
¨g_ty≥s
 = 
cif
->arg_types;

750 
i
 < 
avn
)

752 
ñt
, 
ñnum
;

754 
¨g_ty≥s
[
i
]->
ty≥
)

756 
FFI_TYPE_SINT8
:

757 
FFI_TYPE_UINT8
:

758 #i‚de‡
__LITTLE_ENDIAN__


759 
avÆue
[
i
] = (*Ë
p°
 + 7;

760 
p°
++;

764 
FFI_TYPE_SINT16
:

765 
FFI_TYPE_UINT16
:

766 #i‚de‡
__LITTLE_ENDIAN__


767 
avÆue
[
i
] = (*Ë
p°
 + 6;

768 
p°
++;

772 
FFI_TYPE_SINT32
:

773 
FFI_TYPE_UINT32
:

774 #i‚de‡
__LITTLE_ENDIAN__


775 
avÆue
[
i
] = (*Ë
p°
 + 4;

776 
p°
++;

780 
FFI_TYPE_SINT64
:

781 
FFI_TYPE_UINT64
:

782 
FFI_TYPE_POINTER
:

783 
avÆue
[
i
] = 
p°
;

784 
p°
++;

787 
FFI_TYPE_STRUCT
:

788 i‡((
cif
->
abi
 & 
FFI_LINUX_STRUCT_ALIGN
) != 0)

790 
Æign
 = 
¨g_ty≥s
[
i
]->
Æignmít
;

791 i‡(
Æign
 > 16)

792 
Æign
 = 16;

793 i‡(
Æign
 > 1)

794 
p°
 = (*Ë
	`ALIGN
 ((
size_t
Ëp°, 
Æign
);

796 
ñt
 = 0;

797 #i‡
_CALL_ELF
 == 2

798 
ñt
 = 
	`discovî_homogíeous_aggªg©e
 (
¨g_ty≥s
[
i
], &
ñnum
);

800 i‡(
ñt
)

803 *
v
;

804 *
ul
;

805 *
f
;

806 *
d
;

807 
size_t
 
p
;

808 } 
to
, 
‰om
;

814 i‡(
p‰
 + 
ñnum
 <
íd_p‰
)

815 
to
.
v
 = 
p‰
;

817 
to
.
v
 = 
p°
;

819 
avÆue
[
i
] = 
to
.
v
;

820 
‰om
.
ul
 = 
p°
;

821 i‡(
ñt
 =
FFI_TYPE_FLOAT
)

825 i‡(
p‰
 < 
íd_p‰
 && 
i
 < 
nfixed¨gs
)

827 *
to
.
f
 = (Ë
p‰
->
d
;

828 
p‰
++;

831 *
to
.
f
 = *
‰om
.f;

832 
to
.
f
++;

833 
‰om
.
f
++;

835 --
ñnum
 != 0);

841 i‡(
p‰
 < 
íd_p‰
 && 
i
 < 
nfixed¨gs
)

843 *
to
.
d
 = 
p‰
->d;

844 
p‰
++;

847 *
to
.
d
 = *
‰om
.d;

848 
to
.
d
++;

849 
‰om
.
d
++;

851 --
ñnum
 != 0);

856 #i‚de‡
__LITTLE_ENDIAN__


859 i‡(
¨g_ty≥s
[
i
]->
size
 < 8)

860 
avÆue
[
i
] = (*Ë
p°
 + 8 - 
¨g_ty≥s
[i]->
size
;

863 
avÆue
[
i
] = 
p°
;

865 
p°
 +(
¨g_ty≥s
[
i
]->
size
 + 7) / 8;

868 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


869 
FFI_TYPE_LONGDOUBLE
:

870 i‡((
cif
->
abi
 & 
FFI_LINUX_LONG_DOUBLE_128
) != 0)

872 i‡(
p‰
 + 1 < 
íd_p‰
 && 
i
 + 1 < 
nfixed¨gs
)

874 
avÆue
[
i
] = 
p‰
;

875 
p‰
 += 2;

879 i‡(
p‰
 < 
íd_p‰
 && 
i
 < 
nfixed¨gs
)

883 *
p°
 = *(*Ë
p‰
;

884 
p‰
++;

886 
avÆue
[
i
] = 
p°
;

888 
p°
 += 2;

893 
FFI_TYPE_DOUBLE
:

897 i‡(
p‰
 < 
íd_p‰
 && 
i
 < 
nfixed¨gs
)

899 
avÆue
[
i
] = 
p‰
;

900 
p‰
++;

903 
avÆue
[
i
] = 
p°
;

904 
p°
++;

907 
FFI_TYPE_FLOAT
:

908 i‡(
p‰
 < 
íd_p‰
 && 
i
 < 
nfixed¨gs
)

912 
p‰
->
f
 = (Ëp‰->
d
;

913 
avÆue
[
i
] = 
p‰
;

914 
p‰
++;

917 
avÆue
[
i
] = 
p°
;

918 
p°
++;

922 
	`FFI_ASSERT
 (0);

925 
i
++;

929 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

932 i‡((
cif
->
Êags
 & 
FLAG_RETURNS_SMST
) != 0)

934 i‡((
cif
->
Êags
 & 
FLAG_RETURNS_FP
) == 0)

935  
FFI_V2_TYPE_SMALL_STRUCT
 + 
cif
->
πy≥
->
size
 - 1;

936 i‡((
cif
->
Êags
 & 
FLAG_RETURNS_64BITS
) != 0)

937  
FFI_V2_TYPE_DOUBLE_HOMOG
;

939  
FFI_V2_TYPE_FLOAT_HOMOG
;

941  
cif
->
πy≥
->
ty≥
;

942 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi_powerpc.h

34 
	mFLAG_RETURNS_SMST
 = 1 << (31-31),

35 
	mFLAG_RETURNS_NOTHING
 = 1 << (31-30),

36 
	mFLAG_RETURNS_FP
 = 1 << (31-29),

37 
	mFLAG_RETURNS_64BITS
 = 1 << (31-28),

40 
	mFLAG_RETURNS_128BITS
 = 1 << (31-27),

42 
	mFLAG_COMPAT
 = 1 << (31- 8),

45 
	mFLAG_ARG_NEEDS_COPY
 = 1 << (31- 7),

46 
	mFLAG_ARG_NEEDS_PSAVE
 = 
FLAG_ARG_NEEDS_COPY
,

47 
	mFLAG_FP_ARGUMENTS
 = 1 << (31- 6),

48 
	mFLAG_4_GPR_ARGUMENTS
 = 1 << (31- 5),

49 
	mFLAG_RETVAL_REFERENCE
 = 1 << (31- 4)

54 
	mf
;

55 
	md
;

56 } 
	tffi_dblÊ
;

58 
FFI_HIDDEN
 
ffi_˛osuª_SYSV
 ();

59 
FFI_HIDDEN
 
ffi_ˇŒ_SYSV
(
exãnded_cif
 *, , , *,

62 
FFI_HIDDEN
 
	`ffi_¥ï_ty≥s_sysv
 (
ffi_abi
);

63 
ffi_°©us
 
FFI_HIDDEN
 
	`ffi_¥ï_cif_sysv
 (
ffi_cif
 *);

64 
FFI_HIDDEN
 
	`ffi_˛osuª_hñ≥r_SYSV
 (
ffi_˛osuª
 *, *, *,

65 
ffi_dblÊ
 *, *);

67 
FFI_HIDDEN
 
	`ffi_ˇŒ_LINUX64
(
exãnded_cif
 *, , ,

69 
FFI_HIDDEN
 
	`ffi_˛osuª_LINUX64
 ();

71 
FFI_HIDDEN
 
	`ffi_¥ï_ty≥s_löux64
 (
ffi_abi
);

72 
ffi_°©us
 
FFI_HIDDEN
 
	`ffi_¥ï_cif_löux64
 (
ffi_cif
 *);

73 
ffi_°©us
 
FFI_HIDDEN
 
	`ffi_¥ï_cif_löux64_v¨
 (
ffi_cif
 *, ,

75 
FFI_HIDDEN
 
	`ffi_¥ï_¨gs64
 (
exãnded_cif
 *, *const);

76 
FFI_HIDDEN
 
	`ffi_˛osuª_hñ≥r_LINUX64
 (
ffi_˛osuª
 *, *,

77 *, 
ffi_dblÊ
 *);

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi_sysv.c

31 
	~"ffi.h
"

33 #i‚de‡
POWERPC64


34 
	~"ffi_comm⁄.h
"

35 
	~"ffi_powîpc.h
"

39 
	#ASM_NEEDS_REGISTERS
 4

	)

40 
	#NUM_GPR_ARG_REGISTERS
 8

	)

41 
	#NUM_FPR_ARG_REGISTERS
 8

	)

44 #i‡
HAVE_LONG_DOUBLE_VARIANT
 && 
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


46 
FFI_HIDDEN


47 
	$ffi_¥ï_ty≥s_sysv
 (
ffi_abi
 
abi
)

49 i‡((
abi
 & (
FFI_SYSV
 | 
FFI_SYSV_LONG_DOUBLE_128
)) == FFI_SYSV)

51 
ffi_ty≥_l⁄gdoubÀ
.
size
 = 8;

52 
ffi_ty≥_l⁄gdoubÀ
.
Æignmít
 = 8;

56 
ffi_ty≥_l⁄gdoubÀ
.
size
 = 16;

57 
ffi_ty≥_l⁄gdoubÀ
.
Æignmít
 = 16;

59 
	}
}

64 
	$å™¶©e_Êﬂt
 (
abi
, 
ty≥
)

66 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


67 i‡(
ty≥
 =
FFI_TYPE_LONGDOUBLE


68 && (
abi
 & 
FFI_SYSV_LONG_DOUBLE_128
) == 0)

69 
ty≥
 = 
FFI_TYPE_DOUBLE
;

71 i‡((
abi
 & 
FFI_SYSV_SOFT_FLOAT
) != 0)

73 i‡(
ty≥
 =
FFI_TYPE_FLOAT
)

74 
ty≥
 = 
FFI_TYPE_UINT32
;

75 i‡(
ty≥
 =
FFI_TYPE_DOUBLE
)

76 
ty≥
 = 
FFI_TYPE_UINT64
;

77 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


78 i‡(
ty≥
 =
FFI_TYPE_LONGDOUBLE
)

79 
ty≥
 = 
FFI_TYPE_UINT128
;

81 i‡((
abi
 & 
FFI_SYSV_IBM_LONG_DOUBLE
) == 0)

83 i‡(
ty≥
 =
FFI_TYPE_LONGDOUBLE
)

84 
ty≥
 = 
FFI_TYPE_STRUCT
;

87  
ty≥
;

88 
	}
}

91 
ffi_°©us


92 
	$ffi_¥ï_cif_sysv_c‹e
 (
ffi_cif
 *
cif
)

94 
ffi_ty≥
 **
±r
;

95 
byãs
;

96 
i
, 
Â¨g_cou¡
 = 0, 
öèrg_cou¡
 = 0;

97 
Êags
 = 
cif
->flags;

98 
°ru˘_c›y_size
 = 0;

99 
ty≥
 = 
cif
->
πy≥
->type;

100 
size
 = 
cif
->
πy≥
->size;

106 
byãs
 = (2 + 
ASM_NEEDS_REGISTERS
) *  ();

109 
byãs
 +
NUM_GPR_ARG_REGISTERS
 *  ();

122 
ty≥
 = 
	`å™¶©e_Êﬂt
 (
cif
->
abi
,Åype);

124 
ty≥
)

126 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


127 
FFI_TYPE_LONGDOUBLE
:

128 
Êags
 |
FLAG_RETURNS_128BITS
;

131 
FFI_TYPE_DOUBLE
:

132 
Êags
 |
FLAG_RETURNS_64BITS
;

134 
FFI_TYPE_FLOAT
:

135 
Êags
 |
FLAG_RETURNS_FP
;

136 #ifde‡
__NO_FPRS__


137  
FFI_BAD_ABI
;

141 
FFI_TYPE_UINT128
:

142 
Êags
 |
FLAG_RETURNS_128BITS
;

144 
FFI_TYPE_UINT64
:

145 
FFI_TYPE_SINT64
:

146 
Êags
 |
FLAG_RETURNS_64BITS
;

149 
FFI_TYPE_STRUCT
:

153 i‡((
cif
->
abi
 & 
FFI_SYSV_STRUCT_RET
Ë!0 && 
size
 <= 8)

155 
Êags
 |
FLAG_RETURNS_SMST
;

158 
öèrg_cou¡
++;

159 
Êags
 |
FLAG_RETVAL_REFERENCE
;

161 
FFI_TYPE_VOID
:

162 
Êags
 |
FLAG_RETURNS_NOTHING
;

175 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = cif->
«rgs
; i > 0; i--,Ötr++)

177 
ty≥num
 = (*
±r
)->
ty≥
;

179 
ty≥num
 = 
	`å™¶©e_Êﬂt
 (
cif
->
abi
,Åypenum);

181 
ty≥num
)

183 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


184 
FFI_TYPE_LONGDOUBLE
:

185 
Â¨g_cou¡
++;

188 
FFI_TYPE_DOUBLE
:

189 
Â¨g_cou¡
++;

192 i‡(
Â¨g_cou¡
 > 
NUM_FPR_ARG_REGISTERS


193 && 
öèrg_cou¡
 >
NUM_GPR_ARG_REGISTERS


194 && 
öèrg_cou¡
 % 2 != 0)

195 
öèrg_cou¡
++;

196 #ifde‡
__NO_FPRS__


197  
FFI_BAD_ABI
;

201 
FFI_TYPE_FLOAT
:

202 
Â¨g_cou¡
++;

203 #ifde‡
__NO_FPRS__


204  
FFI_BAD_ABI
;

208 
FFI_TYPE_UINT128
:

212 i‡(
öèrg_cou¡
 >
NUM_GPR_ARG_REGISTERS
 - 3

213 && 
öèrg_cou¡
 < 
NUM_GPR_ARG_REGISTERS
)

214 
öèrg_cou¡
 = 
NUM_GPR_ARG_REGISTERS
;

215 
öèrg_cou¡
 += 4;

218 
FFI_TYPE_UINT64
:

219 
FFI_TYPE_SINT64
:

228 i‡(
öèrg_cou¡
 =
NUM_GPR_ARG_REGISTERS
-1

229 || 
öèrg_cou¡
 % 2 != 0)

230 
öèrg_cou¡
++;

231 
öèrg_cou¡
 += 2;

234 
FFI_TYPE_STRUCT
:

239 
°ru˘_c›y_size
 +((*
±r
)->
size
 + 15) & ~0xF;

242 
FFI_TYPE_POINTER
:

243 
FFI_TYPE_INT
:

244 
FFI_TYPE_UINT32
:

245 
FFI_TYPE_SINT32
:

246 
FFI_TYPE_UINT16
:

247 
FFI_TYPE_SINT16
:

248 
FFI_TYPE_UINT8
:

249 
FFI_TYPE_SINT8
:

252 
öèrg_cou¡
++;

256 
	`FFI_ASSERT
 (0);

260 i‡(
Â¨g_cou¡
 != 0)

261 
Êags
 |
FLAG_FP_ARGUMENTS
;

262 i‡(
öèrg_cou¡
 > 4)

263 
Êags
 |
FLAG_4_GPR_ARGUMENTS
;

264 i‡(
°ru˘_c›y_size
 != 0)

265 
Êags
 |
FLAG_ARG_NEEDS_COPY
;

268 i‡(
Â¨g_cou¡
 != 0)

269 
byãs
 +
NUM_FPR_ARG_REGISTERS
 *  ();

272 i‡(
öèrg_cou¡
 > 
NUM_GPR_ARG_REGISTERS
)

273 
byãs
 +(
öèrg_cou¡
 - 
NUM_GPR_ARG_REGISTERS
) *  ();

274 i‡(
Â¨g_cou¡
 > 
NUM_FPR_ARG_REGISTERS
)

275 
byãs
 +(
Â¨g_cou¡
 - 
NUM_FPR_ARG_REGISTERS
) *  ();

278 
byãs
 = (bytes + 15) & ~0xF;

281 
byãs
 +
°ru˘_c›y_size
;

283 
cif
->
Êags
 = flags;

284 
cif
->
byãs
 = bytes;

286  
FFI_OK
;

287 
	}
}

289 
ffi_°©us
 
FFI_HIDDEN


290 
	$ffi_¥ï_cif_sysv
 (
ffi_cif
 *
cif
)

292 i‡((
cif
->
abi
 & 
FFI_SYSV
) == 0)

295 
cif
->
Êags
 |
FLAG_COMPAT
;

296 
cif
->
abi
)

299  
FFI_BAD_ABI
;

301 
FFI_COMPAT_SYSV
:

302 
cif
->
abi
 = 
FFI_SYSV
 | 
FFI_SYSV_STRUCT_RET
 | 
FFI_SYSV_LONG_DOUBLE_128
;

305 
FFI_COMPAT_GCC_SYSV
:

306 
cif
->
abi
 = 
FFI_SYSV
 | 
FFI_SYSV_LONG_DOUBLE_128
;

309 
FFI_COMPAT_LINUX
:

310 
cif
->
abi
 = (
FFI_SYSV
 | 
FFI_SYSV_IBM_LONG_DOUBLE


311 | 
FFI_SYSV_LONG_DOUBLE_128
);

314 
FFI_COMPAT_LINUX_SOFT_FLOAT
:

315 
cif
->
abi
 = (
FFI_SYSV
 | 
FFI_SYSV_SOFT_FLOAT
 | 
FFI_SYSV_IBM_LONG_DOUBLE


316 | 
FFI_SYSV_LONG_DOUBLE_128
);

320  
	`ffi_¥ï_cif_sysv_c‹e
 (
cif
);

321 
	}
}

349 
FFI_HIDDEN


350 
	$ffi_¥ï_¨gs_SYSV
 (
exãnded_cif
 *
ecif
, *c⁄° 
°ack
)

352 c⁄° 
byãs
 = 
ecif
->
cif
->bytes;

353 c⁄° 
Êags
 = 
ecif
->
cif
->flags;

357 *
c
;

358 *
u
;

359 *
Œ
;

360 *
f
;

361 *
d
;

362 } 
	tvÆp
;

365 
vÆp
 
°ackt›
;

369 
vÆp
 
g¥_ba£
;

370 
öèrg_cou¡
;

372 #i‚de‡
__NO_FPRS__


375 
vÆp
 
Âr_ba£
;

376 
Â¨g_cou¡
;

381 
vÆp
 
c›y_•a˚
;

384 
vÆp
 
√xt_¨g
;

386 
i
;

387 
ffi_ty≥
 **
±r
;

388 #i‚de‡
__NO_FPRS__


389 
doubÀ_tmp
;

393 **
v
;

394 **
c
;

395 sig√d **
sc
;

396 **
uc
;

397 sig√d **
ss
;

398 **
us
;

399 **
ui
;

400 **
Œ
;

401 **
f
;

402 **
d
;

403 } 
p_¨gv
;

404 
size_t
 
°ru˘_c›y_size
;

405 
g¥vÆue
;

407 
°ackt›
.
c
 = (*Ë
°ack
 + 
byãs
;

408 
g¥_ba£
.
u
 = 
°ackt›
.u - 
ASM_NEEDS_REGISTERS
 - 
NUM_GPR_ARG_REGISTERS
;

409 
öèrg_cou¡
 = 0;

410 #i‚de‡
__NO_FPRS__


411 
Âr_ba£
.
d
 = 
g¥_ba£
.d - 
NUM_FPR_ARG_REGISTERS
;

412 
Â¨g_cou¡
 = 0;

413 
c›y_•a˚
.
c
 = ((
Êags
 & 
FLAG_FP_ARGUMENTS
Ë? 
Âr_ba£
.¯: 
g¥_ba£
.c);

415 
c›y_•a˚
.
c
 = 
g¥_ba£
.c;

417 
√xt_¨g
.
u
 = 
°ack
 + 2;

420 
	`FFI_ASSERT
 (((Ë(*Ë
°ack
 & 0xF) == 0);

421 
	`FFI_ASSERT
 (((Ë
c›y_•a˚
.
c
 & 0xF) == 0);

422 
	`FFI_ASSERT
 (((Ë
°ackt›
.
c
 & 0xF) == 0);

423 
	`FFI_ASSERT
 ((
byãs
 & 0xF) == 0);

424 
	`FFI_ASSERT
 (
c›y_•a˚
.
c
 >
√xt_¨g
.c);

427 i‡(
Êags
 & 
FLAG_RETVAL_REFERENCE
)

429 *
g¥_ba£
.
u
++ = (Ë(*Ë
ecif
->
rvÆue
;

430 
öèrg_cou¡
++;

434 
p_¨gv
.
v
 = 
ecif
->
avÆue
;

435 
±r
 = 
ecif
->
cif
->
¨g_ty≥s
, 
i
 =Écif->cif->
«rgs
;

436 
i
 > 0;

437 
i
--, 
±r
++, 
p_¨gv
.
v
++)

439 
ty≥num
 = (*
±r
)->
ty≥
;

441 
ty≥num
 = 
	`å™¶©e_Êﬂt
 (
ecif
->
cif
->
abi
,Åypenum);

444 
ty≥num
)

446 #i‚de‡
__NO_FPRS__


447 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


448 
FFI_TYPE_LONGDOUBLE
:

449 
doubÀ_tmp
 = (*
p_¨gv
.
d
)[0];

451 i‡(
Â¨g_cou¡
 >
NUM_FPR_ARG_REGISTERS
 - 1)

453 i‡(
öèrg_cou¡
 >
NUM_GPR_ARG_REGISTERS


454 && 
öèrg_cou¡
 % 2 != 0)

456 
öèrg_cou¡
++;

457 
√xt_¨g
.
u
++;

459 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

460 
√xt_¨g
.
u
 += 2;

461 
doubÀ_tmp
 = (*
p_¨gv
.
d
)[1];

462 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

463 
√xt_¨g
.
u
 += 2;

467 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

468 
doubÀ_tmp
 = (*
p_¨gv
.
d
)[1];

469 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

472 
Â¨g_cou¡
 += 2;

473 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_FP_ARGUMENTS
);

476 
FFI_TYPE_DOUBLE
:

477 
doubÀ_tmp
 = **
p_¨gv
.
d
;

479 i‡(
Â¨g_cou¡
 >
NUM_FPR_ARG_REGISTERS
)

481 i‡(
öèrg_cou¡
 >
NUM_GPR_ARG_REGISTERS


482 && 
öèrg_cou¡
 % 2 != 0)

484 
öèrg_cou¡
++;

485 
√xt_¨g
.
u
++;

487 *
√xt_¨g
.
d
 = 
doubÀ_tmp
;

488 
√xt_¨g
.
u
 += 2;

491 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

492 
Â¨g_cou¡
++;

493 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_FP_ARGUMENTS
);

496 
FFI_TYPE_FLOAT
:

497 
doubÀ_tmp
 = **
p_¨gv
.
f
;

498 i‡(
Â¨g_cou¡
 >
NUM_FPR_ARG_REGISTERS
)

500 *
√xt_¨g
.
f
 = (Ë
doubÀ_tmp
;

501 
√xt_¨g
.
u
 += 1;

502 
öèrg_cou¡
++;

505 *
Âr_ba£
.
d
++ = 
doubÀ_tmp
;

506 
Â¨g_cou¡
++;

507 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_FP_ARGUMENTS
);

511 
FFI_TYPE_UINT128
:

517 
öt_tmp
;

518 
ii
;

519 i‡(
öèrg_cou¡
 >
NUM_GPR_ARG_REGISTERS
 - 3)

521 i‡(
öèrg_cou¡
 < 
NUM_GPR_ARG_REGISTERS
)

522 
öèrg_cou¡
 = 
NUM_GPR_ARG_REGISTERS
;

523 
ii
 = 0; ii < 4; ii++)

525 
öt_tmp
 = (*
p_¨gv
.
ui
)[
ii
];

526 *
√xt_¨g
.
u
++ = 
öt_tmp
;

531 
ii
 = 0; ii < 4; ii++)

533 
öt_tmp
 = (*
p_¨gv
.
ui
)[
ii
];

534 *
g¥_ba£
.
u
++ = 
öt_tmp
;

537 
öèrg_cou¡
 += 4;

541 
FFI_TYPE_UINT64
:

542 
FFI_TYPE_SINT64
:

543 i‡(
öèrg_cou¡
 =
NUM_GPR_ARG_REGISTERS
-1)

544 
öèrg_cou¡
++;

545 i‡(
öèrg_cou¡
 >
NUM_GPR_ARG_REGISTERS
)

547 i‡(
öèrg_cou¡
 % 2 != 0)

549 
öèrg_cou¡
++;

550 
√xt_¨g
.
u
++;

552 *
√xt_¨g
.
Œ
 = **
p_¨gv
.ll;

553 
√xt_¨g
.
u
 += 2;

562 i‡(
öèrg_cou¡
 % 2 != 0)

564 
öèrg_cou¡
 ++;

565 
g¥_ba£
.
u
++;

567 *
g¥_ba£
.
Œ
++ = **
p_¨gv
.ll;

569 
öèrg_cou¡
 += 2;

572 
FFI_TYPE_STRUCT
:

573 
°ru˘_c›y_size
 = ((*
±r
)->
size
 + 15) & ~0xF;

574 
c›y_•a˚
.
c
 -
°ru˘_c›y_size
;

575 
	`mem˝y
 (
c›y_•a˚
.
c
, *
p_¨gv
.c, (*
±r
)->
size
);

577 
g¥vÆue
 = (Ë
c›y_•a˚
.
c
;

579 
	`FFI_ASSERT
 (
c›y_•a˚
.
c
 > 
√xt_¨g
.c);

580 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_ARG_NEEDS_COPY
);

581 
putg¥
;

583 
FFI_TYPE_UINT8
:

584 
g¥vÆue
 = **
p_¨gv
.
uc
;

585 
putg¥
;

586 
FFI_TYPE_SINT8
:

587 
g¥vÆue
 = **
p_¨gv
.
sc
;

588 
putg¥
;

589 
FFI_TYPE_UINT16
:

590 
g¥vÆue
 = **
p_¨gv
.
us
;

591 
putg¥
;

592 
FFI_TYPE_SINT16
:

593 
g¥vÆue
 = **
p_¨gv
.
ss
;

594 
putg¥
;

596 
FFI_TYPE_INT
:

597 
FFI_TYPE_UINT32
:

598 
FFI_TYPE_SINT32
:

599 
FFI_TYPE_POINTER
:

601 
g¥vÆue
 = **
p_¨gv
.
ui
;

603 
putg¥
:

604 i‡(
öèrg_cou¡
 >
NUM_GPR_ARG_REGISTERS
)

605 *
√xt_¨g
.
u
++ = 
g¥vÆue
;

607 *
g¥_ba£
.
u
++ = 
g¥vÆue
;

608 
öèrg_cou¡
++;

614 
	`FFI_ASSERT
 (
c›y_•a˚
.
c
 >
√xt_¨g
.c);

615 
	`FFI_ASSERT
 (
g¥_ba£
.
u
 <
°ackt›
.u - 
ASM_NEEDS_REGISTERS
);

620 #i‚de‡
__NO_FPRS__


621 i‡(
Â¨g_cou¡
 > 
NUM_FPR_ARG_REGISTERS
)

622 
öèrg_cou¡
 -
Â¨g_cou¡
 - 
NUM_FPR_ARG_REGISTERS
;

623 
	`FFI_ASSERT
 (
Âr_ba£
.
u


624 <
°ackt›
.
u
 - 
ASM_NEEDS_REGISTERS
 - 
NUM_GPR_ARG_REGISTERS
);

626 
	`FFI_ASSERT
 (
Êags
 & 
FLAG_4_GPR_ARGUMENTS
 || 
öèrg_cou¡
 <= 4);

627 
	}
}

629 
	#MIN_CACHE_LINE_SIZE
 8

	)

632 
	$Êush_iˇche
 (*
wøddr
, *
xaddr
, 
size
)

634 
i
;

635 
i
 = 0; i < 
size
; i +
MIN_CACHE_LINE_SIZE
)

636 
__asm__
 volatile ("icbi 0,%0;" "dcbf 0,%1;"

637 : : "r" (
xaddr
 + 
i
), "r" (
wøddr
 + i) : "memory");

638 
__asm__
 volatile ("icbi 0,%0;" "dcbf 0,%1;" "sync;" "isync;"

639 : : "r"(
xaddr
 + 
size
 - 1), "r"(
wøddr
 + size - 1)

641 
	}
}

643 
ffi_°©us
 
FFI_HIDDEN


644 
ffi_¥ï_˛osuª_loc_sysv
 (
ffi_˛osuª
 *
˛osuª
,

645 
ffi_cif
 *
cif
,

646 (*
fun
Ë(
ffi_cif
 *, *, **, *),

647 *
u£r_d©a
,

648 *
codñoc
)

650 *
åamp
;

652 i‡(
cif
->
abi
 < 
FFI_SYSV
 || cif->abò>
FFI_LAST_ABI
)

653  
FFI_BAD_ABI
;

655 
åamp
 = (*Ë&
˛osuª
->tramp[0];

656 
åamp
[0] = 0x7c0802a6;

657 
åamp
[1] = 0x4800000d;

658 
åamp
[4] = 0x7d6802a6;

659 
åamp
[5] = 0x7c0803a6;

660 
åamp
[6] = 0x800b0000;

661 
åamp
[7] = 0x816b0004;

662 
åamp
[8] = 0x7c0903a6;

663 
åamp
[9] = 0x4e800420;

664 *(**Ë&
åamp
[2] = (*Ë
ffi_˛osuª_SYSV
;

665 *(**Ë&
åamp
[3] = 
codñoc
;

668 
	`Êush_iˇche
 ((*)
åamp
, (*)
codñoc
, 
FFI_TRAMPOLINE_SIZE
);

670 
˛osuª
->
cif
 = cif;

671 
˛osuª
->
fun
 = fun;

672 
˛osuª
->
u£r_d©a
 = user_data;

674  
FFI_OK
;

675 
	}
}

685 
	$ffi_˛osuª_hñ≥r_SYSV
 (
ffi_˛osuª
 *
˛osuª
, *
rvÆue
,

686 *
pgr
, 
ffi_dblÊ
 *
p‰
,

687 *
p°
)

694 ** 
avÆue
;

695 
ffi_ty≥
 ** 
¨g_ty≥s
;

696 
i
, 
avn
;

697 #i‚de‡
__NO_FPRS__


698 
nf
 = 0;

700 
ng
 = 0;

702 
ffi_cif
 *
cif
 = 
˛osuª
->cif;

703 
size
 = 
cif
->
πy≥
->size;

704 
πy≥num
 = 
cif
->
πy≥
->
ty≥
;

706 
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

709 
πy≥num
 = 
	`å™¶©e_Êﬂt
 (
cif
->
abi
,Ñtypenum);

715 i‡(
πy≥num
 =
FFI_TYPE_STRUCT


716 && !((
cif
->
abi
 & 
FFI_SYSV_STRUCT_RET
Ë!0 && 
size
 <= 8))

718 
rvÆue
 = (*Ë*
pgr
;

719 
ng
++;

720 
pgr
++;

723 
i
 = 0;

724 
avn
 = 
cif
->
«rgs
;

725 
¨g_ty≥s
 = 
cif
->arg_types;

728 
i
 < 
avn
) {

729 
ty≥num
 = 
¨g_ty≥s
[
i
]->
ty≥
;

732 
ty≥num
 = 
	`å™¶©e_Êﬂt
 (
cif
->
abi
,Åypenum);

734 
ty≥num
)

736 #i‚de‡
__NO_FPRS__


737 
FFI_TYPE_FLOAT
:

741 i‡(
nf
 < 
NUM_FPR_ARG_REGISTERS
)

747 
ãmp
 = 
p‰
->
d
;

748 
p‰
->
f
 = (Ë
ãmp
;

749 
avÆue
[
i
] = 
p‰
;

750 
nf
++;

751 
p‰
++;

755 
avÆue
[
i
] = 
p°
;

756 
p°
 += 1;

760 
FFI_TYPE_DOUBLE
:

761 i‡(
nf
 < 
NUM_FPR_ARG_REGISTERS
)

763 
avÆue
[
i
] = 
p‰
;

764 
nf
++;

765 
p‰
++;

769 i‡(((Ë
p°
) & 4)

770 
p°
++;

771 
avÆue
[
i
] = 
p°
;

772 
p°
 += 2;

776 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


777 
FFI_TYPE_LONGDOUBLE
:

778 i‡(
nf
 < 
NUM_FPR_ARG_REGISTERS
 - 1)

780 
avÆue
[
i
] = 
p‰
;

781 
p‰
 += 2;

782 
nf
 += 2;

786 i‡(((Ë
p°
) & 4)

787 
p°
++;

788 
avÆue
[
i
] = 
p°
;

789 
p°
 += 4;

790 
nf
 = 8;

796 
FFI_TYPE_UINT128
:

799 i‡(
ng
 < 
NUM_GPR_ARG_REGISTERS
 - 3)

801 
avÆue
[
i
] = 
pgr
;

802 
pgr
 += 4;

803 
ng
 += 4;

807 
avÆue
[
i
] = 
p°
;

808 
p°
 += 4;

809 
ng
 = 8+4;

813 
FFI_TYPE_SINT8
:

814 
FFI_TYPE_UINT8
:

815 #i‚de‡
__LITTLE_ENDIAN__


816 i‡(
ng
 < 
NUM_GPR_ARG_REGISTERS
)

818 
avÆue
[
i
] = (*Ë
pgr
 + 3;

819 
ng
++;

820 
pgr
++;

824 
avÆue
[
i
] = (*Ë
p°
 + 3;

825 
p°
++;

830 
FFI_TYPE_SINT16
:

831 
FFI_TYPE_UINT16
:

832 #i‚de‡
__LITTLE_ENDIAN__


833 i‡(
ng
 < 
NUM_GPR_ARG_REGISTERS
)

835 
avÆue
[
i
] = (*Ë
pgr
 + 2;

836 
ng
++;

837 
pgr
++;

841 
avÆue
[
i
] = (*Ë
p°
 + 2;

842 
p°
++;

847 
FFI_TYPE_SINT32
:

848 
FFI_TYPE_UINT32
:

849 
FFI_TYPE_POINTER
:

850 i‡(
ng
 < 
NUM_GPR_ARG_REGISTERS
)

852 
avÆue
[
i
] = 
pgr
;

853 
ng
++;

854 
pgr
++;

858 
avÆue
[
i
] = 
p°
;

859 
p°
++;

863 
FFI_TYPE_STRUCT
:

866 i‡(
ng
 < 
NUM_GPR_ARG_REGISTERS
)

868 
avÆue
[
i
] = (*Ë*
pgr
;

869 
ng
++;

870 
pgr
++;

874 
avÆue
[
i
] = (*Ë*
p°
;

875 
p°
++;

879 
FFI_TYPE_SINT64
:

880 
FFI_TYPE_UINT64
:

889 i‡(
ng
 < 
NUM_GPR_ARG_REGISTERS
 - 1)

891 i‡(
ng
 & 1)

894 
ng
++;

895 
pgr
++;

897 
avÆue
[
i
] = 
pgr
;

898 
ng
 += 2;

899 
pgr
 += 2;

903 i‡(((Ë
p°
) & 4)

904 
p°
++;

905 
avÆue
[
i
] = 
p°
;

906 
p°
 += 2;

907 
ng
 = 
NUM_GPR_ARG_REGISTERS
;

912 
	`FFI_ASSERT
 (0);

915 
i
++;

918 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

926 i‡(
πy≥num
 =
FFI_TYPE_STRUCT


927 && (
cif
->
abi
 & 
FFI_SYSV_STRUCT_RET
Ë!0 && 
size
 <= 8)

928  
FFI_SYSV_TYPE_SMALL_STRUCT
 - 1 + 
size
;

929  
πy≥num
;

930 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffitarget.h

30 #i‚de‡
LIBFFI_TARGET_H


31 
	#LIBFFI_TARGET_H


	)

33 #i‚de‡
LIBFFI_H


39 #i‡
deföed
 (
POWERPC
Ë&& deföed (
__powîpc64__
)

40 #i‚de‡
POWERPC64


41 
	#POWERPC64


	)

43 #ñi‡
deföed
 (
POWERPC_DARWIN
Ë&& deföed (
__µc64__
)

44 #i‚de‡
POWERPC64


45 
	#POWERPC64


	)

47 #i‚de‡
POWERPC_DARWIN64


48 
	#POWERPC_DARWIN64


	)

50 #ñi‡
deföed
 (
POWERPC_AIX
Ë&& deföed (
__64BIT__
)

51 #i‚de‡
POWERPC64


52 
	#POWERPC64


	)

56 #i‚de‡
LIBFFI_ASM


57 
	tffi_¨g
;

58 sig√d 
	tffi_ßrg
;

60 
	effi_abi
 {

61 
	mFFI_FIRST_ABI
 = 0,

63 #i‡
deföed
 (
POWERPC_AIX
)

64 
	mFFI_AIX
,

65 
	mFFI_DARWIN
,

66 
	mFFI_DEFAULT_ABI
 = 
FFI_AIX
,

67 
	mFFI_LAST_ABI


69 #ñi‡
deföed
 (
POWERPC_DARWIN
)

70 
	mFFI_AIX
,

71 
	mFFI_DARWIN
,

72 
	mFFI_DEFAULT_ABI
 = 
FFI_DARWIN
,

73 
	mFFI_LAST_ABI


79 
	mFFI_COMPAT_SYSV
,

80 
	mFFI_COMPAT_GCC_SYSV
,

81 
	mFFI_COMPAT_LINUX64
,

82 
	mFFI_COMPAT_LINUX
,

83 
	mFFI_COMPAT_LINUX_SOFT_FLOAT
,

85 #i‡
deföed
 (
POWERPC64
)

90 
	mFFI_LINUX
 = 8,

92 
	mFFI_LINUX_STRUCT_ALIGN
 = 1,

93 
	mFFI_LINUX_LONG_DOUBLE_128
 = 2,

94 
	mFFI_DEFAULT_ABI
 = (
FFI_LINUX


95 #ifde‡
__STRUCT_PARM_ALIGN__


96 | 
FFI_LINUX_STRUCT_ALIGN


98 #ifde‡
__LONG_DOUBLE_128__


99 | 
FFI_LINUX_LONG_DOUBLE_128


102 
	mFFI_LAST_ABI
 = 12

107 
FFI_SYSV
 = 8,

109 
	mFFI_SYSV_SOFT_FLOAT
 = 1,

110 
	mFFI_SYSV_STRUCT_RET
 = 2,

111 
	mFFI_SYSV_IBM_LONG_DOUBLE
 = 4,

112 
	mFFI_SYSV_LONG_DOUBLE_128
 = 16,

114 
	mFFI_DEFAULT_ABI
 = (
FFI_SYSV


115 #ifde‡
__NO_FPRS__


116 | 
FFI_SYSV_SOFT_FLOAT


118 #i‡(
deföed
 (
__SVR4_STRUCT_RETURN
) \

119 || 
deföed
 (
POWERPC_FREEBSD
Ë&& !deföed (
__AIX_STRUCT_RETURN
))

120 | 
FFI_SYSV_STRUCT_RET


122 #i‡
__LDBL_MANT_DIG__
 == 106

123 | 
FFI_SYSV_IBM_LONG_DOUBLE


125 #ifde‡
__LONG_DOUBLE_128__


126 | 
FFI_SYSV_LONG_DOUBLE_128


129 
	mFFI_LAST_ABI
 = 32

133 } 
	tffi_abi
;

138 
	#FFI_CLOSURES
 1

	)

139 
	#FFI_NATIVE_RAW_API
 0

	)

140 #i‡
deföed
 (
POWERPC
Ë|| deföed (
POWERPC_FREEBSD
)

141 
	#FFI_TARGET_SPECIFIC_VARIADIC
 1

	)

142 
	#FFI_EXTRA_CIF_FIELDS
 
nfixed¨gs


	)

149 
	#FFI_TYPE_UINT128
 (
FFI_TYPE_LAST
 + 1)

	)

152 
	#FFI_SYSV_TYPE_SMALL_STRUCT
 (
FFI_TYPE_LAST
 + 2)

	)

155 
	#FFI_V2_TYPE_FLOAT_HOMOG
 (
FFI_TYPE_LAST
 + 1)

	)

156 
	#FFI_V2_TYPE_DOUBLE_HOMOG
 (
FFI_TYPE_LAST
 + 2)

	)

157 
	#FFI_V2_TYPE_SMALL_STRUCT
 (
FFI_TYPE_LAST
 + 3)

	)

159 #i‡
_CALL_ELF
 == 2

160 
	#FFI_TRAMPOLINE_SIZE
 32

	)

162 #i‡
deföed
(
POWERPC64
Ë|| deföed(
POWERPC_AIX
)

163 #i‡
deföed
(
POWERPC_DARWIN64
)

164 
	#FFI_TRAMPOLINE_SIZE
 48

	)

166 
	#FFI_TRAMPOLINE_SIZE
 24

	)

169 
	#FFI_TRAMPOLINE_SIZE
 40

	)

173 #i‚de‡
LIBFFI_ASM


174 #i‡
deföed
(
POWERPC_DARWIN
Ë|| deföed(
POWERPC_AIX
)

175 
	sffi_aix_åampﬁöe_°ru˘
 {

176 * 
	mcode_poöãr
;

177 * 
	mtoc
;

178 * 
	m°©ic_chaö
;

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/linux64.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

32 #ifde‡
POWERPC64


33 .
hiddí
 
	gffi_ˇŒ_LINUX64


34 .
globl
 
	gffi_ˇŒ_LINUX64


35 #i‡
_CALL_ELF
 == 2

36 .
ãxt


37 
	gffi_ˇŒ_LINUX64
:

38 
addis
 %
r2
, %
	gr12
, .
	gTOC
.-
	gffi_ˇŒ_LINUX64
@
ha


39 
	gaddi
 %
	gr2
, %r2, .
	gTOC
.-
	gffi_ˇŒ_LINUX64
@
	gl


40 .
loˇÀ¡ry
 
	gffi_ˇŒ_LINUX64
, . - ffi_call_LINUX64

42 .
	g£˘i⁄
 ".opd","aw"

43 .
	gÆign
 3

44 
	gffi_ˇŒ_LINUX64
:

45 #ifde‡
_CALL_LINUX


46 .
quad
 .
L
.
ffi_ˇŒ_LINUX64
,.
	gTOC
.@
	gtocba£
,0

47 .
ty≥
 
	gffi_ˇŒ_LINUX64
,@
	gfun˘i⁄


48 .
	gãxt


49 .
	gL
.
	gffi_ˇŒ_LINUX64
:

51 .
hiddí
 .
ffi_ˇŒ_LINUX64


52 .
globl
 .
ffi_ˇŒ_LINUX64


53 .
quad
 .
ffi_ˇŒ_LINUX64
,.
	gTOC
.@
	gtocba£
,0

54 .
size
 
	gffi_ˇŒ_LINUX64
,24

55 .
	gty≥
 .
	gffi_ˇŒ_LINUX64
,@
	gfun˘i⁄


56 .
	gãxt


57 .
	gffi_ˇŒ_LINUX64
:

60 .
LFB1
:

61 
mÊr
 %
r0


62 
°d
 %
r28
, -32(%
	gr1
)

63 
	g°d
 %
	gr29
, -24(%
	gr1
)

64 
	g°d
 %
	gr30
, -16(%
	gr1
)

65 
	g°d
 %
	gr31
, -8(%
	gr1
)

66 
	g°d
 %
	gr0
, 16(%
	gr1
)

68 
	gmr
 %
	gr28
, %
	gr1


69 .
	gLCFI0
:

70 
°dux
 %
r1
, %
	gr1
, %
r4


71 
	gmr
 %
	gr31
, %
r5


72 
	gmr
 %
	gr30
, %
r6


73 
	gmr
 %
	gr29
, %
	gr7


76 #i‡
_CALL_ELF
 == 2

77 
	g°d
 %
	gr2
, 24(%
	gr1
)

79 
	g°d
 %
	gr2
, 40(%
	gr1
)

83 
	gmr
 %
	gr4
, %
	gr1


84 #i‡
deföed
 
_CALL_LINUX
 || 
_CALL_ELF
 == 2

85 
bl
 
	gffi_¥ï_¨gs64


87 
	gbl
 .
	gffi_¥ï_¨gs64


90 #i‡
_CALL_ELF
 == 2

91 
	gmr
 %
	gr12
, %
	gr29


93 
	gld
 %
	gr12
, 0(%
	gr29
)

94 
	gld
 %
	gr2
, 8(%
	gr29
)

95 
	gld
 %
	gr11
, 16(%
	gr29
)

99 
	gmt¸f
 0x40, %
r31


102 
	gmt˘r
 %
r12


104 
	gld
 %
	gr3
, -32-(8*8)(%
	gr28
)

105 
	gld
 %
	gr4
, -32-(7*8)(%
	gr28
)

106 
	gld
 %
	gr5
, -32-(6*8)(%
	gr28
)

107 
	gld
 %
	gr6
, -32-(5*8)(%
	gr28
)

108 
	gbf
- 5, 1f

109 
	gld
 %
	gr7
, -32-(4*8)(%
	gr28
)

110 
	gld
 %
	gr8
, -32-(3*8)(%
	gr28
)

111 
	gld
 %
	gr9
, -32-(2*8)(%
	gr28
)

112 
	gld
 %
	gr10
, -32-(1*8)(%
	gr28
)

116 
bf
- 6, 2f

117 
	glfd
 %
	gf1
, -32-(21*8)(%
	gr28
)

118 
	glfd
 %
	gf2
, -32-(20*8)(%
	gr28
)

119 
	glfd
 %
	gf3
, -32-(19*8)(%
	gr28
)

120 
	glfd
 %
	gf4
, -32-(18*8)(%
	gr28
)

121 
	glfd
 %
	gf5
, -32-(17*8)(%
	gr28
)

122 
	glfd
 %
	gf6
, -32-(16*8)(%
	gr28
)

123 
	glfd
 %
	gf7
, -32-(15*8)(%
	gr28
)

124 
	glfd
 %
	gf8
, -32-(14*8)(%
	gr28
)

125 
	glfd
 %
	gf9
, -32-(13*8)(%
	gr28
)

126 
	glfd
 %
	gf10
, -32-(12*8)(%
	gr28
)

127 
	glfd
 %
	gf11
, -32-(11*8)(%
	gr28
)

128 
	glfd
 %
	gf12
, -32-(10*8)(%
	gr28
)

129 
	glfd
 %
	gf13
, -32-(9*8)(%
	gr28
)

133 
b˘æ


137 #i‡
_CALL_ELF
 == 2

138 
ld
 %
r2
, 24(%
	gr1
)

140 
	gld
 %
	gr2
, 40(%
	gr1
)

144 
	gmt¸f
 0x01, %
r31


145 
	gbt
 31, .
L°ru˘_ªtu∫_vÆue


146 
	gbt
 30, .
Ld⁄e_ªtu∫_vÆue


147 
	gbt
 29, .
LÂ_ªtu∫_vÆue


148 
	g°d
 %
	gr3
, 0(%
	gr30
)

151 .
	gLd⁄e_ªtu∫_vÆue
:

153 
mr
 %
r1
, %
r28


154 
	gld
 %
	gr0
, 16(%
	gr28
)

155 
	gld
 %
	gr28
, -32(%r28)

156 
	gmér
 %
r0


157 
	gld
 %
	gr29
, -24(%
	gr1
)

158 
	gld
 %
	gr30
, -16(%
	gr1
)

159 
	gld
 %
	gr31
, -8(%
	gr1
)

160 
	gbÃ


162 .
	gLÂ_ªtu∫_vÆue
:

163 
bf
 28, .
LÊﬂt_ªtu∫_vÆue


164 
	g°fd
 %
	gf1
, 0(%
	gr30
)

165 
	gmt¸f
 0x02, %
r31


166 
	gbf
 27, .
Ld⁄e_ªtu∫_vÆue


167 
	g°fd
 %
	gf2
, 8(%
	gr30
)

168 
	gb
 .
	gLd⁄e_ªtu∫_vÆue


169 .
	gLÊﬂt_ªtu∫_vÆue
:

170 
°fs
 %
f1
, 0(%
	gr30
)

171 
	gb
 .
	gLd⁄e_ªtu∫_vÆue


173 .
	gL°ru˘_ªtu∫_vÆue
:

174 
bf
 29, .
LsmÆl_°ru˘


175 
	gbf
 28, .
LÊﬂt_homog_ªtu∫_vÆue


176 
	g°fd
 %
	gf1
, 0(%
	gr30
)

177 
	g°fd
 %
	gf2
, 8(%
	gr30
)

178 
	g°fd
 %
	gf3
, 16(%
	gr30
)

179 
	g°fd
 %
	gf4
, 24(%
	gr30
)

180 
	g°fd
 %
	gf5
, 32(%
	gr30
)

181 
	g°fd
 %
	gf6
, 40(%
	gr30
)

182 
	g°fd
 %
	gf7
, 48(%
	gr30
)

183 
	g°fd
 %
	gf8
, 56(%
	gr30
)

184 
	gb
 .
	gLd⁄e_ªtu∫_vÆue


186 .
	gLÊﬂt_homog_ªtu∫_vÆue
:

187 
°fs
 %
f1
, 0(%
	gr30
)

188 
	g°fs
 %
	gf2
, 4(%
	gr30
)

189 
	g°fs
 %
	gf3
, 8(%
	gr30
)

190 
	g°fs
 %
	gf4
, 12(%
	gr30
)

191 
	g°fs
 %
	gf5
, 16(%
	gr30
)

192 
	g°fs
 %
	gf6
, 20(%
	gr30
)

193 
	g°fs
 %
	gf7
, 24(%
	gr30
)

194 
	g°fs
 %
	gf8
, 28(%
	gr30
)

195 
	gb
 .
	gLd⁄e_ªtu∫_vÆue


197 .
	gLsmÆl_°ru˘
:

198 
°d
 %
r3
, 0(%
	gr30
)

199 
	g°d
 %
	gr4
, 8(%
	gr30
)

200 
	gb
 .
	gLd⁄e_ªtu∫_vÆue


202 .
	gLFE1
:

204 .
byã
 0,12,0,1,128,4,0,0

205 #i‡
_CALL_ELF
 == 2

206 .
size
 
	gffi_ˇŒ_LINUX64
,.-ffi_call_LINUX64

208 #ifde‡
_CALL_LINUX


209 .
size
 
	gffi_ˇŒ_LINUX64
,.-.
	gL
.ffi_call_LINUX64

211 .
	gsize
 .
	gffi_ˇŒ_LINUX64
,.-.ffi_call_LINUX64

215 .
	g£˘i⁄
 .
	geh_‰ame
,
	gEH_FRAME_FLAGS
,@
	g¥ogbôs


216 .
	gL‰ame1
:

217 .4b
yã
 .
LECIE1
-.
LSCIE1
 #Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


218 .
LSCIE1
:

219 .4b
yã
 0x0 #CIE 
Idítifõr
 
Tag


220 .
byã
 0x1 #CIE 
Vîsi⁄


221 .
ascii
 "zR\0" #CIE 
Augmíèti⁄


222 .
uÀb128
 0x1 #CIE 
Code
 
Alignmít
 
Fa˘‹


223 .
¶eb128
 -8 #CIE 
D©a
 
Alignmít
 
Fa˘‹


224 .
byã
 0x41 #CIE 
RA
 
Cﬁumn


225 .
uÀb128
 0x1 #Augmíèti⁄ 
size


226 .
byã
 0x14 #FDE 
Encodög
 (
p¸ñ
 
ud©a8
)

227 .
byã
 0xc #DW_CFA_def_cfa

228 .
uÀb128
 0x1

229 .
uÀb128
 0x0

230 .
Æign
 3

231 .
LECIE1
:

232 .
LSFDE1
:

233 .4b
yã
 .
LEFDE1
-.
LASFDE1
 #FDE 
Lígth


234 .
LASFDE1
:

235 .4b
yã
 .
LASFDE1
-.
L‰ame1
 #FDE 
CIE
 
off£t


236 .8b
yã
 .
LFB1
-. #FDE 
öôül
 
loˇti⁄


237 .8b
yã
 .
LFE1
-.
LFB1
 #FDE 
addªss
 
ønge


238 .
uÀb128
 0x0 #Augmíèti⁄ 
size


239 .
byã
 0x2 #DW_CFA_advance_loc1

240 .
byã
 .
LCFI0
-.
LFB1


241 .
byã
 0xd #DW_CFA_def_cfa_register

242 .
uÀb128
 0x1c

243 .
byã
 0x11 #DW_CFA_offset_extended_sf

244 .
uÀb128
 0x41

245 .
¶eb128
 -2

246 .
byã
 0x9‡#DW_CFA_off£t, 
	gcﬁumn
 0x1f

247 .
	guÀb128
 0x1

248 .
	gbyã
 0x9ê#DW_CFA_off£t, 
	gcﬁumn
 0x1e

249 .
	guÀb128
 0x2

250 .
	gbyã
 0x9d #DW_CFA_off£t, 
	gcﬁumn
 0x1d

251 .
	guÀb128
 0x3

252 .
	gbyã
 0x9¯#DW_CFA_off£t, 
	gcﬁumn
 0x1c

253 .
	guÀb128
 0x4

254 .
	gÆign
 3

255 .
	gLEFDE1
:

259 #i‡(
deföed
 
__ELF__
 && deföed 
__löux__
Ë|| 
_CALL_ELF
 == 2

260 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
	g¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/linux64_closure.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

31 .
	gfûe
 "linux64_closure.S"

33 #ifde‡
POWERPC64


34 
FFI_HIDDEN
 (
ffi_˛osuª_LINUX64
)

35 .
globl
 
	gffi_˛osuª_LINUX64


36 #i‡
_CALL_ELF
 == 2

37 .
ãxt


38 
	gffi_˛osuª_LINUX64
:

39 
addis
 %
r2
, %
	gr12
, .
	gTOC
.-
	gffi_˛osuª_LINUX64
@
ha


40 
	gaddi
 %
	gr2
, %r2, .
	gTOC
.-
	gffi_˛osuª_LINUX64
@
	gl


41 .
loˇÀ¡ry
 
	gffi_˛osuª_LINUX64
, . - ffi_closure_LINUX64

43 .
	g£˘i⁄
 ".opd","aw"

44 .
	gÆign
 3

45 
	gffi_˛osuª_LINUX64
:

46 #ifde‡
_CALL_LINUX


47 .
quad
 .
L
.
ffi_˛osuª_LINUX64
,.
	gTOC
.@
	gtocba£
,0

48 .
ty≥
 
	gffi_˛osuª_LINUX64
,@
	gfun˘i⁄


49 .
	gãxt


50 .
	gL
.
	gffi_˛osuª_LINUX64
:

52 
FFI_HIDDEN
 (.
ffi_˛osuª_LINUX64
)

53 .
globl
 .
ffi_˛osuª_LINUX64


54 .
quad
 .
ffi_˛osuª_LINUX64
,.
	gTOC
.@
	gtocba£
,0

55 .
size
 
	gffi_˛osuª_LINUX64
,24

56 .
	gty≥
 .
	gffi_˛osuª_LINUX64
,@
	gfun˘i⁄


57 .
	gãxt


58 .
	gffi_˛osuª_LINUX64
:

62 #i‡
_CALL_ELF
 == 2

63 #32 
byã
 
•ecül
 
ªg
 
ßve
 
¨ó
 + 64 byã 
∑rm
 saveárea

64 #+ 64 
byã
 
ªtvÆ
 
¨ó
 + 13*8 
Âr
 
ßve
áª®+ 
round
 
to
 16

65 
	#STACKFRAME
 272

	)

66 
	#PARMSAVE
 32

	)

67 
	#RETVAL
 
PARMSAVE
+64

	)

69 #48 
byãs
 
•ecül
 
ªg
 
ßve
 
¨ó
 + 64 byã†
∑rm
 saveárea

70 #+ 16 
byãs
 
ªtvÆ
 
¨ó
 + 13*8 byã†
Âr
 
ßve
áª®+ 
round
 
to
 16

71 
	#STACKFRAME
 240

	)

72 
	#PARMSAVE
 48

	)

73 
	#RETVAL
 
PARMSAVE
+64

	)

76 .
LFB1
:

77 #i‡
_CALL_ELF
 == 2

78 
ld
 %
r12
, 
FFI_TRAMPOLINE_SIZE
(%
r11
Ë#˛osuª->
cif


79 
	gmÊr
 %
r0


80 
	glwz
 %
	gr12
, 28(%r12Ë#cif->
Êags


81 
	gmt¸f
 0x40, %
r12


82 
	gaddi
 %
	gr12
, %
	gr1
, 
PARMSAVE


83 
	gbt
 7, .
	gL∑rmßve


84 #Ou∏
ˇŒî
 
has
 
nŸ
 
Æloˇãd
 
a
 
∑ømëî
 
ßve
 
¨ó
.

85 #Wê
√ed
 
to
 
Æloˇã
 
⁄e
 
hîe
 
™d
 
u£
 
ô
Åÿ
∑ss
 
g¥s
Åo

87 
	gaddi
 %
	gr12
, %
	gr1
, -
	gSTACKFRAME
+
	gPARMSAVE


88 .
	gL∑rmßve
:

89 
°d
 %
r0
, 16(%
	gr1
)

90 #Savê
gíîÆ
 
ªgs
 
öto
 
∑rm
 
ßve
 
¨ó


91 
	g°d
 %
	gr3
, 0(%
	gr12
)

92 
	g°d
 %
	gr4
, 8(%
	gr12
)

93 
	g°d
 %
	gr5
, 16(%
	gr12
)

94 
	g°d
 %
	gr6
, 24(%
	gr12
)

95 
	g°d
 %
	gr7
, 32(%
	gr12
)

96 
	g°d
 %
	gr8
, 40(%
	gr12
)

97 
	g°d
 %
	gr9
, 48(%
	gr12
)

98 
	g°d
 %
	gr10
, 56(%
	gr12
)

100 #lﬂd 
up
 
the
 
poöãr
 
to
Åhê
∑rm
 
ßve
 
¨ó


101 
	gmr
 %
	gr5
, %
	gr12


103 #c›y 
r2
 
to
 
r11
 
™d
 
lﬂd
 
TOC
 
öto
Ñ2

104 
	gmr
 %
	gr11
, %
r2


105 
	gld
 %
	gr2
, 16(%
	gr11
)

107 
	gmÊr
 %
	gr0


108 #Savê
gíîÆ
 
ªgs
 
öto
 
∑rm
 
ßve
 
¨ó


109 #Thi†
is
 
the
 
∑ømëî
 
ßve
 
¨ó
 
£t
 
up
 
by
 
our
 
ˇŒî
.

110 
	g°d
 %
	gr3
, 
	gPARMSAVE
+0(%
	gr1
)

111 
	g°d
 %
	gr4
, 
	gPARMSAVE
+8(%
	gr1
)

112 
	g°d
 %
	gr5
, 
	gPARMSAVE
+16(%
	gr1
)

113 
	g°d
 %
	gr6
, 
	gPARMSAVE
+24(%
	gr1
)

114 
	g°d
 %
	gr7
, 
	gPARMSAVE
+32(%
	gr1
)

115 
	g°d
 %
	gr8
, 
	gPARMSAVE
+40(%
	gr1
)

116 
	g°d
 %
	gr9
, 
	gPARMSAVE
+48(%
	gr1
)

117 
	g°d
 %
	gr10
, 
	gPARMSAVE
+56(%
	gr1
)

119 
	g°d
 %
	gr0
, 16(%
	gr1
)

121 #lﬂd 
up
 
the
 
poöãr
 
to
Åhê
∑rm
 
ßve
 
¨ó


122 
	gaddi
 %
	gr5
, %
	gr1
, 
	gPARMSAVE


125 #√xà
ßve
 
Âr
 1 
to
 fpr 13

126 
	g°fd
 %
	gf1
, -104+(0*8)(%
	gr1
)

127 
	g°fd
 %
	gf2
, -104+(1*8)(%
	gr1
)

128 
	g°fd
 %
	gf3
, -104+(2*8)(%
	gr1
)

129 
	g°fd
 %
	gf4
, -104+(3*8)(%
	gr1
)

130 
	g°fd
 %
	gf5
, -104+(4*8)(%
	gr1
)

131 
	g°fd
 %
	gf6
, -104+(5*8)(%
	gr1
)

132 
	g°fd
 %
	gf7
, -104+(6*8)(%
	gr1
)

133 
	g°fd
 %
	gf8
, -104+(7*8)(%
	gr1
)

134 
	g°fd
 %
	gf9
, -104+(8*8)(%
	gr1
)

135 
	g°fd
 %
	gf10
, -104+(9*8)(%
	gr1
)

136 
	g°fd
 %
	gf11
, -104+(10*8)(%
	gr1
)

137 
	g°fd
 %
	gf12
, -104+(11*8)(%
	gr1
)

138 
	g°fd
 %
	gf13
, -104+(12*8)(%
	gr1
)

140 #lﬂd 
up
 
the
 
poöãr
 
to
Åhê
ßved
 
Âr
 
ªgi°îs
 */

141 
	gaddi
 %
	gr6
, %
	gr1
, -104

143 #lﬂd 
up
 
the
 
poöãr
 
to
Åhê
ªsu…
 
°‹age


144 
	gaddi
 %
	gr4
, %
	gr1
, -
	gSTACKFRAME
+
RETVAL


146 
	g°du
 %
	gr1
, -
STACKFRAME
(%
r1
)

147 .
	gLCFI0
:

149 #gë 
the
 
c⁄ãxt
 
poöãr
 
‰om
Åhê
åampﬁöe


150 
mr
 %
r3
, %
	gr11


152 #makê
the
 
ˇŒ


153 #i‡
deföed
 
_CALL_LINUX
 || 
_CALL_ELF
 == 2

154 
bl
 
	gffi_˛osuª_hñ≥r_LINUX64


156 
	gbl
 .
	gffi_˛osuª_hñ≥r_LINUX64


158 .
	gLªt
:

160 #now 
r3
 
c⁄èös
 
the
  
ty≥


161 #sÿ
u£
 
ô
 
to
 
look
 
up
 
ö
 
a
 
èbÀ


162 #sÿ
we
 
know
 
how
 
to
 
dól
 
wôh
 
óch
 
ty≥


164 #look 
up
 
the
 
¥›î
 
°¨tög
 
poöt
 
ö
 
èbÀ


165 #by 
usög
  
ty≥
 
as
 
off£t


166 
ld
 %
r0
, 
	gSTACKFRAME
+16(%
	gr1
)

167 
	gcm∂di
 %
	gr3
, 
FFI_V2_TYPE_SMALL_STRUCT


168 
	gbge
 .
LsmÆl


169 
	gmÊr
 %
	gr4
 #movê
addªss
 
	gof
 .
Lªt
 
to
 
r4


170 
	g¶di
 %
	gr3
, %r3, 4 #now 
mu…ùly
  
ty≥
 
	gby
 16

171 
	gaddi
 %
	gr4
, %r4, .
	gLªt_ty≥0
 - .
Lªt


172 
	gadd
 %
	gr3
, %r3, %
	gr4
 #add 
c⁄ã¡s
 
of
 
èbÀ
 
to
ÅabÀ 
addªss


173 
	gmt˘r
 %
r3


174 
	gb˘r
 #jum∞
to
 
	gô


176 #Each 
of
 
the
 
ªt_ty≥X
 
code
 
‰agmíts
 
has
 
to
 
be
 
exa˘ly
 16 
byãs
 

177 #(4 
ö°ru˘i⁄s
). 
F‹
 
ˇche
 
ef„˘ivíess
 
we
 
Æign
 
to
 
a
 16 
byã
 
bound¨y


179 .
	gÆign
 4

181 .
	gLªt_ty≥0
:

182 #ˇ£ 
FFI_TYPE_VOID


183 
mér
 %
r0


184 
addi
 %
r1
, %
	gr1
, 
STACKFRAME


185 
bÃ


186 
	gn›


187 #ˇ£ 
FFI_TYPE_INT


188 #ifde‡
__LITTLE_ENDIAN__


189 
	glwa
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

191 
	glwa
 %
	gr3
, 
	gRETVAL
+4(%
	gr1
)

193 
	gmér
 %
r0


194 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


195 
	gbÃ


196 #ˇ£ 
FFI_TYPE_FLOAT


197 
	glfs
 %
	gf1
, 
	gRETVAL
+0(%
	gr1
)

198 
	gmér
 %
r0


199 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


200 
	gbÃ


201 #ˇ£ 
FFI_TYPE_DOUBLE


202 
	glfd
 %
	gf1
, 
	gRETVAL
+0(%
	gr1
)

203 
	gmér
 %
r0


204 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


205 
	gbÃ


206 #ˇ£ 
FFI_TYPE_LONGDOUBLE


207 
	glfd
 %
	gf1
, 
	gRETVAL
+0(%
	gr1
)

208 
	gmér
 %
r0


209 
	glfd
 %
	gf2
, 
	gRETVAL
+8(%
	gr1
)

210 
	gb
 .
	gLföish


211 #ˇ£ 
FFI_TYPE_UINT8


212 #ifde‡
__LITTLE_ENDIAN__


213 
	glbz
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

215 
	glbz
 %
	gr3
, 
	gRETVAL
+7(%
	gr1
)

217 
	gmér
 %
r0


218 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


219 
	gbÃ


220 #ˇ£ 
FFI_TYPE_SINT8


221 #ifde‡
__LITTLE_ENDIAN__


222 
	glbz
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

224 
	glbz
 %
	gr3
, 
	gRETVAL
+7(%
	gr1
)

226 
	gextsb
 %
	gr3
,%
r3


227 
	gmér
 %
r0


228 
	gb
 .
	gLföish


229 #ˇ£ 
FFI_TYPE_UINT16


230 #ifde‡
__LITTLE_ENDIAN__


231 
	glhz
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

233 
	glhz
 %
	gr3
, 
	gRETVAL
+6(%
	gr1
)

235 
	gmér
 %
	gr0


236 .
	gLföish
:

237 
addi
 %
r1
, %
	gr1
, 
STACKFRAME


238 
	gbÃ


239 #ˇ£ 
FFI_TYPE_SINT16


240 #ifde‡
__LITTLE_ENDIAN__


241 
	glha
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

243 
	glha
 %
	gr3
, 
	gRETVAL
+6(%
	gr1
)

245 
	gmér
 %
r0


246 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


247 
	gbÃ


248 #ˇ£ 
FFI_TYPE_UINT32


249 #ifde‡
__LITTLE_ENDIAN__


250 
	glwz
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

252 
	glwz
 %
	gr3
, 
	gRETVAL
+4(%
	gr1
)

254 
	gmér
 %
r0


255 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


256 
	gbÃ


257 #ˇ£ 
FFI_TYPE_SINT32


258 #ifde‡
__LITTLE_ENDIAN__


259 
	glwa
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

261 
	glwa
 %
	gr3
, 
	gRETVAL
+4(%
	gr1
)

263 
	gmér
 %
r0


264 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


265 
	gbÃ


266 #ˇ£ 
FFI_TYPE_UINT64


267 
	gld
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

268 
	gmér
 %
r0


269 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


270 
	gbÃ


271 #ˇ£ 
FFI_TYPE_SINT64


272 
	gld
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

273 
	gmér
 %
r0


274 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


275 
	gbÃ


276 #ˇ£ 
FFI_TYPE_STRUCT


277 
	gmér
 %
r0


278 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


279 
bÃ


280 
	gn›


281 #ˇ£ 
FFI_TYPE_POINTER


282 
	gld
 %
	gr3
, 
	gRETVAL
+0(%
	gr1
)

283 
	gmér
 %
r0


284 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


285 
	gbÃ


286 #ˇ£ 
FFI_V2_TYPE_FLOAT_HOMOG


287 
	glfs
 %
	gf1
, 
	gRETVAL
+0(%
	gr1
)

288 
	glfs
 %
	gf2
, 
	gRETVAL
+4(%
	gr1
)

289 
	glfs
 %
	gf3
, 
	gRETVAL
+8(%
	gr1
)

290 
	gb
 .
	gLm‹eÊﬂt


291 #ˇ£ 
FFI_V2_TYPE_DOUBLE_HOMOG


292 
	glfd
 %
	gf1
, 
	gRETVAL
+0(%
	gr1
)

293 
	glfd
 %
	gf2
, 
	gRETVAL
+8(%
	gr1
)

294 
	glfd
 %
	gf3
, 
	gRETVAL
+16(%
	gr1
)

295 
	glfd
 %
	gf4
, 
	gRETVAL
+24(%
	gr1
)

296 
	gmér
 %
r0


297 
	glfd
 %
	gf5
, 
	gRETVAL
+32(%
	gr1
)

298 
	glfd
 %
	gf6
, 
	gRETVAL
+40(%
	gr1
)

299 
	glfd
 %
	gf7
, 
	gRETVAL
+48(%
	gr1
)

300 
	glfd
 %
	gf8
, 
	gRETVAL
+56(%
	gr1
)

301 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


302 
	gbÃ


303 .
	gLm‹eÊﬂt
:

304 
lfs
 %
f4
, 
	gRETVAL
+12(%
	gr1
)

305 
	gmér
 %
r0


306 
	glfs
 %
	gf5
, 
	gRETVAL
+16(%
	gr1
)

307 
	glfs
 %
	gf6
, 
	gRETVAL
+20(%
	gr1
)

308 
	glfs
 %
	gf7
, 
	gRETVAL
+24(%
	gr1
)

309 
	glfs
 %
	gf8
, 
	gRETVAL
+28(%
	gr1
)

310 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


311 
	gbÃ


312 .
	gLsmÆl
:

313 #ifde‡
__LITTLE_ENDIAN__


314 
ld
 %
r3
,
	gRETVAL
+0(%
	gr1
)

315 
	gmér
 %
r0


316 
	gld
 %
	gr4
,
	gRETVAL
+8(%
	gr1
)

317 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


318 
	gbÃ


320 #A 
smÆÀr
 
th™
 
a
 
dw‹d
 
is
 
ªtu∫ed
 
ö
 
the
 
low
 
bôs
 
of
 
r3


321 #õ. 
right
 
ju°ifõd
. 
L¨gî
 
°ru˘s
 
¨e
 
∑s£d
 
À·
 justified

322 #ö 
r3
 
™d
 
r4
. 
The
  
vÆue
 
¨ó
 
⁄
 
the
 
°ack
 
wûl
 
have


323 #thê
°ru˘s
 
as
 
they
 
¨e
 
usuÆly
 
°‹ed
 
ö
 
mem‹y
.

324 
	gcm∂di
 %
	gr3
, 
	gFFI_V2_TYPE_SMALL_STRUCT
 + 7 #sizê8 
	gbyãs
?

325 
	g√g
 %
	gr5
, %
r3


326 
	gld
 %
	gr3
,
	gRETVAL
+0(%
	gr1
)

327 
	gb…
 .
LsmÆldown


328 
	gmér
 %
r0


329 
	gld
 %
	gr4
,
	gRETVAL
+8(%
	gr1
)

330 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


331 
	gbÃ


332 .
	gLsmÆldown
:

333 
addi
 %
r5
, %
	gr5
, 
	gFFI_V2_TYPE_SMALL_STRUCT
 + 7

334 
	gmér
 %
r0


335 
	g¶di
 %
	gr5
, %r5, 3

336 
	gaddi
 %
	gr1
, %r1, 
STACKFRAME


337 
	g§d
 %
	gr3
, %r3, %
r5


338 
	gbÃ


341 .
	gLFE1
:

343 .
byã
 0,12,0,1,128,0,0,0

344 #i‡
_CALL_ELF
 == 2

345 .
size
 
	gffi_˛osuª_LINUX64
,.-ffi_closure_LINUX64

347 #ifde‡
_CALL_LINUX


348 .
size
 
	gffi_˛osuª_LINUX64
,.-.
	gL
.ffi_closure_LINUX64

350 .
	gsize
 .
	gffi_˛osuª_LINUX64
,.-.ffi_closure_LINUX64

354 .
	g£˘i⁄
 .
	geh_‰ame
,
	gEH_FRAME_FLAGS
,@
	g¥ogbôs


355 .
	gL‰ame1
:

356 .4b
yã
 .
LECIE1
-.
LSCIE1
 #Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


357 .
LSCIE1
:

358 .4b
yã
 0x0 #CIE 
Idítifõr
 
Tag


359 .
byã
 0x1 #CIE 
Vîsi⁄


360 .
ascii
 "zR\0" #CIE 
Augmíèti⁄


361 .
uÀb128
 0x1 #CIE 
Code
 
Alignmít
 
Fa˘‹


362 .
¶eb128
 -8 #CIE 
D©a
 
Alignmít
 
Fa˘‹


363 .
byã
 0x41 #CIE 
RA
 
Cﬁumn


364 .
uÀb128
 0x1 #Augmíèti⁄ 
size


365 .
byã
 0x14 #FDE 
Encodög
 (
p¸ñ
 
ud©a8
)

366 .
byã
 0xc #DW_CFA_def_cfa

367 .
uÀb128
 0x1

368 .
uÀb128
 0x0

369 .
Æign
 3

370 .
LECIE1
:

371 .
LSFDE1
:

372 .4b
yã
 .
LEFDE1
-.
LASFDE1
 #FDE 
Lígth


373 .
LASFDE1
:

374 .4b
yã
 .
LASFDE1
-.
L‰ame1
 #FDE 
CIE
 
off£t


375 .8b
yã
 .
LFB1
-. #FDE 
öôül
 
loˇti⁄


376 .8b
yã
 .
LFE1
-.
LFB1
 #FDE 
addªss
 
ønge


377 .
uÀb128
 0x0 #Augmíèti⁄ 
size


378 .
byã
 0x2 #DW_CFA_advance_loc1

379 .
byã
 .
LCFI0
-.
LFB1


380 .
byã
 0xe #DW_CFA_def_cfa_offset

381 .
uÀb128
 
STACKFRAME


382 .
byã
 0x11 #DW_CFA_offset_extended_sf

383 .
uÀb128
 0x41

384 .
¶eb128
 -2

385 .
Æign
 3

386 .
LEFDE1
:

390 #i‡(
deföed
 
__ELF__
 && deföed 
__löux__
Ë|| 
_CALL_ELF
 == 2

391 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
	g¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ppc_closure.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

30 
	~<powîpc/asm.h
>

32 .
	gfûe
 "ppc_closure.S"

34 #i‚de‡
POWERPC64


36 
ENTRY
(
ffi_˛osuª_SYSV
)

37 .
	gLFB1
:

38 
°wu
 %
r1
,-144(%
	gr1
)

39 .
	gLCFI0
:

40 
mÊr
 %
r0


41 .
LCFI1
:

42 
°w
 %
r0
,148(%
	gr1
)

44 #wê
w™t
 
to
 
buûd
 
up
 
™
 
¨ós
 
the
 
∑ømëîs
 
∑s£d


45 #ö 
ªgi°îs
 (
bŸh
 
Êﬂtög
 
poöt
 
™d
 
öãgî
)

47 #sÿ
fú°
 
ßve
 
g¥
 3 
to
 g¥ 10 (
Æig√d
Åo 4)

48 
	g°w
 %
	gr3
, 16(%
	gr1
)

49 
	g°w
 %
	gr4
, 20(%
	gr1
)

50 
	g°w
 %
	gr5
, 24(%
	gr1
)

51 
	g°w
 %
	gr6
, 28(%
	gr1
)

52 
	g°w
 %
	gr7
, 32(%
	gr1
)

53 
	g°w
 %
	gr8
, 36(%
	gr1
)

54 
	g°w
 %
	gr9
, 40(%
	gr1
)

55 
	g°w
 %
	gr10
,44(%
	gr1
)

57 #i‚de‡
__NO_FPRS__


58 #√xà
ßve
 
Âr
 1 
to
 f¥ 8 (
Æig√d
Åo 8)

59 
	g°fd
 %
	gf1
, 48(%
	gr1
)

60 
	g°fd
 %
	gf2
, 56(%
	gr1
)

61 
	g°fd
 %
	gf3
, 64(%
	gr1
)

62 
	g°fd
 %
	gf4
, 72(%
	gr1
)

63 
	g°fd
 %
	gf5
, 80(%
	gr1
)

64 
	g°fd
 %
	gf6
, 88(%
	gr1
)

65 
	g°fd
 %
	gf7
, 96(%
	gr1
)

66 
	g°fd
 %
	gf8
, 104(%
	gr1
)

69 #£à
up
 
ªgi°îs
 
the
 
routöe
 
th©
 
a˘uÆly
 
d€s
Åhê
w‹k


70 #gë 
the
 
c⁄ãxt
 
poöãr
 
‰om
Åhê
åampﬁöe


71 
	gmr
 %
	gr3
,%
	gr11


73 #now 
lﬂd
 
up
 
the
 
poöãr
 
to
Åhê
ªsu…
 
°‹age


74 
	gaddi
 %
	gr4
,%
	gr1
,112

76 #now 
lﬂd
 
up
 
the
 
poöãr
 
to
Åhê
ßved
 
g¥
 
ªgi°îs


77 
	gaddi
 %
	gr5
,%
	gr1
,16

79 #now 
lﬂd
 
up
 
the
 
poöãr
 
to
Åhê
ßved
 
Âr
 
ªgi°îs
 */

80 
	gaddi
 %
	gr6
,%
	gr1
,48

82 #now 
lﬂd
 
up
 
the
 
poöãr
 
to
Åhê
outgoög
 
∑ømëî


83 #°ack 
ö
 
the
 
¥evious
 
‰ame


84 #i.
e
. 
the
 
¥evious
 
‰ame
 
poöãr
 + 8

85 
	gaddi
 %
	gr7
,%
	gr1
,152

87 #makê
the
 
ˇŒ


88 
bl
 
	gffi_˛osuª_hñ≥r_SYSV
@
	gloˇl


89 .
	gLªt
:

90 #now 
r3
 
c⁄èös
 
the
  
ty≥


91 #sÿ
u£
 
ô
 
to
 
look
 
up
 
ö
 
a
 
èbÀ


92 #sÿ
we
 
know
 
how
 
to
 
dól
 
wôh
 
óch
 
ty≥


94 #look 
up
 
the
 
¥›î
 
°¨tög
 
poöt
 
ö
 
èbÀ


95 #by 
usög
  
ty≥
 
as
 
off£t


97 
mÊr
 %
r4
 #movê
addªss
 
of
 .
Lªt
 
to
Ñ4

98 
¶wi
 %
r3
,%
	gr3
,4 #now 
mu…ùly
  
ty≥
 
	gby
 16

99 
	gaddi
 %
	gr4
, %r4, .
	gLªt_ty≥0
 - .
Lªt


100 
	glwz
 %
	gr0
,148(%
	gr1
)

101 
	gadd
 %
	gr3
,%r3,%
	gr4
 #add 
c⁄ã¡s
 
of
 
èbÀ
 
to
ÅabÀ 
addªss


102 
	gmt˘r
 %
r3


103 
	gb˘r
 #jum∞
to
 
	gô


104 .
	gLFE1
:

106 #Each 
of
 
the
 
ªt_ty≥X
 
code
 
‰agmíts
 
has
 
to
 
be
 
exa˘ly
 16 
byãs
 

107 #(4 
ö°ru˘i⁄s
). 
F‹
 
ˇche
 
ef„˘ivíess
 
we
 
Æign
 
to
 
a
 16 
byã
 
bound¨y


109 .
Æign
 4

110 #ˇ£ 
FFI_TYPE_VOID


111 .
Lªt_ty≥0
:

112 
mér
 %
r0


113 
addi
 %
r1
,%
	gr1
,144

114 
bÃ


115 
	gn›


117 #ˇ£ 
FFI_TYPE_INT


118 
	glwz
 %
	gr3
,112+0(%
	gr1
)

119 
	gmér
 %
	gr0


120 .
	gLföish
:

121 
addi
 %
r1
,%
	gr1
,144

122 
	gbÃ


124 #ˇ£ 
FFI_TYPE_FLOAT


125 #i‚de‡
__NO_FPRS__


126 
	glfs
 %
	gf1
,112+0(%
	gr1
)

127 
	gmér
 %
r0


128 
	gaddi
 %
	gr1
,%r1,144

130 
n›


131 
n›


132 
	gn›


134 
	gbÃ


136 #ˇ£ 
FFI_TYPE_DOUBLE


137 #i‚de‡
__NO_FPRS__


138 
	glfd
 %
	gf1
,112+0(%
	gr1
)

139 
	gmér
 %
r0


140 
	gaddi
 %
	gr1
,%r1,144

142 
n›


143 
n›


144 
	gn›


146 
	gbÃ


148 #ˇ£ 
FFI_TYPE_LONGDOUBLE


149 #i‚de‡
__NO_FPRS__


150 
	glfd
 %
	gf1
,112+0(%
	gr1
)

151 
	glfd
 %
	gf2
,112+8(%
	gr1
)

152 
	gmér
 %
r0


153 
	gb
 .
	gLföish


155 
n›


156 
n›


157 
n›


158 
	gbÃ


161 #ˇ£ 
FFI_TYPE_UINT8


162 #ifde‡
__LITTLE_ENDIAN__


163 
	glbz
 %
	gr3
,112+0(%
	gr1
)

165 
	glbz
 %
	gr3
,112+3(%
	gr1
)

167 
	gmér
 %
r0


168 
	gaddi
 %
	gr1
,%r1,144

169 
	gbÃ


171 #ˇ£ 
FFI_TYPE_SINT8


172 #ifde‡
__LITTLE_ENDIAN__


173 
	glbz
 %
	gr3
,112+0(%
	gr1
)

175 
	glbz
 %
	gr3
,112+3(%
	gr1
)

177 
	gextsb
 %
	gr3
,%
r3


178 
	gmér
 %
r0


179 
	gb
 .
	gLföish


181 #ˇ£ 
FFI_TYPE_UINT16


182 #ifde‡
__LITTLE_ENDIAN__


183 
	glhz
 %
	gr3
,112+0(%
	gr1
)

185 
	glhz
 %
	gr3
,112+2(%
	gr1
)

187 
	gmér
 %
r0


188 
	gaddi
 %
	gr1
,%r1,144

189 
	gbÃ


191 #ˇ£ 
FFI_TYPE_SINT16


192 #ifde‡
__LITTLE_ENDIAN__


193 
	glha
 %
	gr3
,112+0(%
	gr1
)

195 
	glha
 %
	gr3
,112+2(%
	gr1
)

197 
	gmér
 %
r0


198 
	gaddi
 %
	gr1
,%r1,144

199 
	gbÃ


201 #ˇ£ 
FFI_TYPE_UINT32


202 
	glwz
 %
	gr3
,112+0(%
	gr1
)

203 
	gmér
 %
r0


204 
	gaddi
 %
	gr1
,%r1,144

205 
	gbÃ


207 #ˇ£ 
FFI_TYPE_SINT32


208 
	glwz
 %
	gr3
,112+0(%
	gr1
)

209 
	gmér
 %
r0


210 
	gaddi
 %
	gr1
,%r1,144

211 
	gbÃ


213 #ˇ£ 
FFI_TYPE_UINT64


214 
	glwz
 %
	gr3
,112+0(%
	gr1
)

215 
	glwz
 %
	gr4
,112+4(%
	gr1
)

216 
	gmér
 %
r0


217 
	gb
 .
	gLföish


219 #ˇ£ 
FFI_TYPE_SINT64


220 
	glwz
 %
	gr3
,112+0(%
	gr1
)

221 
	glwz
 %
	gr4
,112+4(%
	gr1
)

222 
	gmér
 %
r0


223 
	gb
 .
	gLföish


225 #ˇ£ 
FFI_TYPE_STRUCT


226 
	gmér
 %
r0


227 
	gaddi
 %
	gr1
,%r1,144

228 
bÃ


229 
	gn›


231 #ˇ£ 
FFI_TYPE_POINTER


232 
	glwz
 %
	gr3
,112+0(%
	gr1
)

233 
	gmér
 %
r0


234 
	gaddi
 %
	gr1
,%r1,144

235 
	gbÃ


237 #ˇ£ 
FFI_TYPE_UINT128


238 
	glwz
 %
	gr3
,112+0(%
	gr1
)

239 
	glwz
 %
	gr4
,112+4(%
	gr1
)

240 
	glwz
 %
	gr5
,112+8(%
	gr1
)

241 
	gb
 .
	gLuöt128


243 #Thê 
ty≥s
 
bñow
 
¨e
 
⁄ly
 
u£d
 
whí
 
the
 
ABI
 
ty≥
 
is
 
FFI_SYSV
.

244 #ˇ£ 
FFI_SYSV_TYPE_SMALL_STRUCT
 + 1. 
O√
 
byã
 .

245 
	glbz
 %
	gr3
,112+0(%
	gr1
)

246 
	gmér
 %
r0


247 
	gaddi
 %
	gr1
,%r1,144

248 
	gbÃ


250 #ˇ£ 
FFI_SYSV_TYPE_SMALL_STRUCT
 + 2. 
Two
 
byã
 .

251 
	glhz
 %
	gr3
,112+0(%
	gr1
)

252 
	gmér
 %
r0


253 
	gaddi
 %
	gr1
,%r1,144

254 
	gbÃ


256 #ˇ£ 
FFI_SYSV_TYPE_SMALL_STRUCT
 + 3. 
Thªe
 
byã
 .

257 
	glwz
 %
	gr3
,112+0(%
	gr1
)

258 #ifde‡
__LITTLE_ENDIAN__


259 
	gmér
 %
r0


260 
	gaddi
 %
	gr1
,%r1,144

261 
	gbÃ


263 
	g§wi
 %
	gr3
,%r3,8

264 
	gmér
 %
r0


265 
	gb
 .
	gLföish


268 #ˇ£ 
FFI_SYSV_TYPE_SMALL_STRUCT
 + 4. 
Four
 
byã
 .

269 
	glwz
 %
	gr3
,112+0(%
	gr1
)

270 
	gmér
 %
r0


271 
	gaddi
 %
	gr1
,%r1,144

272 
	gbÃ


274 #ˇ£ 
FFI_SYSV_TYPE_SMALL_STRUCT
 + 5. 
Five
 
byã
 .

275 
	glwz
 %
	gr3
,112+0(%
	gr1
)

276 
	glwz
 %
	gr4
,112+4(%
	gr1
)

277 #ifde‡
__LITTLE_ENDIAN__


278 
	gmér
 %
r0


279 
	gb
 .
	gLföish


281 
	gli
 %
	gr5
,24

282 
	gb
 .
	gL°ru˘567


285 #ˇ£ 
FFI_SYSV_TYPE_SMALL_STRUCT
 + 6. 
Six
 
byã
 .

286 
	glwz
 %
	gr3
,112+0(%
	gr1
)

287 
	glwz
 %
	gr4
,112+4(%
	gr1
)

288 #ifde‡
__LITTLE_ENDIAN__


289 
	gmér
 %
r0


290 
	gb
 .
	gLföish


292 
	gli
 %
	gr5
,16

293 
	gb
 .
	gL°ru˘567


296 #ˇ£ 
FFI_SYSV_TYPE_SMALL_STRUCT
 + 7. 
Seví
 
byã
 .

297 
	glwz
 %
	gr3
,112+0(%
	gr1
)

298 
	glwz
 %
	gr4
,112+4(%
	gr1
)

299 #ifde‡
__LITTLE_ENDIAN__


300 
	gmér
 %
r0


301 
	gb
 .
	gLföish


303 
	gli
 %
	gr5
,8

304 
	gb
 .
	gL°ru˘567


307 #ˇ£ 
FFI_SYSV_TYPE_SMALL_STRUCT
 + 8. 
Eight
 
byã
 .

308 
	glwz
 %
	gr3
,112+0(%
	gr1
)

309 
	glwz
 %
	gr4
,112+4(%
	gr1
)

310 
	gmér
 %
r0


311 
	gb
 .
	gLföish


313 #i‚de‡
__LITTLE_ENDIAN__


314 .
	gL°ru˘567
:

315 
subfic
 %
r6
,%
	gr5
,32

316 
	g§w
 %
	gr4
,%r4,%
r5


317 
	g¶w
 %
	gr6
,%
	gr3
,%
r6


318 
	g§w
 %
	gr3
,%r3,%
r5


319 
	g‹
 %
	gr4
,%
	gr6
,%
r4


320 
	gmér
 %
r0


321 
	gaddi
 %
	gr1
,%r1,144

322 
	gbÃ


325 .
	gLuöt128
:

326 
lwz
 %
r6
,112+12(%
	gr1
)

327 
	gmér
 %
r0


328 
	gaddi
 %
	gr1
,%r1,144

329 
bÃ


331 
END
(
ffi_˛osuª_SYSV
)

333 .
	g£˘i⁄
 ".eh_‰ame",
	gEH_FRAME_FLAGS
,@
	g¥ogbôs


334 .
	gL‰ame1
:

335 .4b
yã
 .
LECIE1
-.
LSCIE1
 #Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


336 .
LSCIE1
:

337 .4b
yã
 0x0 #CIE 
Idítifõr
 
Tag


338 .
byã
 0x1 #CIE 
Vîsi⁄


339 #i‡
deföed
 
_RELOCATABLE
 || deföed 
__PIC__


340 .
ascii
 "zR\0" #CIE 
Augmíèti⁄


342 .
ascii
 "\0" #CIE 
Augmíèti⁄


344 .
uÀb128
 0x1 #CIE 
Code
 
Alignmít
 
Fa˘‹


345 .
¶eb128
 -4 #CIE 
D©a
 
Alignmít
 
Fa˘‹


346 .
byã
 0x41 #CIE 
RA
 
Cﬁumn


347 #i‡
deföed
 
_RELOCATABLE
 || deföed 
__PIC__


348 .
uÀb128
 0x1 #Augmíèti⁄ 
size


349 .
byã
 0x1b #FDE 
	$Encodög
 (
p¸ñ
 
sd©a4
)

351 .
byã
 0xc #DW_CFA_def_cfa

352 .
uÀb128
 0x1

353 .
uÀb128
 0x0

354 .
Æign
 2

355 .
LECIE1
:

356 .
LSFDE1
:

357 .4b
yã
 .
LEFDE1
-.
LASFDE1
 #FDE 
Lígth


358 .
LASFDE1
:

359 .4b
yã
 .
LASFDE1
-.
L‰ame1
 #FDE 
CIE
 
off£t


360 #i‡
deföed
 
_RELOCATABLE
 || deföed 
__PIC__


361 .4b
yã
 .
LFB1
-. #FDE 
öôül
 
loˇti⁄


363 .4b
yã
 .
LFB1
 #FDE 
öôül
 
loˇti⁄


365 .4b
yã
 .
LFE1
-.
LFB1
 #FDE 
addªss
 
ønge


366 #i‡
deföed
 
_RELOCATABLE
 || deföed 
__PIC__


367 .
uÀb128
 0x0 #Augmíèti⁄ 
size


369 .
byã
 0x4 #DW_CFA_advance_loc4

370 .4b
yã
 .
LCFI0
-.
LFB1


371 .
byã
 0xe #DW_CFA_def_cfa_offset

372 .
uÀb128
 144

373 .
byã
 0x4 #DW_CFA_advance_loc4

374 .4b
yã
 .
LCFI1
-.
LCFI0


375 .
byã
 0x11 #DW_CFA_offset_extended_sf

376 .
uÀb128
 0x41

377 .
¶eb128
 -1

378 .
Æign
 2

379 .
LEFDE1
:

381 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


382 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/sysv.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

31 
	~<powîpc/asm.h
>

33 #i‚de‡
POWERPC64


34 .
globl
 
ffi_¥ï_¨gs_SYSV


35 
ENTRY
(
ffi_ˇŒ_SYSV
)

36 .
	gLFB1
:

38 
mr
 %
r8
,%
	gr1


40 .
	gLCFI0
:

42 
°wux
 %
r1
,%
	gr1
,%
r4


44 
	gmÊr
 %
r9


45 
	g°w
 %
	gr28
,-16(%
	gr8
)

46 .
	gLCFI1
:

47 
°w
 %
r29
,-12(%
	gr8
)

48 .
	gLCFI2
:

49 
°w
 %
r30
, -8(%
	gr8
)

50 .
	gLCFI3
:

51 
°w
 %
r31
, -4(%
	gr8
)

52 .
	gLCFI4
:

53 
°w
 %
r9
, 4(%
	gr8
)

54 .
	gLCFI5
:

57 
mr
 %
r31
,%
r5


58 
	gmr
 %
	gr30
,%
r6


59 
	gmr
 %
	gr29
,%
r7


60 
	gmr
 %
	gr28
,%
	gr8


61 .
	gLCFI6
:

64 
mr
 %
r4
,%
r1


65 
bl
 
	gffi_¥ï_¨gs_SYSV
@
loˇl


69 
	gmt¸f
 0x40,%
r31


71 
	gmt˘r
 %
r29


73 
	glwz
 %
	gr3
,-16-(8*4)(%
	gr28
)

74 
	glwz
 %
	gr4
,-16-(7*4)(%
	gr28
)

75 
	glwz
 %
	gr5
,-16-(6*4)(%
	gr28
)

76 
	glwz
 %
	gr6
,-16-(5*4)(%
	gr28
)

77 
	gbf
- 5,1f

78 
n›


79 
	glwz
 %
	gr7
,-16-(4*4)(%
	gr28
)

80 
	glwz
 %
	gr8
,-16-(3*4)(%
	gr28
)

81 
	glwz
 %
	gr9
,-16-(2*4)(%
	gr28
)

82 
	glwz
 %
	gr10
,-16-(1*4)(%
	gr28
)

83 
	gn›


86 #i‚de‡
__NO_FPRS__


88 
bf
- 6,2f

89 
	glfd
 %
	gf1
,-16-(8*4)-(8*8)(%
	gr28
)

90 
	glfd
 %
	gf2
,-16-(8*4)-(7*8)(%
	gr28
)

91 
	glfd
 %
	gf3
,-16-(8*4)-(6*8)(%
	gr28
)

92 
	glfd
 %
	gf4
,-16-(8*4)-(5*8)(%
	gr28
)

93 
n›


94 
	glfd
 %
	gf5
,-16-(8*4)-(4*8)(%
	gr28
)

95 
	glfd
 %
	gf6
,-16-(8*4)-(3*8)(%
	gr28
)

96 
	glfd
 %
	gf7
,-16-(8*4)-(2*8)(%
	gr28
)

97 
	glfd
 %
	gf8
,-16-(8*4)-(1*8)(%
	gr28
)

102 
b˘æ


105 
mt¸f
 0x01,%
r31


106 
	gbt
- 31,
	$L
(
smÆl_°ru˘_ªtu∫_vÆue
)

107 
bt
- 30,
	$L
(
d⁄e_ªtu∫_vÆue
)

108 #i‚de‡
__NO_FPRS__


109 
bt
- 29,
	$L
(
Â_ªtu∫_vÆue
)

111 
°w
 %
r3
,0(%
r30
)

112 
bf
+ 28,
	$L
(
d⁄e_ªtu∫_vÆue
)

113 
°w
 %
r4
,4(%
r30
)

114 
mt¸f
 0x02,%
r31


115 
bf
 27,
	$L
(
d⁄e_ªtu∫_vÆue
)

116 
°w
 %
r5
,8(%
r30
)

117 
°w
 %
r6
,12(%
r30
)

120 
	$L
(
d⁄e_ªtu∫_vÆue
):

122 
lwz
 %
r9
, 4(%
r28
)

123 
lwz
 %
r31
, -4(%
r28
)

124 
mér
 %
r9


125 
lwz
 %
r30
, -8(%
r28
)

126 
lwz
 %
r29
,-12(%
r28
)

127 
lwz
 %
r28
,-16(%r28)

128 
lwz
 %
r1
,0(%r1)

129 
bÃ


131 #i‚de‡
__NO_FPRS__


132 
	$L
(
Â_ªtu∫_vÆue
):

133 
bf
 28,
	$L
(
Êﬂt_ªtu∫_vÆue
)

134 
°fd
 %
f1
,0(%
r30
)

135 
mt¸f
 0x02,%
r31


136 
bf
 27,
	$L
(
d⁄e_ªtu∫_vÆue
)

137 
°fd
 %
f2
,8(%
r30
)

138 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

139 
	$L
(
Êﬂt_ªtu∫_vÆue
):

140 
°fs
 %
f1
,0(%
r30
)

141 
b
 
	$L
(
d⁄e_ªtu∫_vÆue
)

144 
	$L
(
smÆl_°ru˘_ªtu∫_vÆue
):

150 
°w
 %
r3
, 0(%
r30
)

151 
°w
 %
r4
, 4(%
r30
)

152 
b
 
	`L
(
d⁄e_ªtu∫_vÆue
)

154 .
LFE1
:

155 
	`END
(
ffi_ˇŒ_SYSV
)

157 .
£˘i⁄
 ".eh_‰ame",
EH_FRAME_FLAGS
,@
¥ogbôs


158 .
L‰ame1
:

159 .4b
yã
 .
LECIE1
-.
LSCIE1


160 .
LSCIE1
:

161 .4b
yã
 0x0

162 .
byã
 0x1

163 #i‡
deföed
 
_RELOCATABLE
 || deföed 
__PIC__


164 .
ascii
 "zR\0"

166 .
ascii
 "\0"

168 .
uÀb128
 0x1

169 .
¶eb128
 -4

170 .
byã
 0x41

171 #i‡
deföed
 
_RELOCATABLE
 || deföed 
__PIC__


172 .
uÀb128
 0x1

173 .
byã
 0x1b

175 .
byã
 0xc

176 .
uÀb128
 0x1

177 .
uÀb128
 0x0

178 .
Æign
 2

179 .
LECIE1
:

180 .
LSFDE1
:

181 .4b
yã
 .
LEFDE1
-.
LASFDE1


182 .
LASFDE1
:

183 .4b
yã
 .
LASFDE1
-.
L‰ame1


184 #i‡
deföed
 
_RELOCATABLE
 || deföed 
__PIC__


185 .4b
yã
 .
LFB1
-.

187 .4b
yã
 .
LFB1


189 .4b
yã
 .
LFE1
-.
LFB1


190 #i‡
deföed
 
_RELOCATABLE
 || deföed 
__PIC__


191 .
uÀb128
 0x0

193 .
byã
 0x4

194 .4b
yã
 .
LCFI0
-.
LFB1


195 .
byã
 0xd

196 .
uÀb128
 0x08

197 .
byã
 0x4

198 .4b
yã
 .
LCFI5
-.
LCFI0


199 .
byã
 0x11

200 .
uÀb128
 0x41

201 .
¶eb128
 -1

202 .
byã
 0x9f

203 .
uÀb128
 0x1

204 .
byã
 0x9e

205 .
uÀb128
 0x2

206 .
byã
 0x9d

207 .
uÀb128
 0x3

208 .
byã
 0x9c

209 .
uÀb128
 0x4

210 .
byã
 0x4

211 .4b
yã
 .
LCFI6
-.
LCFI5


212 .
byã
 0xd

213 .
uÀb128
 0x1c

214 .
Æign
 2

215 .
LEFDE1
:

217 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


218 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/prep_cif.c

26 
	~<ffi.h
>

27 
	~<ffi_comm⁄.h
>

28 
	~<°dlib.h
>

32 
	#STACK_ARG_SIZE
(
x
Ë
	`ALIGN
(x, 
FFI_SIZEOF_ARG
)

	)

37 
ffi_°©us
 
	$öôülize_aggªg©e
(
ffi_ty≥
 *
¨g
)

39 
ffi_ty≥
 **
±r
;

41 i‡(
	`UNLIKELY
(
¨g
 =
NULL
 ||árg->
ñemíts
 == NULL))

42  
FFI_BAD_TYPEDEF
;

44 
¨g
->
size
 = 0;

45 
¨g
->
Æignmít
 = 0;

47 
±r
 = &(
¨g
->
ñemíts
[0]);

49 i‡(
	`UNLIKELY
(
±r
 == 0))

50  
FFI_BAD_TYPEDEF
;

52 (*
±r
Ë!
NULL
)

54 i‡(
	`UNLIKELY
(((*
±r
)->
size
 == 0)

55 && (
	`öôülize_aggªg©e
((*
±r
)Ë!
FFI_OK
)))

56  
FFI_BAD_TYPEDEF
;

59 
	`FFI_ASSERT_VALID_TYPE
(*
±r
);

61 
¨g
->
size
 = 
	`ALIGN
◊rg->size, (*
±r
)->
Æignmít
);

62 
¨g
->
size
 +(*
±r
)->size;

64 
¨g
->
Æignmít
 = (¨g->Æignmíà> (*
±r
)->alignment) ?

65 
¨g
->
Æignmít
 : (*
±r
)->alignment;

67 
±r
++;

77 
¨g
->
size
 = 
	`ALIGN
 (¨g->size,árg->
Æignmít
);

81 #ifde‡
FFI_AGGREGATE_ALIGNMENT


82 i‡(
FFI_AGGREGATE_ALIGNMENT
 > 
¨g
->
Æignmít
)

83 
¨g
->
Æignmít
 = 
FFI_AGGREGATE_ALIGNMENT
;

86 i‡(
¨g
->
size
 == 0)

87  
FFI_BAD_TYPEDEF
;

89  
FFI_OK
;

90 
	}
}

92 #i‚de‡
__CRIS__


107 
ffi_°©us
 
FFI_HIDDEN
 
	$ffi_¥ï_cif_c‹e
(
ffi_cif
 *
cif
, 
ffi_abi
 
abi
,

108 
isv¨üdic
,

109 
nfixed¨gs
,

110 
¡ŸÆ¨gs
,

111 
ffi_ty≥
 *
πy≥
, ffi_ty≥ **
©y≥s
)

113 
byãs
 = 0;

114 
i
;

115 
ffi_ty≥
 **
±r
;

117 
	`FFI_ASSERT
(
cif
 !
NULL
);

118 
	`FFI_ASSERT
((!
isv¨üdic
Ë|| (
nfixed¨gs
 >= 1));

119 
	`FFI_ASSERT
(
nfixed¨gs
 <
¡ŸÆ¨gs
);

121 i‡(! (
abi
 > 
FFI_FIRST_ABI
 &&ábò< 
FFI_LAST_ABI
))

122  
FFI_BAD_ABI
;

124 
cif
->
abi
 =ábi;

125 
cif
->
¨g_ty≥s
 = 
©y≥s
;

126 
cif
->
«rgs
 = 
¡ŸÆ¨gs
;

127 
cif
->
πy≥
 =Ñtype;

129 
cif
->
Êags
 = 0;

131 #i‡
HAVE_LONG_DOUBLE_VARIANT


132 
	`ffi_¥ï_ty≥s
 (
abi
);

136 i‡((
cif
->
πy≥
->
size
 =0Ë&& (
	`öôülize_aggªg©e
(cif->πy≥Ë!
FFI_OK
))

137  
FFI_BAD_TYPEDEF
;

139 #i‚de‡
FFI_TARGET_HAS_COMPLEX_TYPE


140 i‡(
πy≥
->
ty≥
 =
FFI_TYPE_COMPLEX
)

141 
	`ab‹t
();

144 
	`FFI_ASSERT_VALID_TYPE
(
cif
->
πy≥
);

147 #i‡!
deföed
 
FFI_TARGET_SPECIFIC_STACK_SPACE_ALLOCATION


149 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


150 #ifde‡
SPARC


151 && (
cif
->
abi
 !
FFI_V9
 || cif->
πy≥
->
size
 > 32)

153 #ifde‡
TILE


154 && (
cif
->
πy≥
->
size
 > 10 * 
FFI_SIZEOF_ARG
)

156 #ifde‡
XTENSA


157 && (
cif
->
πy≥
->
size
 > 16)

159 #ifde‡
NIOS2


160 && (
cif
->
πy≥
->
size
 > 8)

163 
byãs
 = 
	`STACK_ARG_SIZE
((*));

166 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = cif->
«rgs
; i > 0; i--,Ötr++)

170 i‡(((*
±r
)->
size
 =0Ë&& (
	`öôülize_aggªg©e
((*±r)Ë!
FFI_OK
))

171  
FFI_BAD_TYPEDEF
;

173 #i‚de‡
FFI_TARGET_HAS_COMPLEX_TYPE


174 i‡((*
±r
)->
ty≥
 =
FFI_TYPE_COMPLEX
)

175 
	`ab‹t
();

179 
	`FFI_ASSERT_VALID_TYPE
(*
±r
);

181 #i‡!
deföed
 
FFI_TARGET_SPECIFIC_STACK_SPACE_ALLOCATION


182 #ifde‡
SPARC


183 i‡(((*
±r
)->
ty≥
 =
FFI_TYPE_STRUCT


184 && ((*
±r
)->
size
 > 16 || 
cif
->
abi
 !
FFI_V9
))

185 || ((*
±r
)->
ty≥
 =
FFI_TYPE_LONGDOUBLE


186 && 
cif
->
abi
 !
FFI_V9
))

187 
byãs
 += (*);

192 i‡(((*
±r
)->
Æignmít
 - 1Ë& 
byãs
)

193 
byãs
 = ()
	`ALIGN
(byãs, (*
±r
)->
Æignmít
);

195 #ifde‡
TILE


196 i‡(
byãs
 < 10 * 
FFI_SIZEOF_ARG
 &&

197 
byãs
 + 
	`STACK_ARG_SIZE
((*
±r
)->
size
Ë> 10 * 
FFI_SIZEOF_ARG
)

201 
byãs
 = 10 * 
FFI_SIZEOF_ARG
;

204 #ifde‡
XTENSA


205 i‡(
byãs
 <6*4 && byã†+ 
	`STACK_ARG_SIZE
((*
±r
)->
size
) > 6*4)

206 
byãs
 = 6*4;

209 
byãs
 +
	`STACK_ARG_SIZE
((*
±r
)->
size
);

214 
cif
->
byãs
 = bytes;

217 #ifde‡
FFI_TARGET_SPECIFIC_VARIADIC


218 i‡(
isv¨üdic
)

219  
	`ffi_¥ï_cif_machdï_v¨
(
cif
, 
nfixed¨gs
, 
¡ŸÆ¨gs
);

222  
	`ffi_¥ï_cif_machdï
(
cif
);

223 
	}
}

226 
ffi_°©us
 
	$ffi_¥ï_cif
(
ffi_cif
 *
cif
, 
ffi_abi
 
abi
, 
«rgs
,

227 
ffi_ty≥
 *
πy≥
, ffi_ty≥ **
©y≥s
)

229  
	`ffi_¥ï_cif_c‹e
(
cif
, 
abi
, 0, 
«rgs
,Ç¨gs, 
πy≥
, 
©y≥s
);

230 
	}
}

232 
ffi_°©us
 
	$ffi_¥ï_cif_v¨
(
ffi_cif
 *
cif
,

233 
ffi_abi
 
abi
,

234 
nfixed¨gs
,

235 
¡ŸÆ¨gs
,

236 
ffi_ty≥
 *
πy≥
,

237 
ffi_ty≥
 **
©y≥s
)

239  
	`ffi_¥ï_cif_c‹e
(
cif
, 
abi
, 1, 
nfixed¨gs
, 
¡ŸÆ¨gs
, 
πy≥
, 
©y≥s
);

240 
	}
}

242 #i‡
FFI_CLOSURES


244 
ffi_°©us


245 
ffi_¥ï_˛osuª
 (
ffi_˛osuª
* 
˛osuª
,

246 
ffi_cif
* 
cif
,

247 (*
fun
)(
ffi_cif
*,*,**,*),

248 *
u£r_d©a
)

250  
	`ffi_¥ï_˛osuª_loc
 (
˛osuª
, 
cif
, 
fun
, 
u£r_d©a
, closure);

251 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/raw_api.c

29 
	~<ffi.h
>

30 
	~<ffi_comm⁄.h
>

32 #i‡!
FFI_NO_RAW_API


34 
size_t


35 
	$ffi_øw_size
 (
ffi_cif
 *
cif
)

37 
size_t
 
ªsu…
 = 0;

38 
i
;

40 
ffi_ty≥
 **
©
 = 
cif
->
¨g_ty≥s
;

42 
i
 = 
cif
->
«rgs
-1; i >0; i--, 
©
++)

44 #i‡!
FFI_NO_STRUCTS


45 i‡((*
©
)->
ty≥
 =
FFI_TYPE_STRUCT
)

46 
ªsu…
 +
	`ALIGN
 ( (*), 
FFI_SIZEOF_ARG
);

49 
ªsu…
 +
	`ALIGN
 ((*
©
)->
size
, 
FFI_SIZEOF_ARG
);

52  
ªsu…
;

53 
	}
}

57 
	$ffi_øw_to_±øºay
 (
ffi_cif
 *
cif
, 
ffi_øw
 *
øw
, **
¨gs
)

59 
i
;

60 
ffi_ty≥
 **
ç
 = 
cif
->
¨g_ty≥s
;

62 #i‡
WORDS_BIGENDIAN


64 
i
 = 0; i < 
cif
->
«rgs
; i++, 
ç
++, 
¨gs
++)

66 (*
ç
)->
ty≥
)

68 
FFI_TYPE_UINT8
:

69 
FFI_TYPE_SINT8
:

70 *
¨gs
 = (*Ë((*)(
øw
++Ë+ 
FFI_SIZEOF_ARG
 - 1);

73 
FFI_TYPE_UINT16
:

74 
FFI_TYPE_SINT16
:

75 *
¨gs
 = (*Ë((*)(
øw
++Ë+ 
FFI_SIZEOF_ARG
 - 2);

78 #i‡
FFI_SIZEOF_ARG
 >= 4

79 
FFI_TYPE_UINT32
:

80 
FFI_TYPE_SINT32
:

81 *
¨gs
 = (*Ë((*)(
øw
++Ë+ 
FFI_SIZEOF_ARG
 - 4);

85 #i‡!
FFI_NO_STRUCTS


86 
FFI_TYPE_STRUCT
:

87 *
¨gs
 = (
øw
++)->
±r
;

91 
FFI_TYPE_COMPLEX
:

92 *
¨gs
 = (
øw
++)->
±r
;

95 
FFI_TYPE_POINTER
:

96 *
¨gs
 = (*Ë&(
øw
++)->
±r
;

100 *
¨gs
 = 
øw
;

101 
øw
 +
	`ALIGN
 ((*
ç
)->
size
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

107 #i‡!
PDP


110 
i
 = 0; i < 
cif
->
«rgs
; i++, 
ç
++, 
¨gs
++)

112 #i‡!
FFI_NO_STRUCTS


113 i‡((*
ç
)->
ty≥
 =
FFI_TYPE_STRUCT
)

115 *
¨gs
 = (
øw
++)->
±r
;

119 i‡((*
ç
)->
ty≥
 =
FFI_TYPE_COMPLEX
)

121 *
¨gs
 = (
øw
++)->
±r
;

125 *
¨gs
 = (*Ë
øw
;

126 
øw
 +
	`ALIGN
 ((*
ç
)->
size
,  (*)) /  (*);

135 
	}
}

138 
	$ffi_±øºay_to_øw
 (
ffi_cif
 *
cif
, **
¨gs
, 
ffi_øw
 *
øw
)

140 
i
;

141 
ffi_ty≥
 **
ç
 = 
cif
->
¨g_ty≥s
;

143 
i
 = 0; i < 
cif
->
«rgs
; i++, 
ç
++, 
¨gs
++)

145 (*
ç
)->
ty≥
)

147 
FFI_TYPE_UINT8
:

148 (
øw
++)->
uöt
 = *(
UINT8
*Ë(*
¨gs
);

151 
FFI_TYPE_SINT8
:

152 (
øw
++)->
söt
 = *(
SINT8
*Ë(*
¨gs
);

155 
FFI_TYPE_UINT16
:

156 (
øw
++)->
uöt
 = *(
UINT16
*Ë(*
¨gs
);

159 
FFI_TYPE_SINT16
:

160 (
øw
++)->
söt
 = *(
SINT16
*Ë(*
¨gs
);

163 #i‡
FFI_SIZEOF_ARG
 >= 4

164 
FFI_TYPE_UINT32
:

165 (
øw
++)->
uöt
 = *(
UINT32
*Ë(*
¨gs
);

168 
FFI_TYPE_SINT32
:

169 (
øw
++)->
söt
 = *(
SINT32
*Ë(*
¨gs
);

173 #i‡!
FFI_NO_STRUCTS


174 
FFI_TYPE_STRUCT
:

175 (
øw
++)->
±r
 = *
¨gs
;

179 
FFI_TYPE_COMPLEX
:

180 (
øw
++)->
±r
 = *
¨gs
;

183 
FFI_TYPE_POINTER
:

184 (
øw
++)->
±r
 = **(***Ë
¨gs
;

188 
	`mem˝y
 ((*Ë
øw
->
d©a
, (*)*
¨gs
, (*
ç
)->
size
);

189 
øw
 +
	`ALIGN
 ((*
ç
)->
size
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

192 
	}
}

194 #i‡!
FFI_NATIVE_RAW_API


204 
ffi_øw_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, 
ffi_øw
 *
øw
)

206 **
avÆue
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

207 
	`ffi_øw_to_±øºay
 (
cif
, 
øw
, 
avÆue
);

208 
	`ffi_ˇŒ
 (
cif
, 
‚
, 
rvÆue
, 
avÆue
);

209 
	}
}

211 #i‡
FFI_CLOSURES


214 
	$ffi_å™¶©e_¨gs
 (
ffi_cif
 *
cif
, *
rvÆue
,

215 **
avÆue
, *
u£r_d©a
)

217 
ffi_øw
 *
øw
 = (ffi_øw*)
	`Æloˇ
 (
	`ffi_øw_size
 (
cif
));

218 
ffi_øw_˛osuª
 *
˛
 = (ffi_øw_˛osuª*)
u£r_d©a
;

220 
	`ffi_±øºay_to_øw
 (
cif
, 
avÆue
, 
øw
);

221 (*
˛
->
fun
Ë(
cif
, 
rvÆue
, 
øw
, cl->
u£r_d©a
);

222 
	}
}

224 
ffi_°©us


225 
ffi_¥ï_øw_˛osuª_loc
 (
ffi_øw_˛osuª
* 
˛
,

226 
ffi_cif
 *
cif
,

227 (*
fun
)(
ffi_cif
*,*,
ffi_øw
*,*),

228 *
u£r_d©a
,

229 *
codñoc
)

231 
ffi_°©us
 
°©us
;

233 
°©us
 = 
	`ffi_¥ï_˛osuª_loc
 ((
ffi_˛osuª
*Ë
˛
,

234 
cif
,

235 &
ffi_å™¶©e_¨gs
,

236 
codñoc
,

237 
codñoc
);

238 i‡(
°©us
 =
FFI_OK
)

240 
˛
->
fun
 = fun;

241 
˛
->
u£r_d©a
 = user_data;

244  
°©us
;

245 
	}
}

250 #i‡
FFI_CLOSURES


256 
ffi_°©us


257 
ffi_¥ï_øw_˛osuª
 (
ffi_øw_˛osuª
* 
˛
,

258 
ffi_cif
 *
cif
,

259 (*
fun
)(
ffi_cif
*,*,
ffi_øw
*,*),

260 *
u£r_d©a
)

262  
	`ffi_¥ï_øw_˛osuª_loc
 (
˛
, 
cif
, 
fun
, 
u£r_d©a
, cl);

263 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/s390/ffi.c

31 
	~<ffi.h
>

32 
	~<ffi_comm⁄.h
>

34 
	~<°dlib.h
>

35 
	~<°dio.h
>

45 
	#MAX_GPRARGS
 5

	)

48 #ifde‡
__s390x__


49 
	#MAX_FPRARGS
 4

	)

51 
	#MAX_FPRARGS
 2

	)

55 
	#ROUND_SIZE
(
size
Ë(((sizeË+ 15Ë& ~15)

	)

58 
	#FFI390_RET_VOID
 0

	)

59 
	#FFI390_RET_STRUCT
 1

	)

60 
	#FFI390_RET_FLOAT
 2

	)

61 
	#FFI390_RET_DOUBLE
 3

	)

62 
	#FFI390_RET_INT32
 4

	)

63 
	#FFI390_RET_INT64
 5

	)

72 
ffi_¥ï_¨gs
 (*, 
exãnded_cif
 *);

74 #i‡
__GNUC__
 > 3 || (__GNUC__ =3 && 
__GNUC_MINOR__
 > 2)

75 
__©åibuã__
 ((
visibûôy
 ("hidden")))

77 
ffi_˛osuª_hñ≥r_SYSV
 (
ffi_˛osuª
 *, *,

87 
ffi_ˇŒ_SYSV
(,

88 
exãnded_cif
 *,

89 (*)(*, 
exãnded_cif
 *),

92 (*
‚
)());

94 
	`ffi_˛osuª_SYSV
();

108 
	$ffi_check_°ru˘_ty≥
 (
ffi_ty≥
 *
¨g
)

110 
size_t
 
size
 = 
¨g
->size;

114 
¨g
->
ty≥
 =
FFI_TYPE_STRUCT


115 && 
¨g
->
ñemíts
[0] && !arg->elements[1])

116 
¨g
 =árg->
ñemíts
[0];

120 
size
)

123  
FFI_TYPE_UINT8
;

126  
FFI_TYPE_UINT16
;

129 i‡(
¨g
->
ty≥
 =
FFI_TYPE_FLOAT
)

130  
FFI_TYPE_FLOAT
;

132  
FFI_TYPE_UINT32
;

135 i‡(
¨g
->
ty≥
 =
FFI_TYPE_DOUBLE
)

136  
FFI_TYPE_DOUBLE
;

138  
FFI_TYPE_UINT64
;

145  
FFI_TYPE_POINTER
;

146 
	}
}

162 
	$ffi_¥ï_¨gs
 (*
°ack
, 
exãnded_cif
 *
ecif
)

180 
g¥_off
 = 
ecif
->
cif
->
byãs
;

181 
Âr_off
 = 
g¥_off
 + 
	`ROUND_SIZE
 (
MAX_GPRARGS
 *  ());

183 *
p_Âr
 = (*)(
°ack
 + 
Âr_off
);

184 *
p_g¥
 = (*)(
°ack
 + 
g¥_off
);

185 *
p_°ru˘
 = (*)
p_g¥
;

186 *
p_ov
 = (*)
°ack
;

188 
n_Âr
 = 0;

189 
n_g¥
 = 0;

190 
n_ov
 = 0;

192 
ffi_ty≥
 **
±r
;

193 **
p_¨gv
 = 
ecif
->
avÆue
;

194 
i
;

199 i‡(
ecif
->
cif
->
Êags
 =
FFI390_RET_STRUCT
)

200 
p_g¥
[
n_g¥
++] = (Ë
ecif
->
rvÆue
;

204 
±r
 = 
ecif
->
cif
->
¨g_ty≥s
, 
i
 =Écif->cif->
«rgs
;

205 
i
 > 0;

206 
i
--, 
±r
++, 
p_¨gv
++)

208 *
¨g
 = *
p_¨gv
;

209 
ty≥
 = (*
±r
)->type;

211 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


213 i‡(
ty≥
 =
FFI_TYPE_LONGDOUBLE
)

214 
ty≥
 = 
FFI_TYPE_STRUCT
;

218 i‡(
ty≥
 =
FFI_TYPE_STRUCT
 ||Åy≥ =
FFI_TYPE_COMPLEX
)

220 i‡(
ty≥
 =
FFI_TYPE_COMPLEX
)

221 
ty≥
 = 
FFI_TYPE_POINTER
;

223 
ty≥
 = 
	`ffi_check_°ru˘_ty≥
 (*
±r
);

226 i‡(
ty≥
 =
FFI_TYPE_POINTER
)

228 
p_°ru˘
 -
	`ROUND_SIZE
 ((*
±r
)->
size
);

229 
	`mem˝y
 (
p_°ru˘
, (*)
¨g
, (*
±r
)->
size
);

230 
¨g
 = &
p_°ru˘
;

235 
ty≥
)

237 
FFI_TYPE_DOUBLE
:

238 i‡(
n_Âr
 < 
MAX_FPRARGS
)

239 
p_Âr
[
n_Âr
++] = *(*Ë
¨g
;

241 #ifde‡
__s390x__


242 
p_ov
[
n_ov
++] = *(*Ë
¨g
;

244 
p_ov
[
n_ov
++] = ((*Ë
¨g
)[0],

245 
p_ov
[
n_ov
++] = ((*Ë
¨g
)[1];

249 
FFI_TYPE_FLOAT
:

250 i‡(
n_Âr
 < 
MAX_FPRARGS
)

251 
p_Âr
[
n_Âr
++] = (Ë*(*Ë
¨g
 << 32;

253 
p_ov
[
n_ov
++] = *(*Ë
¨g
;

256 
FFI_TYPE_POINTER
:

257 i‡(
n_g¥
 < 
MAX_GPRARGS
)

258 
p_g¥
[
n_g¥
++] = ()*(**Ë
¨g
;

260 
p_ov
[
n_ov
++] = ()*(**Ë
¨g
;

263 
FFI_TYPE_UINT64
:

264 
FFI_TYPE_SINT64
:

265 #ifde‡
__s390x__


266 i‡(
n_g¥
 < 
MAX_GPRARGS
)

267 
p_g¥
[
n_g¥
++] = *(*Ë
¨g
;

269 
p_ov
[
n_ov
++] = *(*Ë
¨g
;

271 i‡(
n_g¥
 =
MAX_GPRARGS
-1)

272 
n_g¥
 = 
MAX_GPRARGS
;

273 i‡(
n_g¥
 < 
MAX_GPRARGS
)

274 
p_g¥
[
n_g¥
++] = ((*Ë
¨g
)[0],

275 
p_g¥
[
n_g¥
++] = ((*Ë
¨g
)[1];

277 
p_ov
[
n_ov
++] = ((*Ë
¨g
)[0],

278 
p_ov
[
n_ov
++] = ((*Ë
¨g
)[1];

282 
FFI_TYPE_UINT32
:

283 i‡(
n_g¥
 < 
MAX_GPRARGS
)

284 
p_g¥
[
n_g¥
++] = *(*Ë
¨g
;

286 
p_ov
[
n_ov
++] = *(*Ë
¨g
;

289 
FFI_TYPE_INT
:

290 
FFI_TYPE_SINT32
:

291 i‡(
n_g¥
 < 
MAX_GPRARGS
)

292 
p_g¥
[
n_g¥
++] = *(sig√d *Ë
¨g
;

294 
p_ov
[
n_ov
++] = *(sig√d *Ë
¨g
;

297 
FFI_TYPE_UINT16
:

298 i‡(
n_g¥
 < 
MAX_GPRARGS
)

299 
p_g¥
[
n_g¥
++] = *(*Ë
¨g
;

301 
p_ov
[
n_ov
++] = *(*Ë
¨g
;

304 
FFI_TYPE_SINT16
:

305 i‡(
n_g¥
 < 
MAX_GPRARGS
)

306 
p_g¥
[
n_g¥
++] = *(sig√d *Ë
¨g
;

308 
p_ov
[
n_ov
++] = *(sig√d *Ë
¨g
;

311 
FFI_TYPE_UINT8
:

312 i‡(
n_g¥
 < 
MAX_GPRARGS
)

313 
p_g¥
[
n_g¥
++] = *(*Ë
¨g
;

315 
p_ov
[
n_ov
++] = *(*Ë
¨g
;

318 
FFI_TYPE_SINT8
:

319 i‡(
n_g¥
 < 
MAX_GPRARGS
)

320 
p_g¥
[
n_g¥
++] = *(sig√d *Ë
¨g
;

322 
p_ov
[
n_ov
++] = *(sig√d *Ë
¨g
;

326 
	`FFI_ASSERT
 (0);

330 
	}
}

342 
ffi_°©us


343 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

345 
size_t
 
°ru˘_size
 = 0;

346 
n_g¥
 = 0;

347 
n_Âr
 = 0;

348 
n_ov
 = 0;

350 
ffi_ty≥
 **
±r
;

351 
i
;

355 
cif
->
πy≥
->
ty≥
)

358 
FFI_TYPE_VOID
:

359 
cif
->
Êags
 = 
FFI390_RET_VOID
;

363 
FFI_TYPE_STRUCT
:

364 
FFI_TYPE_COMPLEX
:

365 
cif
->
Êags
 = 
FFI390_RET_STRUCT
;

366 
n_g¥
++;

370 
FFI_TYPE_FLOAT
:

371 
cif
->
Êags
 = 
FFI390_RET_FLOAT
;

374 
FFI_TYPE_DOUBLE
:

375 
cif
->
Êags
 = 
FFI390_RET_DOUBLE
;

378 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


379 
FFI_TYPE_LONGDOUBLE
:

380 
cif
->
Êags
 = 
FFI390_RET_STRUCT
;

381 
n_g¥
++;

386 
FFI_TYPE_UINT64
:

387 
FFI_TYPE_SINT64
:

388 
cif
->
Êags
 = 
FFI390_RET_INT64
;

391 
FFI_TYPE_POINTER
:

392 
FFI_TYPE_INT
:

393 
FFI_TYPE_UINT32
:

394 
FFI_TYPE_SINT32
:

395 
FFI_TYPE_UINT16
:

396 
FFI_TYPE_SINT16
:

397 
FFI_TYPE_UINT8
:

398 
FFI_TYPE_SINT8
:

400 #ifde‡
__s390x__


401 
cif
->
Êags
 = 
FFI390_RET_INT64
;

403 
cif
->
Êags
 = 
FFI390_RET_INT32
;

408 
	`FFI_ASSERT
 (0);

414 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = cif->
«rgs
;

415 
i
 > 0;

416 
i
--, 
±r
++)

418 
ty≥
 = (*
±r
)->type;

420 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


422 i‡(
ty≥
 =
FFI_TYPE_LONGDOUBLE
)

423 
ty≥
 = 
FFI_TYPE_STRUCT
;

427 i‡(
ty≥
 =
FFI_TYPE_STRUCT
 ||Åy≥ =
FFI_TYPE_COMPLEX
)

429 i‡(
ty≥
 =
FFI_TYPE_COMPLEX
)

430 
ty≥
 = 
FFI_TYPE_POINTER
;

432 
ty≥
 = 
	`ffi_check_°ru˘_ty≥
 (*
±r
);

436 i‡(
ty≥
 =
FFI_TYPE_POINTER
)

437 
°ru˘_size
 +
	`ROUND_SIZE
 ((*
±r
)->
size
);

441 
ty≥
)

446 
FFI_TYPE_DOUBLE
:

447 i‡(
n_Âr
 < 
MAX_FPRARGS
)

448 
n_Âr
++;

450 
n_ov
 +=  () /  ();

453 
FFI_TYPE_FLOAT
:

454 i‡(
n_Âr
 < 
MAX_FPRARGS
)

455 
n_Âr
++;

457 
n_ov
++;

465 #i‚de‡
__s390x__


466 
FFI_TYPE_UINT64
:

467 
FFI_TYPE_SINT64
:

468 i‡(
n_g¥
 =
MAX_GPRARGS
-1)

469 
n_g¥
 = 
MAX_GPRARGS
;

470 i‡(
n_g¥
 < 
MAX_GPRARGS
)

471 
n_g¥
 += 2;

473 
n_ov
 += 2;

481 i‡(
n_g¥
 < 
MAX_GPRARGS
)

482 
n_g¥
++;

484 
n_ov
++;

492 
cif
->
byãs
 = 
	`ROUND_SIZE
 (
n_ov
 *  ()Ë+ 
°ru˘_size
;

494  
FFI_OK
;

495 
	}
}

508 
ffi_ˇŒ
(
ffi_cif
 *
cif
,

509 (*
‚
)(),

510 *
rvÆue
,

511 **
avÆue
)

513 
ªt_ty≥
 = 
cif
->
Êags
;

514 
exãnded_cif
 
ecif
;

516 
ecif
.
cif
 = cif;

517 
ecif
.
avÆue
 =ávalue;

518 
ecif
.
rvÆue
 =Ñvalue;

521 i‡(
rvÆue
 =
NULL
)

523 i‡(
ªt_ty≥
 =
FFI390_RET_STRUCT
)

524 
ecif
.
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

526 
ªt_ty≥
 = 
FFI390_RET_VOID
;

529 
cif
->
abi
)

531 
FFI_SYSV
:

532 
	`ffi_ˇŒ_SYSV
 (
cif
->
byãs
, &
ecif
, 
ffi_¥ï_¨gs
,

533 
ªt_ty≥
, 
ecif
.
rvÆue
, 
‚
);

537 
	`FFI_ASSERT
 (0);

540 
	}
}

553 
	$ffi_˛osuª_hñ≥r_SYSV
 (
ffi_˛osuª
 *
˛osuª
,

554 *
p_g¥
,

555 *
p_Âr
,

556 *
p_ov
)

558 
ªt_buf„r
;

560 *
rvÆue
 = &
ªt_buf„r
;

561 **
avÆue
;

562 **
p_¨g
;

564 
n_g¥
 = 0;

565 
n_Âr
 = 0;

566 
n_ov
 = 0;

568 
ffi_ty≥
 **
±r
;

569 
i
;

573 
p_¨g
 = 
avÆue
 = 
	`Æloˇ
 (
˛osuª
->
cif
->
«rgs
 *  (*));

579 i‡(
˛osuª
->
cif
->
Êags
 =
FFI390_RET_STRUCT
)

580 
rvÆue
 = (*Ë
p_g¥
[
n_g¥
++];

584 
±r
 = 
˛osuª
->
cif
->
¨g_ty≥s
, 
i
 = closuª->cif->
«rgs
;

585 
i
 > 0;

586 
i
--, 
p_¨g
++, 
±r
++)

588 
dîef_°ru˘_poöãr
 = 0;

589 
ty≥
 = (*
±r
)->type;

591 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


593 i‡(
ty≥
 =
FFI_TYPE_LONGDOUBLE
)

594 
ty≥
 = 
FFI_TYPE_STRUCT
;

598 i‡(
ty≥
 =
FFI_TYPE_STRUCT
 ||Åy≥ =
FFI_TYPE_COMPLEX
)

600 i‡(
ty≥
 =
FFI_TYPE_COMPLEX
)

601 
ty≥
 = 
FFI_TYPE_POINTER
;

603 
ty≥
 = 
	`ffi_check_°ru˘_ty≥
 (*
±r
);

607 i‡(
ty≥
 =
FFI_TYPE_POINTER
)

608 
dîef_°ru˘_poöãr
 = 1;

612 i‡(
ty≥
 =
FFI_TYPE_POINTER
)

613 #ifde‡
__s390x__


614 
ty≥
 = 
FFI_TYPE_UINT64
;

616 
ty≥
 = 
FFI_TYPE_UINT32
;

620 
ty≥
)

622 
FFI_TYPE_DOUBLE
:

623 i‡(
n_Âr
 < 
MAX_FPRARGS
)

624 *
p_¨g
 = &
p_Âr
[
n_Âr
++];

626 *
p_¨g
 = &
p_ov
[
n_ov
],

627 
n_ov
 +=  () /  ();

630 
FFI_TYPE_FLOAT
:

631 i‡(
n_Âr
 < 
MAX_FPRARGS
)

632 *
p_¨g
 = &
p_Âr
[
n_Âr
++];

634 *
p_¨g
 = (*)&
p_ov
[
n_ov
++] +  () - 4;

637 
FFI_TYPE_UINT64
:

638 
FFI_TYPE_SINT64
:

639 #ifde‡
__s390x__


640 i‡(
n_g¥
 < 
MAX_GPRARGS
)

641 *
p_¨g
 = &
p_g¥
[
n_g¥
++];

643 *
p_¨g
 = &
p_ov
[
n_ov
++];

645 i‡(
n_g¥
 =
MAX_GPRARGS
-1)

646 
n_g¥
 = 
MAX_GPRARGS
;

647 i‡(
n_g¥
 < 
MAX_GPRARGS
)

648 *
p_¨g
 = &
p_g¥
[
n_g¥
],Ç_gpr += 2;

650 *
p_¨g
 = &
p_ov
[
n_ov
],Ç_ov += 2;

654 
FFI_TYPE_INT
:

655 
FFI_TYPE_UINT32
:

656 
FFI_TYPE_SINT32
:

657 i‡(
n_g¥
 < 
MAX_GPRARGS
)

658 *
p_¨g
 = (*)&
p_g¥
[
n_g¥
++] +  () - 4;

660 *
p_¨g
 = (*)&
p_ov
[
n_ov
++] +  () - 4;

663 
FFI_TYPE_UINT16
:

664 
FFI_TYPE_SINT16
:

665 i‡(
n_g¥
 < 
MAX_GPRARGS
)

666 *
p_¨g
 = (*)&
p_g¥
[
n_g¥
++] +  () - 2;

668 *
p_¨g
 = (*)&
p_ov
[
n_ov
++] +  () - 2;

671 
FFI_TYPE_UINT8
:

672 
FFI_TYPE_SINT8
:

673 i‡(
n_g¥
 < 
MAX_GPRARGS
)

674 *
p_¨g
 = (*)&
p_g¥
[
n_g¥
++] +  () - 1;

676 *
p_¨g
 = (*)&
p_ov
[
n_ov
++] +  () - 1;

680 
	`FFI_ASSERT
 (0);

686 i‡(
dîef_°ru˘_poöãr
)

687 *
p_¨g
 = *(**)*p_arg;

692 (
˛osuª
->
fun
Ë(˛osuª->
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

695 
˛osuª
->
cif
->
πy≥
->
ty≥
)

698 
FFI_TYPE_VOID
:

699 
FFI_TYPE_STRUCT
:

700 
FFI_TYPE_COMPLEX
:

701 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


702 
FFI_TYPE_LONGDOUBLE
:

707 
FFI_TYPE_FLOAT
:

708 
p_Âr
[0] = (Ë*(*Ë
rvÆue
 << 32;

711 
FFI_TYPE_DOUBLE
:

712 
p_Âr
[0] = *(*Ë
rvÆue
;

717 
FFI_TYPE_UINT64
:

718 
FFI_TYPE_SINT64
:

719 #ifde‡
__s390x__


720 
p_g¥
[0] = *(*Ë
rvÆue
;

722 
p_g¥
[0] = ((*Ë
rvÆue
)[0],

723 
p_g¥
[1] = ((*Ë
rvÆue
)[1];

727 
FFI_TYPE_POINTER
:

728 
FFI_TYPE_UINT32
:

729 
FFI_TYPE_UINT16
:

730 
FFI_TYPE_UINT8
:

731 
p_g¥
[0] = *(*Ë
rvÆue
;

734 
FFI_TYPE_INT
:

735 
FFI_TYPE_SINT32
:

736 
FFI_TYPE_SINT16
:

737 
FFI_TYPE_SINT8
:

738 
p_g¥
[0] = *(sig√d *Ë
rvÆue
;

742 
	`FFI_ASSERT
 (0);

745 
	}
}

757 
ffi_°©us


758 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
 *
˛osuª
,

759 
ffi_cif
 *
cif
,

760 (*
fun
Ë(
ffi_cif
 *, *, **, *),

761 *
u£r_d©a
,

762 *
codñoc
)

764 i‡(
cif
->
abi
 !
FFI_SYSV
)

765  
FFI_BAD_ABI
;

767 #i‚de‡
__s390x__


768 *(*)&
˛osuª
->
åamp
 [0] = 0x0d10;

769 *(*)&
˛osuª
->
åamp
 [2] = 0x9801;

770 *(*)&
˛osuª
->
åamp
 [4] = 0x1006;

771 *(*)&
˛osuª
->
åamp
 [6] = 0x07f1;

772 *(*)&
˛osuª
->
åamp
 [8] = ()
codñoc
;

773 *(*)&
˛osuª
->
åamp
[12] = ()&
ffi_˛osuª_SYSV
;

775 *(*)&
˛osuª
->
åamp
 [0] = 0x0d10;

776 *(*)&
˛osuª
->
åamp
 [2] = 0xeb01;

777 *(*)&
˛osuª
->
åamp
 [4] = 0x100e;

778 *(*)&
˛osuª
->
åamp
 [6] = 0x0004;

779 *(*)&
˛osuª
->
åamp
 [8] = 0x07f1;

780 *(*)&
˛osuª
->
åamp
[16] = ()
codñoc
;

781 *(*)&
˛osuª
->
åamp
[24] = ()&
ffi_˛osuª_SYSV
;

784 
˛osuª
->
cif
 = cif;

785 
˛osuª
->
u£r_d©a
 = user_data;

786 
˛osuª
->
fun
 = fun;

788  
FFI_OK
;

789 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/s390/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


35 #i‡
deföed
 (
__s390x__
)

36 #i‚de‡
S390X


37 
	#S390X


	)

43 #i‚de‡
LIBFFI_ASM


44 
	tffi_¨g
;

45 sig√d 
	tffi_ßrg
;

47 
	effi_abi
 {

48 
	mFFI_FIRST_ABI
 = 0,

49 
	mFFI_SYSV
,

50 
	mFFI_LAST_ABI
,

51 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


52 } 
	tffi_abi
;

55 
	#FFI_TARGET_SPECIFIC_STACK_SPACE_ALLOCATION


	)

56 
	#FFI_TARGET_HAS_COMPLEX_TYPE


	)

60 
	#FFI_CLOSURES
 1

	)

61 #ifde‡
S390X


62 
	#FFI_TRAMPOLINE_SIZE
 32

	)

64 
	#FFI_TRAMPOLINE_SIZE
 16

	)

66 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/s390/sysv.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

32 #i‚de‡
__s390x__


34 .
	gãxt


36 #r2: 
cif
->
byãs


37 #r3: &
ecif


38 #r4: 
ffi_¥ï_¨gs


39 #r5: 
ªt_ty≥


40 #r6: 
ecif
.
rvÆue


41 #ov: 
‚


43 #Thi†
assumes
 
we
 
¨e
 
usög
 
gas
.

44 .
globl
 
	gffi_ˇŒ_SYSV


45 .
ty≥
 
	gffi_ˇŒ_SYSV
,%
fun˘i⁄


46 
	gffi_ˇŒ_SYSV
:

47 .
LFB1
:

48 
°m
 %
r6
,%
	gr15
,24(%r15Ë#Savê
	gªgi°îs


49 .
	gLCFI0
:

50 
ba§
 %
r13
,0 #Së 
up
 
ba£
 

51 .
	gLba£
:

52 
Ã
 %
r11
,%
	gr15
 #Së 
up
 
‰ame
 
	gpoöãr


53 .
	gLCFI1
:

54 
§
 %
r15
,%
r2


55 
	gahi
 %
	gr15
,-96-48 #AŒoˇã 
°ack


56 
	gÃ
 %
	gr8
,%
	gr6
 #Savê
	gecif
.
rvÆue


57 
	g§
 %
	gr9
,%
r9


58 
	gic
 %
	gr9
,.
	gLèbÀ
-.
Lba£
(%
r13
,%
r5
Ë#Lﬂd 
ïûog
 
addªss


59 
	gl
 %
	gr7
,96(%
	gr11
Ë#Lﬂd 
fun˘i⁄
 
addªss


60 
	g°
 %
	gr11
,0(%
	gr15
Ë#Së 
up
 
back
 
chaö


61 
	gahi
 %
	gr11
,-48 #Regi°î 
ßve
 
	g¨ó


62 .
	gLCFI2
:

64 
œ
 %
r2
,96(%
	gr15
Ë#Savê
	g¨ó


65 #r3 
Æªady
 
hﬁds
 &
ecif


66 
	gba§
 %
	gr14
,%
	gr4
 #CÆ»
ffi_¥ï_¨gs


68 
	glm
 %
	gr2
,%
	gr6
,0(%
	gr11
Ë#Lﬂd 
¨gumíts


69 
	gld
 %
	gf0
,32(%
	gr11
)

70 
	gld
 %
	gf2
,40(%
	gr11
)

71 
	gœ
 %
	gr14
,0(%
	gr13
,%
	gr9
Ë#Së  
addªss


72 
	gbr
 %
	gr7
 #... 
™d
 
ˇŒ
 
	gfun˘i⁄


74 .
	gLªtN⁄e
: #Return 

75 
l
 %
r4
,48+56(%
	gr11
)

76 
	glm
 %
	gr6
,%
	gr15
,48+24(%
	gr11
)

77 
	gbr
 %
	gr4


79 .
	gLªtFlﬂt
:

80 
l
 %
r4
,48+56(%
	gr11
)

81 
	g°e
 %
	gf0
,0(%
	gr8
) #Return 

82 
	glm
 %
	gr6
,%
	gr15
,48+24(%
	gr11
)

83 
	gbr
 %
	gr4


85 .
	gLªtDoubÀ
:

86 
l
 %
r4
,48+56(%
	gr11
)

87 
	g°d
 %
	gf0
,0(%
	gr8
) #Return 

88 
	glm
 %
	gr6
,%
	gr15
,48+24(%
	gr11
)

89 
	gbr
 %
	gr4


91 .
	gLªtI¡32
:

92 
l
 %
r4
,48+56(%
	gr11
)

93 
	g°
 %
	gr2
,0(%
	gr8
) #Return 

94 
	glm
 %
	gr6
,%
	gr15
,48+24(%
	gr11
)

95 
	gbr
 %
	gr4


97 .
	gLªtI¡64
:

98 
l
 %
r4
,48+56(%
	gr11
)

99 
	g°m
 %
	gr2
,%
	gr3
,0(%
	gr8
) #Return 

100 
	glm
 %
	gr6
,%
	gr15
,48+24(%
	gr11
)

101 
	gbr
 %
	gr4


103 .
	gLèbÀ
:

104 .
byã
 .
LªtN⁄e
-.
Lba£
 #FFI390_RET_VOID

105 .
byã
 .
LªtN⁄e
-.
Lba£
 #FFI390_RET_STRUCT

106 .
byã
 .
LªtFlﬂt
-.
Lba£
 #FFI390_RET_FLOAT

107 .
byã
 .
LªtDoubÀ
-.
Lba£
 #FFI390_RET_DOUBLE

108 .
byã
 .
LªtI¡32
-.
Lba£
 #FFI390_RET_INT32

109 .
byã
 .
LªtI¡64
-.
Lba£
 #FFI390_RET_INT64

111 .
LFE1
:

112 .
ffi_ˇŒ_SYSV_íd
:

113 .
size
 
ffi_ˇŒ_SYSV
,.
	gffi_ˇŒ_SYSV_íd
-
	gffi_ˇŒ_SYSV


116 .
globl
 
	gffi_˛osuª_SYSV


117 .
ty≥
 
	gffi_˛osuª_SYSV
,%
fun˘i⁄


118 
	gffi_˛osuª_SYSV
:

119 .
LFB2
:

120 
°m
 %
r12
,%
	gr15
,48(%r15Ë#Savê
	gªgi°îs


121 .
	gLCFI10
:

122 
ba§
 %
r13
,0 #Së 
up
 
ba£
 

123 .
	gLcba£
:

124 
°m
 %
r2
,%
	gr6
,8(%
	gr15
Ë#Savê
¨gumíts


125 
	g°d
 %
	gf0
,64(%
	gr15
)

126 
	g°d
 %
	gf2
,72(%
	gr15
)

127 
	gÃ
 %
	gr1
,%
	gr15
 #Së 
up
 
°ack
 
‰ame


128 
	gahi
 %
	gr15
,-96

129 .
	gLCFI11
:

130 
l
 %
r12
,.
	gLchñ≥r
-.
Lcba£
(%
r13
Ë#Gë 
hñ≥r
 
fun˘i⁄


131 
	gÃ
 %
	gr2
,%
	gr0
 #Closure

132 
	gœ
 %
	gr3
,8(%
	gr1
) #GPRs

133 
	gœ
 %
	gr4
,64(%
	gr1
) #FPRs

134 
	gœ
 %
	gr5
,96(%
	gr1
) #Overflow

135 
	g°
 %
	gr1
,0(%
	gr15
Ë#Së 
up
 
back
 
chaö


137 
	gbas
 %
	gr14
,0(%
	gr12
,%
	gr13
Ë#CÆ»
hñ≥r


139 
	gl
 %
	gr4
,96+56(%
	gr15
)

140 
	gld
 %
	gf0
,96+64(%
	gr15
Ë#Lﬂd  
ªgi°îs


141 
	glm
 %
	gr2
,%
	gr3
,96+8(%
	gr15
)

142 
	glm
 %
	gr12
,%
	gr15
,96+48(%r15)

143 
	gbr
 %
	gr4


145 .
	gÆign
 4

146 .
	gLchñ≥r
:

147 .
ffi_˛osuª_hñ≥r_SYSV
-.
Lcba£


149 .
LFE2
:

151 .
ffi_˛osuª_SYSV_íd
:

152 .
size
 
ffi_˛osuª_SYSV
,.
	gffi_˛osuª_SYSV_íd
-
	gffi_˛osuª_SYSV


155 .
	g£˘i⁄
 .
	geh_‰ame
,
	gEH_FRAME_FLAGS
,@
	g¥ogbôs


156 .
	gL‰ame1
:

157 .4b
yã
 .
LECIE1
-.
LSCIE1
 #Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


158 .
LSCIE1
:

159 .4b
yã
 0x0 #CIE 
Idítifõr
 
Tag


160 .
byã
 0x1 #CIE 
Vîsi⁄


161 .
ascii
 "zR\0" #CIE 
Augmíèti⁄


162 .
uÀb128
 0x1 #CIE 
Code
 
Alignmít
 
Fa˘‹


163 .
¶eb128
 -4 #CIE 
D©a
 
Alignmít
 
Fa˘‹


164 .
byã
 0xê#CIE 
RA
 
Cﬁumn


165 .
uÀb128
 0x1 #Augmíèti⁄ 
size


166 .
byã
 0x1b #FDE 
Encodög
 (
p¸ñ
 
sd©a4
)

167 .
byã
 0xc #DW_CFA_def_cfa

168 .
uÀb128
 0xf

169 .
uÀb128
 0x60

170 .
Æign
 4

171 .
LECIE1
:

172 .
LSFDE1
:

173 .4b
yã
 .
LEFDE1
-.
LASFDE1
 #FDE 
Lígth


174 .
LASFDE1
:

175 .4b
yã
 .
LASFDE1
-.
L‰ame1
 #FDE 
CIE
 
off£t


176 .4b
yã
 .
LFB1
-. #FDE 
öôül
 
loˇti⁄


177 .4b
yã
 .
LFE1
-.
LFB1
 #FDE 
addªss
 
ønge


178 .
uÀb128
 0x0 #Augmíèti⁄ 
size


179 .
byã
 0x4 #DW_CFA_advance_loc4

180 .4b
yã
 .
LCFI0
-.
LFB1


181 .
byã
 0x8‡#DW_CFA_off£t, 
	gcﬁumn
 0xf

182 .
	guÀb128
 0x9

183 .
	gbyã
 0x8ê#DW_CFA_off£t, 
	gcﬁumn
 0xe

184 .
	guÀb128
 0xa

185 .
	gbyã
 0x8d #DW_CFA_off£t, 
	gcﬁumn
 0xd

186 .
	guÀb128
 0xb

187 .
	gbyã
 0x8¯#DW_CFA_off£t, 
	gcﬁumn
 0xc

188 .
	guÀb128
 0xc

189 .
	gbyã
 0x8b #DW_CFA_off£t, 
	gcﬁumn
 0xb

190 .
	guÀb128
 0xd

191 .
	gbyã
 0x8®#DW_CFA_off£t, 
	gcﬁumn
 0xa

192 .
	guÀb128
 0xe

193 .
	gbyã
 0x89 #DW_CFA_off£t, 
	gcﬁumn
 0x9

194 .
	guÀb128
 0xf

195 .
	gbyã
 0x88 #DW_CFA_off£t, 
	gcﬁumn
 0x8

196 .
	guÀb128
 0x10

197 .
	gbyã
 0x87 #DW_CFA_off£t, 
	gcﬁumn
 0x7

198 .
	guÀb128
 0x11

199 .
	gbyã
 0x86 #DW_CFA_off£t, 
	gcﬁumn
 0x6

200 .
	guÀb128
 0x12

201 .
	gbyã
 0x4 #DW_CFA_advance_loc4

202 .4b
	gyã
 .
	gLCFI1
-.
	gLCFI0


203 .
	gbyã
 0xd #DW_CFA_def_cfa_register

204 .
	guÀb128
 0xb

205 .
	gbyã
 0x4 #DW_CFA_advance_loc4

206 .4b
	gyã
 .
	gLCFI2
-.
	gLCFI1


207 .
	gbyã
 0xe #DW_CFA_def_cfa_offset

208 .
	guÀb128
 0x90

209 .
	gÆign
 4

210 .
	gLEFDE1
:

211 .
LSFDE2
:

212 .4b
yã
 .
LEFDE2
-.
LASFDE2
 #FDE 
Lígth


213 .
LASFDE2
:

214 .4b
yã
 .
LASFDE2
-.
L‰ame1
 #FDE 
CIE
 
off£t


215 .4b
yã
 .
LFB2
-. #FDE 
öôül
 
loˇti⁄


216 .4b
yã
 .
LFE2
-.
LFB2
 #FDE 
addªss
 
ønge


217 .
uÀb128
 0x0 #Augmíèti⁄ 
size


218 .
byã
 0x4 #DW_CFA_advance_loc4

219 .4b
yã
 .
LCFI10
-.
LFB2


220 .
byã
 0x8‡#DW_CFA_off£t, 
	gcﬁumn
 0xf

221 .
	guÀb128
 0x9

222 .
	gbyã
 0x8ê#DW_CFA_off£t, 
	gcﬁumn
 0xe

223 .
	guÀb128
 0xa

224 .
	gbyã
 0x8d #DW_CFA_off£t, 
	gcﬁumn
 0xd

225 .
	guÀb128
 0xb

226 .
	gbyã
 0x8¯#DW_CFA_off£t, 
	gcﬁumn
 0xc

227 .
	guÀb128
 0xc

228 .
	gbyã
 0x4 #DW_CFA_advance_loc4

229 .4b
	gyã
 .
	gLCFI11
-.
	gLCFI10


230 .
	gbyã
 0xe #DW_CFA_def_cfa_offset

231 .
	guÀb128
 0xc0

232 .
	gÆign
 4

233 .
	gLEFDE2
:

237 .
ãxt


239 #r2: 
cif
->
byãs


240 #r3: &
ecif


241 #r4: 
ffi_¥ï_¨gs


242 #r5: 
ªt_ty≥


243 #r6: 
ecif
.
rvÆue


244 #ov: 
‚


246 #Thi†
assumes
 
we
 
¨e
 
usög
 
gas
.

247 .
globl
 
ffi_ˇŒ_SYSV


248 .
ty≥
 
ffi_ˇŒ_SYSV
,%
fun˘i⁄


249 
	gffi_ˇŒ_SYSV
:

250 .
LFB1
:

251 
°mg
 %
r6
,%
	gr15
,48(%r15Ë#Savê
	gªgi°îs


252 .
	gLCFI0
:

253 
œæ
 %
r13
,.
	gLba£
 #Së 
up
 
ba£
 

254 
	glgr
 %
	gr11
,%
	gr15
 #Së 
up
 
‰ame
 
	gpoöãr


255 .
	gLCFI1
:

256 
sgr
 %
r15
,%
r2


257 
	gaghi
 %
	gr15
,-160-80 #AŒoˇã 
°ack


258 
	glgr
 %
	gr8
,%
	gr6
 #Savê
	gecif
.
rvÆue


259 
	gŒgc
 %
	gr9
,.
	gLèbÀ
-.
Lba£
(%
r13
,%
r5
Ë#Lﬂd 
ïûog
 
addªss


260 
	glg
 %
	gr7
,160(%
	gr11
Ë#Lﬂd 
fun˘i⁄
 
addªss


261 
	g°g
 %
	gr11
,0(%
	gr15
Ë#Së 
up
 
back
 
chaö


262 
	gaghi
 %
	gr11
,-80 #Regi°î 
ßve
 
	g¨ó


263 .
	gLCFI2
:

265 
œ
 %
r2
,160(%
	gr15
Ë#Savê
	g¨ó


266 #r3 
Æªady
 
hﬁds
 &
ecif


267 
	gba§
 %
	gr14
,%
	gr4
 #CÆ»
ffi_¥ï_¨gs


269 
	glmg
 %
	gr2
,%
	gr6
,0(%
	gr11
Ë#Lﬂd 
¨gumíts


270 
	gld
 %
	gf0
,48(%
	gr11
)

271 
	gld
 %
	gf2
,56(%
	gr11
)

272 
	gld
 %
	gf4
,64(%
	gr11
)

273 
	gld
 %
	gf6
,72(%
	gr11
)

274 
	gœ
 %
	gr14
,0(%
	gr13
,%
	gr9
Ë#Së  
addªss


275 
	gbr
 %
	gr7
 #... 
™d
 
ˇŒ
 
	gfun˘i⁄


277 .
	gLba£
:

278 .
LªtN⁄e
: #Return 

279 
lg
 %
r4
,80+112(%
	gr11
)

280 
	glmg
 %
	gr6
,%
	gr15
,80+48(%
	gr11
)

281 
	gbr
 %
	gr4


283 .
	gLªtFlﬂt
:

284 
lg
 %
r4
,80+112(%
	gr11
)

285 
	g°e
 %
	gf0
,0(%
	gr8
) #Return 

286 
	glmg
 %
	gr6
,%
	gr15
,80+48(%
	gr11
)

287 
	gbr
 %
	gr4


289 .
	gLªtDoubÀ
:

290 
lg
 %
r4
,80+112(%
	gr11
)

291 
	g°d
 %
	gf0
,0(%
	gr8
) #Return 

292 
	glmg
 %
	gr6
,%
	gr15
,80+48(%
	gr11
)

293 
	gbr
 %
	gr4


295 .
	gLªtI¡32
:

296 
lg
 %
r4
,80+112(%
	gr11
)

297 
	g°
 %
	gr2
,0(%
	gr8
) #Return 

298 
	glmg
 %
	gr6
,%
	gr15
,80+48(%
	gr11
)

299 
	gbr
 %
	gr4


301 .
	gLªtI¡64
:

302 
lg
 %
r4
,80+112(%
	gr11
)

303 
	g°g
 %
	gr2
,0(%
	gr8
) #Return 

304 
	glmg
 %
	gr6
,%
	gr15
,80+48(%
	gr11
)

305 
	gbr
 %
	gr4


307 .
	gLèbÀ
:

308 .
byã
 .
LªtN⁄e
-.
Lba£
 #FFI390_RET_VOID

309 .
byã
 .
LªtN⁄e
-.
Lba£
 #FFI390_RET_STRUCT

310 .
byã
 .
LªtFlﬂt
-.
Lba£
 #FFI390_RET_FLOAT

311 .
byã
 .
LªtDoubÀ
-.
Lba£
 #FFI390_RET_DOUBLE

312 .
byã
 .
LªtI¡32
-.
Lba£
 #FFI390_RET_INT32

313 .
byã
 .
LªtI¡64
-.
Lba£
 #FFI390_RET_INT64

315 .
LFE1
:

316 .
ffi_ˇŒ_SYSV_íd
:

317 .
size
 
ffi_ˇŒ_SYSV
,.
	gffi_ˇŒ_SYSV_íd
-
	gffi_ˇŒ_SYSV


320 .
globl
 
	gffi_˛osuª_SYSV


321 .
ty≥
 
	gffi_˛osuª_SYSV
,%
fun˘i⁄


322 
	gffi_˛osuª_SYSV
:

323 .
LFB2
:

324 
°mg
 %
r14
,%
	gr15
,112(%r15Ë#Savê
	gªgi°îs


325 .
	gLCFI10
:

326 
°mg
 %
r2
,%
	gr6
,16(%
	gr15
Ë#Savê
¨gumíts


327 
	g°d
 %
	gf0
,128(%
	gr15
)

328 
	g°d
 %
	gf2
,136(%
	gr15
)

329 
	g°d
 %
	gf4
,144(%
	gr15
)

330 
	g°d
 %
	gf6
,152(%
	gr15
)

331 
	glgr
 %
	gr1
,%
	gr15
 #Së 
up
 
°ack
 
‰ame


332 
	gaghi
 %
	gr15
,-160

333 .
	gLCFI11
:

334 
lgr
 %
r2
,%
	gr0
 #Closure

335 
	gœ
 %
	gr3
,16(%
	gr1
) #GPRs

336 
	gœ
 %
	gr4
,128(%
	gr1
) #FPRs

337 
	gœ
 %
	gr5
,160(%
	gr1
) #Overflow

338 
	g°g
 %
	gr1
,0(%
	gr15
Ë#Së 
up
 
back
 
chaö


340 
	gbø¶
 %
	gr14
,
	gffi_˛osuª_hñ≥r_SYSV
 #CÆ»
hñ≥r


342 
	glg
 %
	gr14
,160+112(%
	gr15
)

343 
	gld
 %
	gf0
,160+128(%
	gr15
Ë#Lﬂd  
ªgi°îs


344 
	glg
 %
	gr2
,160+16(%
	gr15
)

345 
	gœ
 %
	gr15
,160(%r15)

346 
	gbr
 %
	gr14


347 .
	gLFE2
:

349 .
ffi_˛osuª_SYSV_íd
:

350 .
size
 
ffi_˛osuª_SYSV
,.
	gffi_˛osuª_SYSV_íd
-
	gffi_˛osuª_SYSV


354 .
	g£˘i⁄
 .
	geh_‰ame
,
	gEH_FRAME_FLAGS
,@
	g¥ogbôs


355 .
	gL‰ame1
:

356 .4b
yã
 .
LECIE1
-.
LSCIE1
 #Lígth 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


357 .
LSCIE1
:

358 .4b
yã
 0x0 #CIE 
Idítifõr
 
Tag


359 .
byã
 0x1 #CIE 
Vîsi⁄


360 .
ascii
 "zR\0" #CIE 
Augmíèti⁄


361 .
uÀb128
 0x1 #CIE 
Code
 
Alignmít
 
Fa˘‹


362 .
¶eb128
 -8 #CIE 
D©a
 
Alignmít
 
Fa˘‹


363 .
byã
 0xê#CIE 
RA
 
Cﬁumn


364 .
uÀb128
 0x1 #Augmíèti⁄ 
size


365 .
byã
 0x1b #FDE 
Encodög
 (
p¸ñ
 
sd©a4
)

366 .
byã
 0xc #DW_CFA_def_cfa

367 .
uÀb128
 0xf

368 .
uÀb128
 0xa0

369 .
Æign
 8

370 .
LECIE1
:

371 .
LSFDE1
:

372 .4b
yã
 .
LEFDE1
-.
LASFDE1
 #FDE 
Lígth


373 .
LASFDE1
:

374 .4b
yã
 .
LASFDE1
-.
L‰ame1
 #FDE 
CIE
 
off£t


375 .4b
yã
 .
LFB1
-. #FDE 
öôül
 
loˇti⁄


376 .4b
yã
 .
LFE1
-.
LFB1
 #FDE 
addªss
 
ønge


377 .
uÀb128
 0x0 #Augmíèti⁄ 
size


378 .
byã
 0x4 #DW_CFA_advance_loc4

379 .4b
yã
 .
LCFI0
-.
LFB1


380 .
byã
 0x8‡#DW_CFA_off£t, 
	gcﬁumn
 0xf

381 .
	guÀb128
 0x5

382 .
	gbyã
 0x8ê#DW_CFA_off£t, 
	gcﬁumn
 0xe

383 .
	guÀb128
 0x6

384 .
	gbyã
 0x8d #DW_CFA_off£t, 
	gcﬁumn
 0xd

385 .
	guÀb128
 0x7

386 .
	gbyã
 0x8¯#DW_CFA_off£t, 
	gcﬁumn
 0xc

387 .
	guÀb128
 0x8

388 .
	gbyã
 0x8b #DW_CFA_off£t, 
	gcﬁumn
 0xb

389 .
	guÀb128
 0x9

390 .
	gbyã
 0x8®#DW_CFA_off£t, 
	gcﬁumn
 0xa

391 .
	guÀb128
 0xa

392 .
	gbyã
 0x89 #DW_CFA_off£t, 
	gcﬁumn
 0x9

393 .
	guÀb128
 0xb

394 .
	gbyã
 0x88 #DW_CFA_off£t, 
	gcﬁumn
 0x8

395 .
	guÀb128
 0xc

396 .
	gbyã
 0x87 #DW_CFA_off£t, 
	gcﬁumn
 0x7

397 .
	guÀb128
 0xd

398 .
	gbyã
 0x86 #DW_CFA_off£t, 
	gcﬁumn
 0x6

399 .
	guÀb128
 0xe

400 .
	gbyã
 0x4 #DW_CFA_advance_loc4

401 .4b
	gyã
 .
	gLCFI1
-.
	gLCFI0


402 .
	gbyã
 0xd #DW_CFA_def_cfa_register

403 .
	guÀb128
 0xb

404 .
	gbyã
 0x4 #DW_CFA_advance_loc4

405 .4b
	gyã
 .
	gLCFI2
-.
	gLCFI1


406 .
	gbyã
 0xe #DW_CFA_def_cfa_offset

407 .
	guÀb128
 0xf0

408 .
	gÆign
 8

409 .
	gLEFDE1
:

410 .
LSFDE2
:

411 .4b
yã
 .
LEFDE2
-.
LASFDE2
 #FDE 
Lígth


412 .
LASFDE2
:

413 .4b
yã
 .
LASFDE2
-.
L‰ame1
 #FDE 
CIE
 
off£t


414 .4b
yã
 .
LFB2
-. #FDE 
öôül
 
loˇti⁄


415 .4b
yã
 .
LFE2
-.
LFB2
 #FDE 
addªss
 
ønge


416 .
uÀb128
 0x0 #Augmíèti⁄ 
size


417 .
byã
 0x4 #DW_CFA_advance_loc4

418 .4b
yã
 .
LCFI10
-.
LFB2


419 .
byã
 0x8‡#DW_CFA_off£t, 
	gcﬁumn
 0xf

420 .
	guÀb128
 0x5

421 .
	gbyã
 0x8ê#DW_CFA_off£t, 
	gcﬁumn
 0xe

422 .
	guÀb128
 0x6

423 .
	gbyã
 0x4 #DW_CFA_advance_loc4

424 .4b
	gyã
 .
	gLCFI11
-.
	gLCFI10


425 .
	gbyã
 0xe #DW_CFA_def_cfa_offset

426 .
	guÀb128
 0x140

427 .
	gÆign
 8

428 .
	gLEFDE2
:

432 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


433 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
	g¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh/ffi.c

28 
	~<ffi.h
>

29 
	~<ffi_comm⁄.h
>

31 
	~<°dlib.h
>

33 
	#NGREGARG
 4

	)

34 #i‡
deföed
(
__SH4__
)

35 
	#NFREGARG
 8

	)

38 #i‡
deföed
(
__HITACHI__
)

39 
	#STRUCT_VALUE_ADDRESS_WITH_ARG
 1

	)

41 
	#STRUCT_VALUE_ADDRESS_WITH_ARG
 0

	)

46 
	$sim∂e_ty≥
 (
ffi_ty≥
 *
¨g
)

48 i‡(
¨g
->
ty≥
 !
FFI_TYPE_STRUCT
)

49  
¨g
->
ty≥
;

50 i‡(
¨g
->
ñemíts
[1])

51  
FFI_TYPE_STRUCT
;

53  
	`sim∂e_ty≥
 (
¨g
->
ñemíts
[0]);

54 
	}
}

57 
	$ªtu∫_ty≥
 (
ffi_ty≥
 *
¨g
)

59 
ty≥
;

61 i‡(
¨g
->
ty≥
 !
FFI_TYPE_STRUCT
)

62  
¨g
->
ty≥
;

64 
ty≥
 = 
	`sim∂e_ty≥
 (
¨g
->
ñemíts
[0]);

65 i‡(! 
¨g
->
ñemíts
[1])

67 
ty≥
)

69 
FFI_TYPE_SINT8
:

70 
FFI_TYPE_UINT8
:

71 
FFI_TYPE_SINT16
:

72 
FFI_TYPE_UINT16
:

73 
FFI_TYPE_SINT32
:

74 
FFI_TYPE_UINT32
:

75  
FFI_TYPE_INT
;

78  
ty≥
;

83 i‡(
¨g
->
size
 <= 2 *  ())

85 
i
 = 0;

86 
ffi_ty≥
 *
e
;

88 (
e
 = 
¨g
->
ñemíts
[
i
++]))

90 
ty≥
 = 
	`sim∂e_ty≥
 (
e
);

91 
ty≥
)

93 
FFI_TYPE_SINT32
:

94 
FFI_TYPE_UINT32
:

95 
FFI_TYPE_INT
:

96 
FFI_TYPE_FLOAT
:

97  
FFI_TYPE_UINT64
;

105  
FFI_TYPE_STRUCT
;

106 
	}
}

111 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

113 
i
;

114 
tmp
;

115 
avn
;

116 **
p_¨gv
;

117 *
¨gp
;

118 
ffi_ty≥
 **
p_¨g
;

119 
gªg
, 
úeg
;

120 #i‡
	`deföed
(
__SH4__
)

121 
‰eg
 = 0;

124 
tmp
 = 0;

125 
¨gp
 = 
°ack
;

127 i‡(
	`ªtu∫_ty≥
 (
ecif
->
cif
->
πy≥
Ë=
FFI_TYPE_STRUCT
)

129 *(**Ë
¨gp
 = 
ecif
->
rvÆue
;

130 
¨gp
 += 4;

131 
úeg
 = 
STRUCT_VALUE_ADDRESS_WITH_ARG
 ? 1 : 0;

134 
úeg
 = 0;

137 
gªg
 = 
úeg
;

138 
avn
 = 
ecif
->
cif
->
«rgs
;

139 
p_¨gv
 = 
ecif
->
avÆue
;

141 
i
 = 0, 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
; i < 
avn
; i++,Ö_¨g++, 
p_¨gv
++)

143 
size_t
 
z
;

145 
z
 = (*
p_¨g
)->
size
;

146 i‡(
z
 < ())

148 i‡(
gªg
++ >
NGREGARG
)

151 
z
 = ();

152 (*
p_¨g
)->
ty≥
)

154 
FFI_TYPE_SINT8
:

155 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT8
 *)(* 
p_¨gv
);

158 
FFI_TYPE_UINT8
:

159 *(*Ë
¨gp
 = ()*(
UINT8
 *)(* 
p_¨gv
);

162 
FFI_TYPE_SINT16
:

163 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT16
 *)(* 
p_¨gv
);

166 
FFI_TYPE_UINT16
:

167 *(*Ë
¨gp
 = ()*(
UINT16
 *)(* 
p_¨gv
);

170 
FFI_TYPE_STRUCT
:

171 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

175 
	`FFI_ASSERT
(0);

177 
¨gp
 +
z
;

179 i‡(
z
 == ())

181 #i‡
	`deföed
(
__SH4__
)

182 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_FLOAT
)

184 i‡(
‰eg
++ >
NFREGARG
)

190 i‡(
gªg
++ >
NGREGARG
)

193 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

194 
¨gp
 +
z
;

196 #i‡
	`deföed
(
__SH4__
)

197 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_DOUBLE
)

199 i‡(
‰eg
 + 1 >
NFREGARG
)

201 
‰eg
 = (freg + 1) & ~1;

202 
‰eg
 += 2;

203 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

204 
¨gp
 +
z
;

209 
n
 = (
z
 +  () - 1) /  ();

210 #i‡
	`deföed
(
__SH4__
)

211 i‡(
gªg
 + 
n
 - 1 >
NGREGARG
)

214 i‡(
gªg
 >
NGREGARG
)

217 
gªg
 +
n
;

218 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

219 
¨gp
 +
n
 *  ();

224 
gªg
 = 
úeg
;

225 #i‡
	`deföed
(
__SH4__
)

226 
‰eg
 = 0;

228 
p_¨gv
 = 
ecif
->
avÆue
;

230 
i
 = 0, 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
; i < 
avn
; i++,Ö_¨g++, 
p_¨gv
++)

232 
size_t
 
z
;

234 
z
 = (*
p_¨g
)->
size
;

235 i‡(
z
 < ())

237 i‡(
gªg
++ < 
NGREGARG
)

240 
z
 = ();

241 (*
p_¨g
)->
ty≥
)

243 
FFI_TYPE_SINT8
:

244 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT8
 *)(* 
p_¨gv
);

247 
FFI_TYPE_UINT8
:

248 *(*Ë
¨gp
 = ()*(
UINT8
 *)(* 
p_¨gv
);

251 
FFI_TYPE_SINT16
:

252 *(sig√d *Ë
¨gp
 = (sig√d )*(
SINT16
 *)(* 
p_¨gv
);

255 
FFI_TYPE_UINT16
:

256 *(*Ë
¨gp
 = ()*(
UINT16
 *)(* 
p_¨gv
);

259 
FFI_TYPE_STRUCT
:

260 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

264 
	`FFI_ASSERT
(0);

266 
¨gp
 +
z
;

268 i‡(
z
 == ())

270 #i‡
	`deföed
(
__SH4__
)

271 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_FLOAT
)

273 i‡(
‰eg
++ < 
NFREGARG
)

279 i‡(
gªg
++ < 
NGREGARG
)

282 *(*Ë
¨gp
 = ()*(
UINT32
 *)(* 
p_¨gv
);

283 
¨gp
 +
z
;

285 #i‡
	`deföed
(
__SH4__
)

286 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_DOUBLE
)

288 i‡(
‰eg
 + 1 < 
NFREGARG
)

290 
‰eg
 = (freg + 1) & ~1;

291 
‰eg
 += 2;

294 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

295 
¨gp
 +
z
;

300 
n
 = (
z
 +  () - 1) /  ();

301 i‡(
gªg
 + 
n
 - 1 < 
NGREGARG
)

303 
gªg
 +
n
;

306 #i‡(! 
	`deföed
(
__SH4__
))

307 i‡(
gªg
 < 
NGREGARG
)

309 
gªg
 = 
NGREGARG
;

313 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

314 
¨gp
 +
n
 *  ();

319 
	}
}

322 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

324 
i
, 
j
;

325 
size
, 
ty≥
;

326 
n
, 
m
;

327 
gªg
;

328 #i‡
	`deföed
(
__SH4__
)

329 
‰eg
 = 0;

332 
cif
->
Êags
 = 0;

334 
gªg
 = ((
	`ªtu∫_ty≥
 (
cif
->
πy≥
Ë=
FFI_TYPE_STRUCT
) &&

335 
STRUCT_VALUE_ADDRESS_WITH_ARG
) ? 1 : 0;

337 #i‡
	`deföed
(
__SH4__
)

338 
i
 = 
j
 = 0; i < 
cif
->
«rgs
 && j < 12; i++)

340 
ty≥
 = (
cif
->
¨g_ty≥s
)[
i
]->type;

341 
ty≥
)

343 
FFI_TYPE_FLOAT
:

344 i‡(
‰eg
 >
NFREGARG
)

346 
‰eg
++;

347 
cif
->
Êags
 +((cif->
¨g_ty≥s
)[
i
]->
ty≥
Ë<< (2 * 
j
);

348 
j
++;

351 
FFI_TYPE_DOUBLE
:

352 i‡((
‰eg
 + 1Ë>
NFREGARG
)

354 
‰eg
 = (freg + 1) & ~1;

355 
‰eg
 += 2;

356 
cif
->
Êags
 +((cif->
¨g_ty≥s
)[
i
]->
ty≥
Ë<< (2 * 
j
);

357 
j
++;

361 
size
 = (
cif
->
¨g_ty≥s
)[
i
]->size;

362 
n
 = (
size
 +  () - 1) /  ();

363 i‡(
gªg
 + 
n
 - 1 >
NGREGARG
)

365 
gªg
 +
n
;

366 
m
 = 0; m < 
n
; m++)

367 
cif
->
Êags
 +
FFI_TYPE_INT
 << (2 * 
j
++);

372 
i
 = 
j
 = 0; i < 
cif
->
«rgs
 && j < 4; i++)

374 
size
 = (
cif
->
¨g_ty≥s
)[
i
]->size;

375 
n
 = (
size
 +  () - 1) /  ();

376 i‡(
gªg
 >
NGREGARG
)

378 i‡(
gªg
 + 
n
 - 1 >
NGREGARG
)

379 
n
 = 
NGREGARG
 - 
gªg
;

380 
gªg
 +
n
;

381 
m
 = 0; m < 
n
; m++)

382 
cif
->
Êags
 +
FFI_TYPE_INT
 << (2 * 
j
++);

387 
cif
->
πy≥
->
ty≥
)

389 
FFI_TYPE_STRUCT
:

390 
cif
->
Êags
 +(Ë(
	`ªtu∫_ty≥
 (cif->
πy≥
)) << 24;

393 
FFI_TYPE_VOID
:

394 
FFI_TYPE_FLOAT
:

395 
FFI_TYPE_DOUBLE
:

396 
FFI_TYPE_SINT64
:

397 
FFI_TYPE_UINT64
:

398 
cif
->
Êags
 +(Ëcif->
πy≥
->
ty≥
 << 24;

402 
cif
->
Êags
 +
FFI_TYPE_INT
 << 24;

406  
FFI_OK
;

407 
	}
}

409 
ffi_ˇŒ_SYSV
((*)(*, 
exãnded_cif
 *),Éxtended_cif *,

410 , , *, (*
‚
)());

412 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

414 
exãnded_cif
 
ecif
;

415 
UINT64
 
åvÆue
;

417 
ecif
.
cif
 = cif;

418 
ecif
.
avÆue
 =ávalue;

423 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


424 && 
	`ªtu∫_ty≥
 (
cif
->
πy≥
Ë!
FFI_TYPE_STRUCT
)

425 
ecif
.
rvÆue
 = &
åvÆue
;

426 i‡((
rvÆue
 =
NULL
) &&

427 (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

429 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

432 
ecif
.
rvÆue
 =Ñvalue;

434 
cif
->
abi
)

436 
FFI_SYSV
:

437 
	`ffi_ˇŒ_SYSV
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
,

438 
‚
);

441 
	`FFI_ASSERT
(0);

445 i‡(
rvÆue


446 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


447 && 
	`ªtu∫_ty≥
 (
cif
->
πy≥
Ë!
FFI_TYPE_STRUCT
)

448 
	`mem˝y
 (
rvÆue
, &
åvÆue
, 
cif
->
πy≥
->
size
);

449 
	}
}

451 
ffi_˛osuª_SYSV
 ();

452 #i‡
deföed
(
__SH4__
)

453 
__ic_övÆid©e
 (*
löe
);

456 
ffi_°©us


457 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

458 
ffi_cif
* 
cif
,

459 (*
fun
)(
ffi_cif
*, *, **, *),

460 *
u£r_d©a
,

461 *
codñoc
)

463 *
åamp
;

464 
ö¢
;

466 i‡(
cif
->
abi
 !
FFI_SYSV
)

467  
FFI_BAD_ABI
;

469 
åamp
 = (*Ë&
˛osuª
->tramp[0];

471 
ö¢
 = (
	`ªtu∫_ty≥
 (
cif
->
πy≥
Ë=
FFI_TYPE_STRUCT


475 #ifde‡
__LITTLE_ENDIAN__


476 
åamp
[0] = 0xd301d102;

477 
åamp
[1] = 0x0000412b | (
ö¢
 << 16);

479 
åamp
[0] = 0xd102d301;

480 
åamp
[1] = 0x412b0000 | 
ö¢
;

482 *(**Ë&
åamp
[2] = (*)
codñoc
;

483 *(**Ë&
åamp
[3] = (*)
ffi_˛osuª_SYSV
;

485 
˛osuª
->
cif
 = cif;

486 
˛osuª
->
fun
 = fun;

487 
˛osuª
->
u£r_d©a
 = user_data;

489 #i‡
	`deföed
(
__SH4__
)

491 
	`__ic_övÆid©e
(
codñoc
);

494  
FFI_OK
;

495 
	}
}

505 #ifde‡
__LITTLE_ENDIAN__


506 
	#OFS_INT8
 0

	)

507 
	#OFS_INT16
 0

	)

509 
	#OFS_INT8
 3

	)

510 
	#OFS_INT16
 2

	)

514 
	$ffi_˛osuª_hñ≥r_SYSV
 (
ffi_˛osuª
 *
˛osuª
, *
rvÆue
,

515 *
pgr
, *
p‰
,

516 *
p°
)

518 **
avÆue
;

519 
ffi_ty≥
 **
p_¨g
;

520 
i
, 
avn
;

521 
úeg
, 
gªg
 = 0;

522 #i‡
	`deföed
(
__SH4__
)

523 
‰eg
 = 0;

525 
ffi_cif
 *
cif
;

527 
cif
 = 
˛osuª
->cif;

528 
avÆue
 = 
	`Æloˇ
(
cif
->
«rgs
 * (*));

532 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 && 
STRUCT_VALUE_ADDRESS_WITH_ARG
)

534 
rvÆue
 = (*Ë*
pgr
++;

535 
úeg
 = 1;

538 
úeg
 = 0;

540 
cif
 = 
˛osuª
->cif;

541 
gªg
 = 
úeg
;

542 
avn
 = 
cif
->
«rgs
;

545 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
; i < 
avn
; i++,Ö_arg++)

547 
size_t
 
z
;

549 
z
 = (*
p_¨g
)->
size
;

550 i‡(
z
 < ())

552 i‡(
gªg
++ >
NGREGARG
)

555 
z
 = ();

556 (*
p_¨g
)->
ty≥
)

558 
FFI_TYPE_SINT8
:

559 
FFI_TYPE_UINT8
:

560 
avÆue
[
i
] = (((*)
pgr
Ë+ 
OFS_INT8
);

563 
FFI_TYPE_SINT16
:

564 
FFI_TYPE_UINT16
:

565 
avÆue
[
i
] = (((*)
pgr
Ë+ 
OFS_INT16
);

568 
FFI_TYPE_STRUCT
:

569 
avÆue
[
i
] = 
pgr
;

573 
	`FFI_ASSERT
(0);

575 
pgr
++;

577 i‡(
z
 == ())

579 #i‡
	`deföed
(
__SH4__
)

580 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_FLOAT
)

582 i‡(
‰eg
++ >
NFREGARG
)

584 
avÆue
[
i
] = 
p‰
;

585 
p‰
++;

590 i‡(
gªg
++ >
NGREGARG
)

592 
avÆue
[
i
] = 
pgr
;

593 
pgr
++;

596 #i‡
	`deföed
(
__SH4__
)

597 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_DOUBLE
)

599 i‡(
‰eg
 + 1 >
NFREGARG
)

601 i‡(
‰eg
 & 1)

602 
p‰
++;

603 
‰eg
 = (freg + 1) & ~1;

604 
‰eg
 += 2;

605 
avÆue
[
i
] = 
p‰
;

606 
p‰
 += 2;

611 
n
 = (
z
 +  () - 1) /  ();

612 #i‡
	`deföed
(
__SH4__
)

613 i‡(
gªg
 + 
n
 - 1 >
NGREGARG
)

616 i‡(
gªg
 >
NGREGARG
)

619 
gªg
 +
n
;

620 
avÆue
[
i
] = 
pgr
;

621 
pgr
 +
n
;

625 
gªg
 = 
úeg
;

626 #i‡
	`deföed
(
__SH4__
)

627 
‰eg
 = 0;

630 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
; i < 
avn
; i++,Ö_arg++)

632 
size_t
 
z
;

634 
z
 = (*
p_¨g
)->
size
;

635 i‡(
z
 < ())

637 i‡(
gªg
++ < 
NGREGARG
)

640 
z
 = ();

641 (*
p_¨g
)->
ty≥
)

643 
FFI_TYPE_SINT8
:

644 
FFI_TYPE_UINT8
:

645 
avÆue
[
i
] = (((*)
p°
Ë+ 
OFS_INT8
);

648 
FFI_TYPE_SINT16
:

649 
FFI_TYPE_UINT16
:

650 
avÆue
[
i
] = (((*)
p°
Ë+ 
OFS_INT16
);

653 
FFI_TYPE_STRUCT
:

654 
avÆue
[
i
] = 
p°
;

658 
	`FFI_ASSERT
(0);

660 
p°
++;

662 i‡(
z
 == ())

664 #i‡
	`deföed
(
__SH4__
)

665 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_FLOAT
)

667 i‡(
‰eg
++ < 
NFREGARG
)

673 i‡(
gªg
++ < 
NGREGARG
)

676 
avÆue
[
i
] = 
p°
;

677 
p°
++;

679 #i‡
	`deföed
(
__SH4__
)

680 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_DOUBLE
)

682 i‡(
‰eg
 + 1 < 
NFREGARG
)

684 
‰eg
 = (freg + 1) & ~1;

685 
‰eg
 += 2;

688 
avÆue
[
i
] = 
p°
;

689 
p°
 += 2;

694 
n
 = (
z
 +  () - 1) /  ();

695 i‡(
gªg
 + 
n
 - 1 < 
NGREGARG
)

697 
gªg
 +
n
;

700 #i‡(! 
	`deföed
(
__SH4__
))

701 i‡(
gªg
 < 
NGREGARG
)

703 
gªg
 +
n
;

704 
p°
 +
gªg
 - 
NGREGARG
;

708 
avÆue
[
i
] = 
p°
;

709 
p°
 +
n
;

713 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

716  
	`ªtu∫_ty≥
 (
cif
->
πy≥
);

717 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


37 #i‚de‡
LIBFFI_ASM


38 
	tffi_¨g
;

39 sig√d 
	tffi_ßrg
;

41 
	effi_abi
 {

42 
	mFFI_FIRST_ABI
 = 0,

43 
	mFFI_SYSV
,

44 
	mFFI_LAST_ABI
,

45 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


46 } 
	tffi_abi
;

49 
	#FFI_CLOSURES
 1

	)

50 
	#FFI_TRAMPOLINE_SIZE
 16

	)

51 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh/sysv.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

30 #ifde‡
HAVE_MACHINE_ASM_H


31 
	~<machöe/asm.h
>

34 
	#CNAME
(
x
Ë
	)
x

35 
	#ENTRY
(
x
Ë.
globl
 
	`CNAME
(x); .
ty≥
 CNAME(x),%
fun˘i⁄
; CNAME(x):

	)

38 #i‡
deföed
(
__HITACHI__
)

39 
	#STRUCT_VALUE_ADDRESS_WITH_ARG
 1

	)

41 
	#STRUCT_VALUE_ADDRESS_WITH_ARG
 0

	)

44 .
	gãxt


46 #r4: 
ffi_¥ï_¨gs


47 #r5: &
ecif


48 #r6: 
byãs


49 #r7: 
Êags


50 #•+0: 
rvÆue


51 #•+4: 
‚


53 #Thi†
assumes
 
we
 
¨e
 
usög
 
gas
.

54 
	$ENTRY
(
ffi_ˇŒ_SYSV
)

55 #Savê
ªgi°îs


56 .
LFB1
:

57 
mov
.
l
 
r8
,@-
r15


58 .
LCFI0
:

59 
mov
.
l
 
r9
,@-
r15


60 .
LCFI1
:

61 
mov
.
l
 
r10
,@-
r15


62 .
LCFI2
:

63 
mov
.
l
 
r12
,@-
r15


64 .
LCFI3
:

65 
mov
.
l
 
r14
,@-
r15


66 .
LCFI4
:

67 
°s
.
l
 
¥
,@-
r15


68 .
LCFI5
:

69 
mov
 
r15
,
r14


70 .
LCFI6
:

71 #i‡
	`deföed
(
__SH4__
)

72 
mov
 
r6
,
r8


73 
mov
 
r7
,
r9


75 
sub
 
r6
,
r15


76 
add
 #-16,
r15


77 
mov
 #~7,
r0


78 
™d
 
r0
,
r15


80 
mov
 
r4
,
r0


81 
j§
 @
r0


82 
mov
 
r15
,
r4


84 
mov
 
r9
,
r1


85 
shÃ8
 
r9


86 
shÃ8
 
r9


87 
shÃ8
 
r9


89 
mov
 #FFI_TYPE_STRUCT,
r2


90 
cmp
/
eq
 
r2
,
r9


91 
bf
 1f

92 #i‡
STRUCT_VALUE_ADDRESS_WITH_ARG


93 
mov
.
l
 @
r15
+,
r4


94 
bø
 2f

95 
mov
 #5,
r2


97 
mov
.
l
 @
r15
+,
r10


100 
mov
 #4,
r2


102 
mov
 #4,
r3


104 
L_∑ss
:

105 
cmp
/
∂
 
r8


106 
bf
 
L_ˇŒ_ô


108 
mov
 
r1
,
r0


109 
™d
 #3,
r0


111 
L_∑ss_d
:

112 
cmp
/
eq
 #FFI_TYPE_DOUBLE,
r0


113 
bf
 
L_∑ss_f


115 
mov
 
r3
,
r0


116 
™d
 #1,
r0


117 
t°
 
r0
,r0

118 
bt
 1f

119 
add
 #1,
r3


121 
mov
 #12,
r0


122 
cmp
/
hs
 
r0
,
r3


123 
bt
/
s
 3f

124 
shÃ2
 
r1


125 
b§
 
L_p›_d


126 
n›


128 
add
 #2,
r3


129 
bø
 
L_∑ss


130 
add
 #-8,
r8


132 
L_p›_d
:

133 
mov
 
r3
,
r0


134 
add
 
r0
,r0

135 
add
 
r3
,
r0


136 
add
 #-12,
r0


137 
bøf
 
r0


138 
n›


139 #ifde‡
__LITTLE_ENDIAN__


140 
fmov
.
s
 @
r15
+,
‰5


141 
πs


142 
fmov
.
s
 @
r15
+,
‰4


143 
fmov
.
s
 @
r15
+,
‰7


144 
πs


145 
fmov
.
s
 @
r15
+,
‰6


146 
fmov
.
s
 @
r15
+,
‰9


147 
πs


148 
fmov
.
s
 @
r15
+,
‰8


149 
fmov
.
s
 @
r15
+,
‰11


150 
πs


151 
fmov
.
s
 @
r15
+,
‰10


153 
fmov
.
s
 @
r15
+,
‰4


154 
πs


155 
fmov
.
s
 @
r15
+,
‰5


156 
fmov
.
s
 @
r15
+,
‰6


157 
πs


158 
fmov
.
s
 @
r15
+,
‰7


159 
fmov
.
s
 @
r15
+,
‰8


160 
πs


161 
fmov
.
s
 @
r15
+,
‰9


162 
fmov
.
s
 @
r15
+,
‰10


163 
πs


164 
fmov
.
s
 @
r15
+,
‰11


167 
L_∑ss_f
:

168 
cmp
/
eq
 #FFI_TYPE_FLOAT,
r0


169 
bf
 
L_∑ss_i


171 
mov
 #12,
r0


172 
cmp
/
hs
 
r0
,
r3


173 
bt
/
s
 2f

174 
shÃ2
 
r1


175 
b§
 
L_p›_f


176 
n›


178 
add
 #1,
r3


179 
bø
 
L_∑ss


180 
add
 #-4,
r8


182 
L_p›_f
:

183 
mov
 
r3
,
r0


184 
shŒ2
 
r0


185 
add
 #-16,
r0


186 
bøf
 
r0


187 
n›


188 #ifde‡
__LITTLE_ENDIAN__


189 
πs


190 
fmov
.
s
 @
r15
+,
‰5


191 
πs


192 
fmov
.
s
 @
r15
+,
‰4


193 
πs


194 
fmov
.
s
 @
r15
+,
‰7


195 
πs


196 
fmov
.
s
 @
r15
+,
‰6


197 
πs


198 
fmov
.
s
 @
r15
+,
‰9


199 
πs


200 
fmov
.
s
 @
r15
+,
‰8


201 
πs


202 
fmov
.
s
 @
r15
+,
‰11


203 
πs


204 
fmov
.
s
 @
r15
+,
‰10


206 
πs


207 
fmov
.
s
 @
r15
+,
‰4


208 
πs


209 
fmov
.
s
 @
r15
+,
‰5


210 
πs


211 
fmov
.
s
 @
r15
+,
‰6


212 
πs


213 
fmov
.
s
 @
r15
+,
‰7


214 
πs


215 
fmov
.
s
 @
r15
+,
‰8


216 
πs


217 
fmov
.
s
 @
r15
+,
‰9


218 
πs


219 
fmov
.
s
 @
r15
+,
‰10


220 
πs


221 
fmov
.
s
 @
r15
+,
‰11


224 
L_∑ss_i
:

225 
cmp
/
eq
 #FFI_TYPE_INT,
r0


226 
bf
 
L_ˇŒ_ô


228 
mov
 #8,
r0


229 
cmp
/
hs
 
r0
,
r2


230 
bt
/
s
 2f

231 
shÃ2
 
r1


232 
b§
 
L_p›_i


233 
n›


235 
add
 #1,
r2


236 
bø
 
L_∑ss


237 
add
 #-4,
r8


239 
L_p›_i
:

240 
mov
 
r2
,
r0


241 
shŒ2
 
r0


242 
add
 #-16,
r0


243 
bøf
 
r0


244 
n›


245 
πs


246 
mov
.
l
 @
r15
+,
r4


247 
πs


248 
mov
.
l
 @
r15
+,
r5


249 
πs


250 
mov
.
l
 @
r15
+,
r6


251 
πs


252 
mov
.
l
 @
r15
+,
r7


254 
L_ˇŒ_ô
:

255 #ˇŒ 
fun˘i⁄


256 #i‡(! 
STRUCT_VALUE_ADDRESS_WITH_ARG
)

257 
mov
 
r10
, 
r2


259 
mov
.
l
 @(28,
r14
),
r1


260 
j§
 @
r1


261 
n›


263 
L_ªt_d
:

264 
mov
 #FFI_TYPE_DOUBLE,
r2


265 
cmp
/
eq
 
r2
,
r9


266 
bf
 
L_ªt_Œ


268 
mov
.
l
 @(24,
r14
),
r1


269 #ifde‡
__LITTLE_ENDIAN__


270 
fmov
.
s
 
‰1
,@
r1


271 
add
 #4,
r1


272 
bø
 
L_ïûogue


273 
fmov
.
s
 
‰0
,@
r1


275 
fmov
.
s
 
‰0
,@
r1


276 
add
 #4,
r1


277 
bø
 
L_ïûogue


278 
fmov
.
s
 
‰1
,@
r1


281 
L_ªt_Œ
:

282 
mov
 #FFI_TYPE_SINT64,
r2


283 
cmp
/
eq
 
r2
,
r9


284 
bt
/
s
 1f

285 
mov
 #FFI_TYPE_UINT64,
r2


286 
cmp
/
eq
 
r2
,
r9


287 
bf
 
L_ªt_f


290 
mov
.
l
 @(24,
r14
),
r2


291 
mov
.
l
 
r0
,@
r2


292 
bø
 
L_ïûogue


293 
mov
.
l
 
r1
,@(4,
r2
)

295 
L_ªt_f
:

296 
mov
 #FFI_TYPE_FLOAT,
r2


297 
cmp
/
eq
 
r2
,
r9


298 
bf
 
L_ªt_i


300 
mov
.
l
 @(24,
r14
),
r1


301 
bø
 
L_ïûogue


302 
fmov
.
s
 
‰0
,@
r1


304 
L_ªt_i
:

305 
mov
 #FFI_TYPE_INT,
r2


306 
cmp
/
eq
 
r2
,
r9


307 
bf
 
L_ïûogue


309 
mov
.
l
 @(24,
r14
),
r1


310 
bø
 
L_ïûogue


311 
mov
.
l
 
r0
,@
r1


313 
L_ïûogue
:

314 #Removê
the
 
•a˚
 
we
 
pushed
 thê
¨gs


315 
mov
 
r14
,
r15


317 
lds
.
l
 @
r15
+,
¥


318 
mov
.
l
 @
r15
+,
r14


319 
mov
.
l
 @
r15
+,
r12


320 
mov
.
l
 @
r15
+,
r10


321 
mov
.
l
 @
r15
+,
r9


322 
πs


323 
mov
.
l
 @
r15
+,
r8


325 
mov
 
r6
,
r8


326 
mov
 
r7
,
r9


328 
sub
 
r6
,
r15


329 
add
 #-16,
r15


330 
mov
 #~7,
r0


331 
™d
 
r0
,
r15


333 
mov
 
r4
,
r0


334 
j§
 @
r0


335 
mov
 
r15
,
r4


337 
mov
 
r9
,
r3


338 
shÃ8
 
r9


339 
shÃ8
 
r9


340 
shÃ8
 
r9


342 
mov
 #FFI_TYPE_STRUCT,
r2


343 
cmp
/
eq
 
r2
,
r9


344 
bf
 1f

345 #i‡
STRUCT_VALUE_ADDRESS_WITH_ARG


346 
mov
.
l
 @
r15
+,
r4


347 
bø
 2f

348 
mov
 #5,
r2


350 
mov
.
l
 @
r15
+,
r10


353 
mov
 #4,
r2


356 
L_∑ss
:

357 
cmp
/
∂
 
r8


358 
bf
 
L_ˇŒ_ô


360 
mov
 
r3
,
r0


361 
™d
 #3,
r0


363 
L_∑ss_d
:

364 
cmp
/
eq
 #FFI_TYPE_DOUBLE,
r0


365 
bf
 
L_∑ss_i


367 
mov
 
r15
,
r0


368 
™d
 #7,
r0


369 
t°
 
r0
,r0

370 
bt
 1f

371 
add
 #4,
r15


373 
mov
 #8,
r0


374 
cmp
/
hs
 
r0
,
r2


375 
bt
/
s
 2f

376 
shÃ2
 
r3


377 
b§
 
L_p›_d


378 
n›


380 
add
 #2,
r2


381 
bø
 
L_∑ss


382 
add
 #-8,
r8


384 
L_p›_d
:

385 
mov
 
r2
,
r0


386 
add
 
r0
,r0

387 
add
 
r2
,
r0


388 
add
 #-12,
r0


389 
add
 
r0
,r0

390 
bøf
 
r0


391 
n›


392 
mov
.
l
 @
r15
+,
r4


393 
πs


394 
mov
.
l
 @
r15
+,
r5


395 
mov
.
l
 @
r15
+,
r5


396 
πs


397 
mov
.
l
 @
r15
+,
r6


398 
mov
.
l
 @
r15
+,
r6


399 
πs


400 
mov
.
l
 @
r15
+,
r7


401 
πs


402 
mov
.
l
 @
r15
+,
r7


404 
L_∑ss_i
:

405 
cmp
/
eq
 #FFI_TYPE_INT,
r0


406 
bf
 
L_ˇŒ_ô


408 
mov
 #8,
r0


409 
cmp
/
hs
 
r0
,
r2


410 
bt
/
s
 2f

411 
shÃ2
 
r3


412 
b§
 
L_p›_i


413 
n›


415 
add
 #1,
r2


416 
bø
 
L_∑ss


417 
add
 #-4,
r8


419 
L_p›_i
:

420 
mov
 
r2
,
r0


421 
shŒ2
 
r0


422 
add
 #-16,
r0


423 
bøf
 
r0


424 
n›


425 
πs


426 
mov
.
l
 @
r15
+,
r4


427 
πs


428 
mov
.
l
 @
r15
+,
r5


429 
πs


430 
mov
.
l
 @
r15
+,
r6


431 
πs


432 
mov
.
l
 @
r15
+,
r7


434 
L_ˇŒ_ô
:

435 #ˇŒ 
fun˘i⁄


436 #i‡(! 
STRUCT_VALUE_ADDRESS_WITH_ARG
)

437 
mov
 
r10
, 
r2


439 
mov
.
l
 @(28,
r14
),
r1


440 
j§
 @
r1


441 
n›


443 
L_ªt_d
:

444 
mov
 #FFI_TYPE_DOUBLE,
r2


445 
cmp
/
eq
 
r2
,
r9


446 
bf
 
L_ªt_Œ


448 
mov
.
l
 @(24,
r14
),
r2


449 
mov
.
l
 
r0
,@
r2


450 
bø
 
L_ïûogue


451 
mov
.
l
 
r1
,@(4,
r2
)

453 
L_ªt_Œ
:

454 
mov
 #FFI_TYPE_SINT64,
r2


455 
cmp
/
eq
 
r2
,
r9


456 
bt
/
s
 1f

457 
mov
 #FFI_TYPE_UINT64,
r2


458 
cmp
/
eq
 
r2
,
r9


459 
bf
 
L_ªt_i


462 
mov
.
l
 @(24,
r14
),
r2


463 
mov
.
l
 
r0
,@
r2


464 
bø
 
L_ïûogue


465 
mov
.
l
 
r1
,@(4,
r2
)

467 
L_ªt_i
:

468 
mov
 #FFI_TYPE_FLOAT,
r2


469 
cmp
/
eq
 
r2
,
r9


470 
bt
 1f

471 
mov
 #FFI_TYPE_INT,
r2


472 
cmp
/
eq
 
r2
,
r9


473 
bf
 
L_ïûogue


475 
mov
.
l
 @(24,
r14
),
r1


476 
bø
 
L_ïûogue


477 
mov
.
l
 
r0
,@
r1


479 
L_ïûogue
:

480 #Removê
the
 
•a˚
 
we
 
pushed
 thê
¨gs


481 
mov
 
r14
,
r15


483 
lds
.
l
 @
r15
+,
¥


484 
mov
.
l
 @
r15
+,
r14


485 
mov
.
l
 @
r15
+,
r12


486 
mov
.
l
 @
r15
+,
r10


487 
mov
.
l
 @
r15
+,
r9


488 
πs


489 
mov
.
l
 @
r15
+,
r8


491 .
LFE1
:

492 .
ffi_ˇŒ_SYSV_íd
:

493 .
size
 
	`CNAME
(
ffi_ˇŒ_SYSV
),.
ffi_ˇŒ_SYSV_íd
-CNAME(ffi_call_SYSV)

495 .
globl
 
ffi_˛osuª_hñ≥r_SYSV


497 
	`ENTRY
(
ffi_˛osuª_SYSV
)

498 .
LFB2
:

499 
mov
.
l
 
r7
,@-
r15


500 .
LCFI7
:

501 
mov
.
l
 
r6
,@-
r15


502 .
LCFI8
:

503 
mov
.
l
 
r5
,@-
r15


504 .
LCFI9
:

505 
mov
.
l
 
r4
,@-
r15


506 .
LCFIA
:

507 
mov
.
l
 
r14
,@-
r15


508 .
LCFIB
:

509 
°s
.
l
 
¥
,@-
r15


522 .
LCFIC
:

523 #i‡
	`deföed
(
__SH4__
)

524 
add
 #-48,
r15


526 
add
 #-16,
r15


528 .
LCFID
:

529 
mov
 
r15
,
r14


530 .
LCFIE
:

532 #i‡
	`deföed
(
__SH4__
)

533 
mov
 
r14
,
r1


534 
add
 #48,
r1


535 #ifde‡
__LITTLE_ENDIAN__


536 
fmov
.
s
 
‰10
,@-
r1


537 
fmov
.
s
 
‰11
,@-
r1


538 
fmov
.
s
 
‰8
,@-
r1


539 
fmov
.
s
 
‰9
,@-
r1


540 
fmov
.
s
 
‰6
,@-
r1


541 
fmov
.
s
 
‰7
,@-
r1


542 
fmov
.
s
 
‰4
,@-
r1


543 
fmov
.
s
 
‰5
,@-
r1


545 
fmov
.
s
 
‰11
,@-
r1


546 
fmov
.
s
 
‰10
,@-
r1


547 
fmov
.
s
 
‰9
,@-
r1


548 
fmov
.
s
 
‰8
,@-
r1


549 
fmov
.
s
 
‰7
,@-
r1


550 
fmov
.
s
 
‰6
,@-
r1


551 
fmov
.
s
 
‰5
,@-
r1


552 
fmov
.
s
 
‰4
,@-
r1


554 
mov
 
r1
,
r7


555 
mov
 
r14
,
r6


556 
add
 #56,
r6


558 
mov
 
r14
,
r6


559 
add
 #24,
r6


562 
bt
/
s
 10f

563 
mov
 
r2
, 
r5


564 
mov
 
r14
,
r1


565 
add
 #8,
r1


566 
mov
 
r1
,
r5


569 
mov
 
r14
,
r1


570 #i‡
	`deföed
(
__SH4__
)

571 
add
 #72,
r1


573 
add
 #40,
r1


575 
mov
.
l
 
r1
,@
r14


577 #ifde‡
PIC


578 
mov
.
l
 
L_gŸ
,
r1


579 
mova
 
L_gŸ
,
r0


580 
add
 
r0
,
r1


581 
mov
.
l
 
L_hñ≥r
,
r0


582 
add
 
r1
,
r0


584 
mov
.
l
 
L_hñ≥r
,
r0


586 
j§
 @
r0


587 
mov
 
r3
,
r4


589 
shŒ
 
r0


590 
mov
 
r0
,
r1


591 
mova
 
L_èbÀ
,
r0


592 
add
 
r1
,
r0


593 
mov
.
w
 @
r0
,r0

594 
mov
 
r14
,
r2


595 
bøf
 
r0


596 
add
 #8,
r2


598 .
Æign
 2

599 #ifde‡
PIC


600 
L_gŸ
:

601 .
_GLOBAL_OFFSET_TABLE_


602 
L_hñ≥r
:

603 .
ffi_˛osuª_hñ≥r_SYSV
@
GOTOFF


605 
L_hñ≥r
:

606 .
ffi_˛osuª_hñ≥r_SYSV


608 
L_èbÀ
:

609 .
L_ˇ£_v
 - 0b

610 .
L_ˇ£_i
 - 0b

611 #i‡
	`deföed
(
__SH4__
)

612 .
L_ˇ£_f
 - 0b

613 .
L_ˇ£_d
 - 0b

614 .
L_ˇ£_d
 - 0b

616 .
L_ˇ£_i
 - 0b

617 .
L_ˇ£_Œ
 - 0b

618 .
L_ˇ£_Œ
 - 0b

620 .
L_ˇ£_uq
 - 0b

621 .
L_ˇ£_q
 - 0b

622 .
L_ˇ£_uh
 - 0b

623 .
L_ˇ£_h
 - 0b

624 .
L_ˇ£_i
 - 0b

625 .
L_ˇ£_i
 - 0b

626 .
L_ˇ£_Œ
 - 0b

627 .
L_ˇ£_Œ
 - 0b

628 .
L_ˇ£_v
 - 0b

629 .
L_ˇ£_i
 - 0b

631 #i‡
	`deföed
(
__SH4__
)

632 
L_ˇ£_d
:

633 #ifde‡
__LITTLE_ENDIAN__


634 
fmov
.
s
 @
r2
+,
‰1


635 
bø
 
L_ˇ£_v


636 
fmov
.
s
 @
r2
,
‰0


638 
fmov
.
s
 @
r2
+,
‰0


639 
bø
 
L_ˇ£_v


640 
fmov
.
s
 @
r2
,
‰1


643 
L_ˇ£_f
:

644 
bø
 
L_ˇ£_v


645 
fmov
.
s
 @
r2
,
‰0


648 
L_ˇ£_Œ
:

649 
mov
.
l
 @
r2
+,
r0


650 
bø
 
L_ˇ£_v


651 
mov
.
l
 @
r2
,
r1


653 
L_ˇ£_i
:

654 
bø
 
L_ˇ£_v


655 
mov
.
l
 @
r2
,
r0


657 
L_ˇ£_q
:

658 #ifde‡
__LITTLE_ENDIAN__


660 
add
 #3,
r2


662 
bø
 
L_ˇ£_v


663 
mov
.
b
 @
r2
,
r0


665 
L_ˇ£_uq
:

666 #ifde‡
__LITTLE_ENDIAN__


668 
add
 #3,
r2


670 
mov
.
b
 @
r2
,
r0


671 
bø
 
L_ˇ£_v


672 
extu
.
b
 
r0
,r0

674 
L_ˇ£_h
:

675 #ifde‡
__LITTLE_ENDIAN__


677 
add
 #2,
r2


679 
bø
 
L_ˇ£_v


680 
mov
.
w
 @
r2
,
r0


682 
L_ˇ£_uh
:

683 #ifde‡
__LITTLE_ENDIAN__


685 
add
 #2,
r2


687 
mov
.
w
 @
r2
,
r0


688 
extu
.
w
 
r0
,r0

691 
L_ˇ£_v
:

692 #i‡
	`deföed
(
__SH4__
)

693 
add
 #48,
r15


695 
add
 #16,
r15


697 
lds
.
l
 @
r15
+,
¥


698 
mov
.
l
 @
r15
+,
r14


699 
πs


700 
add
 #16,
r15


701 .
LFE2
:

702 .
ffi_˛osuª_SYSV_íd
:

703 .
size
 
	`CNAME
(
ffi_˛osuª_SYSV
),.
ffi_˛osuª_SYSV_íd
-
	$CNAME
(
ffi_˛osuª_SYSV
)

705 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


706 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


709 .
£˘i⁄
 ".eh_‰ame","aw",@
¥ogbôs


710 
__FRAME_BEGIN__
:

711 .4b
yã
 .
LECIE1
-.
LSCIE1


712 .
LSCIE1
:

713 .4b
yã
 0x0

714 .
byã
 0x1

715 #ifde‡
PIC


716 .
ascii
 "zR\0"

718 .
byã
 0x0

720 .
byã
 0x1

721 .
byã
 0x7c

722 .
byã
 0x11

723 #ifde‡
PIC


724 .
uÀb128
 0x1

725 .
byã
 0x10

727 .
byã
 0xc

728 .
byã
 0xf

729 .
byã
 0x0

730 .
Æign
 2

731 .
LECIE1
:

732 .
LSFDE1
:

733 .4b
yã
 .
LEFDE1
-.
LASFDE1


734 .
LASFDE1
:

735 .4b
yã
 .
LASFDE1
-
__FRAME_BEGIN__


736 #ifde‡
PIC


737 .4b
yã
 .
LFB1
-.

739 .4b
yã
 .
LFB1


741 .4b
yã
 .
LFE1
-.
LFB1


742 #ifde‡
PIC


743 .
uÀb128
 0x0

745 .
byã
 0x4

746 .4b
yã
 .
LCFI0
-.
LFB1


747 .
byã
 0xe

748 .
byã
 0x4

749 .
byã
 0x4

750 .4b
yã
 .
LCFI1
-.
LCFI0


751 .
byã
 0xe

752 .
byã
 0x8

753 .
byã
 0x4

754 .4b
yã
 .
LCFI2
-.
LCFI1


755 .
byã
 0xe

756 .
byã
 0xc

757 .
byã
 0x4

758 .4b
yã
 .
LCFI3
-.
LCFI2


759 .
byã
 0xe

760 .
byã
 0x10

761 .
byã
 0x4

762 .4b
yã
 .
LCFI4
-.
LCFI3


763 .
byã
 0xe

764 .
byã
 0x14

765 .
byã
 0x4

766 .4b
yã
 .
LCFI5
-.
LCFI4


767 .
byã
 0xe

768 .
byã
 0x18

769 .
byã
 0x91

770 .
byã
 0x6

771 .
byã
 0x8e

772 .
byã
 0x5

773 .
byã
 0x8c

774 .
byã
 0x4

775 .
byã
 0x8a

776 .
byã
 0x3

777 .
byã
 0x89

778 .
byã
 0x2

779 .
byã
 0x88

780 .
byã
 0x1

781 .
byã
 0x4

782 .4b
yã
 .
LCFI6
-.
LCFI5


783 .
byã
 0xd

784 .
byã
 0xe

785 .
Æign
 2

786 .
LEFDE1
:

788 .
LSFDE3
:

789 .4b
yã
 .
LEFDE3
-.
LASFDE3


790 .
LASFDE3
:

791 .4b
yã
 .
LASFDE3
-
__FRAME_BEGIN__


792 #ifde‡
PIC


793 .4b
yã
 .
LFB2
-.

795 .4b
yã
 .
LFB2


797 .4b
yã
 .
LFE2
-.
LFB2


798 #ifde‡
PIC


799 .
uÀb128
 0x0

801 .
byã
 0x4

802 .4b
yã
 .
LCFI7
-.
LFB2


803 .
byã
 0xe

804 .
byã
 0x4

805 .
byã
 0x4

806 .4b
yã
 .
LCFI8
-.
LCFI7


807 .
byã
 0xe

808 .
byã
 0x8

809 .
byã
 0x4

810 .4b
yã
 .
LCFI9
-.
LCFI8


811 .
byã
 0xe

812 .
byã
 0xc

813 .
byã
 0x4

814 .4b
yã
 .
LCFIA
-.
LCFI9


815 .
byã
 0xe

816 .
byã
 0x10

817 .
byã
 0x4

818 .4b
yã
 .
LCFIB
-.
LCFIA


819 .
byã
 0xe

820 .
byã
 0x14

821 .
byã
 0x4

822 .4b
yã
 .
LCFIC
-.
LCFIB


823 .
byã
 0xe

824 .
byã
 0x18

825 .
byã
 0x4

826 .4b
yã
 .
LCFID
-.
LCFIC


827 .
byã
 0xe

828 #i‡
	`deföed
(
__SH4__
)

829 .
byã
 24+48

831 .
byã
 24+16

833 .
byã
 0x91

834 .
byã
 0x6

835 .
byã
 0x8e

836 .
byã
 0x5

837 .
byã
 0x84

838 .
byã
 0x4

839 .
byã
 0x85

840 .
byã
 0x3

841 .
byã
 0x86

842 .
byã
 0x2

843 .
byã
 0x87

844 .
byã
 0x1

845 .
byã
 0x4

846 .4b
yã
 .
LCFIE
-.
LCFID


847 .
byã
 0xd

848 .
byã
 0xe

849 .
Æign
 2

850 .
LEFDE3
:

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh64/ffi.c

28 
	~<ffi.h
>

29 
	~<ffi_comm⁄.h
>

31 
	~<°dlib.h
>

33 
	#NGREGARG
 8

	)

34 
	#NFREGARG
 12

	)

37 
	$ªtu∫_ty≥
 (
ffi_ty≥
 *
¨g
)

40 i‡(
¨g
->
ty≥
 !
FFI_TYPE_STRUCT
)

41  
¨g
->
ty≥
;

44 i‡(
¨g
->
size
 < (
UINT8
))

45  
FFI_TYPE_UINT8
;

46 i‡(
¨g
->
size
 < (
UINT16
))

47  
FFI_TYPE_UINT16
;

48 i‡(
¨g
->
size
 < (
UINT32
))

49  
FFI_TYPE_UINT32
;

50 i‡(
¨g
->
size
 < (
UINT64
))

51  
FFI_TYPE_UINT64
;

53  
FFI_TYPE_STRUCT
;

54 
	}
}

59 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

61 
i
;

62 
avn
;

63 **
p_¨gv
;

64 *
¨gp
;

65 
ffi_ty≥
 **
p_¨g
;

67 
¨gp
 = 
°ack
;

69 i‡(
	`ªtu∫_ty≥
 (
ecif
->
cif
->
πy≥
Ë=
FFI_TYPE_STRUCT
)

71 *(**Ë
¨gp
 = 
ecif
->
rvÆue
;

72 
¨gp
 + (
UINT64
);

75 
avn
 = 
ecif
->
cif
->
«rgs
;

76 
p_¨gv
 = 
ecif
->
avÆue
;

78 
i
 = 0, 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
; i < 
avn
; i++,Ö_¨g++, 
p_¨gv
++)

80 
size_t
 
z
;

81 
Æign
;

83 
z
 = (*
p_¨g
)->
size
;

84 
Æign
 = (*
p_¨g
)->
Æignmít
;

85 i‡(
z
 <  (
UINT32
))

87 (*
p_¨g
)->
ty≥
)

89 
FFI_TYPE_SINT8
:

90 *(
SINT64
 *Ë
¨gp
 = (SINT64Ë*(
SINT8
 *)(*
p_¨gv
);

93 
FFI_TYPE_UINT8
:

94 *(
UINT64
 *Ë
¨gp
 = (UINT64Ë*(
UINT8
 *)(*
p_¨gv
);

97 
FFI_TYPE_SINT16
:

98 *(
SINT64
 *Ë
¨gp
 = (SINT64Ë*(
SINT16
 *)(*
p_¨gv
);

101 
FFI_TYPE_UINT16
:

102 *(
UINT64
 *Ë
¨gp
 = (UINT64Ë*(
UINT16
 *)(*
p_¨gv
);

105 
FFI_TYPE_STRUCT
:

106 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

110 
	`FFI_ASSERT
(0);

112 
¨gp
 + (
UINT64
);

114 i‡(
z
 = (
UINT32
Ë&& 
Æign
 ==  (UINT32))

116 (*
p_¨g
)->
ty≥
)

118 
FFI_TYPE_INT
:

119 
FFI_TYPE_SINT32
:

120 *(
SINT64
 *Ë
¨gp
 = (SINT64Ë*(
SINT32
 *Ë(*
p_¨gv
);

123 
FFI_TYPE_FLOAT
:

124 
FFI_TYPE_POINTER
:

125 
FFI_TYPE_UINT32
:

126 
FFI_TYPE_STRUCT
:

127 *(
UINT64
 *Ë
¨gp
 = (UINT64Ë*(
UINT32
 *Ë(*
p_¨gv
);

131 
	`FFI_ASSERT
(0);

134 
¨gp
 + (
UINT64
);

136 i‡(
z
 = (
UINT64
)

137 && 
Æign
 = (
UINT64
)

138 && ((Ë*
p_¨gv
 & ( (
UINT64
) - 1)) == 0)

140 *(
UINT64
 *Ë
¨gp
 = *(UINT64 *Ë(*
p_¨gv
);

141 
¨gp
 + (
UINT64
);

145 
n
 = (
z
 +  (
UINT64
) - 1) /  (UINT64);

147 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

148 
¨gp
 +
n
 *  (
UINT64
);

153 
	}
}

156 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

158 
i
, 
j
;

159 
size
, 
ty≥
;

160 
n
, 
m
;

161 
gªg
;

162 
‰eg
;

163 
Âaú
 = -1;

165 
gªg
 = (
	`ªtu∫_ty≥
 (
cif
->
πy≥
Ë=
FFI_TYPE_STRUCT
 ? 1 : 0);

166 
‰eg
 = 0;

167 
cif
->
Êags2
 = 0;

169 
i
 = 
j
 = 0; i < 
cif
->
«rgs
; i++)

171 
ty≥
 = (
cif
->
¨g_ty≥s
)[
i
]->type;

172 
ty≥
)

174 
FFI_TYPE_FLOAT
:

175 
gªg
++;

176 
cif
->
byãs
 + (
UINT64
) -  ();

177 i‡(
‰eg
 >
NFREGARG
 - 1)

179 i‡(
Âaú
 < 0)

181 
Âaú
 = 
‰eg
;

182 
‰eg
 += 2;

185 
Âaú
 = -1;

186 
cif
->
Êags2
 +((cif->
¨g_ty≥s
)[
i
]->
ty≥
Ë<< (2 * 
j
++);

189 
FFI_TYPE_DOUBLE
:

190 i‡(
gªg
++ >
NGREGARG
 && (
‰eg
 + 1Ë>
NFREGARG
)

192 i‡((
‰eg
 + 1Ë< 
NFREGARG
)

194 
‰eg
 += 2;

195 
cif
->
Êags2
 +((cif->
¨g_ty≥s
)[
i
]->
ty≥
Ë<< (2 * 
j
++);

198 
cif
->
Êags2
 +
FFI_TYPE_INT
 << (2 * 
j
++);

202 
size
 = (
cif
->
¨g_ty≥s
)[
i
]->size;

203 i‡(
size
 <  (
UINT64
))

204 
cif
->
byãs
 + (
UINT64
Ë- 
size
;

205 
n
 = (
size
 +  (
UINT64
) - 1) /  (UINT64);

206 i‡(
gªg
 >
NGREGARG
)

208 i‡(
gªg
 + 
n
 - 1 >
NGREGARG
)

209 
gªg
 = 
NGREGARG
;

211 
gªg
 +
n
;

212 
m
 = 0; m < 
n
; m++)

213 
cif
->
Êags2
 +
FFI_TYPE_INT
 << (2 * 
j
++);

219 
cif
->
πy≥
->
ty≥
)

221 
FFI_TYPE_STRUCT
:

222 
cif
->
Êags
 = 
	`ªtu∫_ty≥
 (cif->
πy≥
);

225 
FFI_TYPE_VOID
:

226 
FFI_TYPE_FLOAT
:

227 
FFI_TYPE_DOUBLE
:

228 
FFI_TYPE_SINT64
:

229 
FFI_TYPE_UINT64
:

230 
cif
->
Êags
 = cif->
πy≥
->
ty≥
;

234 
cif
->
Êags
 = 
FFI_TYPE_INT
;

238  
FFI_OK
;

239 
	}
}

243 
ffi_ˇŒ_SYSV
((*)(*, 
exãnded_cif
 *),

244  
exãnded_cif
 *,

247 (*
‚
)());

251 
	`ffi_ˇŒ
–
ffi_cif
 *
cif
,

252 (*
‚
)(),

253  *
rvÆue
,

254  **
avÆue
)

256 
exãnded_cif
 
ecif
;

257 
UINT64
 
åvÆue
;

259 
ecif
.
cif
 = cif;

260 
ecif
.
avÆue
 =ávalue;

265 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


266 && 
	`ªtu∫_ty≥
 (
cif
->
πy≥
Ë!
FFI_TYPE_STRUCT
)

267 
ecif
.
rvÆue
 = &
åvÆue
;

268 i‡((
rvÆue
 =
NULL
) &&

269 (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
))

271 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

274 
ecif
.
rvÆue
 =Ñvalue;

276 
cif
->
abi
)

278 
FFI_SYSV
:

279 
	`ffi_ˇŒ_SYSV
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
, cif->
Êags
, cif->
Êags2
,

280 
ecif
.
rvÆue
, 
‚
);

283 
	`FFI_ASSERT
(0);

287 i‡(
rvÆue


288 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


289 && 
	`ªtu∫_ty≥
 (
cif
->
πy≥
Ë!
FFI_TYPE_STRUCT
)

290 
	`mem˝y
 (
rvÆue
, &
åvÆue
, 
cif
->
πy≥
->
size
);

291 
	}
}

293 
ffi_˛osuª_SYSV
 ();

294 
__ic_övÆid©e
 (*
löe
);

296 
ffi_°©us


297 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
 *
˛osuª
,

298 
ffi_cif
 *
cif
,

299 (*
fun
)(
ffi_cif
*, *, **, *),

300 *
u£r_d©a
,

301 *
codñoc
)

303 *
åamp
;

305 i‡(
cif
->
abi
 !
FFI_SYSV
)

306  
FFI_BAD_ABI
;

308 
åamp
 = (*Ë&
˛osuª
->tramp[0];

316 #ifde‡
__LITTLE_ENDIAN__


317 
åamp
[0] = 0x7001c701;

318 
åamp
[1] = 0x0009402b;

320 
åamp
[0] = 0xc7017001;

321 
åamp
[1] = 0x402b0009;

323 
åamp
[2] = 0xcc000010 | (((
UINT32
Ë
ffi_˛osuª_SYSV
) >> 16) << 10;

324 
åamp
[3] = 0xc8000010 | (((
UINT32
Ë
ffi_˛osuª_SYSV
) & 0xffff) << 10;

325 
åamp
[4] = 0x6bf10600;

326 
åamp
[5] = 0xcc000010 | (((
UINT32
Ë
codñoc
) >> 16) << 10;

327 
åamp
[6] = 0xc8000010 | (((
UINT32
Ë
codñoc
) & 0xffff) << 10;

328 
åamp
[7] = 0x4401fff0;

330 
˛osuª
->
cif
 = cif;

331 
˛osuª
->
fun
 = fun;

332 
˛osuª
->
u£r_d©a
 = user_data;

335 
asm
 vﬁ©ûê("ocbwb %0,0; synco; icbò%1,0; synci" : : "r" (
åamp
),

336 "r"(
codñoc
));

338  
FFI_OK
;

339 
	}
}

350 
	$ffi_˛osuª_hñ≥r_SYSV
 (
ffi_˛osuª
 *
˛osuª
, 
UINT64
 *
rvÆue
,

351 
UINT64
 *
pgr
, UINT64 *
p‰
, UINT64 *
p°
)

353 **
avÆue
;

354 
ffi_ty≥
 **
p_¨g
;

355 
i
, 
avn
;

356 
gªg
, 
‰eg
;

357 
ffi_cif
 *
cif
;

358 
Âaú
 = -1;

360 
cif
 = 
˛osuª
->cif;

361 
avÆue
 = 
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

365 i‡(
	`ªtu∫_ty≥
 (
cif
->
πy≥
Ë=
FFI_TYPE_STRUCT
)

367 
rvÆue
 = (
UINT64
 *Ë*
pgr
;

368 
gªg
 = 1;

371 
gªg
 = 0;

373 
‰eg
 = 0;

374 
cif
 = 
˛osuª
->cif;

375 
avn
 = 
cif
->
«rgs
;

378 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
; i < 
avn
; i++,Ö_arg++)

380 
size_t
 
z
;

381 *
p
;

383 
z
 = (*
p_¨g
)->
size
;

384 i‡(
z
 <  (
UINT32
))

386 
p
 = 
pgr
 + 
gªg
++;

388 (*
p_¨g
)->
ty≥
)

390 
FFI_TYPE_SINT8
:

391 
FFI_TYPE_UINT8
:

392 
FFI_TYPE_SINT16
:

393 
FFI_TYPE_UINT16
:

394 
FFI_TYPE_STRUCT
:

395 #ifde‡
__LITTLE_ENDIAN__


396 
avÆue
[
i
] = 
p
;

398 
avÆue
[
i
] = ((*Ë
p
Ë+  (
UINT32
Ë- 
z
;

403 
	`FFI_ASSERT
(0);

406 i‡(
z
 = (
UINT32
))

408 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_FLOAT
)

410 i‡(
‰eg
 < 
NFREGARG
 - 1)

412 i‡(
Âaú
 >= 0)

414 
avÆue
[
i
] = (
UINT32
 *Ë
p‰
 + 
Âaú
;

415 
Âaú
 = -1;

419 #ifde‡
__LITTLE_ENDIAN__


420 
Âaú
 = 
‰eg
;

421 
avÆue
[
i
] = (
UINT32
 *Ë
p‰
 + (1 ^ 
‰eg
);

423 
Âaú
 = 1 ^ 
‰eg
;

424 
avÆue
[
i
] = (
UINT32
 *Ë
p‰
 + 
‰eg
;

426 
‰eg
 += 2;

430 #ifde‡
__LITTLE_ENDIAN__


431 
avÆue
[
i
] = 
pgr
 + 
gªg
;

433 
avÆue
[
i
] = (
UINT32
 *Ë(
pgr
 + 
gªg
) + 1;

437 #ifde‡
__LITTLE_ENDIAN__


438 
avÆue
[
i
] = 
pgr
 + 
gªg
;

440 
avÆue
[
i
] = (
UINT32
 *Ë(
pgr
 + 
gªg
) + 1;

442 
gªg
++;

444 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_DOUBLE
)

446 i‡(
‰eg
 + 1 >
NFREGARG
)

447 
avÆue
[
i
] = 
pgr
 + 
gªg
;

450 
avÆue
[
i
] = 
p‰
 + (
‰eg
 >> 1);

451 
‰eg
 += 2;

453 
gªg
++;

457 
n
 = (
z
 +  (
UINT64
) - 1) /  (UINT64);

459 
avÆue
[
i
] = 
pgr
 + 
gªg
;

460 
gªg
 +
n
;

464 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

467  
	`ªtu∫_ty≥
 (
cif
->
πy≥
);

468 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh64/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


37 #i‚de‡
LIBFFI_ASM


38 
	tffi_¨g
;

39 sig√d 
	tffi_ßrg
;

41 
	effi_abi
 {

42 
	mFFI_FIRST_ABI
 = 0,

43 
	mFFI_SYSV
,

44 
	mFFI_LAST_ABI
,

45 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


46 } 
	tffi_abi
;

48 
	#FFI_EXTRA_CIF_FIELDS
 
Êags2


	)

53 
	#FFI_CLOSURES
 1

	)

54 
	#FFI_TRAMPOLINE_SIZE
 32

	)

55 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh64/sysv.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

31 #ifde‡
HAVE_MACHINE_ASM_H


32 
	~<machöe/asm.h
>

35 
	#CNAME
(
x
Ë
	)
x

36 
	#ENTRY
(
x
Ë.
globl
 
	`CNAME
(x); .
ty≥
 CNAME(x),%
fun˘i⁄
; CNAME(x):

	)

39 #ifde‡
__LITTLE_ENDIAN__


40 
	#OFS_FLT
 0

	)

42 
	#OFS_FLT
 4

	)

45 .
	g£˘i⁄
 .
	gãxt
..
	gSHmedü32
,"ax"

47 #r2: 
ffi_¥ï_¨gs


48 #r3: &
ecif


49 #r4: 
byãs


50 #r5: 
Êags


51 #r6: 
Êags2


52 #r7: 
rvÆue


53 #r8: 
‚


55 #Thi†
assumes
 
we
 
¨e
 
usög
 
gas
.

56 .
	gÆign
 5

57 
	$ENTRY
(
ffi_ˇŒ_SYSV
)

58 #Savê
ªgi°îs


59 .
LFB1
:

60 
addi
.
l
 
r15
, -48,Ñ15

61 .
LCFI0
:

62 
°
.
q
 
r15
, 40, 
r32


63 
°
.
q
 
r15
, 32, 
r31


64 
°
.
q
 
r15
, 24, 
r30


65 
°
.
q
 
r15
, 16, 
r29


66 
°
.
q
 
r15
, 8, 
r28


67 
°
.
l
 
r15
, 4, 
r18


68 
°
.
l
 
r15
, 0, 
r14


69 .
LCFI1
:

70 
add
.
l
 
r15
, 
r63
, 
r14


71 .
LCFI2
:

72 #add 
r4
, 
r63
, 
r28


73 
add
 
r5
, 
r63
, 
r29


74 
add
 
r6
, 
r63
, 
r30


75 
add
 
r7
, 
r63
, 
r31


76 
add
 
r8
, 
r63
, 
r32


78 
addi
 
r4
, (64 + 7),Ñ4

79 
™di
 
r4
, ~7,Ñ4

80 
sub
.
l
 
r15
, 
r4
,Ñ15

82 
±abs
/
l
 
r2
, 
å0


83 
add
 
r15
, 
r63
, 
r2


84 
blök
 
å0
, 
r18


86 
addi
 
r15
, 64, 
r22


87 
movi
 0, 
r0


88 
movi
 0, 
r1


89 
movi
 -1, 
r23


91 
±
/
l
 1f, 
å1


92 
b√i
/
l
 
r29
, 
FFI_TYPE_STRUCT
, 
å1


93 
ld
.
l
 
r15
, 0, 
r19


94 
addi
 
r15
, 8,Ñ15

95 
addi
 
r0
, 1,Ñ0

98 .
L_∑ss
:

99 
™di
 
r30
, 3, 
r20


100 
shÃi
 
r30
, 2,Ñ30

102 
±
/
l
 .
L_ˇŒ_ô
, 
å0


103 
±
/
l
 .
L_∑ss_i
, 
å1


104 
±
/
l
 .
L_∑ss_f
, 
å2


106 
beqi
/
l
 
r20
, 
FFI_TYPE_VOID
, 
å0


107 
beqi
/
l
 
r20
, 
FFI_TYPE_INT
, 
å1


108 
beqi
/
l
 
r20
, 
FFI_TYPE_FLOAT
, 
å2


110 .
L_∑ss_d
:

111 
addi
 
r0
, 1,Ñ0

112 
±
/
l
 3f, 
å0


113 
movi
 12, 
r20


114 
bge
/
l
 
r1
, 
r20
, 
å0


116 
±
/
l
 .
L_p›_d
, 
å1


117 
±
/
l
 2f, 
å0


118 
blök
 
å1
, 
r63


120 
addi
.
l
 
r15
, 8,Ñ15

122 
±
/
l
 .
L_∑ss
, 
å0


123 
addi
 
r1
, 2,Ñ1

124 
blök
 
å0
, 
r63


126 .
L_p›_d
:

127 
±
/
l
 .
L_p›_d_tbl
, 
å1


128 
gëå
 
å1
, 
r20


129 
shŒi
 
r1
, 2, 
r21


130 
add
 
r20
, 
r21
,Ñ20

131 
±abs
/
l
 
r20
, 
å1


132 
blök
 
å1
, 
r63


134 .
L_p›_d_tbl
:

135 
Êd
.
d
 
r15
, 0, 
dr0


136 
blök
 
å0
, 
r63


137 
Êd
.
d
 
r15
, 0, 
dr2


138 
blök
 
å0
, 
r63


139 
Êd
.
d
 
r15
, 0, 
dr4


140 
blök
 
å0
, 
r63


141 
Êd
.
d
 
r15
, 0, 
dr6


142 
blök
 
å0
, 
r63


143 
Êd
.
d
 
r15
, 0, 
dr8


144 
blök
 
å0
, 
r63


145 
Êd
.
d
 
r15
, 0, 
dr10


146 
blök
 
å0
, 
r63


148 .
L_∑ss_f
:

149 
addi
 
r0
, 1,Ñ0

150 
±
/
l
 3f, 
å0


151 
movi
 12, 
r20


152 
bge
/
l
 
r1
, 
r20
, 
å0


154 
±
/
l
 .
L_p›_f
, 
å1


155 
±
/
l
 2f, 
å0


156 
blök
 
å1
, 
r63


158 
addi
.
l
 
r15
, 8,Ñ15

160 
±
/
l
 .
L_∑ss
, 
å0


161 
blök
 
å0
, 
r63


163 .
L_p›_f
:

164 
±
/
l
 .
L_p›_f_tbl
, 
å1


165 
±
/
l
 5f, 
å2


166 
gëå
 
å1
, 
r20


167 
bge
/
l
 
r23
, 
r63
, 
å2


168 
add
 
r1
, 
r63
, 
r23


169 
shŒi
 
r1
, 3, 
r21


170 
addi
 
r1
, 2,Ñ1

171 
add
 
r20
, 
r21
,Ñ20

172 
±abs
/
l
 
r20
, 
å1


173 
blök
 
å1
, 
r63


175 
addi
 
r23
, 1, 
r21


176 
movi
 -1, 
r23


177 
shŒi
 
r21
, 3,Ñ21

178 
add
 
r20
, 
r21
,Ñ20

179 
±abs
/
l
 
r20
, 
å1


180 
blök
 
å1
, 
r63


182 .
L_p›_f_tbl
:

183 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰0


184 
blök
 
å0
, 
r63


185 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰1


186 
blök
 
å0
, 
r63


187 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰2


188 
blök
 
å0
, 
r63


189 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰3


190 
blök
 
å0
, 
r63


191 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰4


192 
blök
 
å0
, 
r63


193 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰5


194 
blök
 
å0
, 
r63


195 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰6


196 
blök
 
å0
, 
r63


197 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰7


198 
blök
 
å0
, 
r63


199 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰8


200 
blök
 
å0
, 
r63


201 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰9


202 
blök
 
å0
, 
r63


203 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰10


204 
blök
 
å0
, 
r63


205 
Êd
.
s
 
r15
, 
OFS_FLT
, 
‰11


206 
blök
 
å0
, 
r63


208 .
L_∑ss_i
:

209 
±
/
l
 3f, 
å0


210 
movi
 8, 
r20


211 
bge
/
l
 
r0
, 
r20
, 
å0


213 
±
/
l
 .
L_p›_i
, 
å1


214 
±
/
l
 2f, 
å0


215 
blök
 
å1
, 
r63


217 
addi
.
l
 
r15
, 8,Ñ15

219 
±
/
l
 .
L_∑ss
, 
å0


220 
addi
 
r0
, 1,Ñ0

221 
blök
 
å0
, 
r63


223 .
L_p›_i
:

224 
±
/
l
 .
L_p›_i_tbl
, 
å1


225 
gëå
 
å1
, 
r20


226 
shŒi
 
r0
, 3, 
r21


227 
add
 
r20
, 
r21
,Ñ20

228 
±abs
/
l
 
r20
, 
å1


229 
blök
 
å1
, 
r63


231 .
L_p›_i_tbl
:

232 
ld
.
q
 
r15
, 0, 
r2


233 
blök
 
å0
, 
r63


234 
ld
.
q
 
r15
, 0, 
r3


235 
blök
 
å0
, 
r63


236 
ld
.
q
 
r15
, 0, 
r4


237 
blök
 
å0
, 
r63


238 
ld
.
q
 
r15
, 0, 
r5


239 
blök
 
å0
, 
r63


240 
ld
.
q
 
r15
, 0, 
r6


241 
blök
 
å0
, 
r63


242 
ld
.
q
 
r15
, 0, 
r7


243 
blök
 
å0
, 
r63


244 
ld
.
q
 
r15
, 0, 
r8


245 
blök
 
å0
, 
r63


246 
ld
.
q
 
r15
, 0, 
r9


247 
blök
 
å0
, 
r63


249 .
L_ˇŒ_ô
:

250 #ˇŒ 
fun˘i⁄


251 
±
/
l
 1f, 
å1


252 
b√i
/
l
 
r29
, 
FFI_TYPE_STRUCT
, 
å1


253 
add
 
r19
, 
r63
, 
r2


255 
add
 
r22
, 
r63
, 
r15


256 
±abs
/
l
 
r32
, 
å0


257 
blök
 
å0
, 
r18


259 
±
/
l
 .
L_ªt_i
, 
å0


260 
±
/
l
 .
L_ªt_Œ
, 
å1


261 
±
/
l
 .
L_ªt_d
, 
å2


262 
±
/
l
 .
L_ªt_f
, 
å3


263 
±
/
l
 .
L_ïûogue
, 
å4


265 
beqi
/
l
 
r29
, 
FFI_TYPE_INT
, 
å0


266 
beqi
/
l
 
r29
, 
FFI_TYPE_UINT32
, 
å0


267 
beqi
/
l
 
r29
, 
FFI_TYPE_SINT64
, 
å1


268 
beqi
/
l
 
r29
, 
FFI_TYPE_UINT64
, 
å1


269 
beqi
/
l
 
r29
, 
FFI_TYPE_DOUBLE
, 
å2


270 
beqi
/
l
 
r29
, 
FFI_TYPE_FLOAT
, 
å3


272 
±
/
l
 .
L_ªt_q
, 
å0


273 
±
/
l
 .
L_ªt_h
, 
å1


275 
beqi
/
l
 
r29
, 
FFI_TYPE_UINT8
, 
å0


276 
beqi
/
l
 
r29
, 
FFI_TYPE_UINT16
, 
å1


277 
blök
 
å4
, 
r63


279 .
L_ªt_d
:

280 
f°
.
d
 
r31
, 0, 
dr0


281 
blök
 
å4
, 
r63


283 .
L_ªt_Œ
:

284 
°
.
q
 
r31
, 0, 
r2


285 
blök
 
å4
, 
r63


287 .
L_ªt_f
:

288 
f°
.
s
 
r31
, 
OFS_FLT
, 
‰0


289 
blök
 
å4
, 
r63


291 .
L_ªt_q
:

292 
°
.
b
 
r31
, 0, 
r2


293 
blök
 
å4
, 
r63


295 .
L_ªt_h
:

296 
°
.
w
 
r31
, 0, 
r2


297 
blök
 
å4
, 
r63


299 .
L_ªt_i
:

300 
°
.
l
 
r31
, 0, 
r2


303 .
L_ïûogue
:

304 #Removê
the
 
•a˚
 
we
 
pushed
 thê
¨gs


305 
add
 
r14
, 
r63
, 
r15


307 
ld
.
l
 
r15
, 0, 
r14


308 
ld
.
l
 
r15
, 4, 
r18


309 
ld
.
q
 
r15
, 8, 
r28


310 
ld
.
q
 
r15
, 16, 
r29


311 
ld
.
q
 
r15
, 24, 
r30


312 
ld
.
q
 
r15
, 32, 
r31


313 
ld
.
q
 
r15
, 40, 
r32


314 
addi
.
l
 
r15
, 48,Ñ15

315 
±abs
 
r18
, 
å0


316 
blök
 
å0
, 
r63


318 .
LFE1
:

319 .
ffi_ˇŒ_SYSV_íd
:

320 .
size
 
	`CNAME
(
ffi_ˇŒ_SYSV
),.
ffi_ˇŒ_SYSV_íd
-CNAME(ffi_call_SYSV)

322 .
Æign
 5

323 
	`ENTRY
(
ffi_˛osuª_SYSV
)

324 .
LFB2
:

325 
addi
.
l
 
r15
, -136,Ñ15

326 .
LCFI3
:

327 
°
.
l
 
r15
, 12, 
r18


328 
°
.
l
 
r15
, 8, 
r14


329 
°
.
l
 
r15
, 4, 
r12


330 .
LCFI4
:

331 
add
 
r15
, 
r63
, 
r14


332 .
LCFI5
:

344 
f°
.
d
 
r14
, 24, 
dr0


345 
f°
.
d
 
r14
, 32, 
dr2


346 
f°
.
d
 
r14
, 40, 
dr4


347 
f°
.
d
 
r14
, 48, 
dr6


348 
f°
.
d
 
r14
, 56, 
dr8


349 
f°
.
d
 
r14
, 64, 
dr10


350 
°
.
q
 
r14
, 72, 
r2


351 
°
.
q
 
r14
, 80, 
r3


352 
°
.
q
 
r14
, 88, 
r4


353 
°
.
q
 
r14
, 96, 
r5


354 
°
.
q
 
r14
, 104, 
r6


355 
°
.
q
 
r14
, 112, 
r7


356 
°
.
q
 
r14
, 120, 
r8


357 
°
.
q
 
r14
, 128, 
r9


359 
add
 
r1
, 
r63
, 
r2


360 
addi
 
r14
, 16, 
r3


361 
addi
 
r14
, 72, 
r4


362 
addi
 
r14
, 24, 
r5


363 
addi
 
r14
, 136, 
r6


364 #ifde‡
PIC


365 
	`movi
 (((
d©Æabñ
 
_GLOBAL_OFFSET_TABLE_
-(.
LPCS0
-.)Ë>> 16Ë& 65535), 
r12


366 
	`sh‹i
 ((
d©Æabñ
 
_GLOBAL_OFFSET_TABLE_
-(.
LPCS0
-.)Ë& 65535), 
r12


367 .
LPCS0
: 
±ªl
/
u
 
r12
, 
å0


368 
	`movi
 ((
ffi_˛osuª_hñ≥r_SYSV
@
GOTPLT
Ë& 65535), 
r1


369 
gëå
 
å0
, 
r12


370 
ldx
.
l
 
r1
, 
r12
,Ñ1

371 
±abs
 
r1
, 
å0


373 
±
/
l
 
ffi_˛osuª_hñ≥r_SYSV
, 
å0


375 
blök
 
å0
, 
r18


377 
shŒi
 
r2
, 1, 
r1


378 
	`movi
 (((
d©Æabñ
 .
L_èbÀ
Ë>> 16Ë& 65535), 
r2


379 
	`sh‹i
 ((
d©Æabñ
 .
L_èbÀ
Ë& 65535), 
r2


380 
ldx
.
w
 
r2
, 
r1
,Ñ1

381 
add
 
r1
, 
r2
,Ñ1

382 
±
/
l
 .
L_ˇ£_v
, 
å1


383 
±abs
 
r1
, 
å0


384 
blök
 
å0
, 
r63


386 .
Æign
 2

387 .
L_èbÀ
:

388 .
w‹d
 .
L_ˇ£_v
 - 
d©Æabñ
 .
L_èbÀ


389 .
w‹d
 .
L_ˇ£_i
 - 
d©Æabñ
 .
L_èbÀ


390 .
w‹d
 .
L_ˇ£_f
 - 
d©Æabñ
 .
L_èbÀ


391 .
w‹d
 .
L_ˇ£_d
 - 
d©Æabñ
 .
L_èbÀ


392 .
w‹d
 .
L_ˇ£_d
 - 
d©Æabñ
 .
L_èbÀ


393 .
w‹d
 .
L_ˇ£_uq
 - 
d©Æabñ
 .
L_èbÀ


394 .
w‹d
 .
L_ˇ£_q
 - 
d©Æabñ
 .
L_èbÀ


395 .
w‹d
 .
L_ˇ£_uh
 - 
d©Æabñ
 .
L_èbÀ


396 .
w‹d
 .
L_ˇ£_h
 - 
d©Æabñ
 .
L_èbÀ


397 .
w‹d
 .
L_ˇ£_i
 - 
d©Æabñ
 .
L_èbÀ


398 .
w‹d
 .
L_ˇ£_i
 - 
d©Æabñ
 .
L_èbÀ


399 .
w‹d
 .
L_ˇ£_Œ
 - 
d©Æabñ
 .
L_èbÀ


400 .
w‹d
 .
L_ˇ£_Œ
 - 
d©Æabñ
 .
L_èbÀ


401 .
w‹d
 .
L_ˇ£_v
 - 
d©Æabñ
 .
L_èbÀ


402 .
w‹d
 .
L_ˇ£_i
 - 
d©Æabñ
 .
L_èbÀ


404 .
Æign
 2

405 .
L_ˇ£_d
:

406 
Êd
.
d
 
r14
, 16, 
dr0


407 
blök
 
å1
, 
r63


408 .
L_ˇ£_f
:

409 
Êd
.
s
 
r14
, 16, 
‰0


410 
blök
 
å1
, 
r63


411 .
L_ˇ£_Œ
:

412 
ld
.
q
 
r14
, 16, 
r2


413 
blök
 
å1
, 
r63


414 .
L_ˇ£_i
:

415 
ld
.
l
 
r14
, 16, 
r2


416 
blök
 
å1
, 
r63


417 .
L_ˇ£_q
:

418 
ld
.
b
 
r14
, 16, 
r2


419 
blök
 
å1
, 
r63


420 .
L_ˇ£_uq
:

421 
ld
.
ub
 
r14
, 16, 
r2


422 
blök
 
å1
, 
r63


423 .
L_ˇ£_h
:

424 
ld
.
w
 
r14
, 16, 
r2


425 
blök
 
å1
, 
r63


426 .
L_ˇ£_uh
:

427 
ld
.
uw
 
r14
, 16, 
r2


428 
blök
 
å1
, 
r63


429 .
L_ˇ£_v
:

430 
add
.
l
 
r14
, 
r63
, 
r15


431 
ld
.
l
 
r15
, 4, 
r12


432 
ld
.
l
 
r15
, 8, 
r14


433 
ld
.
l
 
r15
, 12, 
r18


434 
addi
.
l
 
r15
, 136,Ñ15

435 
±abs
 
r18
, 
å0


436 
blök
 
å0
, 
r63


438 .
LFE2
:

439 .
ffi_˛osuª_SYSV_íd
:

440 .
size
 
	`CNAME
(
ffi_˛osuª_SYSV
),.
ffi_˛osuª_SYSV_íd
-
	$CNAME
(
ffi_˛osuª_SYSV
)

442 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


443 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


446 .
£˘i⁄
 ".eh_‰ame","aw",@
¥ogbôs


447 
__FRAME_BEGIN__
:

448 .4b
yã
 .
LECIE1
-.
LSCIE1


449 .
LSCIE1
:

450 .4b
yã
 0x0

451 .
byã
 0x1

452 #ifde‡
PIC


453 .
ascii
 "zR\0"

455 .
byã
 0x0

457 .
uÀb128
 0x1

458 .
¶eb128
 -4

459 .
byã
 0x12

460 #ifde‡
PIC


461 .
uÀb128
 0x1

462 .
byã
 0x10

464 .
byã
 0xc

465 .
uÀb128
 0xf

466 .
uÀb128
 0x0

467 .
Æign
 2

468 .
LECIE1
:

469 .
LSFDE1
:

470 .4b
yã
 
d©Æabñ
 .
LEFDE1
-d©Æabñ .
LASFDE1


471 .
LASFDE1
:

472 .4b
yã
 
d©Æabñ
 .
LASFDE1
-d©Æabñ 
__FRAME_BEGIN__


473 #ifde‡
PIC


474 .4b
yã
 .
LFB1
-.

476 .4b
yã
 .
LFB1


478 .4b
yã
 
d©Æabñ
 .
LFE1
-d©Æabñ .
LFB1


479 #ifde‡
PIC


480 .
uÀb128
 0x0

482 .
byã
 0x4

483 .4b
yã
 
d©Æabñ
 .
LCFI0
-d©Æabñ .
LFB1


484 .
byã
 0xe

485 .
uÀb128
 0x30

486 .
byã
 0x4

487 .4b
yã
 
d©Æabñ
 .
LCFI1
-d©Æabñ .
LCFI0


488 .
byã
 0x8e

489 .
uÀb128
 0xc

490 .
byã
 0x92

491 .
uÀb128
 0xb

492 .
byã
 0x9c

493 .
uÀb128
 0xa

494 .
byã
 0x9d

495 .
uÀb128
 0x8

496 .
byã
 0x9e

497 .
uÀb128
 0x6

498 .
byã
 0x9f

499 .
uÀb128
 0x4

500 .
byã
 0xa0

501 .
uÀb128
 0x2

502 .
byã
 0x4

503 .4b
yã
 
d©Æabñ
 .
LCFI2
-d©Æabñ .
LCFI1


504 .
byã
 0xd

505 .
uÀb128
 0xe

506 .
Æign
 2

507 .
LEFDE1
:

509 .
LSFDE3
:

510 .4b
yã
 
d©Æabñ
 .
LEFDE3
-d©Æabñ .
LASFDE3


511 .
LASFDE3
:

512 .4b
yã
 
d©Æabñ
 .
LASFDE3
-d©Æabñ 
__FRAME_BEGIN__


513 #ifde‡
PIC


514 .4b
yã
 .
LFB2
-.

516 .4b
yã
 .
LFB2


518 .4b
yã
 
d©Æabñ
 .
LFE2
-d©Æabñ .
LFB2


519 #ifde‡
PIC


520 .
uÀb128
 0x0

522 .
byã
 0x4

523 .4b
yã
 
d©Æabñ
 .
LCFI3
-d©Æabñ .
LFB2


524 .
byã
 0xe

525 .
uÀb128
 0x88

526 .
byã
 0x4

527 .4b
yã
 
d©Æabñ
 .
LCFI4
-d©Æabñ .
LCFI3


528 .
byã
 0x8c

529 .
uÀb128
 0x21

530 .
byã
 0x8e

531 .
uÀb128
 0x20

532 .
byã
 0x92

533 .
uÀb128
 0x1f

534 .
byã
 0x4

535 .4b
yã
 
d©Æabñ
 .
LCFI5
-d©Æabñ .
LCFI4


536 .
byã
 0xd

537 .
uÀb128
 0xe

538 .
Æign
 2

539 .
LEFDE3
:

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sparc/ffi.c

28 
	~<ffi.h
>

29 
	~<ffi_comm⁄.h
>

31 
	~<°dlib.h
>

37 
	$ffi_¥ï_¨gs_v8
(*
°ack
, 
exãnded_cif
 *
ecif
)

39 
i
;

40 **
p_¨gv
;

41 *
¨gp
;

42 
ffi_ty≥
 **
p_¨g
;

45 
¨gp
 = 
°ack
 + 16*();

51 *(*Ë
¨gp
 = ()
ecif
->
rvÆue
;

54 
¨gp
 += ();

56 #ifde‡
USING_PURIFY


60 ((*)
¨gp
)[0] = 0;

61 ((*)
¨gp
)[1] = 0;

62 ((*)
¨gp
)[2] = 0;

63 ((*)
¨gp
)[3] = 0;

64 ((*)
¨gp
)[4] = 0;

65 ((*)
¨gp
)[5] = 0;

68 
p_¨gv
 = 
ecif
->
avÆue
;

70 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
; i; i--,Ö_arg++)

72 
size_t
 
z
;

74 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT


75 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


76 || (*
p_¨g
)->
ty≥
 =
FFI_TYPE_LONGDOUBLE


80 *(*Ë
¨gp
 = ()(* 
p_¨gv
);

81 
z
 = ();

85 
z
 = (*
p_¨g
)->
size
;

86 i‡(
z
 < ())

88 
z
 = ();

89 (*
p_¨g
)->
ty≥
)

91 
FFI_TYPE_SINT8
:

92 *(sig√d *Ë
¨gp
 = *(
SINT8
 *)(* 
p_¨gv
);

95 
FFI_TYPE_UINT8
:

96 *(*Ë
¨gp
 = *(
UINT8
 *)(* 
p_¨gv
);

99 
FFI_TYPE_SINT16
:

100 *(sig√d *Ë
¨gp
 = *(
SINT16
 *)(* 
p_¨gv
);

103 
FFI_TYPE_UINT16
:

104 *(*Ë
¨gp
 = *(
UINT16
 *)(* 
p_¨gv
);

108 
	`FFI_ASSERT
(0);

113 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

116 
p_¨gv
++;

117 
¨gp
 +
z
;

121 
	}
}

123 
	$ffi_¥ï_¨gs_v9
(*
°ack
, 
exãnded_cif
 *
ecif
)

125 
i
, 
ªt
 = 0;

126 
tmp
;

127 **
p_¨gv
;

128 *
¨gp
;

129 
ffi_ty≥
 **
p_¨g
;

131 
tmp
 = 0;

134 
¨gp
 = 
°ack
 + 16*();

136 #ifde‡
USING_PURIFY


140 ((*)
¨gp
)[0] = 0;

141 ((*)
¨gp
)[1] = 0;

142 ((*)
¨gp
)[2] = 0;

143 ((*)
¨gp
)[3] = 0;

144 ((*)
¨gp
)[4] = 0;

145 ((*)
¨gp
)[5] = 0;

148 
p_¨gv
 = 
ecif
->
avÆue
;

150 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 &&

151 
ecif
->
cif
->
πy≥
->
size
 > 32)

153 *(*Ë
¨gp
 = ()
ecif
->
rvÆue
;

154 
¨gp
 += ();

155 
tmp
 = 1;

158 
i
 = 0, 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
; i <Écif->cif->
«rgs
;

159 
i
++, 
p_¨g
++)

161 
size_t
 
z
;

163 
z
 = (*
p_¨g
)->
size
;

164 (*
p_¨g
)->
ty≥
)

166 
FFI_TYPE_STRUCT
:

167 i‡(
z
 > 16)

170 *(*Ë
¨gp
 = ()* 
p_¨gv
;

171 
¨gp
 += ();

172 
tmp
++;

173 
p_¨gv
++;

177 
FFI_TYPE_FLOAT
:

178 
FFI_TYPE_DOUBLE
:

179 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


180 
FFI_TYPE_LONGDOUBLE
:

182 
ªt
 = 1;

185 i‡(
z
 < ())

187 (*
p_¨g
)->
ty≥
)

189 
FFI_TYPE_SINT8
:

190 *(sig√d *Ë
¨gp
 = *(
SINT8
 *)(* 
p_¨gv
);

193 
FFI_TYPE_UINT8
:

194 *(*Ë
¨gp
 = *(
UINT8
 *)(* 
p_¨gv
);

197 
FFI_TYPE_SINT16
:

198 *(sig√d *Ë
¨gp
 = *(
SINT16
 *)(* 
p_¨gv
);

201 
FFI_TYPE_UINT16
:

202 *(*Ë
¨gp
 = *(
UINT16
 *)(* 
p_¨gv
);

205 
FFI_TYPE_SINT32
:

206 *(sig√d *Ë
¨gp
 = *(
SINT32
 *)(* 
p_¨gv
);

209 
FFI_TYPE_UINT32
:

210 *(*Ë
¨gp
 = *(
UINT32
 *)(* 
p_¨gv
);

213 
FFI_TYPE_FLOAT
:

214 *(*Ë(
¨gp
 + 4Ë*(
FLOAT32
 *)(* 
p_¨gv
);

217 
FFI_TYPE_STRUCT
:

218 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

222 
	`FFI_ASSERT
(0);

224 
z
 = ();

225 
tmp
++;

227 i‡(
z
 == ())

229 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

230 
z
 = ();

231 
tmp
++;

235 i‡((
tmp
 & 1Ë&& (*
p_¨g
)->
Æignmít
 > 8)

237 
tmp
++;

238 
¨gp
 += ();

240 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

241 
z
 = 2 * ();

242 
tmp
 += 2;

244 
p_¨gv
++;

245 
¨gp
 +
z
;

248  
ªt
;

249 
	}
}

252 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

254 
w‹dsize
;

256 i‡(
cif
->
abi
 !
FFI_V9
)

258 
w‹dsize
 = 4;

263 i‡(
cif
->
πy≥
->
ty≥
 !
FFI_TYPE_STRUCT
)

264 
cif
->
byãs
 +
w‹dsize
;

269 i‡(
cif
->
byãs
 < 4*6+4)

270 
cif
->
byãs
 = 4*6+4;

274 
w‹dsize
 = 8;

279 i‡(
cif
->
byãs
 < 8*6)

280 
cif
->
byãs
 = 8*6;

286 
cif
->
byãs
 +16 * 
w‹dsize
;

291 
cif
->
byãs
 = 
	`ALIGN
(cif->byãs, 2 * 
w‹dsize
);

294 
cif
->
πy≥
->
ty≥
)

296 
FFI_TYPE_VOID
:

297 
FFI_TYPE_FLOAT
:

298 
FFI_TYPE_DOUBLE
:

299 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


300 
FFI_TYPE_LONGDOUBLE
:

302 
cif
->
Êags
 = cif->
πy≥
->
ty≥
;

305 
FFI_TYPE_STRUCT
:

306 i‡(
cif
->
abi
 =
FFI_V9
 && cif->
πy≥
->
size
 > 32)

307 
cif
->
Êags
 = 
FFI_TYPE_VOID
;

309 
cif
->
Êags
 = 
FFI_TYPE_STRUCT
;

312 
FFI_TYPE_SINT8
:

313 
FFI_TYPE_UINT8
:

314 
FFI_TYPE_SINT16
:

315 
FFI_TYPE_UINT16
:

316 i‡(
cif
->
abi
 =
FFI_V9
)

317 
cif
->
Êags
 = 
FFI_TYPE_INT
;

319 
cif
->
Êags
 = cif->
πy≥
->
ty≥
;

322 
FFI_TYPE_SINT64
:

323 
FFI_TYPE_UINT64
:

324 i‡(
cif
->
abi
 =
FFI_V9
)

325 
cif
->
Êags
 = 
FFI_TYPE_INT
;

327 
cif
->
Êags
 = 
FFI_TYPE_SINT64
;

331 
cif
->
Êags
 = 
FFI_TYPE_INT
;

334  
FFI_OK
;

335 
	}
}

337 
	$ffi_v9_œyout_°ru˘
(
ffi_ty≥
 *
¨g
, 
off
, *
ªt
, *
ötg
, *
Êt
)

339 
ffi_ty≥
 **
±r
 = &
¨g
->
ñemíts
[0];

341 *
±r
 !
NULL
)

343 i‡(
off
 & ((*
±r
)->
Æignmít
 - 1))

344 
off
 = 
	`ALIGN
(off, (*
±r
)->
Æignmít
);

346 (*
±r
)->
ty≥
)

348 
FFI_TYPE_STRUCT
:

349 
off
 = 
	`ffi_v9_œyout_°ru˘
(*
±r
, off, 
ªt
, 
ötg
, 
Êt
);

350 
off
 = 
	`ALIGN
(off, 
FFI_SIZEOF_ARG
);

352 
FFI_TYPE_FLOAT
:

353 
FFI_TYPE_DOUBLE
:

354 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


355 
FFI_TYPE_LONGDOUBLE
:

357 
	`memmove
(
ªt
 + 
off
, 
Êt
 + off, (*
±r
)->
size
);

358 
off
 +(*
±r
)->
size
;

361 
	`memmove
(
ªt
 + 
off
, 
ötg
 + off, (*
±r
)->
size
);

362 
off
 +(*
±r
)->
size
;

365 
±r
++;

367  
off
;

368 
	}
}

371 #ifde‡
SPARC64


372 
ffi_ˇŒ_v9
(*, 
exãnded_cif
 *, ,

373 , *, (*
‚
)());

375 
	`ffi_ˇŒ_v8
(*, 
exãnded_cif
 *, ,

376 , *, (*
‚
)());

379 #i‚de‡
__GNUC__


380 
	`ffi_Êush_iˇche
 (*, 
size_t
);

383 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

385 
exãnded_cif
 
ecif
;

386 *
rvÆ
 = 
rvÆue
;

388 
ecif
.
cif
 = cif;

389 
ecif
.
avÆue
 =ávalue;

394 
ecif
.
rvÆue
 =Ñvalue;

395 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

397 i‡(
cif
->
πy≥
->
size
 <= 32)

398 
rvÆ
 = 
	`Æloˇ
(64);

401 
rvÆ
 = 
NULL
;

402 i‡(
rvÆue
 =
NULL
)

403 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

407 
cif
->
abi
)

409 
FFI_V8
:

410 #ifde‡
SPARC64


412 
	`FFI_ASSERT
(0);

414 i‡(
rvÆue
 && (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


415 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


416 || 
cif
->
Êags
 =
FFI_TYPE_LONGDOUBLE


423 *
ˇŒ_°ru˘
 = 
NULL
;

424 
	`ffi_˛osuª_Æloc
(32, (**)&
ˇŒ_°ru˘
);

425 i‡(
ˇŒ_°ru˘
)

427 
f
 = ()
‚
;

428 
ˇŒ_°ru˘
[0] = 0xae10001f;

429 
ˇŒ_°ru˘
[1] = 0xbe10000f;

430 
ˇŒ_°ru˘
[2] = 0x03000000 | 
f
 >> 10;

431 
ˇŒ_°ru˘
[3] = 0x9fc06000 | (
f
 & 0x3ff);

432 
ˇŒ_°ru˘
[4] = 0x01000000;

433 i‡(
cif
->
πy≥
->
size
 < 0x7f)

434 
ˇŒ_°ru˘
[5] = 
cif
->
πy≥
->
size
;

436 
ˇŒ_°ru˘
[5] = 0x01000000;

437 
ˇŒ_°ru˘
[6] = 0x81c7e008;

438 
ˇŒ_°ru˘
[7] = 0xbe100017;

439 #ifde‡
__GNUC__


440 
asm
 volatile ("iflush %0; iflush %0+8; iflush %0+16; iflush %0+24" : :

441 "r" (
ˇŒ_°ru˘
) : "memory");

443 
asm
 volatile ("nop;Çop;Çop;Çop;Çop");

445 
	`ffi_Êush_iˇche
 (
ˇŒ_°ru˘
, 32);

447 
	`ffi_ˇŒ_v8
(
ffi_¥ï_¨gs_v8
, &
ecif
, 
cif
->
byãs
,

448 
cif
->
Êags
, 
rvÆue
, 
ˇŒ_°ru˘
);

449 
	`ffi_˛osuª_‰ì
(
ˇŒ_°ru˘
);

453 
	`ffi_ˇŒ_v8
(
ffi_¥ï_¨gs_v8
, &
ecif
, 
cif
->
byãs
,

454 
cif
->
Êags
, 
rvÆue
, 
‚
);

459 
	`ffi_ˇŒ_v8
(
ffi_¥ï_¨gs_v8
, &
ecif
, 
cif
->
byãs
,

460 
cif
->
Êags
, 
rvÆue
, 
‚
);

464 
FFI_V9
:

465 #ifde‡
SPARC64


466 
	`ffi_ˇŒ_v9
(
ffi_¥ï_¨gs_v9
, &
ecif
, 
cif
->
byãs
,

467 
cif
->
Êags
, 
rvÆ
, 
‚
);

468 i‡(
rvÆue
 && 
rvÆ
 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

469 
	`ffi_v9_œyout_°ru˘
(
cif
->
πy≥
, 0, (*)
rvÆue
, (*)
rvÆ
, ((*)rval)+32);

472 
	`FFI_ASSERT
(0);

476 
	`FFI_ASSERT
(0);

479 
	}
}

482 #ifde‡
SPARC64


483 
ffi_˛osuª_v9
();

485 
ffi_˛osuª_v8
();

488 
ffi_°©us


489 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

490 
ffi_cif
* 
cif
,

491 (*
fun
)(
ffi_cif
*, *, **, *),

492 *
u£r_d©a
,

493 *
codñoc
)

495 *
åamp
 = (*Ë&
˛osuª
->tramp[0];

496 
‚
;

497 #ifde‡
SPARC64


500 i‡(
cif
->
abi
 !
FFI_V9
)

501  
FFI_BAD_ABI
;

502 
‚
 = (Ë
ffi_˛osuª_v9
;

503 
åamp
[0] = 0x83414000;

504 
åamp
[1] = 0xca586010;

505 
åamp
[2] = 0x81c14000;

506 
åamp
[3] = 0x01000000;

507 *((*Ë&
åamp
[4]Ë
‚
;

509 
˘x
 = (Ë
codñoc
;

510 i‡(
cif
->
abi
 !
FFI_V8
)

511  
FFI_BAD_ABI
;

512 
‚
 = (Ë
ffi_˛osuª_v8
;

513 
åamp
[0] = 0x03000000 | 
‚
 >> 10;

514 
åamp
[1] = 0x05000000 | 
˘x
 >> 10;

515 
åamp
[2] = 0x81c06000 | (
‚
 & 0x3ff);

516 
åamp
[3] = 0x8410a000 | (
˘x
 & 0x3ff);

519 
˛osuª
->
cif
 = cif;

520 
˛osuª
->
fun
 = fun;

521 
˛osuª
->
u£r_d©a
 = user_data;

524 #ifde‡
__GNUC__


525 #ifde‡
SPARC64


526 
asm
 vﬁ©ûê("Êush %0; flush %0+8" : : "r" (
˛osuª
) : "memory");

528 
asm
 vﬁ©ûê("iÊush %0; iÊush %0+8" : : "r" (
˛osuª
) : "memory");

530 
asm
 volatile ("nop;Çop;Çop;Çop;Çop");

533 
	`ffi_Êush_iˇche
 (
˛osuª
, 16);

536  
FFI_OK
;

537 
	}
}

540 
	$ffi_˛osuª_•¨c_ö√r_v8
(
ffi_˛osuª
 *
˛osuª
,

541 *
rvÆue
, *
g¥
, *
s¸©ch
)

543 
ffi_cif
 *
cif
;

544 
ffi_ty≥
 **
¨g_ty≥s
;

545 **
avÆue
;

546 
i
, 
¨gn
;

548 
cif
 = 
˛osuª
->cif;

549 
¨g_ty≥s
 = 
cif
->arg_types;

550 
avÆue
 = 
	`Æloˇ
(
cif
->
«rgs
 * (*));

554 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT


555 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


556 || 
cif
->
Êags
 =
FFI_TYPE_LONGDOUBLE


559 
rvÆue
 = (*Ë
g¥
[0];

562 
¨gn
 = 1;

565 
i
 = 0; i < 
cif
->
«rgs
; i++)

567 i‡(
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_STRUCT


568 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


569 || 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_LONGDOUBLE


574 
avÆue
[
i
] = (*)
g¥
[
¨gn
++];

576 i‡((
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_DOUBLE


577 || 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_SINT64


578 || 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_UINT64
)

580 && (
¨gn
 % 2) != 0)

583 
s¸©ch
[0] = 
g¥
[
¨gn
];

584 
s¸©ch
[1] = 
g¥
[
¨gn
+1];

585 
avÆue
[
i
] = 
s¸©ch
;

586 
s¸©ch
 -= 2;

587 
¨gn
 += 2;

592 
¨gn
 +
	`ALIGN
(
¨g_ty≥s
[
i
]->
size
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

593 
avÆue
[
i
] = ((*Ë&
g¥
[
¨gn
]Ë- 
¨g_ty≥s
[i]->
size
;

598 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

601  
cif
->
πy≥
->
ty≥
;

602 
	}
}

605 
	$ffi_˛osuª_•¨c_ö√r_v9
(
ffi_˛osuª
 *
˛osuª
,

606 *
rvÆue
, *
g¥
, *
Âr
)

608 
ffi_cif
 *
cif
;

609 
ffi_ty≥
 **
¨g_ty≥s
;

610 **
avÆue
;

611 
i
, 
¨gn
, 
Â_¶Ÿ_max
;

613 
cif
 = 
˛osuª
->cif;

614 
¨g_ty≥s
 = 
cif
->arg_types;

615 
avÆue
 = 
	`Æloˇ
(
cif
->
«rgs
 * (*));

619 i‡(
cif
->
Êags
 =
FFI_TYPE_VOID


620 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
)

622 
rvÆue
 = (*Ë
g¥
[0];

624 
¨gn
 = 1;

627 
¨gn
 = 0;

629 
Â_¶Ÿ_max
 = 16 - 
¨gn
;

632 
i
 = 0; i < 
cif
->
«rgs
; i++)

634 i‡(
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_STRUCT
)

636 i‡(
¨g_ty≥s
[
i
]->
size
 > 16)

639 
avÆue
[
i
] = (*)
g¥
[
¨gn
++];

644 
	`ffi_v9_œyout_°ru˘
(
¨g_ty≥s
[
i
],

646 (*Ë&
g¥
[
¨gn
],

647 (*Ë&
g¥
[
¨gn
],

648 (*Ë&
Âr
[
¨gn
]);

649 
avÆue
[
i
] = &
g¥
[
¨gn
];

650 
¨gn
 +
	`ALIGN
(
¨g_ty≥s
[
i
]->
size
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

656 
¨gn
 +
	`ALIGN
(
¨g_ty≥s
[
i
]->
size
, 
FFI_SIZEOF_ARG
) / FFI_SIZEOF_ARG;

659 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


660 i‡(
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_LONGDOUBLE
 && (
¨gn
 % 2) != 0)

661 
¨gn
++;

663 i‡(
i
 < 
Â_¶Ÿ_max


664 && (
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_FLOAT


665 || 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_DOUBLE


666 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


667 || 
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_LONGDOUBLE


670 
avÆue
[
i
] = ((*Ë&
Âr
[
¨gn
]Ë- 
¨g_ty≥s
[i]->
size
;

672 
avÆue
[
i
] = ((*Ë&
g¥
[
¨gn
]Ë- 
¨g_ty≥s
[i]->
size
;

677 (
˛osuª
->
fun
Ë(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

680  
cif
->
πy≥
->
ty≥
;

681 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sparc/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_H


37 #i‡
deföed
(
__¨ch64__
Ë|| deföed(
__•¨cv9
)

38 #i‚de‡
SPARC64


39 
	#SPARC64


	)

43 #i‚de‡
LIBFFI_ASM


44 
	tffi_¨g
;

45 sig√d 
	tffi_ßrg
;

47 
	effi_abi
 {

48 
	mFFI_FIRST_ABI
 = 0,

49 
	mFFI_V8
,

50 
	mFFI_V8PLUS
,

51 
	mFFI_V9
,

52 
	mFFI_LAST_ABI
,

53 #ifde‡
SPARC64


54 
	mFFI_DEFAULT_ABI
 = 
FFI_V9


56 
FFI_DEFAULT_ABI
 = 
FFI_V8


58 } 
	tffi_abi
;

63 
	#FFI_CLOSURES
 1

	)

64 
	#FFI_NATIVE_RAW_API
 0

	)

66 #ifde‡
SPARC64


67 
	#FFI_TRAMPOLINE_SIZE
 24

	)

69 
	#FFI_TRAMPOLINE_SIZE
 16

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sparc/v8.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

32 
	#STACKFRAME
 96

	)

33 
	#ARGS
 (64+4Ë

	)

35 #i‚de‡
__GNUC__


36 .
	gãxt


37 .
	gÆign
 8

38 .
globl
 
	gffi_Êush_iˇche


39 .
globl
 
_ffi_Êush_iˇche


41 
	gffi_Êush_iˇche
:

42 
_ffi_Êush_iˇche
:

43 
add
 %
o0
, %
	go1
, %
	go2


44 #ifde‡
SPARC64


45 1: 
Êush
 %
o0


47 1: 
iÊush
 %
o0


49 
add
 %
o0
, 8, %o0

50 
	gcmp
 %
	go0
, %
o2


51 
	gb…
 1b

52 
n›


53 
n›


54 
n›


55 
n›


56 
n›


57 
ªé


58 
	gn›


59 .
	gffi_Êush_iˇche_íd
:

60 .
size
 
ffi_Êush_iˇche
,.
	gffi_Êush_iˇche_íd
-
	gffi_Êush_iˇche


63 .
	gãxt


64 .
	gÆign
 8

65 .
globl
 
	gffi_ˇŒ_v8


66 .
globl
 
_ffi_ˇŒ_v8


68 
	gffi_ˇŒ_v8
:

69 
_ffi_ˇŒ_v8
:

70 .
LLFB1
:

71 
ßve
 %
•
, -
	gSTACKFRAME
, %
	g•


72 .
	gLLCFI0
:

74 
sub
 %
•
, %
	gi2
, %
	g•
 ! 
	$Æloˇ
(Ë
•a˚
 
ö
 
°ack
 
‰ame
 
to
 
£t
 
up


75 
add
 %
•
, 
STACKFRAME
, %
l0
 ! %l0 
has
 
°¨t
 
of


76 ! 
‰ame
 
to
 
£t
 
up


78 
mov
 %
l0
, %
o0
 ! 
ˇŒ
 
routöe
 
to
 
£t
 
up
 
‰ame


79 
ˇŒ
 %
i0


80 
mov
 %
i1
, %
o1
 ! (
dñay
)

82 
ld
 [%
l0
+
ARGS
], %
o0
 ! 
ˇŒ
 
f‹eign
 
fun˘i⁄


83 
ld
 [%
l0
+
ARGS
+4], %
o1


84 
ld
 [%
l0
+
ARGS
+8], %
o2


85 
ld
 [%
l0
+
ARGS
+12], %
o3


86 
ld
 [%
l0
+
ARGS
+16], %
o4


87 
ld
 [%
l0
+
ARGS
+20], %
o5


88 
ˇŒ
 %
i5


89 
mov
 %
l0
, %
•
 ! (
dñay
Ë
to
 
‰ame


90 
n›
 ! 
STRUCT
 
ªtu∫ög
 
fun˘i⁄s
 
skù
 12 
ö°ód
 
of
 8 
byãs


92 ! 
If
 
the
  
vÆue
 
poöãr
 
is
 
NULL
, 
assume
 
no
  value.

93 
t°
 %
i4


94 
bz
 
d⁄e


95 
n›


97 
cmp
 %
i3
, 
FFI_TYPE_INT


98 
be
,
a
 
d⁄e


99 
°
 %
o0
, [%
i4
] ! (
dñay
)

101 
cmp
 %
i3
, 
FFI_TYPE_FLOAT


102 
be
,
a
 
d⁄e


103 
°
 %
f0
, [%
i4
+0] ! (
dñay
)

105 
cmp
 %
i3
, 
FFI_TYPE_DOUBLE


106 
be
,
a
 

107 
°
 %
f0
, [%
i4
+0] ! (
dñay
)

109 
cmp
 %
i3
, 
FFI_TYPE_SINT8


110 
be
,
a
 
söt8


111 
¶l
 %
o0
, 24, %o0 ! (
dñay
)

113 
cmp
 %
i3
, 
FFI_TYPE_UINT8


114 
be
,
a
 
uöt8


115 
¶l
 %
o0
, 24, %o0 ! (
dñay
)

117 
cmp
 %
i3
, 
FFI_TYPE_SINT16


118 
be
,
a
 
söt16


119 
¶l
 %
o0
, 16, %o0 ! (
dñay
)

121 
cmp
 %
i3
, 
FFI_TYPE_UINT16


122 
be
,
a
 
uöt16


123 
¶l
 %
o0
, 16, %o0 ! (
dñay
)

125 
cmp
 %
i3
, 
FFI_TYPE_SINT64


126 
be
,
a
 
l⁄gl⁄g


127 
°
 %
o0
, [%
i4
+0] ! (
dñay
)

128 
d⁄e
:

129 
ªt


130 
ª°‹e


133 
°
 %
f1
, [%
i4
+4]

134 
ªt


135 
ª°‹e


137 
söt8
:

138 
§a
 %
o0
, 24, %o0

139 
°
 %
o0
, [%
i4
+0]

140 
ªt


141 
ª°‹e


143 
uöt8
:

144 
§l
 %
o0
, 24, %o0

145 
°
 %
o0
, [%
i4
+0]

146 
ªt


147 
ª°‹e


149 
söt16
:

150 
§a
 %
o0
, 16, %o0

151 
°
 %
o0
, [%
i4
+0]

152 
ªt


153 
ª°‹e


155 
uöt16
:

156 
§l
 %
o0
, 16, %o0

157 
°
 %
o0
, [%
i4
+0]

158 
ªt


159 
ª°‹e


161 
l⁄gl⁄g
:

162 
°
 %
o1
, [%
i4
+4]

163 
ªt


164 
ª°‹e


165 .
LLFE1
:

167 .
ffi_ˇŒ_v8_íd
:

168 .
size
 
ffi_ˇŒ_v8
,.
ffi_ˇŒ_v8_íd
-ffi_call_v8

171 #unde‡
STACKFRAME


172 
	#STACKFRAME
 104

	)

181 .
ãxt


182 .
Æign
 8

183 .
globl
 
ffi_˛osuª_v8


185 
ffi_˛osuª_v8
:

186 #ifde‡
HAVE_AS_REGISTER_PSEUDO_OP


187 .%
g2
, #scratch

189 .
LLFB2
:

190 ! 
Re£rve
 
‰ame
 
•a˚
 
Æl
 
¨gumíts
 
ö
 

191 ! 
we
 
√ed
 
to
 
Æign
 
them
 
⁄
 
a
 8-
byã
 
bound¨y
.

192 
ld
 [%
g2
+
FFI_TRAMPOLINE_SIZE
], %
g1


193 
ld
 [%
g1
+4], %g1

194 
¶l
 %
g1
, 3, %g1

195 
add
 %
g1
, 
STACKFRAME
, %g1

196 ! %
g1
 =
STACKFRAME
 + 8*
«rgs


197 
√g
 %
g1


198 
ßve
 %
•
, %
g1
, %sp

199 .
LLCFI1
:

201 ! 
St‹e
 
Æl
 
of
 
the
 
pŸítül
 
¨gumít
 
ªgi°îs
 
ö
 
va_li°
 
f‹m©
.

202 
°
 %
i0
, [%
Â
+68+0]

203 
°
 %
i1
, [%
Â
+68+4]

204 
°
 %
i2
, [%
Â
+68+8]

205 
°
 %
i3
, [%
Â
+68+12]

206 
°
 %
i4
, [%
Â
+68+16]

207 
°
 %
i5
, [%
Â
+68+20]

209 ! 
CÆl
 
ffi_˛osuª_•¨c_ö√r
 
to
 dÿ
the
 
bulk
 
of
Åhê
w‹k
.

210 
mov
 %
g2
, %
o0


211 
add
 %
Â
, -8, %
o1


212 
add
 %
Â
, 64, %
o2


213 
ˇŒ
 
ffi_˛osuª_•¨c_ö√r_v8


214 
add
 %
Â
, -16, %
o3


216 ! 
Lﬂd
 
up
 
the
  
vÆue
 
ö
Åhê
¥›î
 
ty≥
.

217 ! 
Sì
 
ffi_¥ï_cif_machdï
 
the
 
li°
 
of
 
ˇ£s
.

218 
cmp
 %
o0
, 
FFI_TYPE_VOID


219 
be
 
d⁄e1


221 
cmp
 %
o0
, 
FFI_TYPE_INT


222 
be
 
d⁄e1


223 
ld
 [%
Â
-8], %
i0


225 
cmp
 %
o0
, 
FFI_TYPE_FLOAT


226 
be
,
a
 
d⁄e1


227 
ld
 [%
Â
-8], %
f0


229 
cmp
 %
o0
, 
FFI_TYPE_DOUBLE


230 
be
,
a
 
d⁄e1


231 
ldd
 [%
Â
-8], %
f0


233 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


234 
cmp
 %
o0
, 
FFI_TYPE_LONGDOUBLE


235 
be
 
d⁄e2


238 
cmp
 %
o0
, 
FFI_TYPE_STRUCT


239 
be
 
d⁄e2


241 
cmp
 %
o0
, 
FFI_TYPE_SINT64


242 
be
,
a
 
d⁄e1


243 
ldd
 [%
Â
-8], %
i0


245 
cmp
 %
o0
, 
FFI_TYPE_UINT64


246 
be
,
a
 
d⁄e1


247 
ldd
 [%
Â
-8], %
i0


249 
ld
 [%
Â
-8], %
i0


250 
d⁄e1
:

251 
jmp
 %
i7
+8

252 
ª°‹e


253 
d⁄e2
:

254 ! 
Skù
 'unimp'.

255 
jmp
 %
i7
+12

256 
ª°‹e


257 .
LLFE2
:

259 .
ffi_˛osuª_v8_íd
:

260 .
size
 
ffi_˛osuª_v8
,.
ffi_˛osuª_v8_íd
-ffi_closure_v8

262 #ifde‡
SPARC64


263 
	#WS
 8

	)

264 
	#nw‹d
 
xw‹d


	)

265 
	#u™w‹d
 
uaxw‹d


	)

267 
	#WS
 4

	)

268 
	#nw‹d
 

	)

269 
	#u™w‹d
 
uaw‹d


	)

272 #ifde‡
HAVE_RO_EH_FRAME


273 .
£˘i⁄
 ".eh_frame",#alloc

275 .
£˘i⁄
 ".eh_frame",#alloc,#write

277 .
LL‰ame1
:

278 .
uaw‹d
 .
LLECIE1
-.
LLSCIE1
 ! 
Lígth
 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


279 .
LLSCIE1
:

280 .
uaw‹d
 0x0 ! 
CIE
 
Idítifõr
 
Tag


281 .
byã
 0x1 ! 
CIE
 
Vîsi⁄


282 .
ascii
 "zR\0" ! 
CIE
 
Augmíèti⁄


283 .
byã
 0x1 ! 
uÀb128
 0x1; 
CIE
 
Code
 
Alignmít
 
Fa˘‹


284 .
byã
 0x80-
WS
 ! 
¶eb128
 -WS; 
CIE
 
D©a
 
Alignmít
 
Fa˘‹


285 .
byã
 0x‡! 
CIE
 
RA
 
Cﬁumn


286 .
byã
 0x1 ! 
uÀb128
 0x1; 
Augmíèti⁄
 
size


287 #ifde‡
HAVE_AS_SPARC_UA_PCREL


288 .
byã
 0x1b ! 
FDE
 
	$Encodög
 (
p¸ñ
 
sd©a4
)

290 .
byã
 0x50 ! 
FDE
 
	$Encodög
 (
Æig√d
 
absﬁuã
)

292 .
byã
 0x¯! 
DW_CFA_def_cÁ


293 .
byã
 0xê! 
uÀb128
 0xe

294 .
byã
 0x0 ! 
uÀb128
 0x0

295 .
Æign
 
WS


296 .
LLECIE1
:

297 .
LLSFDE1
:

298 .
uaw‹d
 .
LLEFDE1
-.
LLASFDE1
 ! 
FDE
 
Lígth


299 .
LLASFDE1
:

300 .
uaw‹d
 .
LLASFDE1
-.
LL‰ame1
 ! 
FDE
 
CIE
 
off£t


301 #ifde‡
HAVE_AS_SPARC_UA_PCREL


302 .
uaw‹d
 %
	`r_di•32
(.
LLFB1
)

303 .
uaw‹d
 .
LLFE1
-.
LLFB1
 ! 
FDE
 
addªss
 
ønge


305 .
Æign
 
WS


306 .
nw‹d
 .
LLFB1


307 .
u™w‹d
 .
LLFE1
-.
LLFB1
 ! 
FDE
 
addªss
 
ønge


309 .
byã
 0x0 ! 
uÀb128
 0x0; 
Augmíèti⁄
 
size


310 .
byã
 0x4 ! 
DW_CFA_adv™˚_loc4


311 .
uaw‹d
 .
LLCFI0
-.
LLFB1


312 .
byã
 0xd ! 
DW_CFA_def_cÁ_ªgi°î


313 .
byã
 0x1ê! 
uÀb128
 0x1e

314 .
byã
 0x2d ! 
DW_CFA_GNU_wödow_ßve


315 .
byã
 0x9 ! 
DW_CFA_ªgi°î


316 .
byã
 0x‡! 
uÀb128
 0xf

317 .
byã
 0x1‡! 
uÀb128
 0x1f

318 .
Æign
 
WS


319 .
LLEFDE1
:

320 .
LLSFDE2
:

321 .
uaw‹d
 .
LLEFDE2
-.
LLASFDE2
 ! 
FDE
 
Lígth


322 .
LLASFDE2
:

323 .
uaw‹d
 .
LLASFDE2
-.
LL‰ame1
 ! 
FDE
 
CIE
 
off£t


324 #ifde‡
HAVE_AS_SPARC_UA_PCREL


325 .
uaw‹d
 %
	`r_di•32
(.
LLFB2
)

326 .
uaw‹d
 .
LLFE2
-.
LLFB2
 ! 
FDE
 
addªss
 
ønge


328 .
Æign
 
WS


329 .
nw‹d
 .
LLFB2


330 .
u™w‹d
 .
LLFE2
-.
LLFB2
 ! 
FDE
 
addªss
 
ønge


332 .
byã
 0x0 ! 
uÀb128
 0x0; 
Augmíèti⁄
 
size


333 .
byã
 0x4 ! 
DW_CFA_adv™˚_loc4


334 .
uaw‹d
 .
LLCFI1
-.
LLFB2


335 .
byã
 0xd ! 
DW_CFA_def_cÁ_ªgi°î


336 .
byã
 0x1ê! 
uÀb128
 0x1e

337 .
byã
 0x2d ! 
DW_CFA_GNU_wödow_ßve


338 .
byã
 0x9 ! 
DW_CFA_ªgi°î


339 .
byã
 0x‡! 
uÀb128
 0xf

340 .
byã
 0x1‡! 
uÀb128
 0x1f

341 .
Æign
 
WS


342 .
LLEFDE2
:

344 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


345 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sparc/v9.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

31 #ifde‡
SPARC64


35 
	#STACKFRAME
 176

	)

36 
	#STACK_BIAS
 2047

	)

37 
	#ARGS
 (128Ë

	)

39 .
	gãxt


40 .
	gÆign
 8

41 .
globl
 
	gffi_ˇŒ_v9


42 .
globl
 
_ffi_ˇŒ_v9


44 
	gffi_ˇŒ_v9
:

45 
_ffi_ˇŒ_v9
:

46 .
LLFB1
:

47 
ßve
 %
•
, -
	gSTACKFRAME
, %
	g•


48 .
	gLLCFI0
:

50 
sub
 %
•
, %
	gi2
, %
	g•
 ! 
	$Æloˇ
(Ë
•a˚
 
ö
 
°ack
 
‰ame
 
to
 
£t
 
up


51 
add
 %
•
, 
STACKFRAME
+
STACK_BIAS
, %
l0
 ! %l0 
has
 
°¨t
 
of


52 ! 
‰ame
 
to
 
£t
 
up


54 
mov
 %
l0
, %
o0
 ! 
ˇŒ
 
routöe
 
to
 
£t
 
up
 
‰ame


55 
ˇŒ
 %
i0


56 
mov
 %
i1
, %
o1
 ! (
dñay
)

57 
brz
,
±
 %
o0
, 1f

58 
ldx
 [%
l0
+
ARGS
], %
o0
 ! 
ˇŒ
 
f‹eign
 
fun˘i⁄


60 
ldd
 [%
l0
+
ARGS
], %
f0


61 
ldd
 [%
l0
+
ARGS
+8], %
f2


62 
ldd
 [%
l0
+
ARGS
+16], %
f4


63 
ldd
 [%
l0
+
ARGS
+24], %
f6


64 
ldd
 [%
l0
+
ARGS
+32], %
f8


65 
ldd
 [%
l0
+
ARGS
+40], %
f10


66 
ldd
 [%
l0
+
ARGS
+48], %
f12


67 
ldd
 [%
l0
+
ARGS
+56], %
f14


68 
ldd
 [%
l0
+
ARGS
+64], %
f16


69 
ldd
 [%
l0
+
ARGS
+72], %
f18


70 
ldd
 [%
l0
+
ARGS
+80], %
f20


71 
ldd
 [%
l0
+
ARGS
+88], %
f22


72 
ldd
 [%
l0
+
ARGS
+96], %
f24


73 
ldd
 [%
l0
+
ARGS
+104], %
f26


74 
ldd
 [%
l0
+
ARGS
+112], %
f28


75 
ldd
 [%
l0
+
ARGS
+120], %
f30


77 1: 
ldx
 [%
l0
+
ARGS
+8], %
o1


78 
ldx
 [%
l0
+
ARGS
+16], %
o2


79 
ldx
 [%
l0
+
ARGS
+24], %
o3


80 
ldx
 [%
l0
+
ARGS
+32], %
o4


81 
ldx
 [%
l0
+
ARGS
+40], %
o5


82 
ˇŒ
 %
i5


83 
sub
 %
l0
, 
STACK_BIAS
, %
•
 ! (
dñay
Ë
to
 
‰ame


85 ! 
If
 
the
  
vÆue
 
poöãr
 
is
 
NULL
, 
assume
 
no
  value.

86 
brz
,
≤
 %
i4
, 
d⁄e


87 
n›


89 
cmp
 %
i3
, 
FFI_TYPE_INT


90 
be
,
a
,
±
 %
icc
, 
d⁄e


91 
°x
 %
o0
, [%
i4
+0] ! (
dñay
)

93 
cmp
 %
i3
, 
FFI_TYPE_FLOAT


94 
be
,
a
,
≤
 %
icc
, 
d⁄e


95 
°
 %
f0
, [%
i4
+0] ! (
dñay
)

97 
cmp
 %
i3
, 
FFI_TYPE_DOUBLE


98 
be
,
a
,
≤
 %
icc
, 
d⁄e


99 
°d
 %
f0
, [%
i4
+0] ! (
dñay
)

101 
cmp
 %
i3
, 
FFI_TYPE_STRUCT


102 
be
,
≤
 %
icc
, 
do°ru˘


104 
cmp
 %
i3
, 
FFI_TYPE_LONGDOUBLE


105 
b√
,
±
 %
icc
, 
d⁄e


106 
n›


107 
°d
 %
f0
, [%
i4
+0]

108 
°d
 %
f2
, [%
i4
+8]

110 
d⁄e
: 
ªt


111 
ª°‹e


113 
do°ru˘
:

115 
°x
 %
o0
, [%
i4
+0]

116 
°x
 %
o1
, [%
i4
+8]

117 
°x
 %
o2
, [%
i4
+16]

118 
°x
 %
o3
, [%
i4
+24]

119 
°d
 %
f0
, [%
i4
+32]

120 
°d
 %
f2
, [%
i4
+40]

121 
°d
 %
f4
, [%
i4
+48]

122 
°d
 %
f6
, [%
i4
+56]

123 
ªt


124 
ª°‹e


125 .
LLFE1
:

127 .
ffi_ˇŒ_v9_íd
:

128 .
size
 
ffi_ˇŒ_v9
,.
ffi_ˇŒ_v9_íd
-ffi_call_v9

131 #unde‡
STACKFRAME


132 
	#STACKFRAME
 336

	)

135 
	#FP
 %
Â
+
STACK_BIAS


	)

141 .
ãxt


142 .
Æign
 8

143 .
globl
 
ffi_˛osuª_v9


145 
ffi_˛osuª_v9
:

146 .
LLFB2
:

147 
ßve
 %
•
, -
STACKFRAME
, %sp

148 .
LLCFI1
:

150 ! 
St‹e
 
Æl
 
of
 
the
 
pŸítül
 
¨gumít
 
ªgi°îs
 
ö
 
va_li°
 
f‹m©
.

151 
°x
 %
i0
, [
FP
+128+0]

152 
°x
 %
i1
, [
FP
+128+8]

153 
°x
 %
i2
, [
FP
+128+16]

154 
°x
 %
i3
, [
FP
+128+24]

155 
°x
 %
i4
, [
FP
+128+32]

156 
°x
 %
i5
, [
FP
+128+40]

158 ! 
St‹e
 
possibÀ
 
Êﬂtög
 
poöt
 
¨gumít
 
ªgi°îs
 
too
.

159 
°d
 %
f0
, [
FP
-128]

160 
°d
 %
f2
, [
FP
-120]

161 
°d
 %
f4
, [
FP
-112]

162 
°d
 %
f6
, [
FP
-104]

163 
°d
 %
f8
, [
FP
-96]

164 
°d
 %
f10
, [
FP
-88]

165 
°d
 %
f12
, [
FP
-80]

166 
°d
 %
f14
, [
FP
-72]

167 
°d
 %
f16
, [
FP
-64]

168 
°d
 %
f18
, [
FP
-56]

169 
°d
 %
f20
, [
FP
-48]

170 
°d
 %
f22
, [
FP
-40]

171 
°d
 %
f24
, [
FP
-32]

172 
°d
 %
f26
, [
FP
-24]

173 
°d
 %
f28
, [
FP
-16]

174 
°d
 %
f30
, [
FP
-8]

176 ! 
CÆl
 
ffi_˛osuª_•¨c_ö√r
 
to
 dÿ
the
 
bulk
 
of
Åhê
w‹k
.

177 
mov
 %
g1
, %
o0


178 
add
 %
Â
, 
STACK_BIAS
-160, %
o1


179 
add
 %
Â
, 
STACK_BIAS
+128, %
o2


180 
ˇŒ
 
ffi_˛osuª_•¨c_ö√r_v9


181 
add
 %
Â
, 
STACK_BIAS
-128, %
o3


183 ! 
Lﬂd
 
up
 
the
  
vÆue
 
ö
Åhê
¥›î
 
ty≥
.

184 ! 
Sì
 
ffi_¥ï_cif_machdï
 
the
 
li°
 
of
 
ˇ£s
.

185 
cmp
 %
o0
, 
FFI_TYPE_VOID


186 
be
,
≤
 %
icc
, 
d⁄e1


188 
cmp
 %
o0
, 
FFI_TYPE_INT


189 
be
,
≤
 %
icc
, 
öãgî


191 
cmp
 %
o0
, 
FFI_TYPE_FLOAT


192 
be
,
a
,
≤
 %
icc
, 
d⁄e1


193 
ld
 [
FP
-160], %
f0


195 
cmp
 %
o0
, 
FFI_TYPE_DOUBLE


196 
be
,
a
,
≤
 %
icc
, 
d⁄e1


197 
ldd
 [
FP
-160], %
f0


199 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


200 
cmp
 %
o0
, 
FFI_TYPE_LONGDOUBLE


201 
be
,
a
,
≤
 %
icc
, 
l⁄gdoubÀ1


202 
ldd
 [
FP
-160], %
f0


205 ! 
FFI_TYPE_STRUCT


206 
ldx
 [
FP
-152], %
i1


207 
ldx
 [
FP
-144], %
i2


208 
ldx
 [
FP
-136], %
i3


209 
ldd
 [
FP
-160], %
f0


210 
ldd
 [
FP
-152], %
f2


211 
ldd
 [
FP
-144], %
f4


212 
ldd
 [
FP
-136], %
f6


214 
öãgî
:

215 
ldx
 [
FP
-160], %
i0


217 
d⁄e1
:

218 
ªt


219 
ª°‹e


221 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


222 
l⁄gdoubÀ1
:

223 
ldd
 [
FP
-152], %
f2


224 
ªt


225 
ª°‹e


227 .
LLFE2
:

229 .
ffi_˛osuª_v9_íd
:

230 .
size
 
ffi_˛osuª_v9
,.
ffi_˛osuª_v9_íd
-ffi_closure_v9

232 #ifde‡
HAVE_RO_EH_FRAME


233 .
£˘i⁄
 ".eh_frame",#alloc

235 .
£˘i⁄
 ".eh_frame",#alloc,#write

237 .
LL‰ame1
:

238 .
uaw‹d
 .
LLECIE1
-.
LLSCIE1
 ! 
Lígth
 
of
 
Comm⁄
 
Inf‹m©i⁄
 
E¡ry


239 .
LLSCIE1
:

240 .
uaw‹d
 0x0 ! 
CIE
 
Idítifõr
 
Tag


241 .
byã
 0x1 ! 
CIE
 
Vîsi⁄


242 .
ascii
 "zR\0" ! 
CIE
 
Augmíèti⁄


243 .
byã
 0x1 ! 
uÀb128
 0x1; 
CIE
 
Code
 
Alignmít
 
Fa˘‹


244 .
byã
 0x78 ! 
¶eb128
 -8; 
CIE
 
D©a
 
Alignmít
 
Fa˘‹


245 .
byã
 0x‡! 
CIE
 
RA
 
Cﬁumn


246 .
byã
 0x1 ! 
uÀb128
 0x1; 
Augmíèti⁄
 
size


247 #ifde‡
HAVE_AS_SPARC_UA_PCREL


248 .
byã
 0x1b ! 
FDE
 
	$Encodög
 (
p¸ñ
 
sd©a4
)

250 .
byã
 0x50 ! 
FDE
 
	$Encodög
 (
Æig√d
 
absﬁuã
)

252 .
byã
 0x¯! 
DW_CFA_def_cÁ


253 .
byã
 0xê! 
uÀb128
 0xe

254 .
byã
 0xff,0x‡! 
uÀb128
 0x7ff

255 .
Æign
 8

256 .
LLECIE1
:

257 .
LLSFDE1
:

258 .
uaw‹d
 .
LLEFDE1
-.
LLASFDE1
 ! 
FDE
 
Lígth


259 .
LLASFDE1
:

260 .
uaw‹d
 .
LLASFDE1
-.
LL‰ame1
 ! 
FDE
 
CIE
 
off£t


261 #ifde‡
HAVE_AS_SPARC_UA_PCREL


262 .
uaw‹d
 %
	`r_di•32
(.
LLFB1
)

263 .
uaw‹d
 .
LLFE1
-.
LLFB1
 ! 
FDE
 
addªss
 
ønge


265 .
Æign
 8

266 .
xw‹d
 .
LLFB1


267 .
uaxw‹d
 .
LLFE1
-.
LLFB1
 ! 
FDE
 
addªss
 
ønge


269 .
byã
 0x0 ! 
uÀb128
 0x0; 
Augmíèti⁄
 
size


270 .
byã
 0x4 ! 
DW_CFA_adv™˚_loc4


271 .
uaw‹d
 .
LLCFI0
-.
LLFB1


272 .
byã
 0xd ! 
DW_CFA_def_cÁ_ªgi°î


273 .
byã
 0x1ê! 
uÀb128
 0x1e

274 .
byã
 0x2d ! 
DW_CFA_GNU_wödow_ßve


275 .
byã
 0x9 ! 
DW_CFA_ªgi°î


276 .
byã
 0x‡! 
uÀb128
 0xf

277 .
byã
 0x1‡! 
uÀb128
 0x1f

278 .
Æign
 8

279 .
LLEFDE1
:

280 .
LLSFDE2
:

281 .
uaw‹d
 .
LLEFDE2
-.
LLASFDE2
 ! 
FDE
 
Lígth


282 .
LLASFDE2
:

283 .
uaw‹d
 .
LLASFDE2
-.
LL‰ame1
 ! 
FDE
 
CIE
 
off£t


284 #ifde‡
HAVE_AS_SPARC_UA_PCREL


285 .
uaw‹d
 %
	`r_di•32
(.
LLFB2
)

286 .
uaw‹d
 .
LLFE2
-.
LLFB2
 ! 
FDE
 
addªss
 
ønge


288 .
Æign
 8

289 .
xw‹d
 .
LLFB2


290 .
uaxw‹d
 .
LLFE2
-.
LLFB2
 ! 
FDE
 
addªss
 
ønge


292 .
byã
 0x0 ! 
uÀb128
 0x0; 
Augmíèti⁄
 
size


293 .
byã
 0x4 ! 
DW_CFA_adv™˚_loc4


294 .
uaw‹d
 .
LLCFI1
-.
LLFB2


295 .
byã
 0xd ! 
DW_CFA_def_cÁ_ªgi°î


296 .
byã
 0x1ê! 
uÀb128
 0x1e

297 .
byã
 0x2d ! 
DW_CFA_GNU_wödow_ßve


298 .
byã
 0x9 ! 
DW_CFA_ªgi°î


299 .
byã
 0x‡! 
uÀb128
 0xf

300 .
byã
 0x1‡! 
uÀb128
 0x1f

301 .
Æign
 8

302 .
LLEFDE2
:

305 #ifde‡
__löux__


306 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/tile/ffi.c

27 
	~<ffi.h
>

28 
	~<ffi_comm⁄.h
>

29 
	~<°dlib.h
>

30 
	~<°döt.h
>

31 
	~<uni°d.h
>

32 
	~<¨ch/abi.h
>

33 
	~<¨ch/iˇche.h
>

34 
	~<¨ch/›code.h
>

38 
	#NUM_ARG_REGS
 10

	)

42 
ffi_ˇŒ_tûe
(
ffi_ßrg
 
ªg_¨gs
[
NUM_ARG_REGS
],

43 c⁄° 
ffi_ßrg
 *
°ack_¨gs
,

44 
size_t
 
°ack_¨gs_byãs
,

45 (*
‚addr
)())

46 
FFI_HIDDEN
;

50 
	$ffi_˛osuª_tûe
(Ë
FFI_HIDDEN
;

53 
ffi_°©us


54 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

59 i‡(
cif
->
byãs
 < 
NUM_ARG_REGS
 * 
FFI_SIZEOF_ARG
)

60 
cif
->
byãs
 = 
NUM_ARG_REGS
 * 
FFI_SIZEOF_ARG
;

62 i‡(
cif
->
πy≥
->
size
 > 
NUM_ARG_REGS
 * 
FFI_SIZEOF_ARG
)

63 
cif
->
Êags
 = 
FFI_TYPE_STRUCT
;

65 
cif
->
Êags
 = 
FFI_TYPE_INT
;

68  
FFI_OK
;

69 
	}
}

73 
	$assign_to_ffi_¨g
(
ffi_ßrg
 *
out
, *
ö
, c⁄° 
ffi_ty≥
 *
ty≥
,

74 
wrôe_to_ªg
)

76 
ty≥
->type)

78 
FFI_TYPE_SINT8
:

79 *
out
 = *(
SINT8
 *)
ö
;

82 
FFI_TYPE_UINT8
:

83 *
out
 = *(
UINT8
 *)
ö
;

86 
FFI_TYPE_SINT16
:

87 *
out
 = *(
SINT16
 *)
ö
;

90 
FFI_TYPE_UINT16
:

91 *
out
 = *(
UINT16
 *)
ö
;

94 
FFI_TYPE_SINT32
:

95 
FFI_TYPE_UINT32
:

96 #i‚de‡
__LP64__


97 
FFI_TYPE_POINTER
:

101 *
out
 = *(
SINT32
 *)
ö
;

104 
FFI_TYPE_FLOAT
:

105 #ifde‡
__tûegx__


106 i‡(
wrôe_to_ªg
)

109 uni⁄ { 
f
; 
SINT32
 
s32
; } 
vÆ
;

110 
vÆ
.
f
 = *(*)
ö
;

111 *
out
 = 
vÆ
.
s32
;

116 *(*)
out
 = *(*)
ö
;

120 
FFI_TYPE_SINT64
:

121 
FFI_TYPE_UINT64
:

122 
FFI_TYPE_DOUBLE
:

123 #ifde‡
__LP64__


124 
FFI_TYPE_POINTER
:

126 *(
UINT64
 *)
out
 = *(UINT64 *)
ö
;

127  (
UINT64
Ë/ 
FFI_SIZEOF_ARG
;

129 
FFI_TYPE_STRUCT
:

130 
	`mem˝y
(
out
, 
ö
, 
ty≥
->
size
);

131  (
ty≥
->
size
 + 
FFI_SIZEOF_ARG
 - 1) / FFI_SIZEOF_ARG;

133 
FFI_TYPE_VOID
:

138 
	`FFI_ASSERT
(0);

141 
	}
}

145 
ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

147 
ffi_ßrg
 * c⁄° 
¨g_mem
 = 
	`Æloˇ
(
cif
->
byãs
);

148 
ffi_ßrg
 * c⁄° 
ªg_¨gs
 = 
¨g_mem
;

149 
ffi_ßrg
 * c⁄° 
°ack_¨gs
 = &
ªg_¨gs
[
NUM_ARG_REGS
];

150 
ffi_ßrg
 *
¨gp
 = 
¨g_mem
;

151 
ffi_ty≥
 ** c⁄° 
¨g_ty≥s
 = 
cif
->arg_types;

152 c⁄° 
num_¨gs
 = 
cif
->
«rgs
;

153 
i
;

155 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

160 *
¨gp
++ = (
öçå_t
)(
rvÆue
 ?ÑvÆuê: 
	`Æloˇ
(
cif
->
πy≥
->
size
));

163 
rvÆue
 = 
NULL
;

166 
i
 = 0; i < 
num_¨gs
; i++)

168 
ffi_ty≥
 *
ty≥
 = 
¨g_ty≥s
[
i
];

169 * c⁄° 
¨g_ö
 = 
avÆue
[
i
];

170 
±rdiff_t
 
¨g_w‹d
 = 
¨gp
 - 
¨g_mem
;

172 #i‚de‡
__tûegx__


175 
Æign
 = 
¨g_w‹d
 & (
ty≥
->
Æignmít
 > 
FFI_SIZEOF_ARG
);

176 
¨gp
 +
Æign
;

177 
¨g_w‹d
 +
Æign
;

180 i‡(
ty≥
->ty≥ =
FFI_TYPE_STRUCT
)

182 c⁄° 
size_t
 
¨g_size_ö_w‹ds
 =

183 (
ty≥
->
size
 + 
FFI_SIZEOF_ARG
 - 1) / FFI_SIZEOF_ARG;

185 i‡(
¨g_w‹d
 < 
NUM_ARG_REGS
 &&

186 
¨g_w‹d
 + 
¨g_size_ö_w‹ds
 > 
NUM_ARG_REGS
)

189 
¨gp
 = 
°ack_¨gs
;

192 
	`mem˝y
(
¨gp
, 
¨g_ö
, 
ty≥
->
size
);

193 
¨gp
 +
¨g_size_ö_w‹ds
;

197 
¨gp
 +
	`assign_to_ffi_¨g
◊rgp, 
¨g_ö
, 
¨g_ty≥s
[
i
], 1);

202 
	`ffi_ˇŒ_tûe
(
ªg_¨gs
, 
°ack_¨gs
,

203 
cif
->
byãs
 - (
NUM_ARG_REGS
 * 
FFI_SIZEOF_ARG
), 
‚
);

205 i‡(
rvÆue
 !
NULL
)

206 
	`assign_to_ffi_¨g
(
rvÆue
, 
ªg_¨gs
, 
cif
->
πy≥
, 0);

207 
	}
}

211 c⁄° 
UINT64
 
ffi_ãm∂©e_åamp_tûe
[] 
FFI_HIDDEN
;

214 
ffi_°©us


215 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
 *
˛osuª
,

216 
ffi_cif
 *
cif
,

217 (*
fun
)(
ffi_cif
*, *, **, *),

218 *
u£r_d©a
,

219 *
codñoc
)

221 #ifde‡
__tûegx__


223 
SINT64
 
c
;

224 
SINT64
 
h
;

225 
s
;

226 
UINT64
 *
out
;

228 i‡(
cif
->
abi
 !
FFI_UNIX
)

229  
FFI_BAD_ABI
;

231 
out
 = (
UINT64
 *)
˛osuª
->
åamp
;

233 
c
 = (
öçå_t
)
˛osuª
;

234 
h
 = (
öçå_t
)
ffi_˛osuª_tûe
;

235 
s
 = 0;

240 (
c
 >> 
s
Ë!(
SINT16
)(¯>> sË|| (
h
 >> s) != (SINT16)(h >> s))

241 
s
 += 16;

243 
	#OPS
(
a
, 
b
, 
shi·
) \

244 (
	`¸óã_Imm16_X0
((
a
Ë>> (
shi·
)Ë| 
	`¸óã_Imm16_X1
((
b
Ë>> (shi·)))

	)

247 *
out
++ = 
ffi_ãm∂©e_åamp_tûe
[0] | 
	`OPS
(
c
, 
h
, 
s
);

248 
s
 -= 16; s >= 0; s -= 16)

249 *
out
++ = 
ffi_ãm∂©e_åamp_tûe
[1] | 
	`OPS
(
c
, 
h
, 
s
);

251 #unde‡
OPS


253 *
out
++ = 
ffi_ãm∂©e_åamp_tûe
[2];

257 
UINT64
 *
out
;

258 
öçå_t
 
dñè
;

260 i‡(
cif
->
abi
 !
FFI_UNIX
)

261  
FFI_BAD_ABI
;

263 
out
 = (
UINT64
 *)
˛osuª
->
åamp
;

264 
dñè
 = (
öçå_t
)
ffi_˛osuª_tûe
 - (öçå_t)
codñoc
;

266 *
out
++ = 
ffi_ãm∂©e_åamp_tûe
[0] | 
	`¸óã_JOffL⁄g_X1
(
dñè
 >> 3);

269 
˛osuª
->
cif
 = cif;

270 
˛osuª
->
fun
 = fun;

271 
˛osuª
->
u£r_d©a
 = user_data;

273 
	`övÆid©e_iˇche
(
˛osuª
->
åamp
, (*)
out
 - closure->tramp,

274 
	`gë∑gesize
());

276  
FFI_OK
;

277 
	}
}

284 
FFI_HIDDEN


285 
	$ffi_˛osuª_tûe_ö√r
(
ffi_˛osuª
 *
˛osuª
,

286 
ffi_ßrg
 
ªg_¨gs
[2][
NUM_ARG_REGS
],

287 
ffi_ßrg
 *
°ack_¨gs
)

289 
ffi_cif
 * c⁄° 
cif
 = 
˛osuª
->cif;

290 ** c⁄° 
avÆue
 = 
	`Æloˇ
(
cif
->
«rgs
 * (*));

291 *
rvÆue
;

292 
ffi_ty≥
 ** c⁄° 
¨g_ty≥s
 = 
cif
->arg_types;

293 
ffi_ßrg
 * c⁄° 
ªg_¨gs_ö
 = 
ªg_¨gs
[0];

294 
ffi_ßrg
 * c⁄° 
ªg_¨gs_out
 = 
ªg_¨gs
[1];

295 
ffi_ßrg
 * 
¨gp
;

296 
i
, 
¨g_w‹d
, 
«rgs
 = 
cif
->nargs;

298 uni⁄ { 
ffi_ßrg
 
¨g
[
NUM_ARG_REGS
]; 
d
; 
UINT64
 
u64
; } 
˛osuª_ªt
;

301 
¨gp
 = 
ªg_¨gs_ö
;

305 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

308 
rvÆue
 = (*)(
öçå_t
)*
¨gp
++;

309 
¨g_w‹d
 = 1;

314 
rvÆue
 = &
˛osuª_ªt
;

315 
¨g_w‹d
 = 0;

319 
i
 = 0; i < 
«rgs
; i++)

321 
ffi_ty≥
 * c⁄° 
ty≥
 = 
¨g_ty≥s
[
i
];

322 c⁄° 
size_t
 
¨g_size_ö_w‹ds
 =

323 (
ty≥
->
size
 + 
FFI_SIZEOF_ARG
 - 1) / FFI_SIZEOF_ARG;

325 #i‚de‡
__tûegx__


328 
Æign
 = 
¨g_w‹d
 & (
ty≥
->
Æignmít
 > 
FFI_SIZEOF_ARG
);

329 
¨gp
 +
Æign
;

330 
¨g_w‹d
 +
Æign
;

333 i‡(
¨g_w‹d
 =
NUM_ARG_REGS
 ||

334 (
¨g_w‹d
 < 
NUM_ARG_REGS
 &&

335 
¨g_w‹d
 + 
¨g_size_ö_w‹ds
 > 
NUM_ARG_REGS
))

338 
¨gp
 = 
°ack_¨gs
;

339 
¨g_w‹d
 = 
NUM_ARG_REGS
;

342 
avÆue
[
i
] = 
¨gp
;

343 
¨gp
 +
¨g_size_ö_w‹ds
;

344 
¨g_w‹d
 +
¨g_size_ö_w‹ds
;

348 
˛osuª
->
	`fun
(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

350 i‡(
cif
->
Êags
 !
FFI_TYPE_STRUCT
)

353 
	`assign_to_ffi_¨g
(
ªg_¨gs_out
, &
˛osuª_ªt
, 
cif
->
πy≥
, 1);

355 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/tile/ffitarget.h

26 #i‚de‡
LIBFFI_TARGET_H


27 
	#LIBFFI_TARGET_H


	)

29 #i‚de‡
LIBFFI_H


33 #i‚de‡
LIBFFI_ASM


35 
	~<¨ch/abi.h
>

37 
uöt_ªg_t
 
	tffi_¨g
;

38 
öt_ªg_t
 
	tffi_ßrg
;

40 
	effi_abi
 {

41 
	mFFI_FIRST_ABI
 = 0,

42 
	mFFI_UNIX
,

43 
	mFFI_LAST_ABI
,

44 
	mFFI_DEFAULT_ABI
 = 
FFI_UNIX


45 } 
	tffi_abi
;

49 
	#FFI_CLOSURES
 1

	)

51 #ifde‡
__tûegx__


53 
	#FFI_SIZEOF_ARG
 8

	)

54 #ifde‡
__LP64__


55 
	#FFI_TRAMPOLINE_SIZE
 (8 * 5Ë

	)

57 
	#FFI_TRAMPOLINE_SIZE
 (8 * 3Ë

	)

60 
	#FFI_SIZEOF_ARG
 4

	)

61 
	#FFI_TRAMPOLINE_SIZE
 8

	)

63 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/tile/tile.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

32 
	#REG_SIZE
 
FFI_SIZEOF_ARG


	)

41 
	#LINKAGE_SIZE
 (2 * 
REG_SIZE
)

	)

44 
	#NUM_ARG_REGS
 10

	)

46 #ifde‡
__tûegx__


47 
	#SW
 
°


	)

48 
	#LW
 
ld


	)

49 
	#BGZT
 
bgtzt


	)

51 
	#SW
 
sw


	)

52 
	#LW
 
lw


	)

53 
	#BGZT
 
bgzt


	)

70 .
	g£˘i⁄
 .
	gãxt
.
	gffi_ˇŒ_tûe
, "ax", @
	g¥ogbôs


71 .
	gÆign
 8

72 .
globl
 
ffi_ˇŒ_tûe


73 
	$FFI_HIDDEN
(
ffi_ˇŒ_tûe
)

74 
ffi_ˇŒ_tûe
:

77 
	#REG_ARGS
 
r0


	)

78 
	#INCOMING_STACK_ARGS
 
r1


	)

79 
	#STACK_ARG_BYTES
 
r2


	)

80 
	#ORIG_FNADDR
 
r3


	)

83 
	#FRAME_SIZE
 
r10


	)

84 
	#TMP
 
r11


	)

85 
	#TMP2
 
r12


	)

86 
	#OUTGOING_STACK_ARGS
 
r13


	)

87 
	#REG_ADDR_PTR
 
r14


	)

88 
	#RETURN_REG_ADDR
 
r15


	)

89 
	#FNADDR
 
r16


	)

91 .
cfi_°¨çroc


94 
SW
 
•
, 
Ã


95 .
cfi_off£t
 
Ã
, 0

97 
addi
 
TMP
, 
•
, -
REG_SIZE


100 
addi
 
FRAME_SIZE
, 
STACK_ARG_BYTES
, \

101 
REG_SIZE
 + REG_SIZE + 
LINKAGE_SIZE
 + 7

102 
	}
}

105 
™di
 
	gFRAME_SIZE
, FRAME_SIZE, -8

107 
addi
 
	gTMP2
, 
	g•
, -(
	gREG_SIZE
 * 2)

111 
SW
 
	gTMP
, 
	gr52


112 .
cfi_off£t
 
	gr52
, -
REG_SIZE


114 
move
 
	gr52
, 
	g•


115 .
cfi_def_cÁ_ªgi°î
 
r52


117 
sub
 
	g•
, sp, 
	gFRAME_SIZE


121 
addi
 
	gTMP
, 
	g•
, 
REG_SIZE


123 
addi
 
	gOUTGOING_STACK_ARGS
, 
	g•
, 
LINKAGE_SIZE


125 
SW
 
	gTMP2
, 
	gREG_ARGS


129 
SW
 
	gTMP
, 
	gr52


133 
bÀzt
 
	gSTACK_ARG_BYTES
, .
	gLd⁄e_°ack_¨gs_mem˝y


136 .
	gLmem˝y_°ack_¨gs
:

139 
LW
 
TMP
, 
INCOMING_STACK_ARGS


140 
addi
 
	gINCOMING_STACK_ARGS
, INCOMING_STACK_ARGS, 
	gREG_SIZE


144 
SW
 
	gOUTGOING_STACK_ARGS
, 
TMP


145 
addi
 
	gOUTGOING_STACK_ARGS
, OUTGOING_STACK_ARGS, 
REG_SIZE


146 
addi
 
	gSTACK_ARG_BYTES
, STACK_ARG_BYTES, -
	gREG_SIZE


149 
BGZT
 
	gSTACK_ARG_BYTES
, .
	gLmem˝y_°ack_¨gs


151 .
	gLd⁄e_°ack_¨gs_mem˝y
:

155 
move
 
FNADDR
, 
ORIG_FNADDR


157 
addi
 
	gREG_ADDR_PTR
, 
	gr0
, 
REG_SIZE


159 
LW
 
	gr0
,Ñ0

163 
	#LOAD_REG
(
REG
, 
PTR
) \

165 
LW
 
REG
, 
PTR
 ; \

166 
addi
 
PTR
, PTR, 
REG_SIZE
 \

167 }

	)

169 
	$LOAD_REG
(
r1
, 
REG_ADDR_PTR
)

170 
	$LOAD_REG
(
r2
, 
REG_ADDR_PTR
)

171 
	$LOAD_REG
(
r3
, 
REG_ADDR_PTR
)

172 
	$LOAD_REG
(
r4
, 
REG_ADDR_PTR
)

173 
	$LOAD_REG
(
r5
, 
REG_ADDR_PTR
)

174 
	$LOAD_REG
(
r6
, 
REG_ADDR_PTR
)

175 
	$LOAD_REG
(
r7
, 
REG_ADDR_PTR
)

176 
	$LOAD_REG
(
r8
, 
REG_ADDR_PTR
)

177 
	$LOAD_REG
(
r9
, 
REG_ADDR_PTR
)

181 
jÆr
 
FNADDR


182 
	}
}

186 
LW
 
	gÃ
, 
r52


188 
addi
 
	gTMP
, 
	gr52
, -(2 * 
	gREG_SIZE
)

192 
LW
 
	gRETURN_REG_ADDR
, 
TMP


194 
addi
 
	gTMP
, 
	gr52
, -
	gREG_SIZE


199 
move
 
	g•
, 
r52


201 
LW
 
	gr52
, 
	gTMP


204 
	#STORE_REG
(
REG
, 
PTR
) \

206 
SW
 
PTR
, 
REG
 ; \

207 
addi
 
PTR
, PTR, 
REG_SIZE
 \

208 }

	)

211 
	$STORE_REG
(
r0
, 
RETURN_REG_ADDR
)

212 
	$STORE_REG
(
r1
, 
RETURN_REG_ADDR
)

213 
	$STORE_REG
(
r2
, 
RETURN_REG_ADDR
)

214 
	$STORE_REG
(
r3
, 
RETURN_REG_ADDR
)

215 
	$STORE_REG
(
r4
, 
RETURN_REG_ADDR
)

216 
	$STORE_REG
(
r5
, 
RETURN_REG_ADDR
)

217 
	$STORE_REG
(
r6
, 
RETURN_REG_ADDR
)

218 
	$STORE_REG
(
r7
, 
RETURN_REG_ADDR
)

219 
	$STORE_REG
(
r8
, 
RETURN_REG_ADDR
)

220 
	$STORE_REG
(
r9
, 
RETURN_REG_ADDR
)

223 
jΩ
 
Ã


224 
	}
}

226 .
	gcfi_íd¥oc


227 .
size
 
	gffi_ˇŒ_tûe
, .-ffi_call_tile

238 .
	g£˘i⁄
 .
	gãxt
.
	gffi_˛osuª_tûe
, "ax", @
	g¥ogbôs


239 .
	gÆign
 8

240 .
globl
 
ffi_˛osuª_tûe


241 
FFI_HIDDEN
(
ffi_˛osuª_tûe
)

243 .
	gcfi_°¨çroc


245 
	#CLOSURE_FRAME_SIZE
 (((
NUM_ARG_REGS
 * 
REG_SIZE
 * 2 + 
LINKAGE_SIZE
Ë+ 7Ë& -8)

	)

246 
	gffi_˛osuª_tûe
:

248 #ifde‡
__tûegx__


249 
°
 
•
, 
	gÃ


250 .
cfi_off£t
 
	gÃ
, 0

253 
SW
 
	g•
, 
	gr10


254 .
cfi_ªtu∫_cﬁumn
 
	gr10


255 .
cfi_off£t
 
	gr10
, 0

258 
addli
 
	gr10
, 
	g•
, -(
	gCLOSURE_FRAME_SIZE
 - 
	gREG_SIZE
)

262 
SW
 
	gr10
, 
	g•


263 .
cfi_off£t
 
	g•
, -(
	gCLOSURE_FRAME_SIZE
 - 
	gREG_SIZE
)

265 
addli
 
	g•
, sp, -
	gCLOSURE_FRAME_SIZE


266 .
cfi_adju°_cÁ_off£t
 
	gCLOSURE_FRAME_SIZE


271 
addi
 
	gr10
, 
	g•
, 
	gLINKAGE_SIZE


275 
	$STORE_REG
(
r0
, 
r10
)

276 
	$STORE_REG
(
r1
, 
r10
)

277 
	$STORE_REG
(
r2
, 
r10
)

278 
	$STORE_REG
(
r3
, 
r10
)

279 
	$STORE_REG
(
r4
, 
r10
)

280 
	$STORE_REG
(
r5
, 
r10
)

281 
	$STORE_REG
(
r6
, 
r10
)

282 
	$STORE_REG
(
r7
, 
r10
)

283 
	$STORE_REG
(
r8
, 
r10
)

286 
SW
 
r10
, 
r9


287 #ifde‡
__tûegx__


289 
move
 
r0
, 
r11


295 
addi
 
r0
, 
Ã
, -8

298 
addi
 
r1
, 
•
, 
LINKAGE_SIZE


299 
	}
}

302 
addli
 
	gr2
, 
	g•
, 
	gCLOSURE_FRAME_SIZE
 + 
LINKAGE_SIZE


304 
jÆ
 
	gffi_˛osuª_tûe_ö√r


307 
addli
 
	gr10
, 
	g•
, 
	gCLOSURE_FRAME_SIZE


311 
LW
 
	gÃ
, 
r10


313 
addli
 
	gr10
, 
	g•
, 
	gLINKAGE_SIZE
 + (
NUM_ARG_REGS
 * 
	gREG_SIZE
)

316 
	$LOAD_REG
(
r0
, 
r10
)

317 
	$LOAD_REG
(
r1
, 
r10
)

318 
	$LOAD_REG
(
r2
, 
r10
)

319 
	$LOAD_REG
(
r3
, 
r10
)

320 
	$LOAD_REG
(
r4
, 
r10
)

321 
	$LOAD_REG
(
r5
, 
r10
)

322 
	$LOAD_REG
(
r6
, 
r10
)

323 
	$LOAD_REG
(
r7
, 
r10
)

324 
	$LOAD_REG
(
r8
, 
r10
)

325 
	$LOAD_REG
(
r9
, 
r10
)

328 
addli
 
•
, sp, 
CLOSURE_FRAME_SIZE


329 
jΩ
 
Ã


330 
	}
}

332 .
	gcfi_íd¥oc


333 .
size
 
	gffi_˛osuª_tûe
, . - ffi_closure_tile

340 .
	g£˘i⁄
 .
	gãxt
.
	gffi_ãm∂©e_åamp_tûe
, "ax", @
	g¥ogbôs


341 .
	gÆign
 8

342 .
globl
 
ffi_ãm∂©e_åamp_tûe


343 
	$FFI_HIDDEN
(
ffi_ãm∂©e_åamp_tûe
)

344 
ffi_ãm∂©e_åamp_tûe
:

345 #ifde‡
__tûegx__


347 
movñi
 
r11
, 0

348 
movñi
 
r10
, 0

349 
	}
}

352 { 
shl16ö¶i
 
	gr11
,Ñ11, 0 ; shl16ö¶ò
	gr10
,Ñ10, 0 }

353 { 
	göfo
 2+8 ; 
jr
 
	gr10
 }

357 { 
move
 
	gr10
, 
	gÃ
 ; 
	gjÆ
 . }

360 .
size
 
	gffi_ãm∂©e_åamp_tûe
, . - ffi_template_tramp_tile

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/types.c

29 
	#LIBFFI_HIDE_BASIC_TYPES


	)

31 
	~<ffi.h
>

32 
	~<ffi_comm⁄.h
>

36 
	#FFI_TYPEDEF
(
«me
, 
ty≥
, 
id
, 
maybe_c⁄°
)\

37 
°ru˘_Æign_
##
«me
 { \

38 
c
; \

39 
ty≥
 
x
; \

41 
maybe_c⁄°
 
ffi_ty≥
 
ffi_ty≥_
##
«me
 = { \

42 (
ty≥
), \

43 
	`off£tof
(
°ru˘_Æign_
##
«me
, 
x
), \

44 
id
, 
NULL
 \

45 }

	)

47 
	#FFI_COMPLEX_TYPEDEF
(
«me
, 
ty≥
, 
maybe_c⁄°
) \

48 
ffi_ty≥
 *
ffi_ñemíts_com∂ex_
##
«me
 [2] = { \

49 (
ffi_ty≥
 *)(&
ffi_ty≥_
##
«me
), 
NULL
 \

51 
°ru˘_Æign_com∂ex_
##
«me
 { \

52 
c
; \

53 
_Com∂ex
 
ty≥
 
x
; \

55 
maybe_c⁄°
 
ffi_ty≥
 
ffi_ty≥_com∂ex_
##
«me
 = { \

56 (
_Com∂ex
 
ty≥
), \

57 
	`off£tof
(
°ru˘_Æign_com∂ex_
##
«me
, 
x
), \

58 
FFI_TYPE_COMPLEX
, \

59 (
ffi_ty≥
 **)
ffi_ñemíts_com∂ex_
##
«me
 \

60 }

	)

63 c⁄° 
ffi_ty≥
 
	gffi_ty≥_void
 = {

64 1, 1, 
FFI_TYPE_VOID
, 
NULL


67 
FFI_TYPEDEF
(
uöt8
, 
UINT8
, 
FFI_TYPE_UINT8
, const);

68 
FFI_TYPEDEF
(
söt8
, 
SINT8
, 
FFI_TYPE_SINT8
, const);

69 
FFI_TYPEDEF
(
uöt16
, 
UINT16
, 
FFI_TYPE_UINT16
, const);

70 
FFI_TYPEDEF
(
söt16
, 
SINT16
, 
FFI_TYPE_SINT16
, const);

71 
FFI_TYPEDEF
(
uöt32
, 
UINT32
, 
FFI_TYPE_UINT32
, const);

72 
FFI_TYPEDEF
(
söt32
, 
SINT32
, 
FFI_TYPE_SINT32
, const);

73 
FFI_TYPEDEF
(
uöt64
, 
UINT64
, 
FFI_TYPE_UINT64
, const);

74 
FFI_TYPEDEF
(
söt64
, 
SINT64
, 
FFI_TYPE_SINT64
, const);

76 
FFI_TYPEDEF
(
poöãr
, *, 
FFI_TYPE_POINTER
, const);

78 
FFI_TYPEDEF
(, , 
FFI_TYPE_FLOAT
, const);

79 
FFI_TYPEDEF
(, , 
FFI_TYPE_DOUBLE
, const);

81 #i‡!
deföed
 
HAVE_LONG_DOUBLE_VARIANT
 || deföed 
__Æpha__


82 
	#FFI_LDBL_CONST
 c⁄°

	)

84 
	#FFI_LDBL_CONST


	)

87 #ifde‡
__Æpha__


92 #i‡
deföed
(
__LONG_DOUBLE_128__
Ë&& 
FFI_TYPE_LONGDOUBLE
 != 4

93 #îr‹ 
FFI_TYPE_LONGDOUBLE
 
out
 
of
 
d©e


95 c⁄° 
ffi_ty≥
 
	gffi_ty≥_l⁄gdoubÀ
 = { 16, 16, 4, 
NULL
 };

96 #ñi‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


97 
FFI_TYPEDEF
(
l⁄gdoubÀ
, , 
FFI_TYPE_LONGDOUBLE
, 
FFI_LDBL_CONST
);

100 #ifde‡
FFI_TARGET_HAS_COMPLEX_TYPE


101 
FFI_COMPLEX_TYPEDEF
(, , const);

102 
FFI_COMPLEX_TYPEDEF
(, , const);

103 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


104 
FFI_COMPLEX_TYPEDEF
(
l⁄gdoubÀ
, , 
FFI_LDBL_CONST
);

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/vax/elfbsd.S

28 
	#LIBFFI_ASM


	)

29 
	~<ffic⁄fig.h
>

30 
	~<ffi.h
>

32 .
	gãxt


42 .
globl
 
	gffi_ˇŒ_ñfbsd


43 .
ty≥
 
	gffi_ˇŒ_ñfbsd
,@
	gfun˘i⁄


44 .
	gÆign
 2

45 
	gffi_ˇŒ_ñfbsd
:

46 .
w‹d
 0x00¯#ßvê
R2
 
™d
 
R3


48 #AŒoˇã 
°ack
 
•a˚
 
the
 
¨gs


49 
subl2
 8(%
≠
), %
	g•


51 #CÆ»
ffi_¥ï_¨gs


52 
	gpushl
 %
•


53 
	gpushl
 4(%
	g≠
)

54 
ˇŒs
 
	g$2
, 
	gffi_¥ï_¨gs


56 #Gë 
fun˘i⁄
 
poöãr


57 
	gmovl
 20(%
	g≠
), %
	gr1


59 #Buûd 
a
 
CALLS
 
‰ame


60 
ashl
 
	g$
-2, 8(%
	g≠
), %
r0


61 
	gpushl
 %
	gr0
 #¨gumíà
°ack
 
ußge


62 
	gmovl
 %
	g•
, %
	gr0
 #futuª %
	g≠


63 #ßved 
ªgi°îs


64 
bbc
 
	g$11
, 0(%
	gr1
), 1f

65 
	gpushl
 %
	gr11


66 1: 
bbc
 
$10
, 0(%
	gr1
), 1f

67 
	gpushl
 %
	gr10


68 1: 
bbc
 
$9
, 0(%
	gr1
), 1f

69 
	gpushl
 %
	gr9


70 1: 
bbc
 
$8
, 0(%
	gr1
), 1f

71 
	gpushl
 %
	gr8


72 1: 
bbc
 
$7
, 0(%
	gr1
), 1f

73 
	gpushl
 %
	gr7


74 1: 
bbc
 
$6
, 0(%
	gr1
), 1f

75 
	gpushl
 %
	gr6


76 1: 
bbc
 
$5
, 0(%
	gr1
), 1f

77 
	gpushl
 %
	gr5


78 1: 
bbc
 
$4
, 0(%
	gr1
), 1f

79 
	gpushl
 %
	gr4


80 1: 
bbc
 
$3
, 0(%
	gr1
), 1f

81 
	gpushl
 %
	gr3


82 1: 
bbc
 
$2
, 0(%
	gr1
), 1f

83 
	gpushl
 %
	gr2


85 
pushÆ
 9f

86 
pushl
 %
Â


87 
pushl
 %
≠


88 
movl
 16(%
≠
), %
	gr3
 #°ru˘  
	gaddªss
, 
√eded


89 
	gmovl
 %
	gr0
, %
≠


90 
	gmovzwl
 4(%
	gÂ
), %
	gr0
 #¥eviou†
	gPSW
, 
wôhout
 
the
 
ßved
 
ªgi°îs
 
mask


91 
bi¶2
 
	g$0x20000000
, %
	gr0
 #ˇŒ†
‰ame


92 
	gmovzwl
 0(%
	gr1
), %
r2


93 
bicw2
 
	g$0xf003
, %
	gr2
 #⁄ly 
kìp
 
	gR11
-
R2


94 
ashl
 
	g$16
, %
	gr2
, %
r2


95 
	gbi¶2
 %
	gr2
, %
	gr0
 #ßved 
mask
 
of
 
the
 
ˇŒed
 
fun˘i⁄


96 
	gpushl
 %
r0


97 
pushl
 
$0


98 
	gmovl
 %
	g•
, %
	gÂ


100 #Invokê
the
 
fun˘i⁄


101 
	gpushÆ
 2(%
	gr1
Ë#skù 
¥o˚duª
 
íåy
 
mask


102 
	gmovl
 %
	gr3
, %
r1


103 
bi˝sw
 
$0x000f


104 
	grsb


107 #C›y  
vÆue
 
√˚sßry


108 
t°l
 16(%
≠
)

109 
jeql
 9f

110 
movl
 16(%
≠
), %
r2


112 
bbc
 
	g$0
, 12(%
	g≠
), 1f #CIF_FLAGS_CHAR

113 
	gmovb
 %
	gr0
, 0(%
	gr2
)

114 
	gbrb
 9f

116 
bbc
 
$1
, 12(%
	g≠
), 1f #CIF_FLAGS_SHORT

117 
	gmovw
 %
	gr0
, 0(%
	gr2
)

118 
	gbrb
 9f

120 
bbc
 
$2
, 12(%
	g≠
), 1f #CIF_FLAGS_INT

121 
	gmovl
 %
	gr0
, 0(%
	gr2
)

122 
	gbrb
 9f

124 
bbc
 
$3
, 12(%
	g≠
), 1f #CIF_FLAGS_DINT

125 
	gmovq
 %
	gr0
, 0(%
	gr2
)

126 
	gbrb
 9f

128 
movl
 %
r1
, %
	gr0
 #mighà
have
 
bìn
 
a
 

132 
ªt


138 .
globl
 
ffi_˛osuª_ñfbsd


139 .
ty≥
 
ffi_˛osuª_ñfbsd
, @
	gfun˘i⁄


140 .
	gÆign
 2

141 
	gffi_˛osuª_ñfbsd
:

142 .
w‹d
 0

144 #AŒoˇã 
room
 
⁄
 
°ack
  
vÆue


145 
subl2
 
$8
, %
	g•


147 #Invokê
the
 
˛osuª
 
fun˘i⁄


148 
	gpushÆ
 4(%
	g≠
Ë#ˇŒög 
°ack


149 
	gpushÆ
 4(%
	g•
Ë#ªtu∫ 
vÆue


150 
	gpushl
 %
	gr0
 #closure

151 
ˇŒs
 
	g$3
, 
	gffi_˛osuª_ñfbsd_ö√r


153 #C›y  
vÆue
 
√˚sßry


154 
bôb
 
	g$1
, %
	gr0
 #CIF_FLAGS_CHAR

155 
	gbeql
 1f

156 
	gmovb
 0(%
	g•
), %
r0


157 
	gbrb
 9f

159 
bôb
 
$2
, %
	gr0
 #CIF_FLAGS_SHORT

160 
	gbeql
 1f

161 
	gmovw
 0(%
	g•
), %
r0


162 
	gbrb
 9f

164 
bôb
 
$4
, %
	gr0
 #CIF_FLAGS_INT

165 
	gbeql
 1f

166 
	gmovl
 0(%
	g•
), %
r0


167 
	gbrb
 9f

169 
bôb
 
$8
, %
	gr0
 #CIF_FLAGS_DINT

170 
	gbeql
 1f

171 
	gmovq
 0(%
	g•
), %
	gr0


176 
ªt


183 .
globl
 
ffi_˛osuª_°ru˘_ñfbsd


184 .
ty≥
 
ffi_˛osuª_°ru˘_ñfbsd
, @
	gfun˘i⁄


185 .
	gÆign
 2

186 
	gffi_˛osuª_°ru˘_ñfbsd
:

187 .
w‹d
 0

189 #Invokê
the
 
˛osuª
 
fun˘i⁄


190 
pushÆ
 4(%
≠
Ë#ˇŒög 
°ack


191 
pushl
 %
r1
 #ªtu∫ 
vÆue


192 
pushl
 %
r0
 #closure

193 
ˇŒs
 
$3
, 
ffi_˛osuª_ñfbsd_ö√r


195 
	gªt


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/vax/ffi.c

31 
	~<ffi.h
>

32 
	~<ffi_comm⁄.h
>

34 
	~<°dlib.h
>

35 
	~<uni°d.h
>

37 
	#CIF_FLAGS_CHAR
 1

	)

38 
	#CIF_FLAGS_SHORT
 2

	)

39 
	#CIF_FLAGS_INT
 4

	)

40 
	#CIF_FLAGS_DINT
 8

	)

46 
ffi_ˇŒ_ñfbsd
 (
exãnded_cif
 *, , , *,

48 *
ffi_¥ï_¨gs
 (
exãnded_cif
 *
ecif
, *
°ack
);

51 
	$ffi_¥ï_¨gs
 (
exãnded_cif
 *
ecif
, *
°ack
)

53 
i
;

54 **
p_¨gv
;

55 *
¨gp
;

56 
ffi_ty≥
 **
p_¨g
;

57 *
°ru˘_vÆue_±r
;

59 
¨gp
 = 
°ack
;

61 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


62 && !
ecif
->
cif
->
Êags
)

63 
°ru˘_vÆue_±r
 = 
ecif
->
rvÆue
;

65 
°ru˘_vÆue_±r
 = 
NULL
;

67 
p_¨gv
 = 
ecif
->
avÆue
;

69 
i
 = 
ecif
->
cif
->
«rgs
, 
p_¨g
 =Écif->cif->
¨g_ty≥s
;

70 
i
 != 0;

71 
i
--, 
p_¨g
++)

73 
size_t
 
z
;

75 
z
 = (*
p_¨g
)->
size
;

76 i‡(
z
 <  ())

78 (*
p_¨g
)->
ty≥
)

80 
FFI_TYPE_SINT8
:

81 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT8
 *Ë*
p_¨gv
;

84 
FFI_TYPE_UINT8
:

85 *(*Ë
¨gp
 = (Ë*(
UINT8
 *Ë*
p_¨gv
;

88 
FFI_TYPE_SINT16
:

89 *(sig√d *Ë
¨gp
 = (sig√d Ë*(
SINT16
 *Ë*
p_¨gv
;

92 
FFI_TYPE_UINT16
:

93 *(*Ë
¨gp
 = (Ë*(
UINT16
 *Ë*
p_¨gv
;

96 
FFI_TYPE_STRUCT
:

97 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

101 
	`FFI_ASSERT
 (0);

103 
z
 =  ();

107 
	`mem˝y
 (
¨gp
, *
p_¨gv
, 
z
);

110 i‡(((Ë- 1Ë& 
z
)

111 
z
 = 
	`ALIGN
(z, ());

114 
p_¨gv
++;

115 
¨gp
 +
z
;

118  
°ru˘_vÆue_±r
;

119 
	}
}

121 
ffi_°©us


122 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

125 
cif
->
πy≥
->
ty≥
)

127 
FFI_TYPE_VOID
:

128 
cif
->
Êags
 = 0;

131 
FFI_TYPE_STRUCT
:

132 i‡(
cif
->
πy≥
->
ñemíts
[0]->
ty≥
 =
FFI_TYPE_STRUCT
 &&

133 
cif
->
πy≥
->
ñemíts
[1])

135 
cif
->
Êags
 = 0;

139 i‡(
cif
->
πy≥
->
size
 ==  ())

140 
cif
->
Êags
 = 
CIF_FLAGS_CHAR
;

141 i‡(
cif
->
πy≥
->
size
 ==  ())

142 
cif
->
Êags
 = 
CIF_FLAGS_SHORT
;

143 i‡(
cif
->
πy≥
->
size
 ==  ())

144 
cif
->
Êags
 = 
CIF_FLAGS_INT
;

145 i‡(
cif
->
πy≥
->
size
 == 2 *  ())

146 
cif
->
Êags
 = 
CIF_FLAGS_DINT
;

148 
cif
->
Êags
 = 0;

152 i‡(
cif
->
πy≥
->
size
 <=  ())

153 
cif
->
Êags
 = 
CIF_FLAGS_INT
;

155 
cif
->
Êags
 = 
CIF_FLAGS_DINT
;

159  
FFI_OK
;

160 
	}
}

163 
ffi_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
Ë(), *
rvÆue
, **
avÆue
)

165 
exãnded_cif
 
	gecif
;

167 
	gecif
.
	gcif
 = 
cif
;

168 
	gecif
.
	gavÆue
 = 
avÆue
;

173 i‡(
	grvÆue
 =
NULL


174 && 
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


175 && 
cif
->
Êags
 == 0)

176 
ecif
.
rvÆue
 = 
Æloˇ
 (
cif
->
πy≥
->
size
);

178 
	gecif
.
	grvÆue
 = 
rvÆue
;

180 
	gcif
->
	gabi
)

182 
	gFFI_ELFBSD
:

183 
ffi_ˇŒ_ñfbsd
 (&
ecif
, 
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
, 
‚
);

187 
FFI_ASSERT
 (0);

196 
ffi_˛osuª_ñfbsd
 ();

197 
ffi_˛osuª_°ru˘_ñfbsd
 ();

198 
ffi_˛osuª_ñfbsd_ö√r
 (
ffi_˛osuª
 *, *, *);

201 
	$ffi_¥ï_˛osuª_ñfbsd
 (
ffi_cif
 *
cif
, **
avÆue
, *
°ackp
)

203 
i
;

204 **
p_¨gv
;

205 
ffi_ty≥
 **
p_¨g
;

207 
p_¨gv
 = 
avÆue
;

209 
i
 = 
cif
->
«rgs
, 
p_¨g
 = cif->
¨g_ty≥s
; i != 0; i--,Ö_arg++)

211 
size_t
 
z
;

213 
z
 = (*
p_¨g
)->
size
;

214 *
p_¨gv
 = 
°ackp
;

217 i‡(( (Ë- 1Ë& 
z
)

218 
z
 = 
	`ALIGN
(z,  ());

220 
p_¨gv
++;

221 
°ackp
 +
z
;

223 
	}
}

226 
	$ffi_˛osuª_ñfbsd_ö√r
 (
ffi_˛osuª
 *
˛osuª
, *
ª•
, *
°ack
)

228 
ffi_cif
 *
cif
;

229 **
¨g_¨ó
;

231 
cif
 = 
˛osuª
->cif;

232 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

234 
	`ffi_¥ï_˛osuª_ñfbsd
 (
cif
, 
¨g_¨ó
, 
°ack
);

236 (
˛osuª
->
fun
Ë(
cif
, 
ª•
, 
¨g_¨ó
, closuª->
u£r_d©a
);

238  
cif
->
Êags
;

239 
	}
}

241 
ffi_°©us


242 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
 *
˛osuª
, 
ffi_cif
 *
cif
,

243 (*
fun
)(
ffi_cif
 *, *, **, *),

244 *
u£r_d©a
, *
codñoc
)

246 *
åamp
 = (*Ë
codñoc
;

247 *
‚
;

249 
	`FFI_ASSERT
 (
cif
->
abi
 =
FFI_ELFBSD
);

252 *(*)(
åamp
 + 0) = 0x0000;

254 
åamp
[2] = 0xd0;

255 
åamp
[3] = 0x8f;

256 *(*)(
åamp
 + 4Ë(Ë
˛osuª
;

257 
åamp
[8] = 0x50;

259 i‡(
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


260 && !
cif
->
Êags
)

261 
‚
 = &
ffi_˛osuª_°ru˘_ñfbsd
;

263 
‚
 = &
ffi_˛osuª_ñfbsd
;

266 
åamp
[9] = 0x17;

267 
åamp
[10] = 0xef;

268 *(*)(
åamp
 + 11Ë()
‚
 + 2 -

269 ()
åamp
 - 9 - 6;

271 
˛osuª
->
cif
 = cif;

272 
˛osuª
->
u£r_d©a
 = user_data;

273 
˛osuª
->
fun
 = fun;

275  
FFI_OK
;

276 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/vax/ffitarget.h

28 #i‚de‡
LIBFFI_TARGET_H


29 
	#LIBFFI_TARGET_H


	)

31 #i‚de‡
LIBFFI_ASM


32 
	tffi_¨g
;

33 sig√d 
	tffi_ßrg
;

35 
	effi_abi
 {

36 
	mFFI_FIRST_ABI
 = 0,

37 
	mFFI_ELFBSD
,

38 
	mFFI_DEFAULT_ABI
 = 
FFI_ELFBSD
,

39 
	mFFI_LAST_ABI
 = 
FFI_DEFAULT_ABI
 + 1

40 } 
	tffi_abi
;

45 
	#FFI_CLOSURES
 1

	)

46 
	#FFI_TRAMPOLINE_SIZE
 15

	)

47 
	#FFI_NATIVE_RAW_API
 0

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/darwin.S

29 #i‚de‡
__x86_64__


31 
	#LIBFFI_ASM


	)

32 
	~<ffic⁄fig.h
>

33 
	~<ffi.h
>

35 .
	gãxt


37 .
globl
 
	g_ffi_¥ï_¨gs


39 .
	gÆign
 4

40 .
globl
 
_ffi_ˇŒ_SYSV


42 
	g_ffi_ˇŒ_SYSV
:

43 .
LFB1
:

44 
pushl
 %
ebp


45 .
LCFI0
:

46 
movl
 %
e•
,%
	gebp


47 .
	gLCFI1
:

48 
subl
 
$8
,%
e•


50 
	gmovl
 16(%
	gebp
),%
ecx


51 
	gsubl
 %
	gecx
,%
e•


53 
	gmovl
 %
	ge•
,%
óx


56 
subl
 
	g$8
,%
e•


57 
	gpushl
 12(%
	gebp
)

58 
	gpushl
 %
óx


59 
	gˇŒ
 *8(%
	gebp
)

62 
addl
 
	g$16
,%
e•


64 
	gˇŒ
 *28(%
	gebp
)

67 
	gmovl
 20(%
	gebp
),%
ecx


70 
	gpushl
 %
esi


73 
cm∂
 
	g$0
,24(%
	gebp
)

74 
	gj√
 0f

78 
cm∂
 
	g$FFI_TYPE_FLOAT
,%
ecx


79 
j√
 
n‹ëvÆ


80 
	gf°p
 %
	$°
(0)

82 
jmp
 
ïûogue


84 .
Æign
 4

85 
ˇŒ
 1f

86 .
L°‹e_èbÀ
:

87 .
n‹ëvÆ
-.
L°‹e_èbÀ


88 .
ªtöt
-.
L°‹e_èbÀ


89 .
ªtÊﬂt
-.
L°‹e_èbÀ


90 .
ªtdoubÀ
-.
L°‹e_èbÀ


91 .
ªé⁄gdoubÀ
-.
L°‹e_èbÀ


92 .
ªtuöt8
-.
L°‹e_èbÀ


93 .
ªtsöt8
-.
L°‹e_èbÀ


94 .
ªtuöt16
-.
L°‹e_èbÀ


95 .
ªtsöt16
-.
L°‹e_èbÀ


96 .
ªtöt
-.
L°‹e_èbÀ


97 .
ªtöt
-.
L°‹e_èbÀ


98 .
ªtöt64
-.
L°‹e_èbÀ


99 .
ªtöt64
-.
L°‹e_èbÀ


100 .
ªt°ru˘
-.
L°‹e_èbÀ


101 .
ªtöt
-.
L°‹e_èbÀ


102 .
ªt°ru˘1b
-.
L°‹e_èbÀ


103 .
ªt°ru˘2b
-.
L°‹e_èbÀ


105 
p›
 %
esi


106 
	`add
 (%
esi
, %
ecx
, 4), %esi

107 
jmp
 *%
esi


110 
ªtsöt8
:

111 
movsbl
 %
Æ
, %
óx


112 
jmp
 
ªtöt


114 
ªtsöt16
:

115 
movswl
 %
ax
, %
óx


116 
jmp
 
ªtöt


118 
ªtuöt8
:

119 
movzbl
 %
Æ
, %
óx


120 
jmp
 
ªtöt


122 
ªtuöt16
:

123 
movzwl
 %
ax
, %
óx


124 
jmp
 
ªtöt


126 
ªtÊﬂt
:

128 
movl
 24(%
ebp
),%
ecx


129 
	`f°ps
 (%
ecx
)

130 
jmp
 
ïûogue


132 
ªtdoubÀ
:

134 
movl
 24(%
ebp
),%
ecx


135 
	`f°∂
 (%
ecx
)

136 
jmp
 
ïûogue


138 
ªé⁄gdoubÀ
:

140 
movl
 24(%
ebp
),%
ecx


141 
	`f°±
 (%
ecx
)

142 
jmp
 
ïûogue


144 
ªtöt64
:

146 
movl
 24(%
ebp
),%
ecx


147 
movl
 %
óx
,0(%
ecx
)

148 
movl
 %
edx
,4(%
ecx
)

149 
jmp
 
ïûogue


151 
ªt°ru˘1b
:

153 
movl
 24(%
ebp
),%
ecx


154 
movb
 %
Æ
,0(%
ecx
)

155 
jmp
 
ïûogue


157 
ªt°ru˘2b
:

159 
movl
 24(%
ebp
),%
ecx


160 
movw
 %
ax
,0(%
ecx
)

161 
jmp
 
ïûogue


163 
ªtöt
:

165 
movl
 24(%
ebp
),%
ecx


166 
movl
 %
óx
,0(%
ecx
)

168 
ªt°ru˘
:

171 
n‹ëvÆ
:

172 
ïûogue
:

173 
p›l
 %
esi


174 
movl
 %
ebp
,%
e•


175 
p›l
 %
ebp


176 
ªt


178 .
LFE1
:

179 .
ffi_ˇŒ_SYSV_íd
:

181 .
Æign
 4

182 
	`FFI_HIDDEN
 (
ffi_˛osuª_SYSV
)

183 .
globl
 
_ffi_˛osuª_SYSV


185 
_ffi_˛osuª_SYSV
:

186 .
LFB2
:

187 
pushl
 %
ebp


188 .
LCFI2
:

189 
movl
 %
e•
, %
ebp


190 .
LCFI3
:

191 
subl
 
$40
, %
e•


192 
ÀÆ
 -24(%
ebp
), %
edx


193 
movl
 %
edx
, -12(%
ebp
)

194 
ÀÆ
 8(%
ebp
), %
edx


195 
movl
 %
edx
, 4(%
e•
)

196 
ÀÆ
 -12(%
ebp
), %
edx


197 
movl
 %
edx
, (%
e•
)

198 
movl
 %
ebx
, 8(%
e•
)

199 .
LCFI7
:

200 
ˇŒ
 
L_ffi_˛osuª_SYSV_ö√r$°ub


201 
movl
 8(%
e•
), %
ebx


202 
movl
 -12(%
ebp
), %
ecx


203 
cm∂
 
$FFI_TYPE_INT
, %
óx


204 
je
 .
L˛s_ªtöt


208 
cm∂
 
$FFI_TYPE_UINT64
, %
óx


209 
jge
 0f

210 
cm∂
 
$FFI_TYPE_UINT8
, %
óx


211 
jge
 .
L˛s_ªtöt


213 0: 
cm∂
 
$FFI_TYPE_FLOAT
, %
óx


214 
je
 .
L˛s_ªtÊﬂt


215 
cm∂
 
$FFI_TYPE_DOUBLE
, %
óx


216 
je
 .
L˛s_ªtdoubÀ


217 
cm∂
 
$FFI_TYPE_LONGDOUBLE
, %
óx


218 
je
 .
L˛s_ªédoubÀ


219 
cm∂
 
$FFI_TYPE_SINT64
, %
óx


220 
je
 .
L˛s_ªél⁄g


221 
cm∂
 
$FFI_TYPE_SMALL_STRUCT_1B
, %
óx


222 
je
 .
L˛s_ªt°ru˘1b


223 
cm∂
 
$FFI_TYPE_SMALL_STRUCT_2B
, %
óx


224 
je
 .
L˛s_ªt°ru˘2b


225 
cm∂
 
$FFI_TYPE_STRUCT
, %
óx


226 
je
 .
L˛s_ªt°ru˘


227 .
L˛s_ïûogue
:

228 
movl
 %
ebp
, %
e•


229 
p›l
 %
ebp


230 
ªt


231 .
L˛s_ªtöt
:

232 
	`movl
 (%
ecx
), %
óx


233 
jmp
 .
L˛s_ïûogue


234 .
L˛s_ªtÊﬂt
:

235 
	`Êds
 (%
ecx
)

236 
jmp
 .
L˛s_ïûogue


237 .
L˛s_ªtdoubÀ
:

238 
	`Êdl
 (%
ecx
)

239 
jmp
 .
L˛s_ïûogue


240 .
L˛s_ªédoubÀ
:

241 
	`Êdt
 (%
ecx
)

242 
jmp
 .
L˛s_ïûogue


243 .
L˛s_ªél⁄g
:

244 
	`movl
 (%
ecx
), %
óx


245 
movl
 4(%
ecx
), %
edx


246 
jmp
 .
L˛s_ïûogue


247 .
L˛s_ªt°ru˘1b
:

248 
	`movsbl
 (%
ecx
), %
óx


249 
jmp
 .
L˛s_ïûogue


250 .
L˛s_ªt°ru˘2b
:

251 
	`movswl
 (%
ecx
), %
óx


252 
jmp
 .
L˛s_ïûogue


253 .
L˛s_ªt°ru˘
:

254 
Àa
 -8(%
ebp
),%
e•


255 
movl
 %
ebp
, %
e•


256 
p›l
 %
ebp


257 
ªt
 
$4


258 .
LFE2
:

260 #i‡!
FFI_NO_RAW_API


262 
	#RAW_CLOSURE_CIF_OFFSET
 ((
FFI_TRAMPOLINE_SIZE
 + 3Ë& ~3)

	)

263 
	#RAW_CLOSURE_FUN_OFFSET
 (
RAW_CLOSURE_CIF_OFFSET
 + 4)

	)

264 
	#RAW_CLOSURE_USER_DATA_OFFSET
 (
RAW_CLOSURE_FUN_OFFSET
 + 4)

	)

265 
	#CIF_FLAGS_OFFSET
 20

	)

267 .
Æign
 4

268 
	`FFI_HIDDEN
 (
ffi_˛osuª_øw_SYSV
)

269 .
globl
 
_ffi_˛osuª_øw_SYSV


271 
_ffi_˛osuª_øw_SYSV
:

272 .
LFB3
:

273 
pushl
 %
ebp


274 .
LCFI4
:

275 
movl
 %
e•
, %
ebp


276 .
LCFI5
:

277 
pushl
 %
esi


278 .
LCFI6
:

279 
subl
 
$36
, %
e•


280 
movl
 
	`RAW_CLOSURE_CIF_OFFSET
(%
óx
), %
esi


281 
movl
 
	`RAW_CLOSURE_USER_DATA_OFFSET
(%
óx
), %
edx


282 
movl
 %
edx
, 12(%
e•
)

283 
ÀÆ
 8(%
ebp
), %
edx


284 
movl
 %
edx
, 8(%
e•
)

285 
ÀÆ
 -24(%
ebp
), %
edx


286 
movl
 %
edx
, 4(%
e•
)

287 
movl
 %
esi
, (%
e•
)

288 
ˇŒ
 *
	`RAW_CLOSURE_FUN_OFFSET
(%
óx
)

289 
movl
 
	`CIF_FLAGS_OFFSET
(%
esi
), %
óx


290 
cm∂
 
$FFI_TYPE_INT
, %
óx


291 
je
 .
Lr˛s_ªtöt


295 
cm∂
 
$FFI_TYPE_UINT64
, %
óx


296 
jge
 0f

297 
cm∂
 
$FFI_TYPE_UINT8
, %
óx


298 
jge
 .
Lr˛s_ªtöt


300 
cm∂
 
$FFI_TYPE_FLOAT
, %
óx


301 
je
 .
Lr˛s_ªtÊﬂt


302 
cm∂
 
$FFI_TYPE_DOUBLE
, %
óx


303 
je
 .
Lr˛s_ªtdoubÀ


304 
cm∂
 
$FFI_TYPE_LONGDOUBLE
, %
óx


305 
je
 .
Lr˛s_ªédoubÀ


306 
cm∂
 
$FFI_TYPE_SINT64
, %
óx


307 
je
 .
Lr˛s_ªél⁄g


308 .
Lr˛s_ïûogue
:

309 
addl
 
$36
, %
e•


310 
p›l
 %
esi


311 
p›l
 %
ebp


312 
ªt


313 .
Lr˛s_ªtöt
:

314 
movl
 -24(%
ebp
), %
óx


315 
jmp
 .
Lr˛s_ïûogue


316 .
Lr˛s_ªtÊﬂt
:

317 
Êds
 -24(%
ebp
)

318 
jmp
 .
Lr˛s_ïûogue


319 .
Lr˛s_ªtdoubÀ
:

320 
Êdl
 -24(%
ebp
)

321 
jmp
 .
Lr˛s_ïûogue


322 .
Lr˛s_ªédoubÀ
:

323 
Êdt
 -24(%
ebp
)

324 
jmp
 .
Lr˛s_ïûogue


325 .
Lr˛s_ªél⁄g
:

326 
movl
 -24(%
ebp
), %
óx


327 
movl
 -20(%
ebp
), %
edx


328 
jmp
 .
Lr˛s_ïûogue


329 .
LFE3
:

332 .
£˘i⁄
 
__IMPORT
,
__jump_èbÀ
,
symbﬁ_°ubs
,
£lf_modifyög_code
+
puª_ö°ru˘i⁄s
,5

333 
L_ffi_˛osuª_SYSV_ö√r$°ub
:

334 .
ödúe˘_symbﬁ
 
_ffi_˛osuª_SYSV_ö√r


335 
h…
 ; hlt ; hlt ; hlt ; hlt

338 .
£˘i⁄
 
__TEXT
,
__eh_‰ame
,
cﬂÀs˚d
,
no_toc
+
°rù_°©ic_syms
+
live_suµ‹t


339 
EH_‰ame1
:

340 .
£t
 
L$£t$0
,
LECIE1
-
LSCIE1


341 .
L$£t$0


342 
LSCIE1
:

344 .
byã
 0x1

345 .
ascii
 "zR\0"

346 .
byã
 0x1

347 .
byã
 0x7c

348 .
byã
 0x8

349 .
byã
 0x1

350 .
byã
 0x10

351 .
byã
 0xc

352 .
byã
 0x5

353 .
byã
 0x4

354 .
byã
 0x88

355 .
byã
 0x1

356 .
Æign
 2

357 
LECIE1
:

358 .
globl
 
_ffi_ˇŒ_SYSV
.
eh


359 
_ffi_ˇŒ_SYSV
.
eh
:

360 
LSFDE1
:

361 .
£t
 
L$£t$1
,
LEFDE1
-
LASFDE1


362 .
L$£t$1


363 
LASFDE1
:

364 .
LASFDE1
-
EH_‰ame1


365 ..
LFB1
-.

366 .
£t
 
L$£t$2
,.
LFE1
-.
LFB1


367 .
L$£t$2


368 .
byã
 0x0

369 .
byã
 0x4

370 .
£t
 
L$£t$3
,.
LCFI0
-.
LFB1


371 .
L$£t$3


372 .
byã
 0xe

373 .
byã
 0x8

374 .
byã
 0x84

375 .
byã
 0x2

376 .
byã
 0x4

377 .
£t
 
L$£t$4
,.
LCFI1
-.
LCFI0


378 .
L$£t$4


379 .
byã
 0xd

380 .
byã
 0x4

381 .
Æign
 2

382 
LEFDE1
:

383 .
globl
 
_ffi_˛osuª_SYSV
.
eh


384 
_ffi_˛osuª_SYSV
.
eh
:

385 
LSFDE2
:

386 .
£t
 
L$£t$5
,
LEFDE2
-
LASFDE2


387 .
L$£t$5


388 
LASFDE2
:

389 .
LASFDE2
-
EH_‰ame1


390 ..
LFB2
-.

391 .
£t
 
L$£t$6
,.
LFE2
-.
LFB2


392 .
L$£t$6


393 .
byã
 0x0

394 .
byã
 0x4

395 .
£t
 
L$£t$7
,.
LCFI2
-.
LFB2


396 .
L$£t$7


397 .
byã
 0xe

398 .
byã
 0x8

399 .
byã
 0x84

400 .
byã
 0x2

401 .
byã
 0x4

402 .
£t
 
L$£t$8
,.
LCFI3
-.
LCFI2


403 .
L$£t$8


404 .
byã
 0xd

405 .
byã
 0x4

406 .
Æign
 2

407 
LEFDE2
:

409 #i‡!
FFI_NO_RAW_API


411 .
globl
 
_ffi_˛osuª_øw_SYSV
.
eh


412 
_ffi_˛osuª_øw_SYSV
.
eh
:

413 
LSFDE3
:

414 .
£t
 
L$£t$10
,
LEFDE3
-
LASFDE3


415 .
L$£t$10


416 
LASFDE3
:

417 .
LASFDE3
-
EH_‰ame1


418 ..
LFB3
-.

419 .
£t
 
L$£t$11
,.
LFE3
-.
LFB3


420 .
L$£t$11


421 .
byã
 0x0

422 .
byã
 0x4

423 .
£t
 
L$£t$12
,.
LCFI4
-.
LFB3


424 .
L$£t$12


425 .
byã
 0xe

426 .
byã
 0x8

427 .
byã
 0x84

428 .
byã
 0x2

429 .
byã
 0x4

430 .
£t
 
L$£t$13
,.
LCFI5
-.
LCFI4


431 .
L$£t$13


432 .
byã
 0xd

433 .
byã
 0x4

434 .
byã
 0x4

435 .
£t
 
L$£t$14
,.
LCFI6
-.
LCFI5


436 .
L$£t$14


437 .
byã
 0x85

438 .
byã
 0x3

439 .
Æign
 2

440 
LEFDE3
:

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/darwin64.S

28 #ifde‡
__x86_64__


29 
	#LIBFFI_ASM


	)

30 
	~<ffic⁄fig.h
>

31 
	~<ffi.h
>

33 .
	gfûe
 "darwin64.S"

34 .
	gãxt


43 .
	gÆign
 3

44 .
globl
 
_ffi_ˇŒ_unix64


46 
	g_ffi_ˇŒ_unix64
:

47 
LUW0
:

48 
movq
 (%
r•
), %
r10


49 
Àaq
 (%
rdi
, %
rsi
), %
øx


50 
	gmovq
 %
	grdx
, (%
	gøx
)

51 
	gmovq
 %
	grcx
, 8(%
	gøx
)

52 
	gmovq
 %
	grbp
, 16(%
	gøx
)

53 
	gmovq
 %
	gr10
, 24(%
	gøx
)

54 
	gmovq
 %
	gøx
, %
rbp


55 
	gLUW1
:

56 
movq
 %
rdi
, %
r10


57 
	gmovq
 %
	gr8
, %
r11


58 
	gmovl
 %
	gr9d
, %
óx


61 
movq
 (%
r10
), %
rdi


62 
	gmovq
 8(%
	gr10
), %
rsi


63 
	gmovq
 16(%
	gr10
), %
rdx


64 
	gmovq
 24(%
	gr10
), %
rcx


65 
	gmovq
 32(%
	gr10
), %
r8


66 
	gmovq
 40(%
	gr10
), %
r9


67 
	gã°l
 %
	góx
, %
óx


68 
jnz
 
Llﬂd_s£


69 
	gLªt_‰om_lﬂd_s£
:

72 
Àaq
 176(%
r10
), %
r•


75 
	gˇŒ
 *%
r11


78 
	gÀaq
 24(%
	grbp
), %
r•


80 
	gmovq
 0(%
	grbp
), %
rcx


81 
	gmovq
 8(%
	grbp
), %
rdi


82 
	gmovq
 16(%
	grbp
), %
rbp


83 
	gLUW2
:

86 
movzbl
 %
˛
, %
r10d


87 
Àaq
 
L°‹e_èbÀ
(%
rù
), %
r11


88 
mov¶q
 (%
r11
, %
r10
, 4), %r10

89 
	gaddq
 %
	gr11
, %
r10


90 
	gjmp
 *%
r10


92 
	gL°‹e_èbÀ
:

93 .
L°_void
-
L°‹e_èbÀ


94 .
L°_söt32
-
L°‹e_èbÀ


95 .
L°_Êﬂt
-
L°‹e_èbÀ


96 .
L°_doubÀ
-
L°‹e_èbÀ


97 .
L°_ldoubÀ
-
L°‹e_èbÀ


98 .
L°_uöt8
-
L°‹e_èbÀ


99 .
L°_söt8
-
L°‹e_èbÀ


100 .
L°_uöt16
-
L°‹e_èbÀ


101 .
L°_söt16
-
L°‹e_èbÀ


102 .
L°_uöt32
-
L°‹e_èbÀ


103 .
L°_söt32
-
L°‹e_èbÀ


104 .
L°_öt64
-
L°‹e_èbÀ


105 .
L°_öt64
-
L°‹e_èbÀ


106 .
L°_°ru˘
-
L°‹e_èbÀ


107 .
L°_öt64
-
L°‹e_èbÀ


109 .
ãxt


110 .
Æign
 3

111 
L°_void
:

112 
ªt


113 .
Æign
 3

114 
L°_uöt8
:

115 
movzbq
 %
Æ
, %
øx


116 
	gmovq
 %
	gøx
, (%
	grdi
)

117 
	gªt


118 .
	gÆign
 3

119 
	gL°_söt8
:

120 
movsbq
 %
Æ
, %
øx


121 
	gmovq
 %
	gøx
, (%
	grdi
)

122 
	gªt


123 .
	gÆign
 3

124 
	gL°_uöt16
:

125 
movzwq
 %
ax
, %
øx


126 
	gmovq
 %
	gøx
, (%
	grdi
)

127 .
	gÆign
 3

128 
	gL°_söt16
:

129 
movswq
 %
ax
, %
øx


130 
	gmovq
 %
	gøx
, (%
	grdi
)

131 
	gªt


132 .
	gÆign
 3

133 
	gL°_uöt32
:

134 
movl
 %
óx
, %eax

135 
	gmovq
 %
	gøx
, (%
	grdi
)

136 .
	gÆign
 3

137 
	gL°_söt32
:

138 
˛tq


139 
movq
 %
øx
, (%
	grdi
)

140 
	gªt


141 .
	gÆign
 3

142 
	gL°_öt64
:

143 
movq
 %
øx
, (%
	grdi
)

144 
	gªt


145 .
	gÆign
 3

146 
	gL°_Êﬂt
:

147 
movss
 %
xmm0
, (%
	grdi
)

148 
	gªt


149 .
	gÆign
 3

150 
	gL°_doubÀ
:

151 
movsd
 %
xmm0
, (%
	grdi
)

152 
ªt


153 
	gL°_ldoubÀ
:

154 
f°±
 (%
rdi
)

155 
ªt


156 .
Æign
 3

157 
L°_°ru˘
:

158 
Àaq
 -20(%
r•
), %
rsi


165 
	gmovd
 %
	gxmm0
, %
r10


166 
	gmovd
 %
	gxmm1
, %
r11


167 
ã°l
 
	g$0x100
, %
ecx


168 
	gcmovnz
 %
	gøx
, %
rdx


169 
	gcmovnz
 %
	gr10
, %
øx


170 
ã°l
 
	g$0x200
, %
ecx


171 
	gcmovnz
 %
	gr10
, %
rdx


172 
ã°l
 
	g$0x400
, %
ecx


173 
	gcmovnz
 %
	gr10
, %
øx


174 
	gcmovnz
 %
	gr11
, %
rdx


175 
	gmovq
 %
	gøx
, (%
	grsi
)

176 
	gmovq
 %
	grdx
, 8(%
	grsi
)

180 
shæ
 
	g$12
, %
ecx


181 
ªp
 
movsb


182 
	gªt


187 .
	gÆign
 3

188 
	gLUW3
:

189 
Llﬂd_s£
:

190 
movdqa
 48(%
r10
), %
xmm0


191 
	gmovdqa
 64(%
	gr10
), %
xmm1


192 
	gmovdqa
 80(%
	gr10
), %
xmm2


193 
	gmovdqa
 96(%
	gr10
), %
xmm3


194 
	gmovdqa
 112(%
	gr10
), %
xmm4


195 
	gmovdqa
 128(%
	gr10
), %
xmm5


196 
	gmovdqa
 144(%
	gr10
), %
xmm6


197 
	gmovdqa
 160(%
	gr10
), %
xmm7


198 
jmp
 
Lªt_‰om_lﬂd_s£


200 
	gLUW4
:

201 .
Æign
 3

202 .
globl
 
_ffi_˛osuª_unix64


204 
_ffi_˛osuª_unix64
:

205 
LUW5
:

208 
Àaq
 -200(%
r•
), %rsp

209 
	gLUW6
:

210 
movq
 %
rdi
, (%
	gr•
)

211 
	gmovq
 %
	grsi
, 8(%
	gr•
)

212 
	gmovq
 %
	grdx
, 16(%
	gr•
)

213 
	gmovq
 %
	grcx
, 24(%
	gr•
)

214 
	gmovq
 %
	gr8
, 32(%
	gr•
)

215 
	gmovq
 %
	gr9
, 40(%
	gr•
)

216 
jc
 
Lßve_s£


217 
	gLªt_‰om_ßve_s£
:

219 
movq
 %
r10
, %
rdi


220 
	gÀaq
 176(%
	gr•
), %
rsi


221 
	gmovq
 %
	gr•
, %
rdx


222 
	gÀaq
 208(%
	gr•
), %
rcx


223 
ˇŒ
 
_ffi_˛osuª_unix64_ö√r


226 
addq
 
	g$200
, %
r•


227 
	gLUW7
:

230 
movzbl
 %
Æ
, %
r10d


231 
Àaq
 
Llﬂd_èbÀ
(%
rù
), %
r11


232 
mov¶q
 (%
r11
, %
r10
, 4), %r10

233 
	gaddq
 %
	gr11
, %
r10


234 
	gjmp
 *%
r10


236 
	gLlﬂd_èbÀ
:

237 .
Lld_void
-
Llﬂd_èbÀ


238 .
Lld_öt32
-
Llﬂd_èbÀ


239 .
Lld_Êﬂt
-
Llﬂd_èbÀ


240 .
Lld_doubÀ
-
Llﬂd_èbÀ


241 .
Lld_ldoubÀ
-
Llﬂd_èbÀ


242 .
Lld_öt8
-
Llﬂd_èbÀ


243 .
Lld_öt8
-
Llﬂd_èbÀ


244 .
Lld_öt16
-
Llﬂd_èbÀ


245 .
Lld_öt16
-
Llﬂd_èbÀ


246 .
Lld_öt32
-
Llﬂd_èbÀ


247 .
Lld_öt32
-
Llﬂd_èbÀ


248 .
Lld_öt64
-
Llﬂd_èbÀ


249 .
Lld_öt64
-
Llﬂd_èbÀ


250 .
Lld_°ru˘
-
Llﬂd_èbÀ


251 .
Lld_öt64
-
Llﬂd_èbÀ


253 .
ãxt


254 .
Æign
 3

255 
Lld_void
:

256 
ªt


257 .
Æign
 3

258 
Lld_öt8
:

259 
movzbl
 -24(%
r•
), %
óx


260 
	gªt


261 .
	gÆign
 3

262 
	gLld_öt16
:

263 
movzwl
 -24(%
r•
), %
óx


264 
	gªt


265 .
	gÆign
 3

266 
	gLld_öt32
:

267 
movl
 -24(%
r•
), %
óx


268 
	gªt


269 .
	gÆign
 3

270 
	gLld_öt64
:

271 
movq
 -24(%
r•
), %
øx


272 
	gªt


273 .
	gÆign
 3

274 
	gLld_Êﬂt
:

275 
movss
 -24(%
r•
), %
xmm0


276 
	gªt


277 .
	gÆign
 3

278 
	gLld_doubÀ
:

279 
movsd
 -24(%
r•
), %
xmm0


280 
	gªt


281 .
	gÆign
 3

282 
	gLld_ldoubÀ
:

283 
Êdt
 -24(%
r•
)

284 
ªt


285 .
Æign
 3

286 
Lld_°ru˘
:

292 
movq
 -24(%
r•
), %
rcx


293 
	gmovq
 -16(%
	gr•
), %
rdx


294 
	gmovq
 -16(%
	gr•
), %
xmm1


295 
ã°l
 
	g$0x100
, %
óx


296 
	gcmovnz
 %
	grdx
, %
rcx


297 
	gmovd
 %
	grcx
, %
xmm0


298 
ã°l
 
	g$0x200
, %
óx


299 
	gmovq
 -24(%
	gr•
), %
øx


300 
	gcmovnz
 %
	grdx
, %
øx


301 
	gªt


304 .
	gÆign
 3

305 
	gLUW8
:

306 
Lßve_s£
:

307 
movdqa
 %
xmm0
, 48(%
	gr•
)

308 
	gmovdqa
 %
	gxmm1
, 64(%
	gr•
)

309 
	gmovdqa
 %
	gxmm2
, 80(%
	gr•
)

310 
	gmovdqa
 %
	gxmm3
, 96(%
	gr•
)

311 
	gmovdqa
 %
	gxmm4
, 112(%
	gr•
)

312 
	gmovdqa
 %
	gxmm5
, 128(%
	gr•
)

313 
	gmovdqa
 %
	gxmm6
, 144(%
	gr•
)

314 
	gmovdqa
 %
	gxmm7
, 160(%
	gr•
)

315 
jmp
 
Lªt_‰om_ßve_s£


317 
	gLUW9
:

318 .
£˘i⁄
 
__TEXT
,
	g__eh_‰ame
,
	gcﬂÀs˚d
,
	gno_toc
+
	g°rù_°©ic_syms
+
live_suµ‹t


319 
	gEH_‰ame1
:

320 .
£t
 
L$£t$0
,
	gLECIE1
-
	gLSCIE1


321 .
L$£t$0


322 
	gLSCIE1
:

324 .
byã
 0x1

325 .
ascii
 "zR\0"

326 .
byã
 0x1

327 .
byã
 0x78

328 .
byã
 0x10

329 .
byã
 0x1

330 .
byã
 0x10

331 .
byã
 0xc

332 .
byã
 0x7

333 .
byã
 0x8

334 .
byã
 0x90

335 .
byã
 0x1

336 .
Æign
 3

337 
LECIE1
:

338 .
globl
 
_ffi_ˇŒ_unix64
.
eh


339 
_ffi_ˇŒ_unix64
.
eh
:

340 
LSFDE1
:

341 .
£t
 
L$£t$1
,
	gLEFDE1
-
	gLASFDE1


342 .
L$£t$1


343 
	gLASFDE1
:

344 .
LASFDE1
-
EH_‰ame1


345 .
quad
 
LUW0
-.

346 .
£t
 
L$£t$2
,
	gLUW4
-
	gLUW0


347 .
quad
 
	gL$£t$2


348 .
	gbyã
 0x0

349 .
	gbyã
 0x4

350 .
£t
 
	gL$£t$3
,
	gLUW1
-
	gLUW0


351 .
	gL$£t$3


360 .
	gbyã
 0xc

361 .
	gbyã
 0x6

362 .
	gbyã
 0x20

363 .
	gbyã
 0x80+6

364 .
	gbyã
 0x2

365 .
	gbyã
 0xa

367 .
	gbyã
 0x4

368 .
£t
 
	gL$£t$4
,
	gLUW2
-
	gLUW1


369 .
	gL$£t$4


370 .
	gbyã
 0xc

371 .
	gbyã
 0x7

372 .
	gbyã
 0x8

373 .
	gbyã
 0xc0+6

375 .
	gbyã
 0x4

376 .
£t
 
	gL$£t$5
,
	gLUW3
-
	gLUW2


377 .
	gL$£t$5


378 .
	gbyã
 0xb

380 .
	gÆign
 3

381 
	gLEFDE1
:

382 .
globl
 
_ffi_˛osuª_unix64
.
eh


383 
_ffi_˛osuª_unix64
.
eh
:

384 
LSFDE3
:

385 .
£t
 
L$£t$6
,
	gLEFDE3
-
	gLASFDE3


386 .
L$£t$6


387 
	gLASFDE3
:

388 .
LASFDE3
-
EH_‰ame1


389 .
quad
 
LUW5
-.

390 .
£t
 
L$£t$7
,
	gLUW9
-
	gLUW5


391 .
quad
 
	gL$£t$7


392 .
	gbyã
 0x0

394 .
	gbyã
 0x4

395 .
£t
 
	gL$£t$8
,
	gLUW6
-
	gLUW5


396 .
	gL$£t$8


397 .
	gbyã
 0xe

398 .
	gbyã
 208,1

399 .
	gbyã
 0xa

401 .
	gbyã
 0x4

402 .
£t
 
	gL$£t$9
,
	gLUW7
-
	gLUW6


403 .
	gL$£t$9


404 .
	gbyã
 0xe

405 .
	gbyã
 0x8

407 .
	gbyã
 0x4

408 .
£t
 
	gL$£t$10
,
	gLUW8
-
	gLUW7


409 .
	gL$£t$10


410 .
	gbyã
 0xb

412 .
	gÆign
 3

413 
	gLEFDE3
:

414 .
sub£˘i⁄s_vü_symbﬁs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/ffi.c

31 #i‡!
deföed
(
__x86_64__
Ë|| deföed(
_WIN64
Ë|| deföed(
__CYGWIN__
)

33 #ifde‡
_WIN64


34 
	~<wödows.h
>

37 
	~<ffi.h
>

38 
	~<ffi_comm⁄.h
>

40 
	~<°dlib.h
>

46 
ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
);

47 
	$ffi_¥ï_¨gs
(*
°ack
, 
exãnded_cif
 *
ecif
)

49 
i
;

50 **
p_¨gv
;

51 *
¨gp
;

52 
ffi_ty≥
 **
p_¨g
;

53 #i‚de‡
X86_WIN64


54 c⁄° 
ˇbi
 = 
ecif
->
cif
->
abi
;

55 c⁄° 
dú
 = (
ˇbi
 =
FFI_PASCAL
 || cabò=
FFI_REGISTER
) ? -1 : +1;

56 
°ack_¨gs_cou¡
 = 0;

57 *
p_°ack_d©a
[3];

58 *
¨gp2
 = 
°ack
;

60 
	#dú
 1

	)

63 
¨gp
 = 
°ack
;

65 i‡((
ecif
->
cif
->
Êags
 =
FFI_TYPE_STRUCT


66 || 
ecif
->
cif
->
Êags
 =
FFI_TYPE_MS_STRUCT
)

67 #ifde‡
X86_WIN64


68 && ((
ecif
->
cif
->
πy≥
->
size
 & (1 | 2 | 4 | 8)) == 0)

72 #i‚de‡
X86_WIN64


75 i‡(
ˇbi
 =
FFI_THISCALL
 || cabò=
FFI_FASTCALL
 || cabò=
FFI_REGISTER
)

77 
p_°ack_d©a
[
°ack_¨gs_cou¡
] = 
¨gp
;

78 ++
°ack_¨gs_cou¡
;

82 *(**Ë
¨gp
 = 
ecif
->
rvÆue
;

83 
¨gp
 += (*);

86 
p_¨g
 = 
ecif
->
cif
->
¨g_ty≥s
;

87 
p_¨gv
 = 
ecif
->
avÆue
;

88 i‡(
dú
 < 0)

90 c⁄° 
«rgs
 = 
ecif
->
cif
->nargs - 1;

91 i‡(
«rgs
 > 0)

93 
p_¨g
 +
«rgs
;

94 
p_¨gv
 +
«rgs
;

98 
i
 = 
ecif
->
cif
->
«rgs
;

99 
i
 != 0;

100 
i
--, 
p_¨g
 +
dú
, 
p_¨gv
 += dir)

103 i‡(((*Ë- 1Ë& (
size_t
Ë
¨gp
)

104 
¨gp
 = (*Ë
	`ALIGN
(argp, (*));

106 
size_t
 
z
 = (*
p_¨g
)->
size
;

108 #ifde‡
X86_WIN64


109 i‡(
z
 > 
FFI_SIZEOF_ARG


110 || ((*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT


111 && (
z
 & (1 | 2 | 4 | 8)) == 0)

112 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


113 || ((*
p_¨g
)->
ty≥
 =
FFI_TYPE_LONGDOUBLE
)

117 
z
 = 
FFI_SIZEOF_ARG
;

118 *(**)
¨gp
 = *
p_¨gv
;

120 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_FLOAT
)

122 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

126 i‡(
z
 < 
FFI_SIZEOF_ARG
)

128 
z
 = 
FFI_SIZEOF_ARG
;

129 (*
p_¨g
)->
ty≥
)

131 
FFI_TYPE_SINT8
:

132 *(
ffi_ßrg
 *Ë
¨gp
 = (ffi_ßrg)*(
SINT8
 *)(* 
p_¨gv
);

135 
FFI_TYPE_UINT8
:

136 *(
ffi_¨g
 *Ë
¨gp
 = (ffi_¨g)*(
UINT8
 *)(* 
p_¨gv
);

139 
FFI_TYPE_SINT16
:

140 *(
ffi_ßrg
 *Ë
¨gp
 = (ffi_ßrg)*(
SINT16
 *)(* 
p_¨gv
);

143 
FFI_TYPE_UINT16
:

144 *(
ffi_¨g
 *Ë
¨gp
 = (ffi_¨g)*(
UINT16
 *)(* 
p_¨gv
);

147 
FFI_TYPE_SINT32
:

148 *(
ffi_ßrg
 *Ë
¨gp
 = (ffi_ßrg)*(
SINT32
 *)(* 
p_¨gv
);

151 
FFI_TYPE_UINT32
:

152 *(
ffi_¨g
 *Ë
¨gp
 = (ffi_¨g)*(
UINT32
 *)(* 
p_¨gv
);

155 
FFI_TYPE_STRUCT
:

156 *(
ffi_¨g
 *Ë
¨gp
 = *(ffi_¨g *)(* 
p_¨gv
);

160 
	`FFI_ASSERT
(0);

165 
	`mem˝y
(
¨gp
, *
p_¨gv
, 
z
);

168 #i‚de‡
X86_WIN64


172 i‡((
z
 =
FFI_SIZEOF_ARG
)

173 && ((
ˇbi
 =
FFI_REGISTER
)

174 || (
ˇbi
 =
FFI_THISCALL
 && 
°ack_¨gs_cou¡
 < 1)

175 || (
ˇbi
 =
FFI_FASTCALL
 && 
°ack_¨gs_cou¡
 < 2))

176 && ((*
p_¨g
)->
ty≥
 !
FFI_TYPE_FLOAT
 && (*p_¨g)->ty≥ !
FFI_TYPE_STRUCT
)

179 i‡(
dú
 < 0 && 
°ack_¨gs_cou¡
 > 2)

183 
p_°ack_d©a
[0] =Ö_stack_data[1];

184 
p_°ack_d©a
[1] =Ö_stack_data[2];

185 
°ack_¨gs_cou¡
 = 2;

188 
p_°ack_d©a
[
°ack_¨gs_cou¡
] = 
¨gp
;

189 ++
°ack_¨gs_cou¡
;

193 #ifde‡
X86_WIN64


194 
¨gp
 +(
z
 + (*) - 1) & ~((*) - 1);

196 
¨gp
 +
z
;

200 #i‚de‡
X86_WIN64


203 i‡(
°ack_¨gs_cou¡
 > 0)

205 i‡(
dú
 < 0 && 
°ack_¨gs_cou¡
 > 1)

208 
ffi_¨g
 
tmp
 = *(ffi_¨g*Ë
p_°ack_d©a
[0];

209 *(
ffi_¨g
*Ë
p_°ack_d©a
[0] = *(ffi_¨g*Ëp_°ack_d©a[
°ack_¨gs_cou¡
 - 1];

210 *(
ffi_¨g
*Ë
p_°ack_d©a
[
°ack_¨gs_cou¡
 - 1] = 
tmp
;

213 
i
;

214 
i
 = 0; i < 
°ack_¨gs_cou¡
; i++)

216 i‡(
p_°ack_d©a
[
i
] !
¨gp2
)

218 
ffi_¨g
 
tmp
 = *(ffi_¨g*Ë
p_°ack_d©a
[
i
];

219 
	`memmove
 (
¨gp2
 + 
FFI_SIZEOF_ARG
,árgp2, (
size_t
Ë((*Ë
p_°ack_d©a
[
i
] - (*)argp2));

220 *(
ffi_¨g
 *Ë
¨gp2
 = 
tmp
;

223 
¨gp2
 +
FFI_SIZEOF_ARG
;

227  
°ack_¨gs_cou¡
;

230 
	}
}

233 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

235 
i
;

236 
ffi_ty≥
 **
±r
;

239 
cif
->
πy≥
->
ty≥
)

241 
FFI_TYPE_VOID
:

242 
FFI_TYPE_UINT8
:

243 
FFI_TYPE_UINT16
:

244 
FFI_TYPE_SINT8
:

245 
FFI_TYPE_SINT16
:

246 #ifde‡
X86_WIN64


247 
FFI_TYPE_UINT32
:

248 
FFI_TYPE_SINT32
:

250 
FFI_TYPE_SINT64
:

251 
FFI_TYPE_FLOAT
:

252 
FFI_TYPE_DOUBLE
:

253 #i‚de‡
X86_WIN64


254 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


255 
FFI_TYPE_LONGDOUBLE
:

258 
cif
->
Êags
 = (Ëcif->
πy≥
->
ty≥
;

261 
FFI_TYPE_UINT64
:

262 #ifde‡
X86_WIN64


263 
FFI_TYPE_POINTER
:

265 
cif
->
Êags
 = 
FFI_TYPE_SINT64
;

268 
FFI_TYPE_STRUCT
:

269 #i‚de‡
X86


270 i‡(
cif
->
πy≥
->
size
 == 1)

272 
cif
->
Êags
 = 
FFI_TYPE_SMALL_STRUCT_1B
;

274 i‡(
cif
->
πy≥
->
size
 == 2)

276 
cif
->
Êags
 = 
FFI_TYPE_SMALL_STRUCT_2B
;

278 i‡(
cif
->
πy≥
->
size
 == 4)

280 #ifde‡
X86_WIN64


281 
cif
->
Êags
 = 
FFI_TYPE_SMALL_STRUCT_4B
;

283 
cif
->
Êags
 = 
FFI_TYPE_INT
;

286 i‡(
cif
->
πy≥
->
size
 == 8)

288 
cif
->
Êags
 = 
FFI_TYPE_SINT64
;

293 #ifde‡
X86_WIN32


294 i‡(
cif
->
abi
 =
FFI_MS_CDECL
)

295 
cif
->
Êags
 = 
FFI_TYPE_MS_STRUCT
;

298 
cif
->
Êags
 = 
FFI_TYPE_STRUCT
;

300 
cif
->
byãs
 +
	`ALIGN
((*), 
FFI_SIZEOF_ARG
);

305 #ifde‡
X86_WIN64


306 
cif
->
Êags
 = 
FFI_TYPE_SINT64
;

308 
FFI_TYPE_INT
:

309 
cif
->
Êags
 = 
FFI_TYPE_SINT32
;

311 
cif
->
Êags
 = 
FFI_TYPE_INT
;

316 
±r
 = 
cif
->
¨g_ty≥s
, 
i
 = cif->
«rgs
; i > 0; i--,Ötr++)

318 i‡(((*
±r
)->
Æignmít
 - 1Ë& 
cif
->
byãs
)

319 
cif
->
byãs
 = 
	`ALIGN
(cif->byãs, (*
±r
)->
Æignmít
);

320 
cif
->
byãs
 +()
	`ALIGN
((*
±r
)->
size
, 
FFI_SIZEOF_ARG
);

323 #ifde‡
X86_WIN64


325 
cif
->
byãs
 +4 * 
FFI_SIZEOF_ARG
;

328 #i‚de‡
X86_WIN32


329 #i‚de‡
X86_WIN64


330 i‡(
cif
->
abi
 =
FFI_SYSV
 || cif->abò=
FFI_UNIX64
)

332 
cif
->
byãs
 = (cif->bytes + 15) & ~0xF;

335  
FFI_OK
;

336 
	}
}

338 #ifde‡
X86_WIN64


340 
ffi_ˇŒ_wö64
((*)(*, 
exãnded_cif
 *),Éxtended_cif *,

341 , , *, (*
‚
)());

344 
	`ffi_ˇŒ_wö32
((*)(*, 
exãnded_cif
 *),Éxtended_cif *,

345 , , , *, (*
‚
)());

346 
	`ffi_ˇŒ_SYSV
((*)(*, 
exãnded_cif
 *),Éxtended_cif *,

347 , , *, (*
‚
)());

350 
	`ffi_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

352 
exãnded_cif
 
ecif
;

354 
ecif
.
cif
 = cif;

355 
ecif
.
avÆue
 =ávalue;

360 #ifde‡
X86_WIN64


361 i‡(
rvÆue
 =
NULL


362 && 
cif
->
Êags
 =
FFI_TYPE_STRUCT


363 && ((
cif
->
πy≥
->
size
 & (1 | 2 | 4 | 8)) == 0))

365 
ecif
.
rvÆue
 = 
	`Æloˇ
((
cif
->
πy≥
->
size
 + 0xF) & ~0xF);

368 i‡(
rvÆue
 =
NULL


369 && (
cif
->
Êags
 =
FFI_TYPE_STRUCT


370 || 
cif
->
Êags
 =
FFI_TYPE_MS_STRUCT
))

372 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

376 
ecif
.
rvÆue
 =Ñvalue;

379 
cif
->
abi
)

381 #ifde‡
X86_WIN64


382 
FFI_WIN64
:

383 
	`ffi_ˇŒ_wö64
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
,

384 
cif
->
Êags
, 
ecif
.
rvÆue
, 
‚
);

387 #i‚de‡
X86_WIN32


388 
FFI_SYSV
:

389 
	`ffi_ˇŒ_SYSV
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
byãs
, cif->
Êags
,Écif.
rvÆue
,

390 
‚
);

393 
FFI_SYSV
:

394 
FFI_MS_CDECL
:

396 
FFI_STDCALL
:

397 
FFI_THISCALL
:

398 
FFI_FASTCALL
:

399 
FFI_PASCAL
:

400 
FFI_REGISTER
:

401 
	`ffi_ˇŒ_wö32
(
ffi_¥ï_¨gs
, &
ecif
, 
cif
->
abi
, cif->
byãs
, cif->
Êags
,

402 
ecif
.
rvÆue
, 
‚
);

406 
	`FFI_ASSERT
(0);

409 
	}
}

416 
ffi_¥ï_öcomög_¨gs
 (*
°ack
, **
ªt
,

417 ** 
¨gs
, 
ffi_cif
* 
cif
);

418 
FFI_HIDDEN
 
	$ffi_˛osuª_SYSV
 (
ffi_˛osuª
 *)

419 
	`__©åibuã__
 ((
	`ªg∑rm
(1)));

420 
FFI_HIDDEN
 
	$ffi_˛osuª_SYSV_ö√r
 (
ffi_˛osuª
 *, **, *)

421 
	`__©åibuã__
 ((
	`ªg∑rm
(1)));

422 
FFI_HIDDEN
 
	$ffi_˛osuª_WIN32_ö√r
 (
ffi_˛osuª
 *, **, *)

423 
	`__©åibuã__
 ((
	`ªg∑rm
(1)));

424 
FFI_HIDDEN
 
	$ffi_˛osuª_øw_SYSV
 (
ffi_øw_˛osuª
 *)

425 
	`__©åibuã__
 ((
	`ªg∑rm
(1)));

426 #ifde‡
X86_WIN32


427 
FFI_HIDDEN
 
	$ffi_˛osuª_øw_THISCALL
 (
ffi_øw_˛osuª
 *)

428 
	`__©åibuã__
 ((
	`ªg∑rm
(1)));

430 #i‚de‡
X86_WIN64


431 
FFI_HIDDEN
 
	`ffi_˛osuª_STDCALL
 (
ffi_˛osuª
 *);

432 
FFI_HIDDEN
 
	`ffi_˛osuª_THISCALL
 (
ffi_˛osuª
 *);

433 
FFI_HIDDEN
 
	`ffi_˛osuª_FASTCALL
 (
ffi_˛osuª
 *);

434 
FFI_HIDDEN
 
	`ffi_˛osuª_REGISTER
 (
ffi_˛osuª
 *);

436 
FFI_HIDDEN
 
	`ffi_˛osuª_wö64
 (
ffi_˛osuª
 *);

441 #ifde‡
X86_WIN64


442 * 
FFI_HIDDEN


443 
	$ffi_˛osuª_wö64_ö√r
 (
ffi_˛osuª
 *
˛osuª
, *
¨gs
) {

444 
ffi_cif
 *
cif
;

445 **
¨g_¨ó
;

446 *
ªsu…
;

447 *
ª•
 = &
ªsu…
;

449 
cif
 = 
˛osuª
->cif;

450 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

458 
	`ffi_¥ï_öcomög_¨gs
(
¨gs
, &
ª•
, 
¨g_¨ó
, 
cif
);

460 (
˛osuª
->
fun
Ë(
cif
, 
ª•
, 
¨g_¨ó
, closuª->
u£r_d©a
);

467  
cif
->
πy≥
->
size
 > (*Ë? 
ª•
 : *(**)resp;

468 
	}
}

471 
FFI_HIDDEN
 
__©åibuã__
 ((
	$ªg∑rm
(1)))

472 
	$ffi_˛osuª_SYSV_ö√r
 (
ffi_˛osuª
 *
˛osuª
, **
ª•p
, *
¨gs
)

475 
ffi_cif
 *
cif
;

476 **
¨g_¨ó
;

478 
cif
 = 
˛osuª
->cif;

479 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

487 
	`ffi_¥ï_öcomög_¨gs
(
¨gs
, 
ª•p
, 
¨g_¨ó
, 
cif
);

489 (
˛osuª
->
fun
Ë(
cif
, *
ª•p
, 
¨g_¨ó
, closuª->
u£r_d©a
);

491  
cif
->
Êags
;

492 
	}
}

494 
FFI_HIDDEN
 
__©åibuã__
 ((
	$ªg∑rm
(1)))

495 
	$ffi_˛osuª_WIN32_ö√r
 (
ffi_˛osuª
 *
˛osuª
, **
ª•p
, *
¨gs
)

498 
ffi_cif
 *
cif
;

499 **
¨g_¨ó
;

500 
ªt
;

502 
cif
 = 
˛osuª
->cif;

503 
¨g_¨ó
 = (**Ë
	`Æloˇ
 (
cif
->
«rgs
 *  (*));

511 
ªt
 = 
	`ffi_¥ï_öcomög_¨gs
(
¨gs
, 
ª•p
, 
¨g_¨ó
, 
cif
);

513 (
˛osuª
->
fun
Ë(
cif
, *
ª•p
, 
¨g_¨ó
, closuª->
u£r_d©a
);

515  
ªt
;

516 
	}
}

520 
	$ffi_¥ï_öcomög_¨gs
(*
°ack
, **
rvÆue
, **
avÆue
,

521 
ffi_cif
 *
cif
)

523 
i
;

524 **
p_¨gv
;

525 *
¨gp
;

526 
ffi_ty≥
 **
p_¨g
;

527 #i‚de‡
X86_WIN64


528 c⁄° 
ˇbi
 = 
cif
->
abi
;

529 c⁄° 
dú
 = (
ˇbi
 =
FFI_PASCAL
 || cabò=
FFI_REGISTER
) ? -1 : +1;

530 c⁄° 
max_°ack_cou¡
 = (
ˇbi
 =
FFI_THISCALL
) ? 1

531 : (
ˇbi
 =
FFI_FASTCALL
) ? 2

532 : (
ˇbi
 =
FFI_REGISTER
) ? 3

534 
∑s£d_ªgs
 = 0;

535 *
p_°ack_d©a
[3] = { 
°ack
 - 1 };

537 
	#dú
 1

	)

540 
¨gp
 = 
°ack
;

541 #i‚de‡
X86_WIN64


542 
¨gp
 +
max_°ack_cou¡
 * 
FFI_SIZEOF_ARG
;

545 i‡((
cif
->
Êags
 =
FFI_TYPE_STRUCT


546 || 
cif
->
Êags
 =
FFI_TYPE_MS_STRUCT
)

547 #ifde‡
X86_WIN64


548 && ((
cif
->
πy≥
->
size
 & (1 | 2 | 4 | 8)) == 0)

552 #i‚de‡
X86_WIN64


553 i‡(
∑s£d_ªgs
 < 
max_°ack_cou¡
)

555 *
rvÆue
 = *(**Ë(
°ack
 + (
∑s£d_ªgs
*
FFI_SIZEOF_ARG
));

556 ++
∑s£d_ªgs
;

561 *
rvÆue
 = *(**Ë
¨gp
;

562 
¨gp
 += (*);

566 #i‚de‡
X86_WIN64


568 
i
 = 0, 
p_¨g
 = 
cif
->
¨g_ty≥s
;

569 
i
 < 
cif
->
«rgs
 && 
∑s£d_ªgs
 < 
max_°ack_cou¡
;

570 
i
++, 
p_¨g
++)

572 i‡((*
p_¨g
)->
ty≥
 =
FFI_TYPE_FLOAT


573 || (*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT
)

576 
size_t
 
sz
 = (*
p_¨g
)->
size
;

577 if(
sz
 =0 || sz > 
FFI_SIZEOF_ARG
)

580 
p_°ack_d©a
[
∑s£d_ªgs
] = 
avÆue
 + 
i
;

581 
avÆue
[
i
] = 
°ack
 + (
∑s£d_ªgs
*
FFI_SIZEOF_ARG
);

582 ++
∑s£d_ªgs
;

586 
p_¨g
 = 
cif
->
¨g_ty≥s
;

587 
p_¨gv
 = 
avÆue
;

588 i‡(
dú
 < 0)

590 c⁄° 
«rgs
 = 
cif
->nargs - 1;

591 i‡(
«rgs
 > 0)

593 
p_¨g
 +
«rgs
;

594 
p_¨gv
 +
«rgs
;

598 
i
 = 
cif
->
«rgs
;

599 
i
 != 0;

600 
i
--, 
p_¨g
 +
dú
, 
p_¨gv
 += dir)

603 i‡(((*Ë- 1Ë& (
size_t
Ë
¨gp
)

604 
¨gp
 = (*Ë
	`ALIGN
(argp, (*));

606 
size_t
 
z
 = (*
p_¨g
)->
size
;

608 #ifde‡
X86_WIN64


609 i‡(
z
 > 
FFI_SIZEOF_ARG


610 || ((*
p_¨g
)->
ty≥
 =
FFI_TYPE_STRUCT


611 && (
z
 & (1 | 2 | 4 | 8)) == 0)

612 #i‡
FFI_TYPE_DOUBLE
 !
FFI_TYPE_LONGDOUBLE


613 || ((*
p_¨g
)->
ty≥
 =
FFI_TYPE_LONGDOUBLE
)

617 
z
 = 
FFI_SIZEOF_ARG
;

618 *
p_¨gv
 = *(**)
¨gp
;

622 i‡(
∑s£d_ªgs
 > 0

623 && 
z
 <
FFI_SIZEOF_ARG


624 && (
p_¨gv
 =
p_°ack_d©a
[0]

625 || 
p_¨gv
 =
p_°ack_d©a
[1]

626 || 
p_¨gv
 =
p_°ack_d©a
[2]))

635 *
p_¨gv
 = (*Ë
¨gp
;

638 #ifde‡
X86_WIN64


639 
¨gp
 +(
z
 + (*) - 1) & ~((*) - 1);

641 
¨gp
 +
z
;

645  (
size_t
)
¨gp
 - (size_t)
°ack
;

646 
	}
}

648 
	#FFI_INIT_TRAMPOLINE_WIN64
(
TRAMP
,
FUN
,
CTX
,
MASK
) \

649 { *
__åamp
 = (*)(
TRAMP
); \

650 * 
__fun
 = (*)(
FUN
); \

651 * 
__˘x
 = (*)(
CTX
); \

652 *(*Ë&
__åamp
[0] = 0x41; \

653 *(*Ë&
__åamp
[1] = 0xbb; \

654 *(*Ë&
__åamp
[2] = 
MASK
; \

655 *(*Ë&
__åamp
[6] = 0x48; \

656 *(*Ë&
__åamp
[7] = 0xb8; \

657 *(**Ë&
__åamp
[8] = 
__˘x
; \

658 *(*Ë&
__åamp
[16] = 0x49; \

659 *(*Ë&
__åamp
[17] = 0xba; \

660 *(**Ë&
__åamp
[18] = 
__fun
; \

661 *(*Ë&
__åamp
[26] = 0x41; \

662 *(*Ë&
__åamp
[27] = 0xff; \

663 *(*Ë&
__åamp
[28] = 0xe2; \

664 }

	)

668 
	#FFI_INIT_TRAMPOLINE
(
TRAMP
,
FUN
,
CTX
) \

669 { *
__åamp
 = (*)(
TRAMP
); \

670 
__fun
 = ()(
FUN
); \

671 
__˘x
 = ()(
CTX
); \

672 
__dis
 = 
__fun
 - (
__˘x
 + 10); \

673 *(*Ë&
__åamp
[0] = 0xb8; \

674 *(*Ë&
__åamp
[1] = 
__˘x
; \

675 *(*Ë&
__åamp
[5] = 0xe9; \

676 *(*Ë&
__åamp
[6] = 
__dis
; \

677 }

	)

679 
	#FFI_INIT_TRAMPOLINE_RAW_THISCALL
(
TRAMP
,
FUN
,
CTX
,
SIZE
) \

680 { *
__åamp
 = (*)(
TRAMP
); \

681 
__fun
 = ()(
FUN
); \

682 
__˘x
 = ()(
CTX
); \

683 
__dis
 = 
__fun
 - (
__˘x
 + 49); \

684 
__size
 = ()(
SIZE
); \

685 *(*Ë&
__åamp
[0] = 0x8324048b; \

686 *(*Ë&
__åamp
[4] = 0x4c890cec; \

687 *(*Ë&
__åamp
[8] = 0x04890424; \

688 *(*Ë&
__åamp
[12] = 0x24; \

689 *(*Ë&
__åamp
[13] = 0xb8; \

690 *(*Ë&
__åamp
[14] = 
__size
; \

691 *(*Ë&
__åamp
[18] = 0x08244c8d; \

692 *(*Ë&
__åamp
[22] = 0x4802e8c1; \

693 *(*Ë&
__åamp
[26] = 0x0b74; \

694 *(*Ë&
__åamp
[28] = 0x8908518b; \

695 *(*Ë&
__åamp
[32] = 0x04c18311; \

696 *(*Ë&
__åamp
[36] = 0x48; \

697 *(*Ë&
__åamp
[37] = 0xf575; \

698 *(*Ë&
__åamp
[39] = 0xb8; \

699 *(*Ë&
__åamp
[40] = 
__˘x
; \

700 *(*Ë&
__åamp
[44] = 0xe8; \

701 *(*Ë&
__åamp
[45] = 
__dis
; \

702 *(*Ë&
__åamp
[49] = 0xc2; \

703 *(*Ë&
__åamp
[50] = (
__size
 + 8); \

704 }

	)

706 
	#FFI_INIT_TRAMPOLINE_WIN32
(
TRAMP
,
FUN
,
CTX
) \

707 { *
__åamp
 = (*)(
TRAMP
); \

708 
__fun
 = ()(
FUN
); \

709 
__˘x
 = ()(
CTX
); \

710 
__dis
 = 
__fun
 - (
__˘x
 + 10); \

711 *(*Ë&
__åamp
[0] = 0x68; \

712 *(*Ë&
__åamp
[1] = 
__˘x
; \

713 *(*Ë&
__åamp
[5] = 0xe9; \

714 *(*Ë&
__åamp
[6] = 
__dis
; \

715 }

	)

719 
ffi_°©us


720 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

721 
ffi_cif
* 
cif
,

722 (*
fun
)(
ffi_cif
*,*,**,*),

723 *
u£r_d©a
,

724 *
codñoc
)

726 #ifde‡
X86_WIN64


727 
	#ISFLOAT
(
IDX
Ë(
cif
->
¨g_ty≥s
[IDX]->
ty≥
 =
FFI_TYPE_FLOAT
 || cif->¨g_ty≥s[IDX]->ty≥ =
FFI_TYPE_DOUBLE
)

	)

728 
	#FLAG
(
IDX
Ë(
cif
->
«rgs
>(IDX)&&
	`ISFLOAT
(IDX)?(1<<(IDX)):0)

	)

729 i‡(
cif
->
abi
 =
FFI_WIN64
)

731 
mask
 = 
	`FLAG
(0)|FLAG(1)|FLAG(2)|FLAG(3);

732 
	`FFI_INIT_TRAMPOLINE_WIN64
 (&
˛osuª
->
åamp
[0],

733 &
ffi_˛osuª_wö64
,

734 
codñoc
, 
mask
);

738 i‡(
cif
->
abi
 =
FFI_SYSV
)

740 
	`FFI_INIT_TRAMPOLINE
 (&
˛osuª
->
åamp
[0],

741 &
ffi_˛osuª_SYSV
,

742 (*)
codñoc
);

744 i‡(
cif
->
abi
 =
FFI_REGISTER
)

746 
	`FFI_INIT_TRAMPOLINE_WIN32
 (&
˛osuª
->
åamp
[0],

747 &
ffi_˛osuª_REGISTER
,

748 (*)
codñoc
);

750 i‡(
cif
->
abi
 =
FFI_FASTCALL
)

752 
	`FFI_INIT_TRAMPOLINE_WIN32
 (&
˛osuª
->
åamp
[0],

753 &
ffi_˛osuª_FASTCALL
,

754 (*)
codñoc
);

756 i‡(
cif
->
abi
 =
FFI_THISCALL
)

758 
	`FFI_INIT_TRAMPOLINE_WIN32
 (&
˛osuª
->
åamp
[0],

759 &
ffi_˛osuª_THISCALL
,

760 (*)
codñoc
);

762 i‡(
cif
->
abi
 =
FFI_STDCALL
 || cif->abò=
FFI_PASCAL
)

764 
	`FFI_INIT_TRAMPOLINE_WIN32
 (&
˛osuª
->
åamp
[0],

765 &
ffi_˛osuª_STDCALL
,

766 (*)
codñoc
);

768 #ifde‡
X86_WIN32


769 i‡(
cif
->
abi
 =
FFI_MS_CDECL
)

771 
	`FFI_INIT_TRAMPOLINE
 (&
˛osuª
->
åamp
[0],

772 &
ffi_˛osuª_SYSV
,

773 (*)
codñoc
);

779  
FFI_BAD_ABI
;

782 
˛osuª
->
cif
 = cif;

783 
˛osuª
->
u£r_d©a
 = user_data;

784 
˛osuª
->
fun
 = fun;

786  
FFI_OK
;

787 
	}
}

791 #i‡!
FFI_NO_RAW_API


793 
ffi_°©us


794 
ffi_¥ï_øw_˛osuª_loc
 (
ffi_øw_˛osuª
* 
˛osuª
,

795 
ffi_cif
* 
cif
,

796 (*
fun
)(
ffi_cif
*,*,
ffi_øw
*,*),

797 *
u£r_d©a
,

798 *
codñoc
)

800 
i
;

802 i‡(
cif
->
abi
 !
FFI_SYSV


803 #ifde‡
X86_WIN32


804 && 
cif
->
abi
 !
FFI_THISCALL


807  
FFI_BAD_ABI
;

814 
i
 = 
cif
->
«rgs
-1; i >= 0; i--)

816 
	`FFI_ASSERT
 (
cif
->
¨g_ty≥s
[
i
]->
ty≥
 !
FFI_TYPE_STRUCT
);

817 
	`FFI_ASSERT
 (
cif
->
¨g_ty≥s
[
i
]->
ty≥
 !
FFI_TYPE_LONGDOUBLE
);

820 #ifde‡
X86_WIN32


821 i‡(
cif
->
abi
 =
FFI_SYSV
)

824 
	`FFI_INIT_TRAMPOLINE
 (&
˛osuª
->
åamp
[0], &
ffi_˛osuª_øw_SYSV
,

825 
codñoc
);

826 #ifde‡
X86_WIN32


828 i‡(
cif
->
abi
 =
FFI_THISCALL
)

830 
	`FFI_INIT_TRAMPOLINE_RAW_THISCALL
 (&
˛osuª
->
åamp
[0], &
ffi_˛osuª_øw_THISCALL
, 
codñoc
, 
cif
->
byãs
);

833 
˛osuª
->
cif
 = cif;

834 
˛osuª
->
u£r_d©a
 = user_data;

835 
˛osuª
->
fun
 = fun;

837  
FFI_OK
;

838 
	}
}

841 
	$ffi_¥ï_¨gs_øw
(*
°ack
, 
exãnded_cif
 *
ecif
)

843 c⁄° 
ffi_cif
 *
cif
 = 
ecif
->cif;

844 
i
, 
∑s£d_ªgs
 = 0;

846 #i‚de‡
X86_WIN64


847 c⁄° 
abi
 = 
cif
->abi;

848 c⁄° 
max_ªgs
 = (
abi
 =
FFI_THISCALL
) ? 1

849 : (
abi
 =
FFI_FASTCALL
) ? 2

850 : (
abi
 =
FFI_REGISTER
) ? 3

853 i‡(
cif
->
Êags
 =
FFI_TYPE_STRUCT
)

854 ++
∑s£d_ªgs
;

856 
i
 = 0; i < 
cif
->
«rgs
 && 
∑s£d_ªgs
 <
max_ªgs
; i++)

858 i‡(
cif
->
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_FLOAT


859 || 
cif
->
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_STRUCT
)

862 
size_t
 
sz
 = 
cif
->
¨g_ty≥s
[
i
]->
size
;

863 i‡(
sz
 =0 || sz > 
FFI_SIZEOF_ARG
)

866 ++
∑s£d_ªgs
;

870 
	`mem˝y
 (
°ack
, 
ecif
->
avÆue
, 
cif
->
byãs
);

871  
∑s£d_ªgs
;

872 
	}
}

880 
ffi_øw_ˇŒ
(
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, 
ffi_øw
 *
Áke_avÆue
)

882 
exãnded_cif
 
ecif
;

883 **
avÆue
 = (**)
Áke_avÆue
;

885 
ecif
.
cif
 = cif;

886 
ecif
.
avÆue
 =ávalue;

891 i‡(
rvÆue
 =
NULL


892 && (
cif
->
Êags
 =
FFI_TYPE_STRUCT


893 || 
cif
->
Êags
 =
FFI_TYPE_MS_STRUCT
))

895 
ecif
.
rvÆue
 = 
	`Æloˇ
(
cif
->
πy≥
->
size
);

898 
ecif
.
rvÆue
 =Ñvalue;

901 
cif
->
abi
)

903 #i‚de‡
X86_WIN32


904 
FFI_SYSV
:

905 
	`ffi_ˇŒ_SYSV
(
ffi_¥ï_¨gs_øw
, &
ecif
, 
cif
->
byãs
, cif->
Êags
,

906 
ecif
.
rvÆue
, 
‚
);

909 
FFI_SYSV
:

910 
FFI_MS_CDECL
:

912 #i‚de‡
X86_WIN64


913 
FFI_STDCALL
:

914 
FFI_THISCALL
:

915 
FFI_FASTCALL
:

916 
FFI_PASCAL
:

917 
FFI_REGISTER
:

918 
	`ffi_ˇŒ_wö32
(
ffi_¥ï_¨gs_øw
, &
ecif
, 
cif
->
abi
, cif->
byãs
, cif->
Êags
,

919 
ecif
.
rvÆue
, 
‚
);

923 
	`FFI_ASSERT
(0);

926 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/ffi64.c

30 
	~<ffi.h
>

31 
	~<ffi_comm⁄.h
>

33 
	~<°dlib.h
>

34 
	~<°d¨g.h
>

36 #ifde‡
__x86_64__


38 
	#MAX_GPR_REGS
 6

	)

39 
	#MAX_SSE_REGS
 8

	)

41 #i‡
deföed
(
__INTEL_COMPILER
)

42 
	~"xmmöåö.h
"

43 
	#UINT128
 
__m128


	)

45 #i‡
deföed
(
__SUNPRO_C
)

46 
	~<sunmedü_ty≥s.h
>

47 
	#UINT128
 
__m128i


	)

49 
	#UINT128
 
__öt128_t


	)

53 
	ubig_öt_uni⁄


55 
UINT32
 
	mi32
;

56 
UINT64
 
	mi64
;

57 
UINT128
 
	mi128
;

60 
	sªgi°î_¨gs


63 
UINT64
 
	mg¥
[
MAX_GPR_REGS
];

64 
big_öt_uni⁄
 
	ms£
[
MAX_SSE_REGS
];

67 
ffi_ˇŒ_unix64
 (*
¨gs
, 
byãs
, 
Êags
,

68 *
øddr
, (*
‚addr
)(), 
s£cou¡
);

81 
	ex86_64_ªg_˛ass


83 
X86_64_NO_CLASS
,

84 
X86_64_INTEGER_CLASS
,

85 
X86_64_INTEGERSI_CLASS
,

86 
X86_64_SSE_CLASS
,

87 
X86_64_SSESF_CLASS
,

88 
X86_64_SSEDF_CLASS
,

89 
X86_64_SSEUP_CLASS
,

90 
X86_64_X87_CLASS
,

91 
X86_64_X87UP_CLASS
,

92 
X86_64_COMPLEX_X87_CLASS
,

93 
X86_64_MEMORY_CLASS


96 
	#MAX_CLASSES
 4

	)

98 
	#SSE_CLASS_P
(
X
Ë((XË>
X86_64_SSE_CLASS
 && X <
X86_64_SSEUP_CLASS
)

	)

107 
x86_64_ªg_˛ass


108 
	$mîge_˛as£s
 (
x86_64_ªg_˛ass
 
˛ass1
, x86_64_ªg_˛as†
˛ass2
)

111 i‡(
˛ass1
 =
˛ass2
)

112  
˛ass1
;

116 i‡(
˛ass1
 =
X86_64_NO_CLASS
)

117  
˛ass2
;

118 i‡(
˛ass2
 =
X86_64_NO_CLASS
)

119  
˛ass1
;

122 i‡(
˛ass1
 =
X86_64_MEMORY_CLASS
 || 
˛ass2
 == X86_64_MEMORY_CLASS)

123  
X86_64_MEMORY_CLASS
;

126 i‡((
˛ass1
 =
X86_64_INTEGERSI_CLASS
 && 
˛ass2
 =
X86_64_SSESF_CLASS
)

127 || (
˛ass2
 =
X86_64_INTEGERSI_CLASS
 && 
˛ass1
 =
X86_64_SSESF_CLASS
))

128  
X86_64_INTEGERSI_CLASS
;

129 i‡(
˛ass1
 =
X86_64_INTEGER_CLASS
 || cœss1 =
X86_64_INTEGERSI_CLASS


130 || 
˛ass2
 =
X86_64_INTEGER_CLASS
 || cœss2 =
X86_64_INTEGERSI_CLASS
)

131  
X86_64_INTEGER_CLASS
;

135 i‡(
˛ass1
 =
X86_64_X87_CLASS


136 || 
˛ass1
 =
X86_64_X87UP_CLASS


137 || 
˛ass1
 =
X86_64_COMPLEX_X87_CLASS


138 || 
˛ass2
 =
X86_64_X87_CLASS


139 || 
˛ass2
 =
X86_64_X87UP_CLASS


140 || 
˛ass2
 =
X86_64_COMPLEX_X87_CLASS
)

141  
X86_64_MEMORY_CLASS
;

144  
X86_64_SSE_CLASS
;

145 
	}
}

155 
size_t


156 
	$˛assify_¨gumít
 (
ffi_ty≥
 *
ty≥
, 
x86_64_ªg_˛ass
 
˛as£s
[],

157 
size_t
 
byã_off£t
)

159 
ty≥
->type)

161 
FFI_TYPE_UINT8
:

162 
FFI_TYPE_SINT8
:

163 
FFI_TYPE_UINT16
:

164 
FFI_TYPE_SINT16
:

165 
FFI_TYPE_UINT32
:

166 
FFI_TYPE_SINT32
:

167 
FFI_TYPE_UINT64
:

168 
FFI_TYPE_SINT64
:

169 
FFI_TYPE_POINTER
:

171 
size_t
 
size
 = 
byã_off£t
 + 
ty≥
->size;

173 i‡(
size
 <= 4)

175 
˛as£s
[0] = 
X86_64_INTEGERSI_CLASS
;

178 i‡(
size
 <= 8)

180 
˛as£s
[0] = 
X86_64_INTEGER_CLASS
;

183 i‡(
size
 <= 12)

185 
˛as£s
[0] = 
X86_64_INTEGER_CLASS
;

186 
˛as£s
[1] = 
X86_64_INTEGERSI_CLASS
;

189 i‡(
size
 <= 16)

191 
˛as£s
[0] = cœs£s[1] = 
X86_64_INTEGERSI_CLASS
;

195 
	`FFI_ASSERT
 (0);

197 
FFI_TYPE_FLOAT
:

198 i‡(!(
byã_off£t
 % 8))

199 
˛as£s
[0] = 
X86_64_SSESF_CLASS
;

201 
˛as£s
[0] = 
X86_64_SSE_CLASS
;

203 
FFI_TYPE_DOUBLE
:

204 
˛as£s
[0] = 
X86_64_SSEDF_CLASS
;

206 #i‡
FFI_TYPE_LONGDOUBLE
 !
FFI_TYPE_DOUBLE


207 
FFI_TYPE_LONGDOUBLE
:

208 
˛as£s
[0] = 
X86_64_X87_CLASS
;

209 
˛as£s
[1] = 
X86_64_X87UP_CLASS
;

212 
FFI_TYPE_STRUCT
:

214 c⁄° 
size_t
 
UNITS_PER_WORD
 = 8;

215 
size_t
 
w‹ds
 = (
ty≥
->
size
 + 
UNITS_PER_WORD
 - 1) / UNITS_PER_WORD;

216 
ffi_ty≥
 **
±r
;

217 
i
;

218 
x86_64_ªg_˛ass
 
sub˛as£s
[
MAX_CLASSES
];

221 i‡(
ty≥
->
size
 > 32)

224 
i
 = 0; i < 
w‹ds
; i++)

225 
˛as£s
[
i
] = 
X86_64_NO_CLASS
;

229 i‡(!
w‹ds
)

231 
˛as£s
[0] = 
X86_64_NO_CLASS
;

236 
±r
 = 
ty≥
->
ñemíts
; *±∏!
NULL
;Ötr++)

238 
size_t
 
num
;

240 
byã_off£t
 = 
	`ALIGN
 (byã_off£t, (*
±r
)->
Æignmít
);

242 
num
 = 
	`˛assify_¨gumít
 (*
±r
, 
sub˛as£s
, 
byã_off£t
 % 8);

243 i‡(
num
 == 0)

245 
i
 = 0; i < 
num
; i++)

247 
size_t
 
pos
 = 
byã_off£t
 / 8;

248 
˛as£s
[
i
 + 
pos
] =

249 
	`mîge_˛as£s
 (
sub˛as£s
[
i
], 
˛as£s
[ò+ 
pos
]);

252 
byã_off£t
 +(*
±r
)->
size
;

255 i‡(
w‹ds
 > 2)

261 i‡(
˛as£s
[0] !
X86_64_SSE_CLASS
)

264 
i
 = 1; i < 
w‹ds
; i++)

265 i‡(
˛as£s
[
i
] !
X86_64_SSEUP_CLASS
)

270 
i
 = 0; i < 
w‹ds
; i++)

274 i‡(
˛as£s
[
i
] =
X86_64_MEMORY_CLASS
)

279 i‡(
˛as£s
[
i
] =
X86_64_SSEUP_CLASS


280 && 
˛as£s
[
i
 - 1] !
X86_64_SSE_CLASS


281 && 
˛as£s
[
i
 - 1] !
X86_64_SSEUP_CLASS
)

284 
	`FFI_ASSERT
 (
i
 != 0);

285 
˛as£s
[
i
] = 
X86_64_SSE_CLASS
;

290 i‡(
˛as£s
[
i
] =
X86_64_X87UP_CLASS


291 && (
˛as£s
[
i
 - 1] !
X86_64_X87_CLASS
))

294 
	`FFI_ASSERT
 (
i
 != 0);

298  
w‹ds
;

302 
	`FFI_ASSERT
(0);

305 
	}
}

311 
size_t


312 
	$examöe_¨gumít
 (
ffi_ty≥
 *
ty≥
, 
x86_64_ªg_˛ass
 
˛as£s
[
MAX_CLASSES
],

313 
_Boﬁ
 
ö_ªtu∫
, *
≤g¥
, *
≤s£
)

315 
size_t
 
n
;

316 
i
, 
ng¥
, 
ns£
;

318 
n
 = 
	`˛assify_¨gumít
 (
ty≥
, 
˛as£s
, 0);

319 i‡(
n
 == 0)

322 
ng¥
 = 
ns£
 = 0;

323 
i
 = 0; i < 
n
; ++i)

324 
˛as£s
[
i
])

326 
X86_64_INTEGER_CLASS
:

327 
X86_64_INTEGERSI_CLASS
:

328 
ng¥
++;

330 
X86_64_SSE_CLASS
:

331 
X86_64_SSESF_CLASS
:

332 
X86_64_SSEDF_CLASS
:

333 
ns£
++;

335 
X86_64_NO_CLASS
:

336 
X86_64_SSEUP_CLASS
:

338 
X86_64_X87_CLASS
:

339 
X86_64_X87UP_CLASS
:

340 
X86_64_COMPLEX_X87_CLASS
:

341  
ö_ªtu∫
 != 0;

343 
	`ab‹t
 ();

346 *
≤g¥
 = 
ng¥
;

347 *
≤s£
 = 
ns£
;

349  
n
;

350 
	}
}

354 
ffi_°©us


355 
	$ffi_¥ï_cif_machdï
 (
ffi_cif
 *
cif
)

357 
g¥cou¡
, 
s£cou¡
, 
i
, 
avn
, 
ng¥
, 
ns£
, 
Êags
;

358 
x86_64_ªg_˛ass
 
˛as£s
[
MAX_CLASSES
];

359 
size_t
 
byãs
, 
n
;

361 
g¥cou¡
 = 
s£cou¡
 = 0;

363 
Êags
 = 
cif
->
πy≥
->
ty≥
;

364 i‡(
Êags
 !
FFI_TYPE_VOID
)

366 
n
 = 
	`examöe_¨gumít
 (
cif
->
πy≥
, 
˛as£s
, 1, &
ng¥
, &
ns£
);

367 i‡(
n
 == 0)

371 
g¥cou¡
++;

373 
Êags
 = 
FFI_TYPE_VOID
;

375 i‡(
Êags
 =
FFI_TYPE_STRUCT
)

378 
_Boﬁ
 
s£0
 = 
	`SSE_CLASS_P
 (
˛as£s
[0]);

379 
_Boﬁ
 
s£1
 = 
n
 =2 && 
	`SSE_CLASS_P
 (
˛as£s
[1]);

380 i‡(
s£0
 && !
s£1
)

381 
Êags
 |= 1 << 8;

382 i‡(!
s£0
 && 
s£1
)

383 
Êags
 |= 1 << 9;

384 i‡(
s£0
 && 
s£1
)

385 
Êags
 |= 1 << 10;

387 
Êags
 |
cif
->
πy≥
->
size
 << 12;

394 
byãs
 = 0, 
i
 = 0, 
avn
 = 
cif
->
«rgs
; i <ávn; i++)

396 i‡(
	`examöe_¨gumít
 (
cif
->
¨g_ty≥s
[
i
], 
˛as£s
, 0, &
ng¥
, &
ns£
) == 0

397 || 
g¥cou¡
 + 
ng¥
 > 
MAX_GPR_REGS


398 || 
s£cou¡
 + 
ns£
 > 
MAX_SSE_REGS
)

400 
Æign
 = 
cif
->
¨g_ty≥s
[
i
]->
Æignmít
;

402 i‡(
Æign
 < 8)

403 
Æign
 = 8;

405 
byãs
 = 
	`ALIGN
 (byãs, 
Æign
);

406 
byãs
 +
cif
->
¨g_ty≥s
[
i
]->
size
;

410 
g¥cou¡
 +
ng¥
;

411 
s£cou¡
 +
ns£
;

414 i‡(
s£cou¡
)

415 
Êags
 |= 1 << 11;

416 
cif
->
Êags
 = flags;

417 
cif
->
byãs
 = ()
	`ALIGN
 (bytes, 8);

419  
FFI_OK
;

420 
	}
}

423 
ffi_ˇŒ
 (
ffi_cif
 *
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

425 
x86_64_ªg_˛ass
 
˛as£s
[
MAX_CLASSES
];

426 *
°ack
, *
¨gp
;

427 
ffi_ty≥
 **
¨g_ty≥s
;

428 
g¥cou¡
, 
s£cou¡
, 
ng¥
, 
ns£
, 
i
, 
avn
;

429 
_Boﬁ
 
ªt_ö_mem‹y
;

430 
ªgi°î_¨gs
 *
ªg_¨gs
;

433 
	`FFI_ASSERT
 (
cif
->
abi
 =
FFI_UNIX64
);

438 
ªt_ö_mem‹y
 = (
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT


439 && (
cif
->
Êags
 & 0xffË=
FFI_TYPE_VOID
);

440 i‡(
rvÆue
 =
NULL
 && 
ªt_ö_mem‹y
)

441 
rvÆue
 = 
	`Æloˇ
 (
cif
->
πy≥
->
size
);

444 
°ack
 = 
	`Æloˇ
 ( (
ªgi°î_¨gs
Ë+ 
cif
->
byãs
 + 4*8);

445 
ªg_¨gs
 = (
ªgi°î_¨gs
 *Ë
°ack
;

446 
¨gp
 = 
°ack
 +  (
ªgi°î_¨gs
);

448 
g¥cou¡
 = 
s£cou¡
 = 0;

452 i‡(
ªt_ö_mem‹y
)

453 
ªg_¨gs
->
g¥
[
g¥cou¡
++] = (Ë
rvÆue
;

455 
avn
 = 
cif
->
«rgs
;

456 
¨g_ty≥s
 = 
cif
->arg_types;

458 
i
 = 0; i < 
avn
; ++i)

460 
size_t
 
n
, 
size
 = 
¨g_ty≥s
[
i
]->size;

462 
n
 = 
	`examöe_¨gumít
 (
¨g_ty≥s
[
i
], 
˛as£s
, 0, &
ng¥
, &
ns£
);

463 i‡(
n
 == 0

464 || 
g¥cou¡
 + 
ng¥
 > 
MAX_GPR_REGS


465 || 
s£cou¡
 + 
ns£
 > 
MAX_SSE_REGS
)

467 
Æign
 = 
¨g_ty≥s
[
i
]->
Æignmít
;

470 i‡(
Æign
 < 8)

471 
Æign
 = 8;

474 
¨gp
 = (*Ë
	`ALIGN
 (¨gp, 
Æign
);

475 
	`mem˝y
 (
¨gp
, 
avÆue
[
i
], 
size
);

476 
¨gp
 +
size
;

481 *
a
 = (*Ë
avÆue
[
i
];

482 
j
;

484 
j
 = 0; j < 
n
; j++, 
a
 +8, 
size
 -= 8)

486 
˛as£s
[
j
])

488 
X86_64_INTEGER_CLASS
:

489 
X86_64_INTEGERSI_CLASS
:

494 
¨g_ty≥s
[
i
]->
ty≥
)

496 
FFI_TYPE_SINT8
:

497 *(
SINT64
 *)&
ªg_¨gs
->
g¥
[
g¥cou¡
] = (SINT64Ë*((
SINT8
 *Ë
a
);

499 
FFI_TYPE_SINT16
:

500 *(
SINT64
 *)&
ªg_¨gs
->
g¥
[
g¥cou¡
] = (SINT64Ë*((
SINT16
 *Ë
a
);

502 
FFI_TYPE_SINT32
:

503 *(
SINT64
 *)&
ªg_¨gs
->
g¥
[
g¥cou¡
] = (SINT64Ë*((
SINT32
 *Ë
a
);

506 
ªg_¨gs
->
g¥
[
g¥cou¡
] = 0;

507 
	`mem˝y
 (&
ªg_¨gs
->
g¥
[
g¥cou¡
], 
a
, 
size
 < 8 ? size : 8);

509 
g¥cou¡
++;

511 
X86_64_SSE_CLASS
:

512 
X86_64_SSEDF_CLASS
:

513 
ªg_¨gs
->
s£
[
s£cou¡
++].
i64
 = *(
UINT64
 *Ë
a
;

515 
X86_64_SSESF_CLASS
:

516 
ªg_¨gs
->
s£
[
s£cou¡
++].
i32
 = *(
UINT32
 *Ë
a
;

519 
	`ab‹t
();

525 
	`ffi_ˇŒ_unix64
 (
°ack
, 
cif
->
byãs
 +  (
ªgi°î_¨gs
),

526 
cif
->
Êags
, 
rvÆue
, 
‚
, 
s£cou¡
);

527 
	}
}

530 
ffi_˛osuª_unix64
();

532 
ffi_°©us


533 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

534 
ffi_cif
* 
cif
,

535 (*
fun
)(
ffi_cif
*, *, **, *),

536 *
u£r_d©a
,

537 *
codñoc
)

539 vﬁ©ûê*
åamp
;

543 
abi
 = 
cif
->abi;

544 i‡(
	`UNLIKELY
 (! (
abi
 > 
FFI_FIRST_ABI
 &&ábò< 
FFI_LAST_ABI
)))

545  
FFI_BAD_ABI
;

548 
åamp
 = (vﬁ©ûê*Ë&
˛osuª
->tramp[0];

550 
åamp
[0] = 0xbb49;

551 *((* vﬁ©ûeË&
åamp
[1])

552 (Ë
ffi_˛osuª_unix64
;

553 
åamp
[5] = 0xba49;

554 *((* vﬁ©ûeË&
åamp
[6])

555 (Ë
codñoc
;

559 
åamp
[10] = 
cif
->
Êags
 & (1 << 11) ? 0x49f9 : 0x49f8;

561 
åamp
[11] = 0xe3ff;

563 
˛osuª
->
cif
 = cif;

564 
˛osuª
->
fun
 = fun;

565 
˛osuª
->
u£r_d©a
 = user_data;

567  
FFI_OK
;

568 
	}
}

571 
	$ffi_˛osuª_unix64_ö√r
(
ffi_˛osuª
 *
˛osuª
, *
rvÆue
,

572 
ªgi°î_¨gs
 *
ªg_¨gs
, *
¨gp
)

574 
ffi_cif
 *
cif
;

575 **
avÆue
;

576 
ffi_ty≥
 **
¨g_ty≥s
;

577 
i
, 
avn
;

578 
g¥cou¡
, 
s£cou¡
, 
ng¥
, 
ns£
;

579 
ªt
;

581 
cif
 = 
˛osuª
->cif;

582 
avÆue
 = 
	`Æloˇ
(
cif
->
«rgs
 * (*));

583 
g¥cou¡
 = 
s£cou¡
 = 0;

585 
ªt
 = 
cif
->
πy≥
->
ty≥
;

586 i‡(
ªt
 !
FFI_TYPE_VOID
)

588 
x86_64_ªg_˛ass
 
˛as£s
[
MAX_CLASSES
];

589 
size_t
 
n
 = 
	`examöe_¨gumít
 (
cif
->
πy≥
, 
˛as£s
, 1, &
ng¥
, &
ns£
);

590 i‡(
n
 == 0)

594 
rvÆue
 = (*Ë(Ë
ªg_¨gs
->
g¥
[
g¥cou¡
++];

596 
ªt
 = 
FFI_TYPE_VOID
;

598 i‡(
ªt
 =
FFI_TYPE_STRUCT
 && 
n
 == 2)

601 
_Boﬁ
 
s£0
 = 
	`SSE_CLASS_P
 (
˛as£s
[0]);

602 
_Boﬁ
 
s£1
 = 
	`SSE_CLASS_P
 (
˛as£s
[1]);

603 i‡(!
s£0
 && 
s£1
)

604 
ªt
 |= 1 << 8;

605 i‡(
s£0
 && !
s£1
)

606 
ªt
 |= 1 << 9;

610 
avn
 = 
cif
->
«rgs
;

611 
¨g_ty≥s
 = 
cif
->arg_types;

613 
i
 = 0; i < 
avn
; ++i)

615 
x86_64_ªg_˛ass
 
˛as£s
[
MAX_CLASSES
];

616 
size_t
 
n
;

618 
n
 = 
	`examöe_¨gumít
 (
¨g_ty≥s
[
i
], 
˛as£s
, 0, &
ng¥
, &
ns£
);

619 i‡(
n
 == 0

620 || 
g¥cou¡
 + 
ng¥
 > 
MAX_GPR_REGS


621 || 
s£cou¡
 + 
ns£
 > 
MAX_SSE_REGS
)

623 
Æign
 = 
¨g_ty≥s
[
i
]->
Æignmít
;

626 i‡(
Æign
 < 8)

627 
Æign
 = 8;

630 
¨gp
 = (*Ë
	`ALIGN
 (¨gp, 
Æign
);

631 
avÆue
[
i
] = 
¨gp
;

632 
¨gp
 +
¨g_ty≥s
[
i
]->
size
;

636 i‡(
n
 == 1

637 || (
n
 =2 && !(
	`SSE_CLASS_P
 (
˛as£s
[0])

638 || 
	`SSE_CLASS_P
 (
˛as£s
[1]))))

641 i‡(
	`SSE_CLASS_P
 (
˛as£s
[0]))

643 
avÆue
[
i
] = &
ªg_¨gs
->
s£
[
s£cou¡
];

644 
s£cou¡
 +
n
;

648 
avÆue
[
i
] = &
ªg_¨gs
->
g¥
[
g¥cou¡
];

649 
g¥cou¡
 +
n
;

655 *
a
 = 
	`Æloˇ
 (16);

656 
j
;

658 
avÆue
[
i
] = 
a
;

659 
j
 = 0; j < 
n
; j++, 
a
 += 8)

661 i‡(
	`SSE_CLASS_P
 (
˛as£s
[
j
]))

662 
	`mem˝y
 (
a
, &
ªg_¨gs
->
s£
[
s£cou¡
++], 8);

664 
	`mem˝y
 (
a
, &
ªg_¨gs
->
g¥
[
g¥cou¡
++], 8);

670 
˛osuª
->
	`fun
 (
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

673  
ªt
;

674 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/ffitarget.h

30 #i‚de‡
LIBFFI_TARGET_H


31 
	#LIBFFI_TARGET_H


	)

33 #i‚de‡
LIBFFI_H


40 
	#X86_ANY


	)

42 #i‡
deföed
 (
X86_64
Ë&& deföed (
__i386__
)

43 #unde‡
X86_64


44 
	#X86


	)

47 #ifde‡
X86_WIN64


48 
	#FFI_SIZEOF_ARG
 8

	)

49 
	#USE_BUILTIN_FFS
 0

	)

52 
	#FFI_TARGET_SPECIFIC_STACK_SPACE_ALLOCATION


	)

53 
	#FFI_TARGET_HAS_COMPLEX_TYPE


	)

57 #i‚de‡
LIBFFI_ASM


58 #ifde‡
X86_WIN64


59 #ifde‡
_MSC_VER


60 
	t__öt64
 
	tffi_¨g
;

61 
__öt64
 
	tffi_ßrg
;

63 
	tffi_¨g
;

64 
	tffi_ßrg
;

67 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


68 
	#FFI_SIZEOF_ARG
 8

	)

69 
	#FFI_SIZEOF_JAVA_RAW
 4

	)

70 
	tffi_¨g
;

71 
	tffi_ßrg
;

73 
	tffi_¨g
;

74 sig√d 
	tffi_ßrg
;

78 
	effi_abi
 {

79 
	mFFI_FIRST_ABI
 = 0,

82 #ifde‡
X86_WIN32


83 
	mFFI_SYSV
,

84 
	mFFI_STDCALL
,

85 
	mFFI_THISCALL
,

86 
	mFFI_FASTCALL
,

87 
	mFFI_MS_CDECL
,

88 
	mFFI_PASCAL
,

89 
	mFFI_REGISTER
,

90 
	mFFI_LAST_ABI
,

91 #ifde‡
_MSC_VER


92 
	mFFI_DEFAULT_ABI
 = 
FFI_MS_CDECL


94 
FFI_DEFAULT_ABI
 = 
FFI_SYSV


97 #ñi‡
deföed
(
X86_WIN64
)

98 
FFI_WIN64
,

99 
	mFFI_LAST_ABI
,

100 
	mFFI_DEFAULT_ABI
 = 
FFI_WIN64


104 
FFI_SYSV
,

105 
	mFFI_UNIX64
,

106 
	mFFI_THISCALL
,

107 
	mFFI_FASTCALL
,

108 
	mFFI_STDCALL
,

109 
	mFFI_PASCAL
,

110 
	mFFI_REGISTER
,

111 
	mFFI_LAST_ABI
,

112 #i‡
deföed
(
__i386__
Ë|| deföed(
__i386
)

113 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


115 
FFI_DEFAULT_ABI
 = 
FFI_UNIX64


118 } 
	tffi_abi
;

123 
	#FFI_CLOSURES
 1

	)

124 
	#FFI_TYPE_SMALL_STRUCT_1B
 (
FFI_TYPE_LAST
 + 1)

	)

125 
	#FFI_TYPE_SMALL_STRUCT_2B
 (
FFI_TYPE_LAST
 + 2)

	)

126 
	#FFI_TYPE_SMALL_STRUCT_4B
 (
FFI_TYPE_LAST
 + 3)

	)

127 
	#FFI_TYPE_MS_STRUCT
 (
FFI_TYPE_LAST
 + 4)

	)

129 #i‡
deföed
 (
X86_64
Ë|| (deföed (
__x86_64__
Ë&& deföed (
X86_DARWIN
))

130 
	#FFI_TRAMPOLINE_SIZE
 24

	)

131 
	#FFI_NATIVE_RAW_API
 0

	)

133 #ifde‡
X86_WIN32


134 
	#FFI_TRAMPOLINE_SIZE
 52

	)

136 #ifde‡
X86_WIN64


137 
	#FFI_TRAMPOLINE_SIZE
 29

	)

138 
	#FFI_NATIVE_RAW_API
 0

	)

139 
	#FFI_NO_RAW_API
 1

	)

141 
	#FFI_TRAMPOLINE_SIZE
 10

	)

144 #i‚de‡
X86_WIN64


145 
	#FFI_NATIVE_RAW_API
 1

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/freebsd.S

28 #i‚de‡
__x86_64__


30 
	#LIBFFI_ASM


	)

31 
	~<ffic⁄fig.h
>

32 
	~<ffi.h
>

34 .
	gãxt


36 .
globl
 
	gffi_¥ï_¨gs


38 .
	gÆign
 4

39 .
globl
 
	gffi_ˇŒ_SYSV


40 .
ty≥
 
	gffi_ˇŒ_SYSV
,@
fun˘i⁄


42 
	gffi_ˇŒ_SYSV
:

43 .
LFB1
:

44 
pushl
 %
ebp


45 .
LCFI0
:

46 
movl
 %
e•
,%
	gebp


47 .
	gLCFI1
:

49 
movl
 16(%
ebp
),%
ecx


50 
	gsubl
 %
	gecx
,%
e•


53 
™dl
 
	g$0xfffffff0
, %
e•


55 
	gmovl
 %
	ge•
,%
óx


58 
	gpushl
 12(%
	gebp
)

59 
	gpushl
 %
óx


60 
	gˇŒ
 *8(%
	gebp
)

63 
addl
 
	g$8
,%
e•


65 
	gˇŒ
 *28(%
	gebp
)

68 
	gmovl
 20(%
	gebp
),%
ecx


71 
	gpushl
 %
esi


74 
cm∂
 
	g$0
,24(%
	gebp
)

75 
	gj√
 0f

79 
cm∂
 
	g$FFI_TYPE_FLOAT
,%
ecx


80 
j√
 
n‹ëvÆ


81 
	gf°p
 %
	$°
(0)

83 
jmp
 
ïûogue


86 
ˇŒ
 1f

88 .
L°‹e_èbÀ
:

89 .
n‹ëvÆ
-.
L°‹e_èbÀ


90 .
ªtöt
-.
L°‹e_èbÀ


91 .
ªtÊﬂt
-.
L°‹e_èbÀ


92 .
ªtdoubÀ
-.
L°‹e_èbÀ


93 .
ªé⁄gdoubÀ
-.
L°‹e_èbÀ


94 .
ªtuöt8
-.
L°‹e_èbÀ


95 .
ªtsöt8
-.
L°‹e_èbÀ


96 .
ªtuöt16
-.
L°‹e_èbÀ


97 .
ªtsöt16
-.
L°‹e_èbÀ


98 .
ªtöt
-.
L°‹e_èbÀ


99 .
ªtöt
-.
L°‹e_èbÀ


100 .
ªtöt64
-.
L°‹e_èbÀ


101 .
ªtöt64
-.
L°‹e_èbÀ


102 .
ªt°ru˘
-.
L°‹e_èbÀ


103 .
ªtöt
-.
L°‹e_èbÀ


104 .
ªt°ru˘1b
-.
L°‹e_èbÀ


105 .
ªt°ru˘2b
-.
L°‹e_èbÀ


108 
p›
 %
esi


109 
	`add
 (%
esi
, %
ecx
, 4), %esi

110 
jmp
 *%
esi


113 
ªtsöt8
:

114 
movsbl
 %
Æ
, %
óx


115 
jmp
 
ªtöt


117 
ªtsöt16
:

118 
movswl
 %
ax
, %
óx


119 
jmp
 
ªtöt


121 
ªtuöt8
:

122 
movzbl
 %
Æ
, %
óx


123 
jmp
 
ªtöt


125 
ªtuöt16
:

126 
movzwl
 %
ax
, %
óx


127 
jmp
 
ªtöt


129 
ªtÊﬂt
:

131 
movl
 24(%
ebp
),%
ecx


132 
	`f°ps
 (%
ecx
)

133 
jmp
 
ïûogue


135 
ªtdoubÀ
:

137 
movl
 24(%
ebp
),%
ecx


138 
	`f°∂
 (%
ecx
)

139 
jmp
 
ïûogue


141 
ªé⁄gdoubÀ
:

143 
movl
 24(%
ebp
),%
ecx


144 
	`f°±
 (%
ecx
)

145 
jmp
 
ïûogue


147 
ªtöt64
:

149 
movl
 24(%
ebp
),%
ecx


150 
movl
 %
óx
,0(%
ecx
)

151 
movl
 %
edx
,4(%
ecx
)

152 
jmp
 
ïûogue


154 
ªt°ru˘1b
:

156 
movl
 24(%
ebp
),%
ecx


157 
movb
 %
Æ
,0(%
ecx
)

158 
jmp
 
ïûogue


160 
ªt°ru˘2b
:

162 
movl
 24(%
ebp
),%
ecx


163 
movw
 %
ax
,0(%
ecx
)

164 
jmp
 
ïûogue


166 
ªtöt
:

168 
movl
 24(%
ebp
),%
ecx


169 
movl
 %
óx
,0(%
ecx
)

171 
ªt°ru˘
:

174 
n‹ëvÆ
:

175 
ïûogue
:

176 
p›l
 %
esi


177 
movl
 %
ebp
,%
e•


178 
p›l
 %
ebp


179 
ªt


180 .
LFE1
:

181 .
ffi_ˇŒ_SYSV_íd
:

182 .
size
 
ffi_ˇŒ_SYSV
,.
ffi_ˇŒ_SYSV_íd
-ffi_call_SYSV

184 .
Æign
 4

185 
	`FFI_HIDDEN
 (
ffi_˛osuª_SYSV
)

186 .
globl
 
ffi_˛osuª_SYSV


187 .
ty≥
 
ffi_˛osuª_SYSV
, @
fun˘i⁄


189 
ffi_˛osuª_SYSV
:

190 .
LFB2
:

191 
pushl
 %
ebp


192 .
LCFI2
:

193 
movl
 %
e•
, %
ebp


194 .
LCFI3
:

195 
subl
 
$40
, %
e•


196 
ÀÆ
 -24(%
ebp
), %
edx


197 
movl
 %
edx
, -12(%
ebp
)

198 
ÀÆ
 8(%
ebp
), %
edx


199 
movl
 %
edx
, 4(%
e•
)

200 
ÀÆ
 -12(%
ebp
), %
edx


201 
movl
 %
edx
, (%
e•
)

202 #i‡
deföed
 
HAVE_HIDDEN_VISIBILITY_ATTRIBUTE
 || !deföed 
__PIC__


203 
ˇŒ
 
ffi_˛osuª_SYSV_ö√r


205 
movl
 %
ebx
, 8(%
e•
)

206 .
LCFI7
:

207 
ˇŒ
 1f

208 1: 
p›l
 %
ebx


209 
addl
 
$_GLOBAL_OFFSET_TABLE_
+[.-1b], %
ebx


210 
ˇŒ
 
ffi_˛osuª_SYSV_ö√r
@
PLT


211 
movl
 8(%
e•
), %
ebx


213 
movl
 -12(%
ebp
), %
ecx


214 
cm∂
 
$FFI_TYPE_INT
, %
óx


215 
je
 .
L˛s_ªtöt


219 
cm∂
 
$FFI_TYPE_UINT64
, %
óx


220 
jge
 0f

221 
cm∂
 
$FFI_TYPE_UINT8
, %
óx


222 
jge
 .
L˛s_ªtöt


224 0: 
cm∂
 
$FFI_TYPE_FLOAT
, %
óx


225 
je
 .
L˛s_ªtÊﬂt


226 
cm∂
 
$FFI_TYPE_DOUBLE
, %
óx


227 
je
 .
L˛s_ªtdoubÀ


228 
cm∂
 
$FFI_TYPE_LONGDOUBLE
, %
óx


229 
je
 .
L˛s_ªédoubÀ


230 
cm∂
 
$FFI_TYPE_SINT64
, %
óx


231 
je
 .
L˛s_ªél⁄g


232 
cm∂
 
$FFI_TYPE_SMALL_STRUCT_1B
, %
óx


233 
je
 .
L˛s_ªt°ru˘1b


234 
cm∂
 
$FFI_TYPE_SMALL_STRUCT_2B
, %
óx


235 
je
 .
L˛s_ªt°ru˘2b


236 
cm∂
 
$FFI_TYPE_STRUCT
, %
óx


237 
je
 .
L˛s_ªt°ru˘


238 .
L˛s_ïûogue
:

239 
movl
 %
ebp
, %
e•


240 
p›l
 %
ebp


241 
ªt


242 .
L˛s_ªtöt
:

243 
	`movl
 (%
ecx
), %
óx


244 
jmp
 .
L˛s_ïûogue


245 .
L˛s_ªtÊﬂt
:

246 
	`Êds
 (%
ecx
)

247 
jmp
 .
L˛s_ïûogue


248 .
L˛s_ªtdoubÀ
:

249 
	`Êdl
 (%
ecx
)

250 
jmp
 .
L˛s_ïûogue


251 .
L˛s_ªédoubÀ
:

252 
	`Êdt
 (%
ecx
)

253 
jmp
 .
L˛s_ïûogue


254 .
L˛s_ªél⁄g
:

255 
	`movl
 (%
ecx
), %
óx


256 
movl
 4(%
ecx
), %
edx


257 
jmp
 .
L˛s_ïûogue


258 .
L˛s_ªt°ru˘1b
:

259 
	`movsbl
 (%
ecx
), %
óx


260 
jmp
 .
L˛s_ïûogue


261 .
L˛s_ªt°ru˘2b
:

262 
	`movswl
 (%
ecx
), %
óx


263 
jmp
 .
L˛s_ïûogue


264 .
L˛s_ªt°ru˘
:

265 
movl
 %
ebp
, %
e•


266 
p›l
 %
ebp


267 
ªt
 
$4


268 .
LFE2
:

269 .
size
 
ffi_˛osuª_SYSV
, .-ffi_closure_SYSV

271 #i‡!
FFI_NO_RAW_API


273 
	#RAW_CLOSURE_CIF_OFFSET
 ((
FFI_TRAMPOLINE_SIZE
 + 3Ë& ~3)

	)

274 
	#RAW_CLOSURE_FUN_OFFSET
 (
RAW_CLOSURE_CIF_OFFSET
 + 4)

	)

275 
	#RAW_CLOSURE_USER_DATA_OFFSET
 (
RAW_CLOSURE_FUN_OFFSET
 + 4)

	)

276 
	#CIF_FLAGS_OFFSET
 20

	)

278 .
Æign
 4

279 
	`FFI_HIDDEN
 (
ffi_˛osuª_øw_SYSV
)

280 .
globl
 
ffi_˛osuª_øw_SYSV


281 .
ty≥
 
ffi_˛osuª_øw_SYSV
, @
fun˘i⁄


283 
ffi_˛osuª_øw_SYSV
:

284 .
LFB3
:

285 
pushl
 %
ebp


286 .
LCFI4
:

287 
movl
 %
e•
, %
ebp


288 .
LCFI5
:

289 
pushl
 %
esi


290 .
LCFI6
:

291 
subl
 
$36
, %
e•


292 
movl
 
	`RAW_CLOSURE_CIF_OFFSET
(%
óx
), %
esi


293 
movl
 
	`RAW_CLOSURE_USER_DATA_OFFSET
(%
óx
), %
edx


294 
movl
 %
edx
, 12(%
e•
)

295 
ÀÆ
 8(%
ebp
), %
edx


296 
movl
 %
edx
, 8(%
e•
)

297 
ÀÆ
 -24(%
ebp
), %
edx


298 
movl
 %
edx
, 4(%
e•
)

299 
movl
 %
esi
, (%
e•
)

300 
ˇŒ
 *
	`RAW_CLOSURE_FUN_OFFSET
(%
óx
)

301 
movl
 
	`CIF_FLAGS_OFFSET
(%
esi
), %
óx


302 
cm∂
 
$FFI_TYPE_INT
, %
óx


303 
je
 .
Lr˛s_ªtöt


307 
cm∂
 
$FFI_TYPE_UINT64
, %
óx


308 
jge
 0f

309 
cm∂
 
$FFI_TYPE_UINT8
, %
óx


310 
jge
 .
Lr˛s_ªtöt


312 
cm∂
 
$FFI_TYPE_FLOAT
, %
óx


313 
je
 .
Lr˛s_ªtÊﬂt


314 
cm∂
 
$FFI_TYPE_DOUBLE
, %
óx


315 
je
 .
Lr˛s_ªtdoubÀ


316 
cm∂
 
$FFI_TYPE_LONGDOUBLE
, %
óx


317 
je
 .
Lr˛s_ªédoubÀ


318 
cm∂
 
$FFI_TYPE_SINT64
, %
óx


319 
je
 .
Lr˛s_ªél⁄g


320 .
Lr˛s_ïûogue
:

321 
addl
 
$36
, %
e•


322 
p›l
 %
esi


323 
p›l
 %
ebp


324 
ªt


325 .
Lr˛s_ªtöt
:

326 
movl
 -24(%
ebp
), %
óx


327 
jmp
 .
Lr˛s_ïûogue


328 .
Lr˛s_ªtÊﬂt
:

329 
Êds
 -24(%
ebp
)

330 
jmp
 .
Lr˛s_ïûogue


331 .
Lr˛s_ªtdoubÀ
:

332 
Êdl
 -24(%
ebp
)

333 
jmp
 .
Lr˛s_ïûogue


334 .
Lr˛s_ªédoubÀ
:

335 
Êdt
 -24(%
ebp
)

336 
jmp
 .
Lr˛s_ïûogue


337 .
Lr˛s_ªél⁄g
:

338 
movl
 -24(%
ebp
), %
óx


339 
movl
 -20(%
ebp
), %
edx


340 
jmp
 .
Lr˛s_ïûogue


341 .
LFE3
:

342 .
size
 
ffi_˛osuª_øw_SYSV
, .-ffi_closure_raw_SYSV

345 .
£˘i⁄
 .
eh_‰ame
,
EH_FRAME_FLAGS
,@
¥ogbôs


346 .
L‰ame1
:

347 ..
LECIE1
-.
LSCIE1


348 .
LSCIE1
:

350 .
byã
 0x1

351 #ifde‡
__PIC__


352 .
ascii
 "zR\0"

354 .
ascii
 "\0"

356 .
byã
 0x1

357 .
byã
 0x7c

358 .
byã
 0x8

359 #ifde‡
__PIC__


360 .
byã
 0x1

361 .
byã
 0x1b

363 .
byã
 0xc

364 .
byã
 0x4

365 .
byã
 0x4

366 .
byã
 0x88

367 .
byã
 0x1

368 .
Æign
 4

369 .
LECIE1
:

370 .
LSFDE1
:

371 ..
LEFDE1
-.
LASFDE1


372 .
LASFDE1
:

373 ..
LASFDE1
-.
L‰ame1


374 #ifde‡
__PIC__


375 ..
LFB1
-.

377 ..
LFB1


379 ..
LFE1
-.
LFB1


380 #ifde‡
__PIC__


381 .
byã
 0x0

383 .
byã
 0x4

384 ..
LCFI0
-.
LFB1


385 .
byã
 0xe

386 .
byã
 0x8

387 .
byã
 0x85

388 .
byã
 0x2

389 .
byã
 0x4

390 ..
LCFI1
-.
LCFI0


391 .
byã
 0xd

392 .
byã
 0x5

393 .
Æign
 4

394 .
LEFDE1
:

395 .
LSFDE2
:

396 ..
LEFDE2
-.
LASFDE2


397 .
LASFDE2
:

398 ..
LASFDE2
-.
L‰ame1


399 #ifde‡
__PIC__


400 ..
LFB2
-.

402 ..
LFB2


404 ..
LFE2
-.
LFB2


405 #ifde‡
__PIC__


406 .
byã
 0x0

408 .
byã
 0x4

409 ..
LCFI2
-.
LFB2


410 .
byã
 0xe

411 .
byã
 0x8

412 .
byã
 0x85

413 .
byã
 0x2

414 .
byã
 0x4

415 ..
LCFI3
-.
LCFI2


416 .
byã
 0xd

417 .
byã
 0x5

418 #i‡!
deföed
 
HAVE_HIDDEN_VISIBILITY_ATTRIBUTE
 && deföed 
__PIC__


419 .
byã
 0x4

420 ..
LCFI7
-.
LCFI3


421 .
byã
 0x83

422 .
byã
 0xa

424 .
Æign
 4

425 .
LEFDE2
:

427 #i‡!
FFI_NO_RAW_API


429 .
LSFDE3
:

430 ..
LEFDE3
-.
LASFDE3


431 .
LASFDE3
:

432 ..
LASFDE3
-.
L‰ame1


433 #ifde‡
__PIC__


434 ..
LFB3
-.

436 ..
LFB3


438 ..
LFE3
-.
LFB3


439 #ifde‡
__PIC__


440 .
byã
 0x0

442 .
byã
 0x4

443 ..
LCFI4
-.
LFB3


444 .
byã
 0xe

445 .
byã
 0x8

446 .
byã
 0x85

447 .
byã
 0x2

448 .
byã
 0x4

449 ..
LCFI5
-.
LCFI4


450 .
byã
 0xd

451 .
byã
 0x5

452 .
byã
 0x4

453 ..
LCFI6
-.
LCFI5


454 .
byã
 0x86

455 .
byã
 0x3

456 .
Æign
 4

457 .
LEFDE3
:

463 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",%
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/sysv.S

28 #i‚de‡
__x86_64__


30 
	#LIBFFI_ASM


	)

31 
	~<ffic⁄fig.h
>

32 
	~<ffi.h
>

34 .
	gãxt


36 .
globl
 
	gffi_¥ï_¨gs


38 .
	gÆign
 4

39 .
globl
 
	gffi_ˇŒ_SYSV


40 .
ty≥
 
	gffi_ˇŒ_SYSV
,@
fun˘i⁄


42 
	gffi_ˇŒ_SYSV
:

43 .
LFB1
:

44 
pushl
 %
ebp


45 .
LCFI0
:

46 
movl
 %
e•
,%
	gebp


47 .
	gLCFI1
:

49 
movl
 16(%
ebp
),%
ecx


50 
	gsubl
 %
	gecx
,%
e•


53 
™dl
 
	g$0xfffffff0
, %
e•


55 
	gmovl
 %
	ge•
,%
óx


58 
	gpushl
 12(%
	gebp
)

59 
	gpushl
 %
óx


60 
	gˇŒ
 *8(%
	gebp
)

63 
addl
 
	g$8
,%
e•


65 
	gˇŒ
 *28(%
	gebp
)

68 
	gmovl
 20(%
	gebp
),%
ecx


71 
	gpushl
 %
esi


74 
cm∂
 
	g$0
,24(%
	gebp
)

75 
	gj√
 0f

79 
cm∂
 
	g$FFI_TYPE_FLOAT
,%
ecx


80 
j√
 
n‹ëvÆ


81 
	gf°p
 %
	$°
(0)

83 
jmp
 
ïûogue


86 
ˇŒ
 1f

88 .
L°‹e_èbÀ
:

89 .
n‹ëvÆ
-.
L°‹e_èbÀ


90 .
ªtöt
-.
L°‹e_èbÀ


91 .
ªtÊﬂt
-.
L°‹e_èbÀ


92 .
ªtdoubÀ
-.
L°‹e_èbÀ


93 .
ªé⁄gdoubÀ
-.
L°‹e_èbÀ


94 .
ªtuöt8
-.
L°‹e_èbÀ


95 .
ªtsöt8
-.
L°‹e_èbÀ


96 .
ªtuöt16
-.
L°‹e_èbÀ


97 .
ªtsöt16
-.
L°‹e_èbÀ


98 .
ªtöt
-.
L°‹e_èbÀ


99 .
ªtöt
-.
L°‹e_èbÀ


100 .
ªtöt64
-.
L°‹e_èbÀ


101 .
ªtöt64
-.
L°‹e_èbÀ


102 .
ªt°ru˘
-.
L°‹e_èbÀ


103 .
ªtöt
-.
L°‹e_èbÀ


106 
p›
 %
esi


107 
	`add
 (%
esi
, %
ecx
, 4), %esi

108 
jmp
 *%
esi


111 
ªtsöt8
:

112 
movsbl
 %
Æ
, %
óx


113 
jmp
 
ªtöt


115 
ªtsöt16
:

116 
movswl
 %
ax
, %
óx


117 
jmp
 
ªtöt


119 
ªtuöt8
:

120 
movzbl
 %
Æ
, %
óx


121 
jmp
 
ªtöt


123 
ªtuöt16
:

124 
movzwl
 %
ax
, %
óx


125 
jmp
 
ªtöt


127 
ªtÊﬂt
:

129 
movl
 24(%
ebp
),%
ecx


130 
	`f°ps
 (%
ecx
)

131 
jmp
 
ïûogue


133 
ªtdoubÀ
:

135 
movl
 24(%
ebp
),%
ecx


136 
	`f°∂
 (%
ecx
)

137 
jmp
 
ïûogue


139 
ªé⁄gdoubÀ
:

141 
movl
 24(%
ebp
),%
ecx


142 
	`f°±
 (%
ecx
)

143 
jmp
 
ïûogue


145 
ªtöt64
:

147 
movl
 24(%
ebp
),%
ecx


148 
movl
 %
óx
,0(%
ecx
)

149 
movl
 %
edx
,4(%
ecx
)

150 
jmp
 
ïûogue


152 
ªtöt
:

154 
movl
 24(%
ebp
),%
ecx


155 
movl
 %
óx
,0(%
ecx
)

157 
ªt°ru˘
:

160 
n‹ëvÆ
:

161 
ïûogue
:

162 
p›l
 %
esi


163 
movl
 %
ebp
,%
e•


164 
p›l
 %
ebp


165 
ªt


166 .
LFE1
:

167 .
ffi_ˇŒ_SYSV_íd
:

168 .
size
 
ffi_ˇŒ_SYSV
,.
ffi_ˇŒ_SYSV_íd
-ffi_call_SYSV

170 .
Æign
 4

171 
	`FFI_HIDDEN
 (
ffi_˛osuª_SYSV
)

172 .
globl
 
ffi_˛osuª_SYSV


173 .
ty≥
 
ffi_˛osuª_SYSV
, @
fun˘i⁄


175 
ffi_˛osuª_SYSV
:

176 .
LFB2
:

177 
pushl
 %
ebp


178 .
LCFI2
:

179 
movl
 %
e•
, %
ebp


180 .
LCFI3
:

181 
subl
 
$40
, %
e•


182 
ÀÆ
 -24(%
ebp
), %
edx


183 
movl
 %
edx
, -12(%
ebp
)

184 
ÀÆ
 8(%
ebp
), %
edx


185 #ifde‡
__SUNPRO_C


189 
movl
 %
edx
, 8(%
e•
)

190 
ÀÆ
 -12(%
ebp
), %
edx


191 
movl
 %
edx
, 4(%
e•
)

192 
movl
 %
óx
, (%
e•
)

194 
movl
 %
edx
, 4(%
e•
)

195 
ÀÆ
 -12(%
ebp
), %
edx


196 
movl
 %
edx
, (%
e•
)

198 #i‡
deföed
 
HAVE_HIDDEN_VISIBILITY_ATTRIBUTE
 || !deföed 
__PIC__


199 
ˇŒ
 
ffi_˛osuª_SYSV_ö√r


201 
movl
 %
ebx
, 8(%
e•
)

202 .
LCFI7
:

203 
ˇŒ
 1f

204 1: 
p›l
 %
ebx


205 
addl
 
$_GLOBAL_OFFSET_TABLE_
+[.-1b], %
ebx


206 
ˇŒ
 
ffi_˛osuª_SYSV_ö√r
@
PLT


207 
movl
 8(%
e•
), %
ebx


209 
movl
 -12(%
ebp
), %
ecx


210 
cm∂
 
$FFI_TYPE_INT
, %
óx


211 
je
 .
L˛s_ªtöt


215 
cm∂
 
$FFI_TYPE_UINT64
, %
óx


216 
jge
 0f

217 
cm∂
 
$FFI_TYPE_UINT8
, %
óx


218 
jge
 .
L˛s_ªtöt


220 0: 
cm∂
 
$FFI_TYPE_FLOAT
, %
óx


221 
je
 .
L˛s_ªtÊﬂt


222 
cm∂
 
$FFI_TYPE_DOUBLE
, %
óx


223 
je
 .
L˛s_ªtdoubÀ


224 
cm∂
 
$FFI_TYPE_LONGDOUBLE
, %
óx


225 
je
 .
L˛s_ªédoubÀ


226 
cm∂
 
$FFI_TYPE_SINT64
, %
óx


227 
je
 .
L˛s_ªél⁄g


228 
cm∂
 
$FFI_TYPE_STRUCT
, %
óx


229 
je
 .
L˛s_ªt°ru˘


230 .
L˛s_ïûogue
:

231 
movl
 %
ebp
, %
e•


232 
p›l
 %
ebp


233 
ªt


234 .
L˛s_ªtöt
:

235 
	`movl
 (%
ecx
), %
óx


236 
jmp
 .
L˛s_ïûogue


237 .
L˛s_ªtÊﬂt
:

238 
	`Êds
 (%
ecx
)

239 
jmp
 .
L˛s_ïûogue


240 .
L˛s_ªtdoubÀ
:

241 
	`Êdl
 (%
ecx
)

242 
jmp
 .
L˛s_ïûogue


243 .
L˛s_ªédoubÀ
:

244 
	`Êdt
 (%
ecx
)

245 
jmp
 .
L˛s_ïûogue


246 .
L˛s_ªél⁄g
:

247 
	`movl
 (%
ecx
), %
óx


248 
movl
 4(%
ecx
), %
edx


249 
jmp
 .
L˛s_ïûogue


250 .
L˛s_ªt°ru˘
:

251 
movl
 %
ebp
, %
e•


252 
p›l
 %
ebp


253 
ªt
 
$4


254 .
LFE2
:

255 .
size
 
ffi_˛osuª_SYSV
, .-ffi_closure_SYSV

257 #i‡!
FFI_NO_RAW_API


260 #i‡
FFI_TRAMPOLINE_SIZE
 == 10

261 
	#RAW_CLOSURE_CIF_OFFSET
 12

	)

262 
	#RAW_CLOSURE_FUN_OFFSET
 16

	)

263 
	#RAW_CLOSURE_USER_DATA_OFFSET
 20

	)

264 #ñi‡
FFI_TRAMPOLINE_SIZE
 == 24

265 
	#RAW_CLOSURE_CIF_OFFSET
 24

	)

266 
	#RAW_CLOSURE_FUN_OFFSET
 28

	)

267 
	#RAW_CLOSURE_USER_DATA_OFFSET
 32

	)

269 
	#RAW_CLOSURE_CIF_OFFSET
 ((
FFI_TRAMPOLINE_SIZE
 + 3Ë& ~3)

	)

270 
	#RAW_CLOSURE_FUN_OFFSET
 (
RAW_CLOSURE_CIF_OFFSET
 + 4)

	)

271 
	#RAW_CLOSURE_USER_DATA_OFFSET
 (
RAW_CLOSURE_FUN_OFFSET
 + 4)

	)

273 
	#CIF_FLAGS_OFFSET
 20

	)

275 .
Æign
 4

276 
	`FFI_HIDDEN
 (
ffi_˛osuª_øw_SYSV
)

277 .
globl
 
ffi_˛osuª_øw_SYSV


278 .
ty≥
 
ffi_˛osuª_øw_SYSV
, @
fun˘i⁄


280 
ffi_˛osuª_øw_SYSV
:

281 .
LFB3
:

282 
pushl
 %
ebp


283 .
LCFI4
:

284 
movl
 %
e•
, %
ebp


285 .
LCFI5
:

286 
pushl
 %
esi


287 .
LCFI6
:

288 
subl
 
$36
, %
e•


289 
movl
 
	`RAW_CLOSURE_CIF_OFFSET
(%
óx
), %
esi


290 
movl
 
	`RAW_CLOSURE_USER_DATA_OFFSET
(%
óx
), %
edx


291 
movl
 %
edx
, 12(%
e•
)

292 
ÀÆ
 8(%
ebp
), %
edx


293 
movl
 %
edx
, 8(%
e•
)

294 
ÀÆ
 -24(%
ebp
), %
edx


295 
movl
 %
edx
, 4(%
e•
)

296 
movl
 %
esi
, (%
e•
)

297 
ˇŒ
 *
	`RAW_CLOSURE_FUN_OFFSET
(%
óx
)

298 
movl
 
	`CIF_FLAGS_OFFSET
(%
esi
), %
óx


299 
cm∂
 
$FFI_TYPE_INT
, %
óx


300 
je
 .
Lr˛s_ªtöt


304 
cm∂
 
$FFI_TYPE_UINT64
, %
óx


305 
jge
 0f

306 
cm∂
 
$FFI_TYPE_UINT8
, %
óx


307 
jge
 .
Lr˛s_ªtöt


309 
cm∂
 
$FFI_TYPE_FLOAT
, %
óx


310 
je
 .
Lr˛s_ªtÊﬂt


311 
cm∂
 
$FFI_TYPE_DOUBLE
, %
óx


312 
je
 .
Lr˛s_ªtdoubÀ


313 
cm∂
 
$FFI_TYPE_LONGDOUBLE
, %
óx


314 
je
 .
Lr˛s_ªédoubÀ


315 
cm∂
 
$FFI_TYPE_SINT64
, %
óx


316 
je
 .
Lr˛s_ªél⁄g


317 .
Lr˛s_ïûogue
:

318 
addl
 
$36
, %
e•


319 
p›l
 %
esi


320 
p›l
 %
ebp


321 
ªt


322 .
Lr˛s_ªtöt
:

323 
movl
 -24(%
ebp
), %
óx


324 
jmp
 .
Lr˛s_ïûogue


325 .
Lr˛s_ªtÊﬂt
:

326 
Êds
 -24(%
ebp
)

327 
jmp
 .
Lr˛s_ïûogue


328 .
Lr˛s_ªtdoubÀ
:

329 
Êdl
 -24(%
ebp
)

330 
jmp
 .
Lr˛s_ïûogue


331 .
Lr˛s_ªédoubÀ
:

332 
Êdt
 -24(%
ebp
)

333 
jmp
 .
Lr˛s_ïûogue


334 .
Lr˛s_ªél⁄g
:

335 
movl
 -24(%
ebp
), %
óx


336 
movl
 -20(%
ebp
), %
edx


337 
jmp
 .
Lr˛s_ïûogue


338 .
LFE3
:

339 .
size
 
ffi_˛osuª_øw_SYSV
, .-ffi_closure_raw_SYSV

342 #i‡
deföed
 
__GNUC__


345 #i‡
deföed
 
__PIC__


346 #i‡
deföed
 
__sun__
 && deföed 
__svr4__


349 
	#FDE_ENCODING
 0x30

	)

350 
	#FDE_ENCODE
(
X
ËX@
GOTOFF


	)

352 
	#FDE_ENCODING
 0x1b

	)

353 #i‡
deföed
 
HAVE_AS_X86_PCREL


354 
	#FDE_ENCODE
(
X
ËX-.

	)

356 
	#FDE_ENCODE
(
X
ËX@
ªl


	)

360 
	#FDE_ENCODING
 0

	)

361 
	#FDE_ENCODE
(
X
Ë
	)
X

364 .
£˘i⁄
 .
eh_‰ame
,
EH_FRAME_FLAGS
,@
¥ogbôs


365 .
L‰ame1
:

366 ..
LECIE1
-.
LSCIE1


367 .
LSCIE1
:

369 .
byã
 0x1

370 #ifde‡
HAVE_AS_ASCII_PSEUDO_OP


371 #ifde‡
__PIC__


372 .
ascii
 "zR\0"

374 .
ascii
 "\0"

376 #ñi‡
deföed
 
HAVE_AS_STRING_PSEUDO_OP


377 #ifde‡
__PIC__


378 .
°rög
 "zR"

380 .
°rög
 ""

383 #îr‹ 
missög
 .
ascii
/.
°rög


385 .
byã
 0x1

386 .
byã
 0x7c

387 .
byã
 0x8

388 #ifde‡
__PIC__


389 .
byã
 0x1

390 .
byã
 
FDE_ENCODING


392 .
byã
 0xc

393 .
byã
 0x4

394 .
byã
 0x4

395 .
byã
 0x88

396 .
byã
 0x1

397 .
Æign
 4

398 .
LECIE1
:

399 .
LSFDE1
:

400 ..
LEFDE1
-.
LASFDE1


401 .
LASFDE1
:

402 ..
LASFDE1
-.
L‰ame1


403 .
	`FDE_ENCODE
(.
LFB1
)

404 ..
LFE1
-.
LFB1


405 #ifde‡
__PIC__


406 .
byã
 0x0

408 .
byã
 0x4

409 ..
LCFI0
-.
LFB1


410 .
byã
 0xe

411 .
byã
 0x8

412 .
byã
 0x85

413 .
byã
 0x2

414 .
byã
 0x4

415 ..
LCFI1
-.
LCFI0


416 .
byã
 0xd

417 .
byã
 0x5

418 .
Æign
 4

419 .
LEFDE1
:

420 .
LSFDE2
:

421 ..
LEFDE2
-.
LASFDE2


422 .
LASFDE2
:

423 ..
LASFDE2
-.
L‰ame1


424 .
	`FDE_ENCODE
(.
LFB2
)

425 ..
LFE2
-.
LFB2


426 #ifde‡
__PIC__


427 .
byã
 0x0

429 .
byã
 0x4

430 ..
LCFI2
-.
LFB2


431 .
byã
 0xe

432 .
byã
 0x8

433 .
byã
 0x85

434 .
byã
 0x2

435 .
byã
 0x4

436 ..
LCFI3
-.
LCFI2


437 .
byã
 0xd

438 .
byã
 0x5

439 #i‡!
deföed
 
HAVE_HIDDEN_VISIBILITY_ATTRIBUTE
 && deföed 
__PIC__


440 .
byã
 0x4

441 ..
LCFI7
-.
LCFI3


442 .
byã
 0x83

443 .
byã
 0xa

445 .
Æign
 4

446 .
LEFDE2
:

448 #i‡!
FFI_NO_RAW_API


450 .
LSFDE3
:

451 ..
LEFDE3
-.
LASFDE3


452 .
LASFDE3
:

453 ..
LASFDE3
-.
L‰ame1


454 .
	`FDE_ENCODE
(.
LFB3
)

455 ..
LFE3
-.
LFB3


456 #ifde‡
__PIC__


457 .
byã
 0x0

459 .
byã
 0x4

460 ..
LCFI4
-.
LFB3


461 .
byã
 0xe

462 .
byã
 0x8

463 .
byã
 0x85

464 .
byã
 0x2

465 .
byã
 0x4

466 ..
LCFI5
-.
LCFI4


467 .
byã
 0xd

468 .
byã
 0x5

469 .
byã
 0x4

470 ..
LCFI6
-.
LCFI5


471 .
byã
 0x86

472 .
byã
 0x3

473 .
Æign
 4

474 .
LEFDE3
:

481 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


482 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/unix64.S

29 #ifde‡
__x86_64__


30 
	#LIBFFI_ASM


	)

31 
	~<ffic⁄fig.h
>

32 
	~<ffi.h
>

34 .
	gãxt


43 .
	gÆign
 2

44 .
globl
 
	gffi_ˇŒ_unix64


45 .
ty≥
 
	gffi_ˇŒ_unix64
,@
fun˘i⁄


47 
	gffi_ˇŒ_unix64
:

48 .
LUW0
:

49 
movq
 (%
r•
), %
r10


50 
Àaq
 (%
rdi
, %
rsi
), %
øx


51 
	gmovq
 %
	grdx
, (%
	gøx
)

52 
	gmovq
 %
	grcx
, 8(%
	gøx
)

53 
	gmovq
 %
	grbp
, 16(%
	gøx
)

54 
	gmovq
 %
	gr10
, 24(%
	gøx
)

55 
	gmovq
 %
	gøx
, %
	grbp


56 .
	gLUW1
:

57 
movq
 %
rdi
, %
r10


58 
	gmovq
 %
	gr8
, %
r11


59 
	gmovl
 %
	gr9d
, %
óx


62 
movq
 (%
r10
), %
rdi


63 
	gmovq
 8(%
	gr10
), %
rsi


64 
	gmovq
 16(%
	gr10
), %
rdx


65 
	gmovq
 24(%
	gr10
), %
rcx


66 
	gmovq
 32(%
	gr10
), %
r8


67 
	gmovq
 40(%
	gr10
), %
r9


68 
	gã°l
 %
	góx
, %
óx


69 
	gjnz
 .
	gLlﬂd_s£


70 .
	gLªt_‰om_lﬂd_s£
:

73 
Àaq
 176(%
r10
), %
r•


76 
	gˇŒ
 *%
r11


79 
	gÀaq
 24(%
	grbp
), %
r•


81 
	gmovq
 0(%
	grbp
), %
rcx


82 
	gmovq
 8(%
	grbp
), %
rdi


83 
	gmovq
 16(%
	grbp
), %rbp

84 .
	gLUW2
:

87 
movzbl
 %
˛
, %
r10d


88 
	gÀaq
 .
L°‹e_èbÀ
(%
rù
), %
r11


89 
mov¶q
 (%
r11
, %
r10
, 4), %r10

90 
	gaddq
 %
	gr11
, %
r10


91 
	gjmp
 *%
	gr10


93 .
	gL°‹e_èbÀ
:

94 ..
L°_void
-.
L°‹e_èbÀ


95 ..
L°_söt32
-.
L°‹e_èbÀ


96 ..
L°_Êﬂt
-.
L°‹e_èbÀ


97 ..
L°_doubÀ
-.
L°‹e_èbÀ


98 ..
L°_ldoubÀ
-.
L°‹e_èbÀ


99 ..
L°_uöt8
-.
L°‹e_èbÀ


100 ..
L°_söt8
-.
L°‹e_èbÀ


101 ..
L°_uöt16
-.
L°‹e_èbÀ


102 ..
L°_söt16
-.
L°‹e_èbÀ


103 ..
L°_uöt32
-.
L°‹e_èbÀ


104 ..
L°_söt32
-.
L°‹e_èbÀ


105 ..
L°_öt64
-.
L°‹e_èbÀ


106 ..
L°_öt64
-.
L°‹e_èbÀ


107 ..
L°_°ru˘
-.
L°‹e_èbÀ


108 ..
L°_öt64
-.
L°‹e_èbÀ


110 .
Æign
 2

111 .
L°_void
:

112 
ªt


113 .
Æign
 2

115 .
L°_uöt8
:

116 
movzbq
 %
Æ
, %
øx


117 
	gmovq
 %
	gøx
, (%
	grdi
)

118 
	gªt


119 .
	gÆign
 2

120 .
	gL°_söt8
:

121 
movsbq
 %
Æ
, %
øx


122 
	gmovq
 %
	gøx
, (%
	grdi
)

123 
	gªt


124 .
	gÆign
 2

125 .
	gL°_uöt16
:

126 
movzwq
 %
ax
, %
øx


127 
	gmovq
 %
	gøx
, (%
	grdi
)

128 .
	gÆign
 2

129 .
	gL°_söt16
:

130 
movswq
 %
ax
, %
øx


131 
	gmovq
 %
	gøx
, (%
	grdi
)

132 
	gªt


133 .
	gÆign
 2

134 .
	gL°_uöt32
:

135 
movl
 %
óx
, %eax

136 
	gmovq
 %
	gøx
, (%
	grdi
)

137 .
	gÆign
 2

138 .
	gL°_söt32
:

139 
˛tq


140 
movq
 %
øx
, (%
	grdi
)

141 
	gªt


142 .
	gÆign
 2

143 .
	gL°_öt64
:

144 
movq
 %
øx
, (%
	grdi
)

145 
	gªt


147 .
	gÆign
 2

148 .
	gL°_Êﬂt
:

149 
movss
 %
xmm0
, (%
	grdi
)

150 
	gªt


151 .
	gÆign
 2

152 .
	gL°_doubÀ
:

153 
movsd
 %
xmm0
, (%
	grdi
)

154 
	gªt


155 .
	gL°_ldoubÀ
:

156 
f°±
 (%
rdi
)

157 
ªt


159 .
Æign
 2

160 .
L°_°ru˘
:

161 
Àaq
 -20(%
r•
), %
rsi


168 
	gmovd
 %
	gxmm0
, %
r10


169 
	gmovd
 %
	gxmm1
, %
r11


170 
ã°l
 
	g$0x100
, %
ecx


171 
	gcmovnz
 %
	gøx
, %
rdx


172 
	gcmovnz
 %
	gr10
, %
øx


173 
ã°l
 
	g$0x200
, %
ecx


174 
	gcmovnz
 %
	gr10
, %
rdx


175 
ã°l
 
	g$0x400
, %
ecx


176 
	gcmovnz
 %
	gr10
, %
øx


177 
	gcmovnz
 %
	gr11
, %
rdx


178 
	gmovq
 %
	gøx
, (%
	grsi
)

179 
	gmovq
 %
	grdx
, 8(%
	grsi
)

183 
shæ
 
	g$12
, %
ecx


184 
ªp
 
movsb


185 
	gªt


190 .
	gÆign
 2

191 .
	gLUW3
:

192 .
Llﬂd_s£
:

193 
movdqa
 48(%
r10
), %
xmm0


194 
	gmovdqa
 64(%
	gr10
), %
xmm1


195 
	gmovdqa
 80(%
	gr10
), %
xmm2


196 
	gmovdqa
 96(%
	gr10
), %
xmm3


197 
	gmovdqa
 112(%
	gr10
), %
xmm4


198 
	gmovdqa
 128(%
	gr10
), %
xmm5


199 
	gmovdqa
 144(%
	gr10
), %
xmm6


200 
	gmovdqa
 160(%
	gr10
), %
xmm7


201 
	gjmp
 .
	gLªt_‰om_lﬂd_s£


203 .
	gLUW4
:

204 .
size
 
ffi_ˇŒ_unix64
,.-
	gffi_ˇŒ_unix64


206 .
	gÆign
 2

207 .
globl
 
	gffi_˛osuª_unix64


208 .
ty≥
 
	gffi_˛osuª_unix64
,@
fun˘i⁄


210 
	gffi_˛osuª_unix64
:

211 .
LUW5
:

214 
Àaq
 -200(%
r•
), %
	gr•


215 .
	gLUW6
:

216 
movq
 %
rdi
, (%
	gr•
)

217 
	gmovq
 %
	grsi
, 8(%
	gr•
)

218 
	gmovq
 %
	grdx
, 16(%
	gr•
)

219 
	gmovq
 %
	grcx
, 24(%
	gr•
)

220 
	gmovq
 %
	gr8
, 32(%
	gr•
)

221 
	gmovq
 %
	gr9
, 40(%
	gr•
)

222 
	gjc
 .
	gLßve_s£


223 .
	gLªt_‰om_ßve_s£
:

225 
movq
 %
r10
, %
rdi


226 
	gÀaq
 176(%
	gr•
), %
rsi


227 
	gmovq
 %
	gr•
, %
rdx


228 
	gÀaq
 208(%
	gr•
), %
rcx


229 
ˇŒ
 
	gffi_˛osuª_unix64_ö√r
@
PLT


232 
addq
 
	g$200
, %
	gr•


233 .
	gLUW7
:

236 
movzbl
 %
Æ
, %
r10d


237 
	gÀaq
 .
Llﬂd_èbÀ
(%
rù
), %
r11


238 
mov¶q
 (%
r11
, %
r10
, 4), %r10

239 
	gaddq
 %
	gr11
, %
r10


240 
	gjmp
 *%
	gr10


242 .
	gLlﬂd_èbÀ
:

243 ..
Lld_void
-.
Llﬂd_èbÀ


244 ..
Lld_öt32
-.
Llﬂd_èbÀ


245 ..
Lld_Êﬂt
-.
Llﬂd_èbÀ


246 ..
Lld_doubÀ
-.
Llﬂd_èbÀ


247 ..
Lld_ldoubÀ
-.
Llﬂd_èbÀ


248 ..
Lld_öt8
-.
Llﬂd_èbÀ


249 ..
Lld_öt8
-.
Llﬂd_èbÀ


250 ..
Lld_öt16
-.
Llﬂd_èbÀ


251 ..
Lld_öt16
-.
Llﬂd_èbÀ


252 ..
Lld_öt32
-.
Llﬂd_èbÀ


253 ..
Lld_öt32
-.
Llﬂd_èbÀ


254 ..
Lld_öt64
-.
Llﬂd_èbÀ


255 ..
Lld_öt64
-.
Llﬂd_èbÀ


256 ..
Lld_°ru˘
-.
Llﬂd_èbÀ


257 ..
Lld_öt64
-.
Llﬂd_èbÀ


259 .
Æign
 2

260 .
Lld_void
:

261 
ªt


263 .
Æign
 2

264 .
Lld_öt8
:

265 
movzbl
 -24(%
r•
), %
óx


266 
	gªt


267 .
	gÆign
 2

268 .
	gLld_öt16
:

269 
movzwl
 -24(%
r•
), %
óx


270 
	gªt


271 .
	gÆign
 2

272 .
	gLld_öt32
:

273 
movl
 -24(%
r•
), %
óx


274 
	gªt


275 .
	gÆign
 2

276 .
	gLld_öt64
:

277 
movq
 -24(%
r•
), %
øx


278 
	gªt


280 .
	gÆign
 2

281 .
	gLld_Êﬂt
:

282 
movss
 -24(%
r•
), %
xmm0


283 
	gªt


284 .
	gÆign
 2

285 .
	gLld_doubÀ
:

286 
movsd
 -24(%
r•
), %
xmm0


287 
	gªt


288 .
	gÆign
 2

289 .
	gLld_ldoubÀ
:

290 
Êdt
 -24(%
r•
)

291 
ªt


293 .
Æign
 2

294 .
Lld_°ru˘
:

300 
movq
 -24(%
r•
), %
rcx


301 
	gmovq
 -16(%
	gr•
), %
rdx


302 
	gmovq
 -16(%
	gr•
), %
xmm1


303 
ã°l
 
	g$0x100
, %
óx


304 
	gcmovnz
 %
	grdx
, %
rcx


305 
	gmovd
 %
	grcx
, %
xmm0


306 
ã°l
 
	g$0x200
, %
óx


307 
	gmovq
 -24(%
	gr•
), %
øx


308 
	gcmovnz
 %
	grdx
, %
øx


309 
	gªt


312 .
	gÆign
 2

313 .
	gLUW8
:

314 .
Lßve_s£
:

315 
movdqa
 %
xmm0
, 48(%
	gr•
)

316 
	gmovdqa
 %
	gxmm1
, 64(%
	gr•
)

317 
	gmovdqa
 %
	gxmm2
, 80(%
	gr•
)

318 
	gmovdqa
 %
	gxmm3
, 96(%
	gr•
)

319 
	gmovdqa
 %
	gxmm4
, 112(%
	gr•
)

320 
	gmovdqa
 %
	gxmm5
, 128(%
	gr•
)

321 
	gmovdqa
 %
	gxmm6
, 144(%
	gr•
)

322 
	gmovdqa
 %
	gxmm7
, 160(%
	gr•
)

323 
	gjmp
 .
	gLªt_‰om_ßve_s£


325 .
	gLUW9
:

326 .
size
 
ffi_˛osuª_unix64
,.-
	gffi_˛osuª_unix64


328 #ifde‡
__GNUC__


331 #ifde‡
HAVE_AS_X86_64_UNWIND_SECTION_TYPE


332 .
	g£˘i⁄
 .
	geh_‰ame
,"a",@
	gunwöd


334 .
	g£˘i⁄
 .
	geh_‰ame
,"a",@
	g¥ogbôs


336 .
	gL‰ame1
:

337 ..
LECIE1
-.
LSCIE1


338 .
LSCIE1
:

340 .
byã
 1

341 .
ascii
 "zR\0"

342 .
uÀb128
 1

343 .
¶eb128
 -8

344 .
byã
 0x10

345 .
uÀb128
 1

346 .
byã
 0x1b

347 .
byã
 0xc

348 .
uÀb128
 7

349 .
uÀb128
 8

350 .
byã
 0x80+16

351 .
uÀb128
 1

352 .
Æign
 8

353 .
LECIE1
:

354 .
LSFDE1
:

355 ..
LEFDE1
-.
LASFDE1


356 .
LASFDE1
:

357 ..
LASFDE1
-.
L‰ame1


358 #i‡
HAVE_AS_X86_PCREL


359 ..
LUW0
-.

361 ..
LUW0
@
ªl


363 ..
LUW4
-.
LUW0


364 .
uÀb128
 0x0

366 .
byã
 0x4

367 ..
LUW1
-.
LUW0


376 .
byã
 0xc

377 .
uÀb128
 6

378 .
uÀb128
 32

379 .
byã
 0x80+6

380 .
uÀb128
 2

381 .
byã
 0xa

383 .
byã
 0x4

384 ..
LUW2
-.
LUW1


385 .
byã
 0xc

386 .
uÀb128
 7

387 .
uÀb128
 8

388 .
byã
 0xc0+6

390 .
byã
 0x4

391 ..
LUW3
-.
LUW2


392 .
byã
 0xb

394 .
Æign
 8

395 .
LEFDE1
:

396 .
LSFDE3
:

397 ..
LEFDE3
-.
LASFDE3


398 .
LASFDE3
:

399 ..
LASFDE3
-.
L‰ame1


400 #i‡
HAVE_AS_X86_PCREL


401 ..
LUW5
-.

403 ..
LUW5
@
ªl


405 ..
LUW9
-.
LUW5


406 .
uÀb128
 0x0

408 .
byã
 0x4

409 ..
LUW6
-.
LUW5


410 .
byã
 0xe

411 .
uÀb128
 208

412 .
byã
 0xa

414 .
byã
 0x4

415 ..
LUW7
-.
LUW6


416 .
byã
 0xe

417 .
uÀb128
 8

419 .
byã
 0x4

420 ..
LUW8
-.
LUW7


421 .
byã
 0xb

423 .
Æign
 8

424 .
LEFDE3
:

430 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


431 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
	g¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/win32.S

33 
	#LIBFFI_ASM


	)

34 
	~<ffic⁄fig.h
>

35 
	~<ffi.h
>

37 
	#CIF_BYTES_OFFSET
 16

	)

38 
	#CIF_FLAGS_OFFSET
 20

	)

40 #ifde‡
_MSC_VER


42 
	#CLOSURE_CIF_OFFSET
 ((
FFI_TRAMPOLINE_SIZE
 + 3Ë
AND
 
NOT
 3)

	)

45 .
MODEL
 
	gFLAT
, 
C


47 
EXTRN
 
	gffi_˛osuª_SYSV_ö√r
:
NEAR


48 
EXTRN
 
ffi_˛osuª_WIN32_ö√r
:
NEAR


50 
_TEXT
 
SEGMENT


52 
ffi_ˇŒ_wö32
 
PROC
 
NEAR
,

53 
	gffi_¥ï_¨gs
 : 
NEAR
 
PTR
 
DWORD
,

54 
	gecif
 : 
NEAR
 
PTR
 
DWORD
,

55 
	gcif_abi
 : 
DWORD
,

56 
	gcif_byãs
 : 
DWORD
,

57 
	gcif_Êags
 : 
DWORD
,

58 
	grvÆue
 : 
NEAR
 
PTR
 
DWORD
,

59 
	g‚
 : 
NEAR
 
PTR
 
DWORD


61 ;; 
Make
 
room
 
Æl
 
of
 
the
 
√w
 
	g¨gs
.

62 
mov
 
	gecx
, 
cif_byãs


63 
sub
 
	ge•
, 
ecx


65 
mov
 
	góx
, 
	ge•


67 ;; 
CÆl
 
ffi_¥ï_¨gs


68 
push
 
ecif


69 
push
 
óx


70 
ˇŒ
 
ffi_¥ï_¨gs


71 
add
 
	ge•
, 8

73 ;; 
Pª∑ª
 
	gªgi°îs


74 ;; 
EAX
 
°‹es
 
the
 
numbî
 
of
 
¨gumíts


75 
cmp
 
	góx
, 0

76 
je
 
fun


77 
cmp
 
	góx
, 3

78 
jl
 
¥ïr_two_cmp


80 
mov
 
	gecx
, 
e•


81 
add
 
	ge•
, 12

82 
mov
 
	góx
, 
DWORD
 
	gPTR
 [
ecx
+8]

83 
jmp
 
¥ïr_two


84 
	g¥ïr_two_cmp
:

85 
cmp
 
óx
, 2

86 
jl
 
¥ïr_⁄e_¥ï


87 
mov
 
	gecx
, 
e•


88 
add
 
	ge•
, 8

89 
	g¥ïr_two
:

90 
mov
 
edx
, 
DWORD
 
	gPTR
 [
ecx
+4]

91 
jmp
 
¥ïr_⁄e


92 
	g¥ïr_⁄e_¥ï
:

93 
mov
 
ecx
, 
e•


94 
add
 
	ge•
, 4

95 
	g¥ïr_⁄e
:

96 
mov
 
ecx
, 
DWORD
 
	gPTR
 [ecx]

97 
cmp
 
	gcif_abi
, 7 ;; 
FFI_REGISTER


98 
j√
 
fun


100 
xchg
 
	gecx
, 
óx


102 
	gfun
:

103 ;; 
CÆl
 
fun˘i⁄


104 
ˇŒ
 
	g‚


106 ;; 
Lﬂd
 
ecx
 
wôh
 
the
  
ty≥
 
code


107 
mov
 
	gecx
, 
	gcif_Êags


109 ;; 
If
 
the
  
vÆue
 
poöãr
 
is
 
	gNULL
, 
assume
 
no
  
	gvÆue
.

110 
cmp
 
	grvÆue
, 0

111 
j√
 
	gˇ_jum±abÀ


113 ;; 
Eví
 
thîe
 
is
 
no
 
•a˚
 
the
  
	gvÆue
, 
we
 
	g¨e


114 ;; 
obliged
 
to
 
h™dÀ
 
	gÊﬂtög
-
poöt
 
	gvÆues
.

115 
cmp
 
	gecx
, 
FFI_TYPE_FLOAT


116 
j√
 
ˇ_ïûogue


117 
f°p
 
	$°
(0)

119 
jmp
 
ˇ_ïûogue


121 
ˇ_jum±abÀ
:

122 
jmp
 [
ˇ_jumpd©a
 + 4 * 
ecx
]

123 
ˇ_jumpd©a
:

124 ;; 
Do
 
nŸ
 
ö£π
 
™ythög
 
hîe
 
bëwìn
 
œbñ
 
™d
 
jump
 
èbÀ
.

125 
dd
 
off£t
 
ˇ_ïûogue
 ;; 
FFI_TYPE_VOID


126 
dd
 
off£t
 
ˇ_ªtöt
 ;; 
FFI_TYPE_INT


127 
dd
 
off£t
 
ˇ_ªtÊﬂt
 ;; 
FFI_TYPE_FLOAT


128 
dd
 
off£t
 
ˇ_ªtdoubÀ
 ;; 
FFI_TYPE_DOUBLE


129 
dd
 
off£t
 
ˇ_ªé⁄gdoubÀ
 ;; 
FFI_TYPE_LONGDOUBLE


130 
dd
 
off£t
 
ˇ_ªtuöt8
 ;; 
FFI_TYPE_UINT8


131 
dd
 
off£t
 
ˇ_ªtsöt8
 ;; 
FFI_TYPE_SINT8


132 
dd
 
off£t
 
ˇ_ªtuöt16
 ;; 
FFI_TYPE_UINT16


133 
dd
 
off£t
 
ˇ_ªtsöt16
 ;; 
FFI_TYPE_SINT16


134 
dd
 
off£t
 
ˇ_ªtöt
 ;; 
FFI_TYPE_UINT32


135 
dd
 
off£t
 
ˇ_ªtöt
 ;; 
FFI_TYPE_SINT32


136 
dd
 
off£t
 
ˇ_ªtöt64
 ;; 
FFI_TYPE_UINT64


137 
dd
 
off£t
 
ˇ_ªtöt64
 ;; 
FFI_TYPE_SINT64


138 
dd
 
off£t
 
ˇ_ïûogue
 ;; 
FFI_TYPE_STRUCT


139 
dd
 
off£t
 
ˇ_ªtöt
 ;; 
FFI_TYPE_POINTER


140 
dd
 
off£t
 
ˇ_ªt°ru˘1b
 ;; 
FFI_TYPE_SMALL_STRUCT_1B


141 
dd
 
off£t
 
ˇ_ªt°ru˘2b
 ;; 
FFI_TYPE_SMALL_STRUCT_2B


142 
dd
 
off£t
 
ˇ_ªtöt
 ;; 
FFI_TYPE_SMALL_STRUCT_4B


143 
dd
 
off£t
 
ˇ_ïûogue
 ;; 
FFI_TYPE_MS_STRUCT


146 
ˇ_ªtuöt8
:

147 
movzx
 
óx
, 
Æ


148 
jmp
 
ˇ_ªtöt


150 
ˇ_ªtsöt8
:

151 
movsx
 
óx
, 
Æ


152 
jmp
 
ˇ_ªtöt


154 
ˇ_ªtuöt16
:

155 
movzx
 
óx
, 
ax


156 
jmp
 
ˇ_ªtöt


158 
ˇ_ªtsöt16
:

159 
movsx
 
óx
, 
ax


160 
jmp
 
ˇ_ªtöt


162 
ˇ_ªtöt
:

163 ;; 
Lﬂd
 %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


164 
mov
 
ecx
, 
rvÆue


165 
mov
 [
ecx
 + 0], 
óx


166 
jmp
 
ˇ_ïûogue


168 
ˇ_ªtöt64
:

169 ;; 
Lﬂd
 %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


170 
mov
 
ecx
, 
rvÆue


171 
mov
 [
ecx
 + 0], 
óx


172 
mov
 [
ecx
 + 4], 
edx


173 
jmp
 
ˇ_ïûogue


175 
ˇ_ªtÊﬂt
:

176 ;; 
Lﬂd
 %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


177 
mov
 
ecx
, 
rvÆue


178 
f°p
 
DWORD
 
PTR
 [
ecx
]

179 
jmp
 
ˇ_ïûogue


181 
ˇ_ªtdoubÀ
:

182 ;; 
Lﬂd
 %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


183 
mov
 
ecx
, 
rvÆue


184 
f°p
 
QWORD
 
PTR
 [
ecx
]

185 
jmp
 
ˇ_ïûogue


187 
ˇ_ªé⁄gdoubÀ
:

188 ;; 
Lﬂd
 %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


189 
mov
 
ecx
, 
rvÆue


190 
f°p
 
TBYTE
 
PTR
 [
ecx
]

191 
jmp
 
ˇ_ïûogue


193 
ˇ_ªt°ru˘1b
:

194 ;; 
Lﬂd
 %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


195 
mov
 
ecx
, 
rvÆue


196 
mov
 [
ecx
 + 0], 
Æ


197 
jmp
 
ˇ_ïûogue


199 
ˇ_ªt°ru˘2b
:

200 ;; 
Lﬂd
 %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


201 
mov
 
ecx
, 
rvÆue


202 
mov
 [
ecx
 + 0], 
ax


203 
jmp
 
ˇ_ïûogue


205 
ˇ_ïûogue
:

206 ;; 
Epûogue
 
code
 
is
 
autogíî©ed
.

207 
ªt


208 
ffi_ˇŒ_wö32
 
ENDP


210 
ffi_˛osuª_THISCALL
 
PROC
 
NEAR


211 ;; 
In£π
 
the
 
¨gumít
 
⁄
Åhê
°ack
 
as
Åhê
fú°
árgument

212 
xchg
 
DWORD
 
PTR
 [
e•
+4], 
ecx


213 
xchg
 
DWORD
 
PTR
 [
e•
], 
ecx


214 
push
 
ecx


215 
jmp
 
ffi_˛osuª_STDCALL


216 
ffi_˛osuª_THISCALL
 
ENDP


218 
ffi_˛osuª_FASTCALL
 
PROC
 
NEAR


219 ;; 
In£π
 
the
 2 
¨gumíts
 
⁄
Åhê
°ack
 
as
Åhê
fú°
 
¨gumít


220 
xchg
 
DWORD
 
PTR
 [
e•
+4], 
edx


221 
xchg
 
DWORD
 
PTR
 [
e•
], 
ecx


222 
push
 
edx


223 
push
 
ecx


224 
jmp
 
ffi_˛osuª_STDCALL


225 
ffi_˛osuª_FASTCALL
 
ENDP


227 
ffi_˛osuª_REGISTER
 
PROC
 
NEAR


228 ;; 
In£π
 
the
 3 
¨gumíts
 
⁄
Åhê
°ack
 
as
Åhê
fú°
 
¨gumít


229 
push
 
óx


230 
xchg
 
DWORD
 
PTR
 [
e•
+8], 
ecx


231 
xchg
 
DWORD
 
PTR
 [
e•
+4], 
edx


232 
push
 
ecx


233 
push
 
edx


234 
jmp
 
ffi_˛osuª_STDCALL


235 
ffi_˛osuª_REGISTER
 
ENDP


237 
ffi_˛osuª_SYSV
 
PROC
 
NEAR
 
FORCEFRAME


238 ;; 
the
 
ffi_˛osuª
 
˘x
 
is
 
∑s£d
 
ö
 
óx
 
by
Åhê
åampﬁöe
.

240 
sub
 
e•
, 40

241 
Àa
 
edx
, [
ebp
 - 24]

242 
mov
 [
ebp
 - 12], 
edx
 ;; 
ª•


243 
Àa
 
edx
, [
ebp
 + 8]

244 
°ub
::

245 
mov
 [
e•
 + 8], 
edx
 ;; 
¨gs


246 
Àa
 
edx
, [
ebp
 - 12]

247 
mov
 [
e•
 + 4], 
edx
 ;; &
ª•


248 
mov
 [
e•
], 
óx
 ;; 
˛osuª


249 
ˇŒ
 
ffi_˛osuª_SYSV_ö√r


250 
mov
 
ecx
, [
ebp
 - 12]

252 
cs_jum±abÀ
:

253 
jmp
 [
cs_jumpd©a
 + 4 * 
óx
]

254 
cs_jumpd©a
:

255 ;; 
Do
 
nŸ
 
ö£π
 
™ythög
 
hîe
 
bëwìn
 
the
 
œbñ
 
™d
 
jump
 
èbÀ
.

256 
dd
 
off£t
 
cs_ïûogue
 ;; 
FFI_TYPE_VOID


257 
dd
 
off£t
 
cs_ªtöt
 ;; 
FFI_TYPE_INT


258 
dd
 
off£t
 
cs_ªtÊﬂt
 ;; 
FFI_TYPE_FLOAT


259 
dd
 
off£t
 
cs_ªtdoubÀ
 ;; 
FFI_TYPE_DOUBLE


260 
dd
 
off£t
 
cs_ªé⁄gdoubÀ
 ;; 
FFI_TYPE_LONGDOUBLE


261 
dd
 
off£t
 
cs_ªtuöt8
 ;; 
FFI_TYPE_UINT8


262 
dd
 
off£t
 
cs_ªtsöt8
 ;; 
FFI_TYPE_SINT8


263 
dd
 
off£t
 
cs_ªtuöt16
 ;; 
FFI_TYPE_UINT16


264 
dd
 
off£t
 
cs_ªtsöt16
 ;; 
FFI_TYPE_SINT16


265 
dd
 
off£t
 
cs_ªtöt
 ;; 
FFI_TYPE_UINT32


266 
dd
 
off£t
 
cs_ªtöt
 ;; 
FFI_TYPE_SINT32


267 
dd
 
off£t
 
cs_ªtöt64
 ;; 
FFI_TYPE_UINT64


268 
dd
 
off£t
 
cs_ªtöt64
 ;; 
FFI_TYPE_SINT64


269 
dd
 
off£t
 
cs_ªt°ru˘
 ;; 
FFI_TYPE_STRUCT


270 
dd
 
off£t
 
cs_ªtöt
 ;; 
FFI_TYPE_POINTER


271 
dd
 
off£t
 
cs_ªtsöt8
 ;; 
FFI_TYPE_SMALL_STRUCT_1B


272 
dd
 
off£t
 
cs_ªtsöt16
 ;; 
FFI_TYPE_SMALL_STRUCT_2B


273 
dd
 
off£t
 
cs_ªtöt
 ;; 
FFI_TYPE_SMALL_STRUCT_4B


274 
dd
 
off£t
 
cs_ªtms°ru˘
 ;; 
FFI_TYPE_MS_STRUCT


276 
cs_ªtuöt8
:

277 
movzx
 
óx
, 
BYTE
 
PTR
 [
ecx
]

278 
jmp
 
cs_ïûogue


280 
cs_ªtsöt8
:

281 
movsx
 
óx
, 
BYTE
 
PTR
 [
ecx
]

282 
jmp
 
cs_ïûogue


284 
cs_ªtuöt16
:

285 
movzx
 
óx
, 
WORD
 
PTR
 [
ecx
]

286 
jmp
 
cs_ïûogue


288 
cs_ªtsöt16
:

289 
movsx
 
óx
, 
WORD
 
PTR
 [
ecx
]

290 
jmp
 
cs_ïûogue


292 
cs_ªtöt
:

293 
mov
 
óx
, [
ecx
]

294 
jmp
 
cs_ïûogue


296 
cs_ªtöt64
:

297 
mov
 
óx
, [
ecx
 + 0]

298 
mov
 
edx
, [
ecx
 + 4]

299 
jmp
 
cs_ïûogue


301 
cs_ªtÊﬂt
:

302 
Êd
 
DWORD
 
PTR
 [
ecx
]

303 
jmp
 
cs_ïûogue


305 
cs_ªtdoubÀ
:

306 
Êd
 
QWORD
 
PTR
 [
ecx
]

307 
jmp
 
cs_ïûogue


309 
cs_ªé⁄gdoubÀ
:

310 
Êd
 
TBYTE
 
PTR
 [
ecx
]

311 
jmp
 
cs_ïûogue


313 
cs_ªt°ru˘
:

314 ;; 
CÆÀr
 
ex≥˘s
 
us
 
to
 
p›
  
vÆue
 
poöãr
 
hiddí
 
¨g
.

315 ;; 
Epûogue
 
code
 
is
 
autogíî©ed
.

316 
ªt
 4

318 
cs_ªtms°ru˘
:

319 ;; 
CÆÀr
 
ex≥˘s
 
us
 
to
  
a
 
poöãr
Åÿ
the
 
ªÆ
  
vÆue
.

320 
mov
 
óx
, 
ecx


321 ;; 
CÆÀr
 
d€¢
'tÉxpects usÅoÖop structÑeturn valueÖointer hiddenárg.

322 
jmp
 
cs_ïûogue


324 
cs_ïûogue
:

325 ;; 
Epûogue
 
code
 
is
 
autogíî©ed
.

326 
ªt


327 
ffi_˛osuª_SYSV
 
ENDP


329 #i‡!
FFI_NO_RAW_API


331 
	#RAW_CLOSURE_CIF_OFFSET
 ((
FFI_TRAMPOLINE_SIZE
 + 3Ë
AND
 
NOT
 3)

	)

332 
	#RAW_CLOSURE_FUN_OFFSET
 (
RAW_CLOSURE_CIF_OFFSET
 + 4)

	)

333 
	#RAW_CLOSURE_USER_DATA_OFFSET
 (
RAW_CLOSURE_FUN_OFFSET
 + 4)

	)

335 
ffi_˛osuª_øw_THISCALL
 
PROC
 
NEAR
 
USES
 
esi
 
FORCEFRAME


336 
sub
 
e•
, 36

337 
mov
 
esi
, [
óx
 + 
RAW_CLOSURE_CIF_OFFSET
] ;; 
˛osuª
->
cif


338 
mov
 
edx
, [
óx
 + 
RAW_CLOSURE_USER_DATA_OFFSET
] ;; 
˛osuª
->
u£r_d©a


339 
mov
 [
e•
 + 12], 
edx


340 
Àa
 
edx
, [
ebp
 + 12]

341 
jmp
 
°ubøw


342 
ffi_˛osuª_øw_THISCALL
 
ENDP


344 
ffi_˛osuª_øw_SYSV
 
PROC
 
NEAR
 
USES
 
esi
 
FORCEFRAME


345 ;; 
the
 
ffi_˛osuª
 
˘x
 
is
 
∑s£d
 
ö
 
óx
 
by
Åhê
åampﬁöe
.

347 
sub
 
e•
, 40

348 
mov
 
esi
, [
óx
 + 
RAW_CLOSURE_CIF_OFFSET
] ;; 
˛osuª
->
cif


349 
mov
 
edx
, [
óx
 + 
RAW_CLOSURE_USER_DATA_OFFSET
] ;; 
˛osuª
->
u£r_d©a


350 
mov
 [
e•
 + 12], 
edx
 ;; 
u£r_d©a


351 
Àa
 
edx
, [
ebp
 + 8]

352 
°ubøw
::

353 
mov
 [
e•
 + 8], 
edx
 ;; 
øw_¨gs


354 
Àa
 
edx
, [
ebp
 - 24]

355 
mov
 [
e•
 + 4], 
edx
 ;; &
ªs


356 
mov
 [
e•
], 
esi
 ;; 
cif


357 
ˇŒ
 
DWORD
 
PTR
 [
óx
 + 
RAW_CLOSURE_FUN_OFFSET
] ;; 
˛osuª
->
fun


358 
mov
 
óx
, [
esi
 + 
CIF_FLAGS_OFFSET
] ;; 
cif
->
Êags


359 
Àa
 
ecx
, [
ebp
 - 24]

361 
¸_jum±abÀ
:

362 
jmp
 [
¸_jumpd©a
 + 4 * 
óx
]

363 
¸_jumpd©a
:

364 ;; 
Do
 
nŸ
 
ö£π
 
™ythög
 
hîe
 
bëwìn
 
the
 
œbñ
 
™d
 
jump
 
èbÀ
.

365 
dd
 
off£t
 
¸_ïûogue
 ;; 
FFI_TYPE_VOID


366 
dd
 
off£t
 
¸_ªtöt
 ;; 
FFI_TYPE_INT


367 
dd
 
off£t
 
¸_ªtÊﬂt
 ;; 
FFI_TYPE_FLOAT


368 
dd
 
off£t
 
¸_ªtdoubÀ
 ;; 
FFI_TYPE_DOUBLE


369 
dd
 
off£t
 
¸_ªé⁄gdoubÀ
 ;; 
FFI_TYPE_LONGDOUBLE


370 
dd
 
off£t
 
¸_ªtuöt8
 ;; 
FFI_TYPE_UINT8


371 
dd
 
off£t
 
¸_ªtsöt8
 ;; 
FFI_TYPE_SINT8


372 
dd
 
off£t
 
¸_ªtuöt16
 ;; 
FFI_TYPE_UINT16


373 
dd
 
off£t
 
¸_ªtsöt16
 ;; 
FFI_TYPE_SINT16


374 
dd
 
off£t
 
¸_ªtöt
 ;; 
FFI_TYPE_UINT32


375 
dd
 
off£t
 
¸_ªtöt
 ;; 
FFI_TYPE_SINT32


376 
dd
 
off£t
 
¸_ªtöt64
 ;; 
FFI_TYPE_UINT64


377 
dd
 
off£t
 
¸_ªtöt64
 ;; 
FFI_TYPE_SINT64


378 
dd
 
off£t
 
¸_ïûogue
 ;; 
FFI_TYPE_STRUCT


379 
dd
 
off£t
 
¸_ªtöt
 ;; 
FFI_TYPE_POINTER


380 
dd
 
off£t
 
¸_ªtsöt8
 ;; 
FFI_TYPE_SMALL_STRUCT_1B


381 
dd
 
off£t
 
¸_ªtsöt16
 ;; 
FFI_TYPE_SMALL_STRUCT_2B


382 
dd
 
off£t
 
¸_ªtöt
 ;; 
FFI_TYPE_SMALL_STRUCT_4B


383 
dd
 
off£t
 
¸_ïûogue
 ;; 
FFI_TYPE_MS_STRUCT


385 
¸_ªtuöt8
:

386 
movzx
 
óx
, 
BYTE
 
PTR
 [
ecx
]

387 
jmp
 
¸_ïûogue


389 
¸_ªtsöt8
:

390 
movsx
 
óx
, 
BYTE
 
PTR
 [
ecx
]

391 
jmp
 
¸_ïûogue


393 
¸_ªtuöt16
:

394 
movzx
 
óx
, 
WORD
 
PTR
 [
ecx
]

395 
jmp
 
¸_ïûogue


397 
¸_ªtsöt16
:

398 
movsx
 
óx
, 
WORD
 
PTR
 [
ecx
]

399 
jmp
 
¸_ïûogue


401 
¸_ªtöt
:

402 
mov
 
óx
, [
ecx
]

403 
jmp
 
¸_ïûogue


405 
¸_ªtöt64
:

406 
mov
 
óx
, [
ecx
 + 0]

407 
mov
 
edx
, [
ecx
 + 4]

408 
jmp
 
¸_ïûogue


410 
¸_ªtÊﬂt
:

411 
Êd
 
DWORD
 
PTR
 [
ecx
]

412 
jmp
 
¸_ïûogue


414 
¸_ªtdoubÀ
:

415 
Êd
 
QWORD
 
PTR
 [
ecx
]

416 
jmp
 
¸_ïûogue


418 
¸_ªé⁄gdoubÀ
:

419 
Êd
 
TBYTE
 
PTR
 [
ecx
]

420 
jmp
 
¸_ïûogue


422 
¸_ïûogue
:

423 ;; 
Epûogue
 
code
 
is
 
autogíî©ed
.

424 
ªt


425 
ffi_˛osuª_øw_SYSV
 
ENDP


429 
ffi_˛osuª_STDCALL
 
PROC
 
NEAR
 
FORCEFRAME


430 
mov
 
óx
, [
e•
] ;; 
the
 
ffi_˛osuª
 
˘x
 
∑s£d
 
by
Åhê
åampﬁöe
.

432 
sub
 
e•
, 40

433 
Àa
 
edx
, [
ebp
 - 24]

434 
mov
 [
ebp
 - 12], 
edx
 ;; 
ª•


435 
Àa
 
edx
, [
ebp
 + 12] ;; 
accou¡
 
°ub
  
addªss
 
⁄
 
°ack


436 
mov
 [
e•
 + 8], 
edx
 ;; 
¨gs


437 
Àa
 
edx
, [
ebp
 - 12]

438 
mov
 [
e•
 + 4], 
edx
 ;; &
ª•


439 
mov
 [
e•
], 
óx
 ;; 
˛osuª


440 
ˇŒ
 
ffi_˛osuª_WIN32_ö√r


441 
mov
 
ecx
, [
ebp
 - 12]

443 
xchg
 [
ebp
 + 4], 
óx
 ;;xchg 
size
 
of
 
°ack
 
∑ømëîs
 
™d
 
ffi_˛osuª
 
˘x


444 
mov
 
óx
, 
DWORD
 
PTR
 [óx + 
CLOSURE_CIF_OFFSET
]

445 
mov
 
óx
, 
DWORD
 
PTR
 [óx + 
CIF_FLAGS_OFFSET
]

447 
cd_jum±abÀ
:

448 
jmp
 [
cd_jumpd©a
 + 4 * 
óx
]

449 
cd_jumpd©a
:

450 ;; 
Do
 
nŸ
 
ö£π
 
™ythög
 
hîe
 
bëwìn
 
the
 
œbñ
 
™d
 
jump
 
èbÀ
.

451 
dd
 
off£t
 
cd_ïûogue
 ;; 
FFI_TYPE_VOID


452 
dd
 
off£t
 
cd_ªtöt
 ;; 
FFI_TYPE_INT


453 
dd
 
off£t
 
cd_ªtÊﬂt
 ;; 
FFI_TYPE_FLOAT


454 
dd
 
off£t
 
cd_ªtdoubÀ
 ;; 
FFI_TYPE_DOUBLE


455 
dd
 
off£t
 
cd_ªé⁄gdoubÀ
 ;; 
FFI_TYPE_LONGDOUBLE


456 
dd
 
off£t
 
cd_ªtuöt8
 ;; 
FFI_TYPE_UINT8


457 
dd
 
off£t
 
cd_ªtsöt8
 ;; 
FFI_TYPE_SINT8


458 
dd
 
off£t
 
cd_ªtuöt16
 ;; 
FFI_TYPE_UINT16


459 
dd
 
off£t
 
cd_ªtsöt16
 ;; 
FFI_TYPE_SINT16


460 
dd
 
off£t
 
cd_ªtöt
 ;; 
FFI_TYPE_UINT32


461 
dd
 
off£t
 
cd_ªtöt
 ;; 
FFI_TYPE_SINT32


462 
dd
 
off£t
 
cd_ªtöt64
 ;; 
FFI_TYPE_UINT64


463 
dd
 
off£t
 
cd_ªtöt64
 ;; 
FFI_TYPE_SINT64


464 
dd
 
off£t
 
cd_ïûogue
 ;; 
FFI_TYPE_STRUCT


465 
dd
 
off£t
 
cd_ªtöt
 ;; 
FFI_TYPE_POINTER


466 
dd
 
off£t
 
cd_ªtsöt8
 ;; 
FFI_TYPE_SMALL_STRUCT_1B


467 
dd
 
off£t
 
cd_ªtsöt16
 ;; 
FFI_TYPE_SMALL_STRUCT_2B


468 
dd
 
off£t
 
cd_ªtöt
 ;; 
FFI_TYPE_SMALL_STRUCT_4B


470 
cd_ªtuöt8
:

471 
movzx
 
óx
, 
BYTE
 
PTR
 [
ecx
]

472 
jmp
 
cd_ïûogue


474 
cd_ªtsöt8
:

475 
movsx
 
óx
, 
BYTE
 
PTR
 [
ecx
]

476 
jmp
 
cd_ïûogue


478 
cd_ªtuöt16
:

479 
movzx
 
óx
, 
WORD
 
PTR
 [
ecx
]

480 
jmp
 
cd_ïûogue


482 
cd_ªtsöt16
:

483 
movsx
 
óx
, 
WORD
 
PTR
 [
ecx
]

484 
jmp
 
cd_ïûogue


486 
cd_ªtöt
:

487 
mov
 
óx
, [
ecx
]

488 
jmp
 
cd_ïûogue


490 
cd_ªtöt64
:

491 
mov
 
óx
, [
ecx
 + 0]

492 
mov
 
edx
, [
ecx
 + 4]

493 
jmp
 
cd_ïûogue


495 
cd_ªtÊﬂt
:

496 
Êd
 
DWORD
 
PTR
 [
ecx
]

497 
jmp
 
cd_ïûogue


499 
cd_ªtdoubÀ
:

500 
Êd
 
QWORD
 
PTR
 [
ecx
]

501 
jmp
 
cd_ïûogue


503 
cd_ªé⁄gdoubÀ
:

504 
Êd
 
TBYTE
 
PTR
 [
ecx
]

505 
jmp
 
cd_ïûogue


507 
cd_ïûogue
:

508 
mov
 
e•
, 
ebp


509 
p›
 
ebp


510 
mov
 
ecx
, [
e•
 + 4] ;; 
Rëu∫
 
addªss


511 
add
 
e•
, [e•] ;; 
P¨amëîs
 
°ack
 
size


512 
add
 
e•
, 8

513 
jmp
 
ecx


514 
ffi_˛osuª_STDCALL
 
ENDP


516 
_TEXT
 
ENDS


517 
END


521 
	#CLOSURE_CIF_OFFSET
 ((
FFI_TRAMPOLINE_SIZE
 + 3Ë& ~3)

	)

523 #i‡
	`deföed
(
SYMBOL_UNDERSCORE
)

524 
	#USCORE_SYMBOL
(
x
Ë
_
##
	)
x

526 
	#USCORE_SYMBOL
(
x
Ë
	)
x

528 .
ãxt


530 #Thi†
assumes
 
we
 
¨e
 
usög
 
gas
.

531 .
bÆign
 16

532 
	`FFI_HIDDEN
(
ffi_ˇŒ_wö32
)

533 .
globl
 
	$USCORE_SYMBOL
(
ffi_ˇŒ_wö32
)

534 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

535 .
def
 
_ffi_ˇŒ_wö32
; .
s˛
 2; .
ty≥
 32; .
ídef


537 
	$USCORE_SYMBOL
(
ffi_ˇŒ_wö32
):

538 .
LFB1
:

539 
pushl
 %
ebp


540 .
LCFI0
:

541 
movl
 %
e•
,%
ebp


542 .
LCFI1
:

543 #Makê
room
 
Æl
 
of
 
the
 
√w
 
¨gs
.

544 
movl
 20(%
ebp
),%
ecx


545 
subl
 %
ecx
,%
e•


547 
movl
 %
e•
,%
óx


549 #CÆ»
ffi_¥ï_¨gs


550 
pushl
 12(%
ebp
)

551 
pushl
 %
óx


552 
ˇŒ
 *8(%
ebp
)

553 
addl
 
$8
,%
e•


555 #Pª∑ª 
ªgi°îs


556 #EAX 
°‹es
 
the
 
numbî
 
of
 
¨gumíts


557 
cm∂
 
$0
, %
óx


558 
je
 .
fun


559 
cm∂
 
$3
, %
óx


560 
jl
 .
¥ïr_two_cmp


562 
movl
 %
e•
, %
ecx


563 
addl
 
$12
, %
e•


564 
movl
 8(%
ecx
), %
óx


565 
jmp
 .
¥ïr_two


566 .
¥ïr_two_cmp
:

567 
cm∂
 
$2
, %
óx


568 
jl
 .
¥ïr_⁄e_¥ï


569 
movl
 %
e•
, %
ecx


570 
addl
 
$8
, %
e•


571 .
¥ïr_two
:

572 
movl
 4(%
ecx
), %
edx


573 
jmp
 .
¥ïr_⁄e


574 .
¥ïr_⁄e_¥ï
:

575 
movl
 %
e•
, %
ecx


576 
addl
 
$4
, %
e•


577 .
¥ïr_⁄e
:

578 
	`movl
 (%
ecx
), %ecx

579 
cm∂
 
$7
, 16(%
ebp
) #FFI_REGISTER

580 
j√
 .
fun


582 
xchgl
 %
óx
, %
ecx


584 .
fun
:

585 #FIXME: 
Align
 
the
 
°ack
 
to
 
a
 128-
bô
 
bound¨y
Åÿ
avoid


586 #pŸítü»
≥rf‹m™˚
 
hôs
.

588 #CÆ»
fun˘i⁄


589 
ˇŒ
 *32(%
ebp
)

591 #°dˇŒ 
fun˘i⁄s
 
p›
 
¨gumíts
 
off
 
the
 
°ack
 
them£lves


593 #Lﬂd %
ecx
 
wôh
 
the
  
ty≥
 
code


594 
movl
 24(%
ebp
),%
ecx


596 #I‡
the
  
vÆue
 
poöãr
 
is
 
NULL
, 
assume
 
no
  value.

597 
cm∂
 
$0
,28(%
ebp
)

598 
j√
 0f

600 #Eví 
thîe
 
is
 
no
 
•a˚
 
the
  
vÆue
, 
we
 
¨e


601 #obliged 
to
 
h™dÀ
 
Êﬂtög
-
poöt
 
vÆues
.

602 
cm∂
 
$FFI_TYPE_FLOAT
,%
ecx


603 
j√
 .
Ln‹ëvÆ


604 
f°p
 %
	$°
(0)

606 
jmp
 .
Lïûogue


609 
ˇŒ
 1f

610 #Dÿ
nŸ
 
ö£π
 
™ythög
 
hîe
 
bëwìn
 
the
 
ˇŒ
 
™d
Åhê
jump
 
èbÀ
.

611 .
L°‹e_èbÀ
:

612 ..
Ln‹ëvÆ
-.
L°‹e_èbÀ


613 ..
Lªtöt
-.
L°‹e_èbÀ


614 ..
LªtÊﬂt
-.
L°‹e_èbÀ


615 ..
LªtdoubÀ
-.
L°‹e_èbÀ


616 ..
Lªé⁄gdoubÀ
-.
L°‹e_èbÀ


617 ..
Lªtuöt8
-.
L°‹e_èbÀ


618 ..
Lªtsöt8
-.
L°‹e_èbÀ


619 ..
Lªtuöt16
-.
L°‹e_èbÀ


620 ..
Lªtsöt16
-.
L°‹e_èbÀ


621 ..
Lªtöt
-.
L°‹e_èbÀ


622 ..
Lªtöt
-.
L°‹e_èbÀ


623 ..
Lªtöt64
-.
L°‹e_èbÀ


624 ..
Lªtöt64
-.
L°‹e_èbÀ


625 ..
Lªt°ru˘
-.
L°‹e_èbÀ


626 ..
Lªtöt
-.
L°‹e_èbÀ


627 ..
Lªt°ru˘1b
-.
L°‹e_èbÀ


628 ..
Lªt°ru˘2b
-.
L°‹e_èbÀ


629 ..
Lªt°ru˘4b
-.
L°‹e_èbÀ


630 ..
Lªt°ru˘
-.
L°‹e_èbÀ


632 
shl
 
$2
, %
ecx


633 
	`add
 (%
e•
),%
ecx


634 
	`mov
 (%
ecx
),%ecx

635 
	`add
 (%
e•
),%
ecx


636 
add
 
$4
, %
e•


637 
jmp
 *%
ecx


640 .
Lªtsöt8
:

641 
movsbl
 %
Æ
, %
óx


642 
jmp
 .
Lªtöt


644 .
Lªtsöt16
:

645 
movswl
 %
ax
, %
óx


646 
jmp
 .
Lªtöt


648 .
Lªtuöt8
:

649 
movzbl
 %
Æ
, %
óx


650 
jmp
 .
Lªtöt


652 .
Lªtuöt16
:

653 
movzwl
 %
ax
, %
óx


654 
jmp
 .
Lªtöt


656 .
Lªtöt
:

657 #Lﬂd %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


658 
movl
 28(%
ebp
),%
ecx


659 
movl
 %
óx
,0(%
ecx
)

660 
jmp
 .
Lïûogue


662 .
LªtÊﬂt
:

663 #Lﬂd %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


664 
movl
 28(%
ebp
),%
ecx


665 
	`f°ps
 (%
ecx
)

666 
jmp
 .
Lïûogue


668 .
LªtdoubÀ
:

669 #Lﬂd %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


670 
movl
 28(%
ebp
),%
ecx


671 
	`f°∂
 (%
ecx
)

672 
jmp
 .
Lïûogue


674 .
Lªé⁄gdoubÀ
:

675 #Lﬂd %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


676 
movl
 28(%
ebp
),%
ecx


677 
	`f°±
 (%
ecx
)

678 
jmp
 .
Lïûogue


680 .
Lªtöt64
:

681 #Lﬂd %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


682 
movl
 28(%
ebp
),%
ecx


683 
movl
 %
óx
,0(%
ecx
)

684 
movl
 %
edx
,4(%
ecx
)

685 
jmp
 .
Lïûogue


687 .
Lªt°ru˘1b
:

688 #Lﬂd %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


689 
movl
 28(%
ebp
),%
ecx


690 
movb
 %
Æ
,0(%
ecx
)

691 
jmp
 .
Lïûogue


693 .
Lªt°ru˘2b
:

694 #Lﬂd %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


695 
movl
 28(%
ebp
),%
ecx


696 
movw
 %
ax
,0(%
ecx
)

697 
jmp
 .
Lïûogue


699 .
Lªt°ru˘4b
:

700 #Lﬂd %
ecx
 
wôh
 
the
 
poöãr
 
to
 
°‹age
 thê 
vÆue


701 
movl
 28(%
ebp
),%
ecx


702 
movl
 %
óx
,0(%
ecx
)

703 
jmp
 .
Lïûogue


705 .
Lªt°ru˘
:

706 #NŸhög 
to
 do!

708 .
Ln‹ëvÆ
:

709 .
Lïûogue
:

710 
movl
 %
ebp
,%
e•


711 
p›l
 %
ebp


712 
ªt


713 .
ffi_ˇŒ_wö32_íd
:

714 .
bÆign
 16

715 
	`FFI_HIDDEN
(
ffi_˛osuª_THISCALL
)

716 .
globl
 
	$USCORE_SYMBOL
(
ffi_˛osuª_THISCALL
)

717 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

718 .
def
 
_ffi_˛osuª_THISCALL
; .
s˛
 2; .
ty≥
 32; .
ídef


720 
	$USCORE_SYMBOL
(
ffi_˛osuª_THISCALL
):

722 
xchg
 %
ecx
, 4(%
e•
)

723 
xchg
 %
ecx
, (%
e•
)

724 
push
 %
ecx


725 
jmp
 .
ffi_˛osuª_STDCALL_öã∫Æ


727 .
bÆign
 16

728 
	`FFI_HIDDEN
(
ffi_˛osuª_FASTCALL
)

729 .
globl
 
	$USCORE_SYMBOL
(
ffi_˛osuª_FASTCALL
)

730 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

731 .
def
 
_ffi_˛osuª_FASTCALL
; .
s˛
 2; .
ty≥
 32; .
ídef


733 
	$USCORE_SYMBOL
(
ffi_˛osuª_FASTCALL
):

735 
xchg
 %
edx
, 4(%
e•
)

736 
xchg
 %
ecx
, (%
e•
)

737 
push
 %
edx


738 
push
 %
ecx


739 
jmp
 .
ffi_˛osuª_STDCALL_öã∫Æ


740 
	`FFI_HIDDEN
(
ffi_˛osuª_REGISTER
)

741 .
globl
 
	$USCORE_SYMBOL
(
ffi_˛osuª_REGISTER
)

742 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

743 .
def
 
_ffi_˛osuª_REGISTER
; .
s˛
 2; .
ty≥
 32; .
ídef


745 
	$USCORE_SYMBOL
(
ffi_˛osuª_REGISTER
):

747 
push
 %
óx


748 
xchg
 %
ecx
, 8(%
e•
)

749 
xchg
 %
edx
, 4(%
e•
)

750 
push
 %
ecx


751 
push
 %
edx


752 
jmp
 .
ffi_˛osuª_STDCALL_öã∫Æ


754 .
LFE1
:

755 #Thi†
assumes
 
we
 
¨e
 
usög
 
gas
.

756 .
bÆign
 16

757 
	$FFI_HIDDEN
(
ffi_˛osuª_SYSV
)

758 #i‡
	`deföed
(
X86_WIN32
)

759 .
globl
 
	$USCORE_SYMBOL
(
ffi_˛osuª_SYSV
)

760 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

761 .
def
 
_ffi_˛osuª_SYSV
; .
s˛
 2; .
ty≥
 32; .
ídef


763 
	$USCORE_SYMBOL
(
ffi_˛osuª_SYSV
):

765 .
LFB3
:

766 
pushl
 %
ebp


767 .
LCFI4
:

768 
movl
 %
e•
, %
ebp


769 .
LCFI5
:

770 
subl
 
$40
, %
e•


771 
ÀÆ
 -24(%
ebp
), %
edx


772 
movl
 %
edx
, -12(%
ebp
)

773 
ÀÆ
 8(%
ebp
), %
edx


774 
movl
 %
edx
, 4(%
e•
)

775 
ÀÆ
 -12(%
ebp
), %
edx


776 
movl
 %
edx
, (%
e•
)

777 #i‡
	`deföed
(
HAVE_HIDDEN_VISIBILITY_ATTRIBUTE
Ë|| !deföed(
__PIC__
)

778 
ˇŒ
 
	$USCORE_SYMBOL
(
ffi_˛osuª_SYSV_ö√r
)

779 #ñi‡
	`deföed
(
X86_DARWIN
)

780 
ˇŒl
 
L_ffi_˛osuª_SYSV_ö√r$°ub


782 
movl
 %
ebx
, 8(%
e•
)

783 
ˇŒ
 1f

784 1: 
p›l
 %
ebx


785 
addl
 
$_GLOBAL_OFFSET_TABLE_
+[.-1b], %
ebx


786 
ˇŒ
 
ffi_˛osuª_SYSV_ö√r
@
PLT


787 
movl
 8(%
e•
), %
ebx


789 
movl
 -12(%
ebp
), %
ecx


792 
ˇŒ
 1f

793 #Dÿ
nŸ
 
ö£π
 
™ythög
 
hîe
 
bëwìn
 
the
 
ˇŒ
 
™d
Åhê
jump
 
èbÀ
.

794 .
L˛s_°‹e_èbÀ
:

795 ..
L˛s_n‹ëvÆ
-.
L˛s_°‹e_èbÀ


796 ..
L˛s_ªtöt
-.
L˛s_°‹e_èbÀ


797 ..
L˛s_ªtÊﬂt
-.
L˛s_°‹e_èbÀ


798 ..
L˛s_ªtdoubÀ
-.
L˛s_°‹e_èbÀ


799 ..
L˛s_ªédoubÀ
-.
L˛s_°‹e_èbÀ


800 ..
L˛s_ªtuöt8
-.
L˛s_°‹e_èbÀ


801 ..
L˛s_ªtsöt8
-.
L˛s_°‹e_èbÀ


802 ..
L˛s_ªtuöt16
-.
L˛s_°‹e_èbÀ


803 ..
L˛s_ªtsöt16
-.
L˛s_°‹e_èbÀ


804 ..
L˛s_ªtöt
-.
L˛s_°‹e_èbÀ


805 ..
L˛s_ªtöt
-.
L˛s_°‹e_èbÀ


806 ..
L˛s_ªél⁄g
-.
L˛s_°‹e_èbÀ


807 ..
L˛s_ªél⁄g
-.
L˛s_°‹e_èbÀ


808 ..
L˛s_ªt°ru˘
-.
L˛s_°‹e_èbÀ


809 ..
L˛s_ªtöt
-.
L˛s_°‹e_èbÀ


810 ..
L˛s_ªt°ru˘1
-.
L˛s_°‹e_èbÀ


811 ..
L˛s_ªt°ru˘2
-.
L˛s_°‹e_èbÀ


812 ..
L˛s_ªt°ru˘4
-.
L˛s_°‹e_èbÀ


813 ..
L˛s_ªtms°ru˘
-.
L˛s_°‹e_èbÀ


816 
shl
 
$2
, %
óx


817 
	`add
 (%
e•
),%
óx


818 
	`mov
 (%
óx
),%eax

819 
	`add
 (%
e•
),%
óx


820 
add
 
$4
, %
e•


821 
jmp
 *%
óx


824 .
L˛s_ªtsöt8
:

825 
	`movsbl
 (%
ecx
), %
óx


826 
jmp
 .
L˛s_ïûogue


828 .
L˛s_ªtsöt16
:

829 
	`movswl
 (%
ecx
), %
óx


830 
jmp
 .
L˛s_ïûogue


832 .
L˛s_ªtuöt8
:

833 
	`movzbl
 (%
ecx
), %
óx


834 
jmp
 .
L˛s_ïûogue


836 .
L˛s_ªtuöt16
:

837 
	`movzwl
 (%
ecx
), %
óx


838 
jmp
 .
L˛s_ïûogue


840 .
L˛s_ªtöt
:

841 
	`movl
 (%
ecx
), %
óx


842 
jmp
 .
L˛s_ïûogue


844 .
L˛s_ªtÊﬂt
:

845 
	`Êds
 (%
ecx
)

846 
jmp
 .
L˛s_ïûogue


848 .
L˛s_ªtdoubÀ
:

849 
	`Êdl
 (%
ecx
)

850 
jmp
 .
L˛s_ïûogue


852 .
L˛s_ªédoubÀ
:

853 
	`Êdt
 (%
ecx
)

854 
jmp
 .
L˛s_ïûogue


856 .
L˛s_ªél⁄g
:

857 
	`movl
 (%
ecx
), %
óx


858 
movl
 4(%
ecx
), %
edx


859 
jmp
 .
L˛s_ïûogue


861 .
L˛s_ªt°ru˘1
:

862 
	`movsbl
 (%
ecx
), %
óx


863 
jmp
 .
L˛s_ïûogue


865 .
L˛s_ªt°ru˘2
:

866 
	`movswl
 (%
ecx
), %
óx


867 
jmp
 .
L˛s_ïûogue


869 .
L˛s_ªt°ru˘4
:

870 
	`movl
 (%
ecx
), %
óx


871 
jmp
 .
L˛s_ïûogue


873 .
L˛s_ªt°ru˘
:

874 #CÆÀ∏
ex≥˘s
 
us
 
to
 
p›
  
vÆue
 
poöãr
 
hiddí
 
¨g
.

875 
movl
 %
ebp
, %
e•


876 
p›l
 %
ebp


877 
ªt
 
$0x4


879 .
L˛s_ªtms°ru˘
:

880 #CÆÀ∏
ex≥˘s
 
us
 
to
  
a
 
poöãr
Åÿ
the
 
ªÆ
  
vÆue
.

881 
mov
 %
ecx
, %
óx


882 #CÆÀ∏
d€¢
'tÉxpects usÅoÖop structÑeturn valueÖointer hiddenárg.

883 
jmp
 .
L˛s_ïûogue


885 .
L˛s_n‹ëvÆ
:

886 .
L˛s_ïûogue
:

887 
movl
 %
ebp
, %
e•


888 
p›l
 %
ebp


889 
ªt


890 .
ffi_˛osuª_SYSV_íd
:

891 .
LFE3
:

893 #i‡!
FFI_NO_RAW_API


895 
	#RAW_CLOSURE_CIF_OFFSET
 ((
FFI_TRAMPOLINE_SIZE
 + 3Ë& ~3)

	)

896 
	#RAW_CLOSURE_FUN_OFFSET
 (
RAW_CLOSURE_CIF_OFFSET
 + 4)

	)

897 
	#RAW_CLOSURE_USER_DATA_OFFSET
 (
RAW_CLOSURE_FUN_OFFSET
 + 4)

	)

899 #ifde‡
X86_WIN32


900 .
bÆign
 16

901 
	`FFI_HIDDEN
(
ffi_˛osuª_øw_THISCALL
)

902 .
globl
 
	$USCORE_SYMBOL
(
ffi_˛osuª_øw_THISCALL
)

903 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

904 .
def
 
_ffi_˛osuª_øw_THISCALL
; .
s˛
 2; .
ty≥
 32; .
ídef


906 
	$USCORE_SYMBOL
(
ffi_˛osuª_øw_THISCALL
):

907 
pushl
 %
ebp


908 
movl
 %
e•
, %
ebp


909 
pushl
 %
esi


910 
subl
 
$36
, %
e•


911 
movl
 
	`RAW_CLOSURE_CIF_OFFSET
(%
óx
), %
esi


912 
movl
 
	`RAW_CLOSURE_USER_DATA_OFFSET
(%
óx
), %
edx


913 
movl
 %
edx
, 12(%
e•
)

914 
ÀÆ
 12(%
ebp
), %
edx


915 
jmp
 .
°ubøw


918 #Thi†
assumes
 
we
 
¨e
 
usög
 
gas
.

919 .
bÆign
 16

920 #i‡
	`deföed
(
X86_WIN32
)

921 .
globl
 
	$USCORE_SYMBOL
(
ffi_˛osuª_øw_SYSV
)

922 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

923 .
def
 
_ffi_˛osuª_øw_SYSV
; .
s˛
 2; .
ty≥
 32; .
ídef


925 
	$USCORE_SYMBOL
(
ffi_˛osuª_øw_SYSV
):

927 .
LFB4
:

928 
pushl
 %
ebp


929 .
LCFI6
:

930 
movl
 %
e•
, %
ebp


931 .
LCFI7
:

932 
pushl
 %
esi


933 .
LCFI8
:

934 
subl
 
$36
, %
e•


935 
movl
 
	`RAW_CLOSURE_CIF_OFFSET
(%
óx
), %
esi


936 
movl
 
	`RAW_CLOSURE_USER_DATA_OFFSET
(%
óx
), %
edx


937 
movl
 %
edx
, 12(%
e•
)

938 
ÀÆ
 8(%
ebp
), %
edx


939 .
°ubøw
:

940 
movl
 %
edx
, 8(%
e•
)

941 
ÀÆ
 -24(%
ebp
), %
edx


942 
movl
 %
edx
, 4(%
e•
)

943 
movl
 %
esi
, (%
e•
)

944 
ˇŒ
 *
	`RAW_CLOSURE_FUN_OFFSET
(%
óx
)

945 
movl
 
	`CIF_FLAGS_OFFSET
(%
esi
), %
óx


947 
ˇŒ
 1f

948 #Dÿ
nŸ
 
ö£π
 
™ythög
 
hîe
 
bëwìn
 
the
 
ˇŒ
 
™d
Åhê
jump
 
èbÀ
.

949 .
Lr˛s_°‹e_èbÀ
:

950 ..
Lr˛s_n‹ëvÆ
-.
Lr˛s_°‹e_èbÀ


951 ..
Lr˛s_ªtöt
-.
Lr˛s_°‹e_èbÀ


952 ..
Lr˛s_ªtÊﬂt
-.
Lr˛s_°‹e_èbÀ


953 ..
Lr˛s_ªtdoubÀ
-.
Lr˛s_°‹e_èbÀ


954 ..
Lr˛s_ªédoubÀ
-.
Lr˛s_°‹e_èbÀ


955 ..
Lr˛s_ªtuöt8
-.
Lr˛s_°‹e_èbÀ


956 ..
Lr˛s_ªtsöt8
-.
Lr˛s_°‹e_èbÀ


957 ..
Lr˛s_ªtuöt16
-.
Lr˛s_°‹e_èbÀ


958 ..
Lr˛s_ªtsöt16
-.
Lr˛s_°‹e_èbÀ


959 ..
Lr˛s_ªtöt
-.
Lr˛s_°‹e_èbÀ


960 ..
Lr˛s_ªtöt
-.
Lr˛s_°‹e_èbÀ


961 ..
Lr˛s_ªél⁄g
-.
Lr˛s_°‹e_èbÀ


962 ..
Lr˛s_ªél⁄g
-.
Lr˛s_°‹e_èbÀ


963 ..
Lr˛s_ªt°ru˘
-.
Lr˛s_°‹e_èbÀ


964 ..
Lr˛s_ªtöt
-.
Lr˛s_°‹e_èbÀ


965 ..
Lr˛s_ªt°ru˘1
-.
Lr˛s_°‹e_èbÀ


966 ..
Lr˛s_ªt°ru˘2
-.
Lr˛s_°‹e_èbÀ


967 ..
Lr˛s_ªt°ru˘4
-.
Lr˛s_°‹e_èbÀ


968 ..
Lr˛s_ªt°ru˘
-.
Lr˛s_°‹e_èbÀ


970 
shl
 
$2
, %
óx


971 
	`add
 (%
e•
),%
óx


972 
	`mov
 (%
óx
),%eax

973 
	`add
 (%
e•
),%
óx


974 
add
 
$4
, %
e•


975 
jmp
 *%
óx


978 .
Lr˛s_ªtsöt8
:

979 
movsbl
 -24(%
ebp
), %
óx


980 
jmp
 .
Lr˛s_ïûogue


982 .
Lr˛s_ªtsöt16
:

983 
movswl
 -24(%
ebp
), %
óx


984 
jmp
 .
Lr˛s_ïûogue


986 .
Lr˛s_ªtuöt8
:

987 
movzbl
 -24(%
ebp
), %
óx


988 
jmp
 .
Lr˛s_ïûogue


990 .
Lr˛s_ªtuöt16
:

991 
movzwl
 -24(%
ebp
), %
óx


992 
jmp
 .
Lr˛s_ïûogue


994 .
Lr˛s_ªtöt
:

995 
movl
 -24(%
ebp
), %
óx


996 
jmp
 .
Lr˛s_ïûogue


998 .
Lr˛s_ªtÊﬂt
:

999 
Êds
 -24(%
ebp
)

1000 
jmp
 .
Lr˛s_ïûogue


1002 .
Lr˛s_ªtdoubÀ
:

1003 
Êdl
 -24(%
ebp
)

1004 
jmp
 .
Lr˛s_ïûogue


1006 .
Lr˛s_ªédoubÀ
:

1007 
Êdt
 -24(%
ebp
)

1008 
jmp
 .
Lr˛s_ïûogue


1010 .
Lr˛s_ªél⁄g
:

1011 
movl
 -24(%
ebp
), %
óx


1012 
movl
 -20(%
ebp
), %
edx


1013 
jmp
 .
Lr˛s_ïûogue


1015 .
Lr˛s_ªt°ru˘1
:

1016 
movsbl
 -24(%
ebp
), %
óx


1017 
jmp
 .
Lr˛s_ïûogue


1019 .
Lr˛s_ªt°ru˘2
:

1020 
movswl
 -24(%
ebp
), %
óx


1021 
jmp
 .
Lr˛s_ïûogue


1023 .
Lr˛s_ªt°ru˘4
:

1024 
movl
 -24(%
ebp
), %
óx


1025 
jmp
 .
Lr˛s_ïûogue


1027 .
Lr˛s_ªt°ru˘
:

1028 #NŸhög 
to
 do!

1030 .
Lr˛s_n‹ëvÆ
:

1031 .
Lr˛s_ïûogue
:

1032 
addl
 
$36
, %
e•


1033 
p›l
 %
esi


1034 
p›l
 %
ebp


1035 
ªt


1036 .
ffi_˛osuª_øw_SYSV_íd
:

1037 .
LFE4
:

1041 #Thi†
assumes
 
we
 
¨e
 
usög
 
gas
.

1042 .
bÆign
 16

1043 
	`FFI_HIDDEN
(
ffi_˛osuª_STDCALL
)

1044 .
globl
 
	$USCORE_SYMBOL
(
ffi_˛osuª_STDCALL
)

1045 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

1046 .
def
 
_ffi_˛osuª_STDCALL
; .
s˛
 2; .
ty≥
 32; .
ídef


1048 
	$USCORE_SYMBOL
(
ffi_˛osuª_STDCALL
):

1049 .
ffi_˛osuª_STDCALL_öã∫Æ
:

1051 
	`movl
 (%
e•
), %
óx


1052 .
LFB5
:

1053 
pushl
 %
ebp


1054 .
LCFI9
:

1055 
movl
 %
e•
, %
ebp


1056 .
LCFI10
:

1057 
subl
 
$40
, %
e•


1058 
ÀÆ
 -24(%
ebp
), %
edx


1059 
movl
 %
edx
, -12(%
ebp
)

1060 
ÀÆ
 12(%
ebp
), %
edx


1061 
movl
 %
edx
, 4(%
e•
)

1062 
ÀÆ
 -12(%
ebp
), %
edx


1063 
movl
 %
edx
, (%
e•
)

1064 #i‡
	`deföed
(
HAVE_HIDDEN_VISIBILITY_ATTRIBUTE
Ë|| !deföed(
__PIC__
)

1065 
ˇŒ
 
	$USCORE_SYMBOL
(
ffi_˛osuª_WIN32_ö√r
)

1066 #ñi‡
	`deföed
(
X86_DARWIN
)

1067 
ˇŒl
 
L_ffi_˛osuª_WIN32_ö√r$°ub


1069 
movl
 %
ebx
, 8(%
e•
)

1070 
ˇŒ
 1f

1071 1: 
p›l
 %
ebx


1072 
addl
 
$_GLOBAL_OFFSET_TABLE_
+[.-1b], %
ebx


1073 
ˇŒ
 
ffi_˛osuª_WIN32_ö√r
@
PLT


1074 
movl
 8(%
e•
), %
ebx


1076 
movl
 -12(%
ebp
), %
ecx


1078 
xchgl
 4(%
ebp
), %
óx


1079 
movl
 
	`CLOSURE_CIF_OFFSET
(%
óx
), %eax

1080 
movl
 
	`CIF_FLAGS_OFFSET
(%
óx
), %eax

1082 
ˇŒ
 1f

1083 #Dÿ
nŸ
 
ö£π
 
™ythög
 
hîe
 
bëwìn
 
the
 
ˇŒ
 
™d
Åhê
jump
 
èbÀ
.

1084 .
Ls˛s_°‹e_èbÀ
:

1085 ..
Ls˛s_n‹ëvÆ
-.
Ls˛s_°‹e_èbÀ


1086 ..
Ls˛s_ªtöt
-.
Ls˛s_°‹e_èbÀ


1087 ..
Ls˛s_ªtÊﬂt
-.
Ls˛s_°‹e_èbÀ


1088 ..
Ls˛s_ªtdoubÀ
-.
Ls˛s_°‹e_èbÀ


1089 ..
Ls˛s_ªédoubÀ
-.
Ls˛s_°‹e_èbÀ


1090 ..
Ls˛s_ªtuöt8
-.
Ls˛s_°‹e_èbÀ


1091 ..
Ls˛s_ªtsöt8
-.
Ls˛s_°‹e_èbÀ


1092 ..
Ls˛s_ªtuöt16
-.
Ls˛s_°‹e_èbÀ


1093 ..
Ls˛s_ªtsöt16
-.
Ls˛s_°‹e_èbÀ


1094 ..
Ls˛s_ªtöt
-.
Ls˛s_°‹e_èbÀ


1095 ..
Ls˛s_ªtöt
-.
Ls˛s_°‹e_èbÀ


1096 ..
Ls˛s_ªél⁄g
-.
Ls˛s_°‹e_èbÀ


1097 ..
Ls˛s_ªél⁄g
-.
Ls˛s_°‹e_èbÀ


1098 ..
Ls˛s_ªt°ru˘
-.
Ls˛s_°‹e_èbÀ


1099 ..
Ls˛s_ªtöt
-.
Ls˛s_°‹e_èbÀ


1100 ..
Ls˛s_ªt°ru˘1
-.
Ls˛s_°‹e_èbÀ


1101 ..
Ls˛s_ªt°ru˘2
-.
Ls˛s_°‹e_èbÀ


1102 ..
Ls˛s_ªt°ru˘4
-.
Ls˛s_°‹e_èbÀ


1104 
shl
 
$2
, %
óx


1105 
	`add
 (%
e•
),%
óx


1106 
	`mov
 (%
óx
),%eax

1107 
	`add
 (%
e•
),%
óx


1108 
add
 
$4
, %
e•


1109 
jmp
 *%
óx


1112 .
Ls˛s_ªtsöt8
:

1113 
	`movsbl
 (%
ecx
), %
óx


1114 
jmp
 .
Ls˛s_ïûogue


1116 .
Ls˛s_ªtsöt16
:

1117 
	`movswl
 (%
ecx
), %
óx


1118 
jmp
 .
Ls˛s_ïûogue


1120 .
Ls˛s_ªtuöt8
:

1121 
	`movzbl
 (%
ecx
), %
óx


1122 
jmp
 .
Ls˛s_ïûogue


1124 .
Ls˛s_ªtuöt16
:

1125 
	`movzwl
 (%
ecx
), %
óx


1126 
jmp
 .
Ls˛s_ïûogue


1128 .
Ls˛s_ªtöt
:

1129 
	`movl
 (%
ecx
), %
óx


1130 
jmp
 .
Ls˛s_ïûogue


1132 .
Ls˛s_ªtÊﬂt
:

1133 
	`Êds
 (%
ecx
)

1134 
jmp
 .
Ls˛s_ïûogue


1136 .
Ls˛s_ªtdoubÀ
:

1137 
	`Êdl
 (%
ecx
)

1138 
jmp
 .
Ls˛s_ïûogue


1140 .
Ls˛s_ªédoubÀ
:

1141 
	`Êdt
 (%
ecx
)

1142 
jmp
 .
Ls˛s_ïûogue


1144 .
Ls˛s_ªél⁄g
:

1145 
	`movl
 (%
ecx
), %
óx


1146 
movl
 4(%
ecx
), %
edx


1147 
jmp
 .
Ls˛s_ïûogue


1149 .
Ls˛s_ªt°ru˘1
:

1150 
	`movsbl
 (%
ecx
), %
óx


1151 
jmp
 .
Ls˛s_ïûogue


1153 .
Ls˛s_ªt°ru˘2
:

1154 
	`movswl
 (%
ecx
), %
óx


1155 
jmp
 .
Ls˛s_ïûogue


1157 .
Ls˛s_ªt°ru˘4
:

1158 
	`movl
 (%
ecx
), %
óx


1159 
jmp
 .
Ls˛s_ïûogue


1161 .
Ls˛s_ªt°ru˘
:

1162 #NŸhög 
to
 do!

1164 .
Ls˛s_n‹ëvÆ
:

1165 .
Ls˛s_ïûogue
:

1166 
movl
 %
ebp
, %
e•


1167 
p›l
 %
ebp


1168 
movl
 4(%
e•
), %
ecx


1169 
	`addl
 (%
e•
), %esp

1170 
addl
 
$8
, %
e•


1171 
jmp
 *%
ecx


1172 .
ffi_˛osuª_STDCALL_íd
:

1173 .
LFE5
:

1175 #i‡
	`deföed
(
X86_DARWIN
)

1176 .
£˘i⁄
 
__IMPORT
,
__jump_èbÀ
,
symbﬁ_°ubs
,
£lf_modifyög_code
+
puª_ö°ru˘i⁄s
,5

1177 
L_ffi_˛osuª_SYSV_ö√r$°ub
:

1178 .
ödúe˘_symbﬁ
 
_ffi_˛osuª_SYSV_ö√r


1179 
h…
 ; hlt ; hlt ; hlt ; hlt

1180 
L_ffi_˛osuª_WIN32_ö√r$°ub
:

1181 .
ödúe˘_symbﬁ
 
_ffi_˛osuª_WIN32_ö√r


1182 
h…
 ; hlt ; hlt ; hlt ; hlt

1185 #i‡
	`deföed
(
X86_WIN32
Ë&& !deföed(
__OS2__
)

1186 .
£˘i⁄
 .
eh_‰ame
,"w"

1188 .
L‰ame1
:

1189 .
LSCIE1
:

1190 ..
LECIE1
-.
LASCIE1


1191 .
LASCIE1
:

1193 .
byã
 0x1

1194 #ifde‡
__PIC__


1195 .
ascii
 "zR\0"

1197 .
ascii
 "\0"

1199 .
byã
 0x1

1200 .
byã
 0x7c

1201 .
byã
 0x8

1202 #ifde‡
__PIC__


1203 .
byã
 0x1

1204 .
byã
 0x1b

1206 .
byã
 0xc

1207 .
byã
 0x4

1208 .
byã
 0x4

1209 .
byã
 0x88

1210 .
byã
 0x1

1211 .
Æign
 4

1212 .
LECIE1
:

1214 .
LSFDE1
:

1215 ..
LEFDE1
-.
LASFDE1


1216 .
LASFDE1
:

1217 ..
LASFDE1
-.
L‰ame1


1218 #i‡
deföed
 
__PIC__
 && deföed 
HAVE_AS_X86_PCREL


1219 ..
LFB1
-.

1221 ..
LFB1


1223 ..
LFE1
-.
LFB1


1224 #ifde‡
__PIC__


1225 .
byã
 0x0

1229 .
byã
 0x4

1230 ..
LCFI0
-.
LFB1


1231 .
byã
 0xe

1232 .
byã
 0x8

1233 .
byã
 0x85

1234 .
byã
 0x2

1236 .
byã
 0x4

1237 ..
LCFI1
-.
LCFI0


1238 .
byã
 0xd

1239 .
byã
 0x5

1242 .
Æign
 4

1243 .
LEFDE1
:

1245 .
LSFDE3
:

1246 ..
LEFDE3
-.
LASFDE3


1247 .
LASFDE3
:

1248 ..
LASFDE3
-.
L‰ame1


1249 #i‡
deföed
 
__PIC__
 && deföed 
HAVE_AS_X86_PCREL


1250 ..
LFB3
-.

1252 ..
LFB3


1254 ..
LFE3
-.
LFB3


1255 #ifde‡
__PIC__


1256 .
byã
 0x0

1260 .
byã
 0x4

1261 ..
LCFI4
-.
LFB3


1262 .
byã
 0xe

1263 .
byã
 0x8

1264 .
byã
 0x85

1265 .
byã
 0x2

1267 .
byã
 0x4

1268 ..
LCFI5
-.
LCFI4


1269 .
byã
 0xd

1270 .
byã
 0x5

1273 .
Æign
 4

1274 .
LEFDE3
:

1276 #i‡!
FFI_NO_RAW_API


1278 .
LSFDE4
:

1279 ..
LEFDE4
-.
LASFDE4


1280 .
LASFDE4
:

1281 ..
LASFDE4
-.
L‰ame1


1282 #i‡
deföed
 
__PIC__
 && deföed 
HAVE_AS_X86_PCREL


1283 ..
LFB4
-.

1285 ..
LFB4


1287 ..
LFE4
-.
LFB4


1288 #ifde‡
__PIC__


1289 .
byã
 0x0

1293 .
byã
 0x4

1294 ..
LCFI6
-.
LFB4


1295 .
byã
 0xe

1296 .
byã
 0x8

1297 .
byã
 0x85

1298 .
byã
 0x2

1300 .
byã
 0x4

1301 ..
LCFI7
-.
LCFI6


1302 .
byã
 0xd

1303 .
byã
 0x5

1305 .
byã
 0x4

1306 ..
LCFI8
-.
LCFI7


1307 .
byã
 0x86

1308 .
byã
 0x3

1311 .
Æign
 4

1312 .
LEFDE4
:

1316 .
LSFDE5
:

1317 ..
LEFDE5
-.
LASFDE5


1318 .
LASFDE5
:

1319 ..
LASFDE5
-.
L‰ame1


1320 #i‡
deföed
 
__PIC__
 && deföed 
HAVE_AS_X86_PCREL


1321 ..
LFB5
-.

1323 ..
LFB5


1325 ..
LFE5
-.
LFB5


1326 #ifde‡
__PIC__


1327 .
byã
 0x0

1331 .
byã
 0x4

1332 ..
LCFI9
-.
LFB5


1333 .
byã
 0xe

1334 .
byã
 0x8

1335 .
byã
 0x85

1336 .
byã
 0x2

1338 .
byã
 0x4

1339 ..
LCFI10
-.
LCFI9


1340 .
byã
 0xd

1341 .
byã
 0x5

1344 .
Æign
 4

1345 .
LEFDE5
:

1349 #i‡
deföed
 
__ELF__
 && deföed 
__löux__


1350 .
£˘i⁄
 .
nŸe
.
GNU
-
°ack
,"",@
¥ogbôs


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/win64.S

1 
	#LIBFFI_ASM


	)

2 
	~<ffic⁄fig.h
>

3 
	~<ffi.h
>

6 
	#STACK
 0

	)

7 
	#PREP_ARGS_FN
 32

	)

8 
	#ECIF
 40

	)

9 
	#CIF_BYTES
 48

	)

10 
	#CIF_FLAGS
 56

	)

11 
	#RVALUE
 64

	)

12 
	#FN
 72

	)

19 #ifde‡
_MSC_VER


20 
PUBLIC
 
ffi_ˇŒ_wö64


22 
EXTRN
 
	g__chk°k
:
NEAR


23 
EXTRN
 
ffi_˛osuª_wö64_ö√r
:
NEAR


25 
_TEXT
 
SEGMENT


27 ;;; 
ffi_˛osuª_wö64
 
wûl
 
be
 
ˇŒed
 
wôh
 
the£
 
ªgi°îs
 
	g£t
:

28 ;;; 
øx
 
poöts
 
	gto
 'closure'

29 ;;; 
r11
 
c⁄èös
 
a
 
bô
 
mask
 
th©
 
•ecifõs
 
which
 
of
 
	gthe


30 ;;; 
fú°
 
four
 
∑ømëîs
 
¨e
 
‹
 

32 ;;; 
It
 
mu°
 
move
 
the
 
∑ømëîs
 
∑s£d
 
ö
 
ªgi°îs
 
to
 
theú
 
°ack
 
	gloˇti⁄
,

33 ;;; 
ˇŒ
 
ffi_˛osuª_wö64_ö√r
 
the
 
a˘uÆ
 
	gw‹k
, 
thí
 Åhê
	gªsu…
.

35 
ffi_˛osuª_wö64
 
PROC
 
	gFRAME


36 ;; 
c›y
 
¨gumíts
 
⁄to
 
°ack


37 
ã°
 
	gr11
, 1

38 
j√
 
fú°_is_Êﬂt


39 
mov
 
QWORD
 
	gPTR
 [
r•
+8], 
rcx


40 
jmp
 
£c⁄d


41 
	gfú°_is_Êﬂt
:

42 
movÕd
 
QWORD
 
PTR
 [
r•
+8], 
xmm0


44 
	g£c⁄d
:

45 
ã°
 
r11
, 2

46 
j√
 
£c⁄d_is_Êﬂt


47 
mov
 
QWORD
 
	gPTR
 [
r•
+16], 
rdx


48 
jmp
 
thúd


49 
	g£c⁄d_is_Êﬂt
:

50 
movÕd
 
QWORD
 
PTR
 [
r•
+16], 
xmm1


52 
	gthúd
:

53 
ã°
 
r11
, 4

54 
j√
 
thúd_is_Êﬂt


55 
mov
 
QWORD
 
	gPTR
 [
r•
+24], 
r8


56 
jmp
 
fouπh


57 
	gthúd_is_Êﬂt
:

58 
movÕd
 
QWORD
 
PTR
 [
r•
+24], 
xmm2


60 
	gfouπh
:

61 
ã°
 
r11
, 8

62 
j√
 
fouπh_is_Êﬂt


63 
mov
 
QWORD
 
	gPTR
 [
r•
+32], 
r9


64 
jmp
 
d⁄e


65 
	gfouπh_is_Êﬂt
:

66 
movÕd
 
QWORD
 
PTR
 [
r•
+32], 
xmm3


68 
	gd⁄e
:

69 .
ALLOCSTACK
 40

70 
sub
 
r•
, 40

71 .
ENDPROLOG


72 
mov
 
	grcx
, 
	gøx
 ; 
c⁄ãxt
 
is
 
fú°
 
∑ømëî


73 
mov
 
	grdx
, 
	gr•
 ; 
°ack
 
is
 
£c⁄d
 
∑ømëî


74 
add
 
	grdx
, 48 ; 
poöt
 
to
 
°¨t
 
of
 
¨gumíts


75 
mov
 
	gøx
, 
ffi_˛osuª_wö64_ö√r


76 
ˇŒ
 
	gøx
 ; cÆ»
the
 
ªÆ
 
˛osuª
 
fun˘i⁄


77 
add
 
	gr•
, 40

78 
movd
 
	gxmm0
, 
	gøx
 ; 
If
 
the
 
˛osuª
 
ªtu∫ed
 
a
 ,

79 ; 
ffi_˛osuª_wö64_ö√r
 
wrŸe
 
ô
 
to
 
øx


80 
	gªt
 0

81 
ffi_˛osuª_wö64
 
ENDP


83 
ffi_ˇŒ_wö64
 
PROC
 
	gFRAME


84 ;; 
c›y
 
ªgi°îs
 
⁄to
 
°ack


85 
mov
 
QWORD
 
	gPTR
 [
r•
+32], 
r9


86 
mov
 
QWORD
 
	gPTR
 [
r•
+24], 
r8


87 
mov
 
QWORD
 
	gPTR
 [
r•
+16], 
rdx


88 
mov
 
QWORD
 
	gPTR
 [
r•
+8], 
	grcx


89 .
PUSHREG
 
rbp


90 
push
 
	grbp


91 .
	gALLOCSTACK
 48

92 
sub
 
	gr•
, 48 ; 00000030
	gH


93 .
SETFRAME
 
	grbp
, 32

94 
Àa
 
	grbp
, 
QWORD
 
	gPTR
 [
r•
+32]

95 .
ENDPROLOG


97 
mov
 
	góx
, 
DWORD
 
PTR
 
	gCIF_BYTES
[
rbp
]

98 
add
 
	gøx
, 15

99 
™d
 
	gøx
, -16

100 
ˇŒ
 
__chk°k


101 
sub
 
	gr•
, 
øx


102 
Àa
 
	gøx
, 
QWORD
 
	gPTR
 [
r•
+32]

103 
mov
 
QWORD
 
PTR
 
	gSTACK
[
rbp
], 
øx


105 
mov
 
	grdx
, 
QWORD
 
PTR
 
	gECIF
[
rbp
]

106 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gSTACK
[
rbp
]

107 
ˇŒ
 
QWORD
 
PTR
 
	gPREP_ARGS_FN
[
rbp
]

109 
mov
 
	gr•
, 
QWORD
 
PTR
 
	gSTACK
[
rbp
]

111 
movÕd
 
	gxmm3
, 
QWORD
 
	gPTR
 [
r•
+24]

112 
movd
 
	gr9
, 
xmm3


114 
movÕd
 
	gxmm2
, 
QWORD
 
	gPTR
 [
r•
+16]

115 
movd
 
	gr8
, 
xmm2


117 
movÕd
 
	gxmm1
, 
QWORD
 
	gPTR
 [
r•
+8]

118 
movd
 
	grdx
, 
xmm1


120 
movÕd
 
	gxmm0
, 
QWORD
 
	gPTR
 [
r•
]

121 
movd
 
	grcx
, 
xmm0


123 
ˇŒ
 
QWORD
 
PTR
 
	gFN
[
rbp
]

124 
	gªt_°ru˘4b$
:

125 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_SMALL_STRUCT_4B


126 
j√
 
ªt_°ru˘2b$


128 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

129 
mov
 
DWORD
 
	gPTR
 [
rcx
], 
óx


130 
jmp
 
ªt_void$


132 
	gªt_°ru˘2b$
:

133 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_SMALL_STRUCT_2B


134 
j√
 
ªt_°ru˘1b$


136 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

137 
mov
 
WORD
 
	gPTR
 [
rcx
], 
ax


138 
jmp
 
ªt_void$


140 
	gªt_°ru˘1b$
:

141 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_SMALL_STRUCT_1B


142 
j√
 
ªt_uöt8$


144 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

145 
mov
 
BYTE
 
	gPTR
 [
rcx
], 
Æ


146 
jmp
 
ªt_void$


148 
	gªt_uöt8$
:

149 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_UINT8


150 
j√
 
ªt_söt8$


152 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

153 
movzx
 
	gøx
, 
Æ


154 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


155 
jmp
 
ªt_void$


157 
	gªt_söt8$
:

158 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_SINT8


159 
j√
 
ªt_uöt16$


161 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

162 
movsx
 
	gøx
, 
Æ


163 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


164 
jmp
 
ªt_void$


166 
	gªt_uöt16$
:

167 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_UINT16


168 
j√
 
ªt_söt16$


170 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

171 
movzx
 
	gøx
, 
ax


172 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


173 
jmp
 
SHORT
 
ªt_void$


175 
	gªt_söt16$
:

176 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_SINT16


177 
j√
 
ªt_uöt32$


179 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

180 
movsx
 
	gøx
, 
ax


181 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


182 
jmp
 
SHORT
 
ªt_void$


184 
	gªt_uöt32$
:

185 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_UINT32


186 
j√
 
ªt_söt32$


188 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

189 
mov
 
	góx
, 
óx


190 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


191 
jmp
 
SHORT
 
ªt_void$


193 
	gªt_söt32$
:

194 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_SINT32


195 
j√
 
ªt_Êﬂt$


197 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

198 
cdqe


199 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


200 
jmp
 
SHORT
 
ªt_void$


202 
	gªt_Êﬂt$
:

203 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_FLOAT


204 
j√
 
SHORT
 
ªt_doubÀ$


206 
mov
 
	gøx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

207 
movss
 
DWORD
 
	gPTR
 [
øx
], 
xmm0


208 
jmp
 
SHORT
 
ªt_void$


210 
	gªt_doubÀ$
:

211 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_DOUBLE


212 
j√
 
SHORT
 
ªt_uöt64$


214 
mov
 
	gøx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

215 
movÕd
 
QWORD
 
	gPTR
 [
øx
], 
xmm0


216 
jmp
 
SHORT
 
ªt_void$


218 
	gªt_uöt64$
:

219 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_UINT64


220 
j√
 
SHORT
 
ªt_söt64$


222 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

223 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


224 
jmp
 
SHORT
 
ªt_void$


226 
	gªt_söt64$
:

227 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_SINT64


228 
j√
 
SHORT
 
ªt_poöãr$


230 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

231 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


232 
jmp
 
SHORT
 
ªt_void$


234 
	gªt_poöãr$
:

235 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_POINTER


236 
j√
 
SHORT
 
ªt_öt$


238 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

239 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


240 
jmp
 
SHORT
 
ªt_void$


242 
	gªt_öt$
:

243 
cmp
 
DWORD
 
PTR
 
CIF_FLAGS
[
rbp
], 
FFI_TYPE_INT


244 
j√
 
SHORT
 
ªt_void$


246 
mov
 
	grcx
, 
QWORD
 
PTR
 
	gRVALUE
[
rbp
]

247 
cdqe


248 
mov
 
QWORD
 
	gPTR
 [
rcx
], 
øx


249 
jmp
 
SHORT
 
ªt_void$


251 
	gªt_void$
:

252 
x‹
 
øx
,Ñax

254 
Àa
 
	gr•
, 
QWORD
 
	gPTR
 [
rbp
+16]

255 
p›
 
rbp


256 
	gªt
 0

257 
ffi_ˇŒ_wö64
 
ENDP


258 
_TEXT
 
ENDS


259 
	gEND


263 #ifde‡
SYMBOL_UNDERSCORE


264 
	#SYMBOL_NAME
(
«me
Ë
_
##
	)
name

266 
	#SYMBOL_NAME
(
«me
Ë
	)
name

269 .
	gãxt


271 .
	$SYMBOL_NAME
(
ffi_˛osuª_wö64_ö√r
)

273 #ffi_˛osuª_wö64 
wûl
 
be
 
ˇŒed
 
wôh
 
the£
 
ªgi°îs
 
£t
:

274 #øx 
poöts
 
to
 'closure'

275 #r11 
c⁄èös
 
a
 
bô
 
mask
 
th©
 
•ecifõs
 
which
 
of
 
the


276 #fú° 
four
 
∑ømëîs
 
¨e
 
‹
 

277 #
#Ià
mu°
 
move
 
the
 
∑ømëîs
 
∑s£d
 
ö
 
ªgi°îs
 
to
 
theú
 
°ack
 
loˇti⁄
,

279 #ˇŒ 
ffi_˛osuª_wö64_ö√r
 
the
 
a˘uÆ
 
w‹k
, 
thí
 Åhê
ªsu…
.

280 #
.
bÆign
 16

282 .
globl
 
	`SYMBOL_NAME
(
ffi_˛osuª_wö64
)

283 .
£h_¥oc
 
	$SYMBOL_NAME
(
ffi_˛osuª_wö64
)

284 
	$SYMBOL_NAME
(
ffi_˛osuª_wö64
):

285 #c›y 
¨gumíts
 
⁄to
 
°ack


286 
ã°
 
$1
,%
r11


287 
j√
 .
Lfú°_is_Êﬂt


288 
mov
 %
rcx
, 8(%
r•
)

289 
jmp
 .
L£c⁄d


290 .
Lfú°_is_Êﬂt
:

291 
movÕd
 %
xmm0
, 8(%
r•
)

293 .
L£c⁄d
:

294 
ã°
 
$2
, %
r11


295 
j√
 .
L£c⁄d_is_Êﬂt


296 
mov
 %
rdx
, 16(%
r•
)

297 
jmp
 .
Lthúd


298 .
L£c⁄d_is_Êﬂt
:

299 
movÕd
 %
xmm1
, 16(%
r•
)

301 .
Lthúd
:

302 
ã°
 
$4
, %
r11


303 
j√
 .
Lthúd_is_Êﬂt


304 
mov
 %
r8
,24(%
r•
)

305 
jmp
 .
Lfouπh


306 .
Lthúd_is_Êﬂt
:

307 
movÕd
 %
xmm2
, 24(%
r•
)

309 .
Lfouπh
:

310 
ã°
 
$8
, %
r11


311 
j√
 .
Lfouπh_is_Êﬂt


312 
mov
 %
r9
, 32(%
r•
)

313 
jmp
 .
Ld⁄e


314 .
Lfouπh_is_Êﬂt
:

315 
movÕd
 %
xmm3
, 32(%
r•
)

317 .
Ld⁄e
:

318 .
£h_°ackÆloc
 40

319 
sub
 
$40
, %
r•


320 .
£h_íd¥ﬁogue


321 
mov
 %
øx
, %
rcx
 #c⁄ãxà
is
 
fú°
 
∑ømëî


322 
mov
 %
r•
, %
rdx
 #°ack 
is
 
£c⁄d
 
∑ømëî


323 
add
 
$48
, %
rdx
 #poöà
to
 
°¨t
 
of
 
¨gumíts


324 
Àaq
 
	`SYMBOL_NAME
(
ffi_˛osuª_wö64_ö√r
)(%
rù
), %
øx


325 
ˇŒq
 *%
øx
 #ˇŒ 
the
 
ªÆ
 
˛osuª
 
fun˘i⁄


326 
add
 
$40
, %
r•


327 
movq
 %
øx
, %
xmm0
 #I‡
the
 
˛osuª
 
ªtu∫ed
 
a
 ,

328 #ffi_˛osuª_wö64_ö√∏
wrŸe
 
ô
 
to
 
øx


329 
ªtq


330 .
£h_íd¥oc


332 .
bÆign
 16

333 .
globl
 
	`SYMBOL_NAME
(
ffi_ˇŒ_wö64
)

334 .
£h_¥oc
 
	$SYMBOL_NAME
(
ffi_ˇŒ_wö64
)

335 
	$SYMBOL_NAME
(
ffi_ˇŒ_wö64
):

336 #c›y 
ªgi°îs
 
⁄to
 
°ack


337 
mov
 %
r9
,32(%
r•
)

338 
mov
 %
r8
,24(%
r•
)

339 
mov
 %
rdx
,16(%
r•
)

340 
mov
 %
rcx
,8(%
r•
)

341 .
£h_pushªg
 
rbp


342 
push
 %
rbp


343 .
£h_°ackÆloc
 48

344 
sub
 
$48
,%
r•


345 .
£h_£t‰ame
 
rbp
, 32

346 
Àa
 32(%
r•
),%
rbp


347 .
£h_íd¥ﬁogue


349 
mov
 
	`CIF_BYTES
(%
rbp
),%
óx


350 
add
 
$15
, %
øx


351 
™d
 
$
-16, %
øx


352 
cmpq
 
$0x1000
, %
øx


353 
jb
 
Lch_d⁄e


354 
Lch_¥obe
:

355 
subq
 
$0x1000
,%
r•


356 
‹l
 
$0x0
, (%
r•
)

357 
subq
 
$0x1000
,%
øx


358 
cmpq
 
$0x1000
,%
øx


359 
ja
 
Lch_¥obe


360 
Lch_d⁄e
:

361 
subq
 %
øx
, %
r•


362 
‹l
 
$0x0
, (%
r•
)

363 
Àa
 32(%
r•
), %
øx


364 
mov
 %
øx
, 
	`STACK
(%
rbp
)

366 
mov
 
	`ECIF
(%
rbp
), %
rdx


367 
mov
 
	`STACK
(%
rbp
), %
rcx


368 
ˇŒq
 *
	`PREP_ARGS_FN
(%
rbp
)

370 
mov
 
	`STACK
(%
rbp
), %
r•


372 
movÕd
 24(%
r•
), %
xmm3


373 
movd
 %
xmm3
, %
r9


375 
movÕd
 16(%
r•
), %
xmm2


376 
movd
 %
xmm2
, %
r8


378 
movÕd
 8(%
r•
), %
xmm1


379 
movd
 %
xmm1
, %
rdx


381 
	`movÕd
 (%
r•
), %
xmm0


382 
movd
 %
xmm0
, %
rcx


384 
ˇŒq
 *
	`FN
(%
rbp
)

385 .
Lªt_°ru˘4b
:

386 
cm∂
 
$FFI_TYPE_SMALL_STRUCT_4B
, 
	`CIF_FLAGS
(%
rbp
)

387 
j√
 .
Lªt_°ru˘2b


389 
mov
 
	`RVALUE
(%
rbp
), %
rcx


390 
mov
 %
óx
, (%
rcx
)

391 
jmp
 .
Lªt_void


393 .
Lªt_°ru˘2b
:

394 
cm∂
 
$FFI_TYPE_SMALL_STRUCT_2B
, 
	`CIF_FLAGS
(%
rbp
)

395 
j√
 .
Lªt_°ru˘1b


397 
mov
 
	`RVALUE
(%
rbp
), %
rcx


398 
mov
 %
ax
, (%
rcx
)

399 
jmp
 .
Lªt_void


401 .
Lªt_°ru˘1b
:

402 
cm∂
 
$FFI_TYPE_SMALL_STRUCT_1B
, 
	`CIF_FLAGS
(%
rbp
)

403 
j√
 .
Lªt_uöt8


405 
mov
 
	`RVALUE
(%
rbp
), %
rcx


406 
mov
 %
Æ
, (%
rcx
)

407 
jmp
 .
Lªt_void


409 .
Lªt_uöt8
:

410 
cm∂
 
$FFI_TYPE_UINT8
, 
	`CIF_FLAGS
(%
rbp
)

411 
j√
 .
Lªt_söt8


413 
mov
 
	`RVALUE
(%
rbp
), %
rcx


414 
movzbq
 %
Æ
, %
øx


415 
movq
 %
øx
, (%
rcx
)

416 
jmp
 .
Lªt_void


418 .
Lªt_söt8
:

419 
cm∂
 
$FFI_TYPE_SINT8
, 
	`CIF_FLAGS
(%
rbp
)

420 
j√
 .
Lªt_uöt16


422 
mov
 
	`RVALUE
(%
rbp
), %
rcx


423 
movsbq
 %
Æ
, %
øx


424 
movq
 %
øx
, (%
rcx
)

425 
jmp
 .
Lªt_void


427 .
Lªt_uöt16
:

428 
cm∂
 
$FFI_TYPE_UINT16
, 
	`CIF_FLAGS
(%
rbp
)

429 
j√
 .
Lªt_söt16


431 
mov
 
	`RVALUE
(%
rbp
), %
rcx


432 
movzwq
 %
ax
, %
øx


433 
movq
 %
øx
, (%
rcx
)

434 
jmp
 .
Lªt_void


436 .
Lªt_söt16
:

437 
cm∂
 
$FFI_TYPE_SINT16
, 
	`CIF_FLAGS
(%
rbp
)

438 
j√
 .
Lªt_uöt32


440 
mov
 
	`RVALUE
(%
rbp
), %
rcx


441 
movswq
 %
ax
, %
øx


442 
movq
 %
øx
, (%
rcx
)

443 
jmp
 .
Lªt_void


445 .
Lªt_uöt32
:

446 
cm∂
 
$FFI_TYPE_UINT32
, 
	`CIF_FLAGS
(%
rbp
)

447 
j√
 .
Lªt_söt32


449 
mov
 
	`RVALUE
(%
rbp
), %
rcx


450 
movl
 %
óx
, %eax

451 
movq
 %
øx
, (%
rcx
)

452 
jmp
 .
Lªt_void


454 .
Lªt_söt32
:

455 
cm∂
 
$FFI_TYPE_SINT32
, 
	`CIF_FLAGS
(%
rbp
)

456 
j√
 .
Lªt_Êﬂt


458 
mov
 
	`RVALUE
(%
rbp
), %
rcx


459 
˛tq


460 
movq
 %
øx
, (%
rcx
)

461 
jmp
 .
Lªt_void


463 .
Lªt_Êﬂt
:

464 
cm∂
 
$FFI_TYPE_FLOAT
, 
	`CIF_FLAGS
(%
rbp
)

465 
j√
 .
Lªt_doubÀ


467 
mov
 
	`RVALUE
(%
rbp
), %
øx


468 
movss
 %
xmm0
, (%
øx
)

469 
jmp
 .
Lªt_void


471 .
Lªt_doubÀ
:

472 
cm∂
 
$FFI_TYPE_DOUBLE
, 
	`CIF_FLAGS
(%
rbp
)

473 
j√
 .
Lªt_uöt64


475 
mov
 
	`RVALUE
(%
rbp
), %
øx


476 
movÕd
 %
xmm0
, (%
øx
)

477 
jmp
 .
Lªt_void


479 .
Lªt_uöt64
:

480 
cm∂
 
$FFI_TYPE_UINT64
, 
	`CIF_FLAGS
(%
rbp
)

481 
j√
 .
Lªt_söt64


483 
mov
 
	`RVALUE
(%
rbp
), %
rcx


484 
mov
 %
øx
, (%
rcx
)

485 
jmp
 .
Lªt_void


487 .
Lªt_söt64
:

488 
cm∂
 
$FFI_TYPE_SINT64
, 
	`CIF_FLAGS
(%
rbp
)

489 
j√
 .
Lªt_poöãr


491 
mov
 
	`RVALUE
(%
rbp
), %
rcx


492 
mov
 %
øx
, (%
rcx
)

493 
jmp
 .
Lªt_void


495 .
Lªt_poöãr
:

496 
cm∂
 
$FFI_TYPE_POINTER
, 
	`CIF_FLAGS
(%
rbp
)

497 
j√
 .
Lªt_öt


499 
mov
 
	`RVALUE
(%
rbp
), %
rcx


500 
mov
 %
øx
, (%
rcx
)

501 
jmp
 .
Lªt_void


503 .
Lªt_öt
:

504 
cm∂
 
$FFI_TYPE_INT
, 
	`CIF_FLAGS
(%
rbp
)

505 
j√
 .
Lªt_void


507 
mov
 
	`RVALUE
(%
rbp
), %
rcx


508 
˛tq


509 
movq
 %
øx
, (%
rcx
)

510 
jmp
 .
Lªt_void


512 .
Lªt_void
:

513 
x‹
 %
øx
, %rax

515 
Àa
 16(%
rbp
), %
r•


516 
p›
 %
rbp


517 
ªtq


518 .
£h_íd¥oc


	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/xtensa/ffi.c

27 
	~<ffi.h
>

28 
	~<ffi_comm⁄.h
>

48 
	#FFI_TYPE_STRUCT_REGS
 
FFI_TYPE_LAST


	)

51 
ffi_ˇŒ_SYSV
(*
rvÆue
, 
rsize
, 
Êags
,

52 (*
‚
)(), 
nbyãs
, 
exãnded_cif
*);

53 
	$ffi_˛osuª_SYSV
(Ë
FFI_HIDDEN
;

55 
ffi_°©us
 
	$ffi_¥ï_cif_machdï
(
ffi_cif
 *
cif
)

57 
cif
->
πy≥
->
ty≥
) {

58 
FFI_TYPE_SINT8
:

59 
FFI_TYPE_UINT8
:

60 
FFI_TYPE_SINT16
:

61 
FFI_TYPE_UINT16
:

62 
cif
->
Êags
 = cif->
πy≥
->
ty≥
;

64 
FFI_TYPE_VOID
:

65 
FFI_TYPE_FLOAT
:

66 
cif
->
Êags
 = 
FFI_TYPE_UINT32
;

68 
FFI_TYPE_DOUBLE
:

69 
FFI_TYPE_UINT64
:

70 
FFI_TYPE_SINT64
:

71 
cif
->
Êags
 = 
FFI_TYPE_UINT64
;

73 
FFI_TYPE_STRUCT
:

74 
cif
->
Êags
 = 
FFI_TYPE_STRUCT
;

76 i‡(
cif
->
πy≥
->
size
 > 4 * 4) {

79 
cif
->
Êags
 = 
FFI_TYPE_STRUCT
;

80 
cif
->
byãs
 += 8;

85 
cif
->
Êags
 = 
FFI_TYPE_UINT32
;

92 
cif
->
byãs
 = 
	`ALIGN
(cif->bytes, 16);

94  
FFI_OK
;

95 
	}
}

97 
	$ffi_¥ï_¨gs
(
exãnded_cif
 *
ecif
, * 
°ack
)

99 
i
;

100 *
addr
;

101 
ffi_ty≥
 **
±r
;

104 **
v
;

105 **
c
;

106 sig√d **
sc
;

107 **
uc
;

108 sig√d **
ss
;

109 **
us
;

110 **
i
;

111 **
Œ
;

112 **
f
;

113 **
d
;

114 } 
p_¨gv
;

117 
	`FFI_ASSERT
 (((Ë
°ack
 & 0x7) == 0);

119 
p_¨gv
.
v
 = 
ecif
->
avÆue
;

120 
addr
 = (*)
°ack
;

123 i‡(
ecif
->
cif
->
πy≥
->
ty≥
 =
FFI_TYPE_STRUCT
 &&Écif->cif->πy≥->
size
 > 16)

125 *
addr
++ = ()
ecif
->
rvÆue
;

128 
i
 = 
ecif
->
cif
->
«rgs
, 
±r
 =Écif->cif->
¨g_ty≥s
;

129 
i
 > 0;

130 
i
--, 
±r
++, 
p_¨gv
.
v
++)

132 (*
±r
)->
ty≥
)

134 
FFI_TYPE_SINT8
:

135 *
addr
++ = **
p_¨gv
.
sc
;

137 
FFI_TYPE_UINT8
:

138 *
addr
++ = **
p_¨gv
.
uc
;

140 
FFI_TYPE_SINT16
:

141 *
addr
++ = **
p_¨gv
.
ss
;

143 
FFI_TYPE_UINT16
:

144 *
addr
++ = **
p_¨gv
.
us
;

146 
FFI_TYPE_FLOAT
:

147 
FFI_TYPE_INT
:

148 
FFI_TYPE_UINT32
:

149 
FFI_TYPE_SINT32
:

150 
FFI_TYPE_POINTER
:

151 *
addr
++ = **
p_¨gv
.
i
;

153 
FFI_TYPE_DOUBLE
:

154 
FFI_TYPE_UINT64
:

155 
FFI_TYPE_SINT64
:

156 i‡((()
addr
 & 4) != 0)

157 
addr
++;

158 *(*)
addr
 = **
p_¨gv
.
Œ
;

159 
addr
 += () /  (addr);

162 
FFI_TYPE_STRUCT
:

164 
offs
;

165 
size
;

167 i‡((()
addr
 & 4Ë!0 && (*
±r
)->
Æignmít
 > 4)

168 
addr
++;

170 
offs
 = (Ë
addr
 - (Ë
°ack
;

171 
size
 = (*
±r
)->size;

174 i‡(
offs
 < 
FFI_REGISTER_NARGS
 * 4

175 && 
offs
 + 
size
 > 
FFI_REGISTER_NARGS
 * 4)

176 
addr
 = (*Ë(
°ack
 + 
FFI_REGISTER_NARGS
 * 4);

178 
	`mem˝y
((*Ë
addr
, *
p_¨gv
.
c
, 
size
);

179 
addr
 +(
size
 + 3) / 4;

184 
	`FFI_ASSERT
(0);

187 
	}
}

190 
ffi_ˇŒ
(
ffi_cif
* 
cif
, (*
‚
)(), *
rvÆue
, **
avÆue
)

192 
exãnded_cif
 
ecif
;

193 
rsize
 = 
cif
->
πy≥
->
size
;

194 
Êags
 = 
cif
->flags;

195 *
Æloc
 = 
NULL
;

197 
ecif
.
cif
 = cif;

198 
ecif
.
avÆue
 =ávalue;

206 i‡(
Êags
 =
FFI_TYPE_STRUCT
 && (
rsize
 <16 || 
rvÆue
 =
NULL
))

208 
Æloc
 = 
	`Æloˇ
(
	`ALIGN
(
rsize
, 4));

209 
ecif
.
rvÆue
 = 
Æloc
;

213 
ecif
.
rvÆue
 =Ñvalue;

216 i‡(
cif
->
abi
 !
FFI_SYSV
)

217 
	`FFI_ASSERT
(0);

219 
	`ffi_ˇŒ_SYSV
 (
ecif
.
rvÆue
, 
rsize
, 
cif
->
Êags
, 
‚
, cif->
byãs
, &ecif);

221 i‡(
Æloc
 !
NULL
 && 
rvÆue
 != NULL)

222 
	`mem˝y
(
rvÆue
, 
Æloc
, 
rsize
);

223 
	}
}

225 
ffi_åampﬁöe
();

226 
ffi_ˇcheÊush
(* 
°¨t
, * 
íd
);

228 
ffi_°©us


229 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
* 
˛osuª
,

230 
ffi_cif
* 
cif
,

231 (*
fun
)(
ffi_cif
*, *, **, *),

232 *
u£r_d©a
,

233 *
codñoc
)

236 
	`mem˝y
(
˛osuª
->
åamp
, 
ffi_åampﬁöe
, 
FFI_TRAMPOLINE_SIZE
);

237 *(*)(&
˛osuª
->
åamp
[8]Ë()
ffi_˛osuª_SYSV
;

241 
	`ffi_ˇcheÊush
(
˛osuª
->
åamp
, closuª->åam∞+ 
FFI_TRAMPOLINE_SIZE
);

243 
˛osuª
->
cif
 = cif;

244 
˛osuª
->
fun
 = fun;

245 
˛osuª
->
u£r_d©a
 = user_data;

246  
FFI_OK
;

247 
	}
}

250 
FFI_HIDDEN


251 
	$ffi_˛osuª_SYSV_ö√r
(
ffi_˛osuª
 *
˛osuª
, **
vÆues
, *
rvÆue
)

253 
ffi_cif
 *
cif
;

254 
ffi_ty≥
 **
¨g_ty≥s
;

255 **
avÆue
;

256 
i
, 
¨eg
;

258 
cif
 = 
˛osuª
->cif;

259 i‡(
cif
->
abi
 !
FFI_SYSV
)

260  
FFI_BAD_ABI
;

262 
¨eg
 = 0;

264 
πy≥
 = 
cif
->πy≥->
ty≥
;

265 i‡(
πy≥
 =
FFI_TYPE_STRUCT
 && 
cif
->πy≥->
size
 > 4 * 4)

267 
rvÆue
 = *
vÆues
;

268 
¨eg
++;

271 
cif
 = 
˛osuª
->cif;

272 
¨g_ty≥s
 = 
cif
->arg_types;

273 
avÆue
 = 
	`Æloˇ
(
cif
->
«rgs
 * (*));

275 
i
 = 0; i < 
cif
->
«rgs
; i++)

277 i‡(
¨g_ty≥s
[
i
]->
Æignmít
 =8 && (
¨eg
 & 1) != 0)

278 
¨eg
++;

281 i‡(
¨eg
 =
FFI_REGISTER_NARGS
)

282 
¨eg
 += 4;

284 i‡(
¨g_ty≥s
[
i
]->
ty≥
 =
FFI_TYPE_STRUCT
)

286 
numªgs
 = ((
¨g_ty≥s
[
i
]->
size
 + 3) & ~3) / 4;

287 i‡(
¨eg
 < 
FFI_REGISTER_NARGS
 &&áªg + 
numªgs
 > FFI_REGISTER_NARGS)

288 
¨eg
 = 
FFI_REGISTER_NARGS
 + 4;

291 
avÆue
[
i
] = &
vÆues
[
¨eg
];

292 
¨eg
 +(
¨g_ty≥s
[
i
]->
size
 + 3) / 4;

295 (
˛osuª
->
fun
)(
cif
, 
rvÆue
, 
avÆue
, closuª->
u£r_d©a
);

297  
πy≥
;

298 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/xtensa/ffitarget.h

26 #i‚de‡
LIBFFI_TARGET_H


27 
	#LIBFFI_TARGET_H


	)

29 #i‚de‡
LIBFFI_H


33 #i‚de‡
LIBFFI_ASM


34 
	tffi_¨g
;

35 sig√d 
	tffi_ßrg
;

37 
	effi_abi
 {

38 
	mFFI_FIRST_ABI
 = 0,

39 
	mFFI_SYSV
,

40 
	mFFI_LAST_ABI
,

41 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


42 } 
	tffi_abi
;

45 
	#FFI_REGISTER_NARGS
 6

	)

49 
	#FFI_CLOSURES
 1

	)

50 
	#FFI_NATIVE_RAW_API
 0

	)

51 
	#FFI_TRAMPOLINE_SIZE
 24

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/xtensa/sysv.S

27 
	#LIBFFI_ASM


	)

28 
	~<ffic⁄fig.h
>

29 
	~<ffi.h
>

31 
	#ENTRY
(
«me
Ë.
ãxt
; .
globl
Çame; .
ty≥
Çame,@
fun˘i⁄
; .
Æign
 4;Çame:

	)

32 
	#END
(
«me
Ë.
size
Çamê, . - 
	)
name

36 #if 
FFI_TYPE_UINT8
 != 5 \

37 || 
	gFFI_TYPE_SINT8
 != 6 \

38 || 
FFI_TYPE_UINT16
 != 7 \

39 || 
FFI_TYPE_SINT16
 != 8 \

40 || 
FFI_TYPE_UINT32
 != 9 \

41 || 
FFI_TYPE_SINT32
 != 10 \

42 || 
FFI_TYPE_UINT64
 != 11

56 
	$ENTRY
(
ffi_ˇŒ_SYSV
)

58 
íåy
 
a1
, 32 #32 
byã
 
‰ame
 
usög
 
ˇŒ8
 
bñow


60 
mov
 
a10
, 
a7
 #a10(->
¨g0
): 
ecif


61 
sub
 
a11
, 
a1
, 
a6
 #a11(->
¨g1
): 
°ack
 
poöãr


62 
mov
 
a7
, 
a1
 #fp

63 
mov•
 
a1
, 
a11
 #£à
√w
 
•
 = 
ﬁd_•
 - 
byãs


65 
movi
 
a8
, 
ffi_¥ï_¨gs


66 
ˇŒx8
 
a8
 #ffi_¥ï_¨gs(
ecif
, 
°ack
)

68 #¥ï¨ê
to
 
move
 
°ack
 
poöãr
 
back
 
up
Åÿ6 
¨gumíts


69 #nŸê
th©
 'byãs' 
is
 
Æªady
 
Æig√d


71 
movi
 
a10
, 6*4

72 
sub
 
a11
, 
a6
, 
a10


73 
movgez
 
a6
, 
a10
, 
a11


74 
add
 
a6
, 
a1
,á6

77 #wê
ˇn
 
∑ss
 
up
 
to
 6 
¨gumíts
 
ö
 
ªgi°îs


78 #f‹ 
sim∂icôy
, 
ju°
 
lﬂd
 6 
¨gumíts


79 #(
the
 
°ack
 
size
 
is
 
©
 
Àa°
 32 
byãs
, 
so
 
no
 
risk
 
to
 
¸oss
 
bound¨õs
)

81 
l32i
 
a10
, 
a1
, 0

82 
l32i
 
a11
, 
a1
, 4

83 
l32i
 
a12
, 
a1
, 8

84 
l32i
 
a13
, 
a1
, 12

85 
l32i
 
a14
, 
a1
, 16

86 
l32i
 
a15
, 
a1
, 20

88 #movê
°ack
 
poöãr


90 
mov•
 
a1
, 
a6


92 
ˇŒx8
 
a5
 #(*
‚
)(
¨gs
...)

94 #H™dÀ  
	`vÆue
(
s
)

96 
beqz
 
a2
, .
Lexô


98 
movi
 
a5
, 
FFI_TYPE_STRUCT


99 
b√
 
a4
, 
a5
, .
L°‹e


100 
movi
 
a5
, 16

101 
b…
 
a5
, 
a3
, .
Lexô


103 
s32i
 
a10
, 
a2
, 0

104 
b…i
 
a3
, 5, .
Lexô


105 
addi
 
a3
,á3, -1

106 
s32i
 
a11
, 
a2
, 4

107 
b…i
 
a3
, 8, .
Lexô


108 
s32i
 
a12
, 
a2
, 8

109 
b…i
 
a3
, 12, .
Lexô


110 
s32i
 
a13
, 
a2
, 12

112 .
Lexô
: 
ªtw


114 .
L°‹e
:

115 
addi
 
a4
,á4, -
FFI_TYPE_UINT8


116 
bgei
 
a4
, 7, .
Lexô
 #should 
√vî
 
h≠≥n


117 
movi
 
a6
, 
°‹e_ˇŒs


118 
add
 
a4
,á4,á4

119 
addx4
 
a6
, 
a4
,á6 #°‹e_èbÀ + 
idx
 * 8

120 
jx
 
a6


122 .
Æign
 8

123 
°‹e_ˇŒs
:

125 
s8i
 
a10
, 
a2
, 0

126 
ªtw


129 .
Æign
 8

130 
s8i
 
a10
, 
a2
, 0

131 
ªtw


134 .
Æign
 8

135 
s16i
 
a10
, 
a2
, 0

136 
ªtw


139 .
Æign
 8

140 
s16i
 
a10
, 
a2
, 0

141 
ªtw


144 .
Æign
 8

145 
s32i
 
a10
, 
a2
, 0

146 
ªtw


149 .
Æign
 8

150 
s32i
 
a10
, 
a2
, 0

151 
ªtw


154 .
Æign
 8

155 
s32i
 
a10
, 
a2
, 0

156 
s32i
 
a11
, 
a2
, 4

157 
ªtw


159 
	$END
(
ffi_ˇŒ_SYSV
)

166 
	#EXTRA_ARGS_SIZE
 24

	)

168 
	$ENTRY
(
ffi_ˇcheÊush
)

170 
íåy
 
a1
, 16

172 1: 
dhwbi
 
a2
, 0

173 
ihi
 
a2
, 0

174 
addi
 
a2
,á2, 4

175 
b…
 
a2
, 
a3
, 1b

177 
ªtw


179 
	$END
(
ffi_ˇcheÊush
)

183 
	$ENTRY
(
ffi_åampﬁöe
)

185 
íåy
 
a1
, 16 + (
FFI_REGISTER_NARGS
 * 4) + (4 * 4) #[ 0]

186 
j
 2f #[ 3]

187 .
Æign
 4 #[ 6]

189 2: 
l32r
 
a15
, 1b #[12]

190 
_mov
 
a14
, 
a0
 #[15]

191 
ˇŒx0
 
a15
 #[18]

193 
	$END
(
ffi_åampﬁöe
)

202 
	$ENTRY
(
ffi_˛osuª_SYSV
)

206 #ª°‹ê 
	`addªss
 (
a0
Ë
™d
 
move
 
poöãr
 
to
 
˛osuª
Åÿ
a10


207 
addi
 
a10
, 
a0
, -21

208 
mov
 
a0
, 
a14


210 #Ælow 
up
 
to
 4 
¨gumíts
 
as
  
vÆues


211 
addi
 
a11
, 
a1
, 4 * 4

213 #ßvê
up
 
to
 6 
¨gumíts
Åÿ
	`°ack
 (
Æloˇãd
 
by
 
íåy
 
bñow
)

214 
s32i
 
a2
, 
a11
, 0

215 
s32i
 
a3
, 
a11
, 4

216 
s32i
 
a4
, 
a11
, 8

217 
s32i
 
a5
, 
a11
, 12

218 
s32i
 
a6
, 
a11
, 16

219 
s32i
 
a7
, 
a11
, 20

221 
movi
 
a8
, 
ffi_˛osuª_SYSV_ö√r


222 
mov
 
a12
, 
a1


223 
ˇŒx8
 
a8
 #..
	$_ö√r
(*
˛osuª
, **
avÆue
, *
rvÆue
)

225 #lﬂd 
up
 
to
 
four
  
¨gumíts


226 
l32i
 
a2
, 
a1
, 0

227 
l32i
 
a3
, 
a1
, 4

228 
l32i
 
a4
, 
a1
, 8

229 
l32i
 
a5
, 
a1
, 12

231 #(
sign
-)
exãnd
  
vÆue


232 
movi
 
a11
, 
FFI_TYPE_UINT8


233 
b√
 
a10
, 
a11
, 1f

234 
extui
 
a2
,á2, 0, 8

235 
ªtw


237 1: 
movi
 
a11
, 
FFI_TYPE_SINT8


238 
b√
 
a10
, 
a11
, 1f

239 
£xt
 
a2
,á2, 7

240 
ªtw


242 1: 
movi
 
a11
, 
FFI_TYPE_UINT16


243 
b√
 
a10
, 
a11
, 1f

244 
extui
 
a2
,á2, 0, 16

245 
ªtw


247 1: 
movi
 
a11
, 
FFI_TYPE_SINT16


248 
b√
 
a10
, 
a11
, 1f

249 
£xt
 
a2
,á2, 15

251 1: 
ªtw


253 
	`END
(
ffi_˛osuª_SYSV
)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn0.c

13 
	~"ffôe°.h
"

16 
	$˛osuª_ã°_‚0
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

17 * 
u£rd©a
)

19 *(
ffi_¨g
*)
ª•
 =

20 ()*(*)
¨gs
[0] + ()(*(*)args[1]) +

21 ()(*(*)
¨gs
[2]) + ()*(*)args[3] +

22 ()(*(sig√d *)
¨gs
[4]) +

23 ()(*(*)
¨gs
[5]) +

24 ()*(*)
¨gs
[6] + ()(*(*)args[7]) +

25 ()(*(*)
¨gs
[8]) + ()*(*)args[9] +

26 ()(*(*)
¨gs
[10]) + ()(*(*)args[11]) +

27 ()*(*)
¨gs
[12] + ()(*(*)args[13]) +

28 ()(*(*)
¨gs
[14]Ë+ *(*Ôrgs[15] + (
öçå_t
)
u£rd©a
;

30 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d\n",

31 ()*(*)
¨gs
[0], ()(*(*)args[1]),

32 ()(*(*)
¨gs
[2]),

33 ()*(*)
¨gs
[3], ()(*(signed *)args[4]),

34 ()(*(*)
¨gs
[5]),

35 ()*(*)
¨gs
[6], ()(*(*)args[7]),

36 ()(*(*)
¨gs
[8]), ()*(*)args[9],

37 ()(*(*)
¨gs
[10]), ()(*(*)args[11]),

38 ()*(*)
¨gs
[12], ()(*(*)args[13]),

39 ()(*(*)
¨gs
[14]),*(*)args[15],

40 ()(
öçå_t
)
u£rd©a
, ()*(
ffi_¨g
 *)
ª•
);

42 
	}
}

44 (*
	t˛osuª_ã°_ty≥0
)(, , ,

49 
	$maö
 ()

51 
ffi_cif
 
cif
;

52 * 
code
;

53 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

54 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

55 
ªs
;

57 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uöt64
;

58 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_söt
;

59 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_uöt64
;

60 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_söt
;

61 
˛_¨g_ty≥s
[4] = &
ffi_ty≥_ssh‹t
;

62 
˛_¨g_ty≥s
[5] = &
ffi_ty≥_uöt64
;

63 
˛_¨g_ty≥s
[6] = &
ffi_ty≥_söt
;

64 
˛_¨g_ty≥s
[7] = &
ffi_ty≥_söt
;

65 
˛_¨g_ty≥s
[8] = &
ffi_ty≥_doubÀ
;

66 
˛_¨g_ty≥s
[9] = &
ffi_ty≥_söt
;

67 
˛_¨g_ty≥s
[10] = &
ffi_ty≥_söt
;

68 
˛_¨g_ty≥s
[11] = &
ffi_ty≥_Êﬂt
;

69 
˛_¨g_ty≥s
[12] = &
ffi_ty≥_söt
;

70 
˛_¨g_ty≥s
[13] = &
ffi_ty≥_söt
;

71 
˛_¨g_ty≥s
[14] = &
ffi_ty≥_söt
;

72 
˛_¨g_ty≥s
[15] = &
ffi_ty≥_söt
;

73 
˛_¨g_ty≥s
[16] = 
NULL
;

76 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 16,

77 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

79 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°_‚0
,

80 (*Ë3 , 
code
Ë=
FFI_OK
);

82 
ªs
 = (*((
˛osuª_ã°_ty≥0
)
code
))

86 
	`¥ötf
("ªs: %d\n",
ªs
);

88 
	`exô
(0);

89 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn1.c

10 
	~"ffôe°.h
"

13 
	$˛osuª_ã°_‚1
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

14 * 
u£rd©a
)

16 *(
ffi_¨g
*)
ª•
 =

17 ()*(*)
¨gs
[0] +()(*(*)args[1]) +

18 ()(*(*)
¨gs
[2]) + ()*(*)args[3] +

19 ()(*(sig√d *)
¨gs
[4]) + ()(*(*)args[5]) +

20 ()*(*)
¨gs
[6] + ()(*(*)args[7]) +

21 ()(*(*)
¨gs
[8]) + ()*(*)args[9] +

22 ()(*(*)
¨gs
[10]) + ()(*(*)args[11]) +

23 ()*(*)
¨gs
[12] + ()(*(*)args[13]) +

24 ()(*(*)
¨gs
[14]Ë+ *(*Ôrgs[15] + (
öçå_t
)
u£rd©a
;

26 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d\n",

27 ()*(*)
¨gs
[0], ()(*(*)args[1]),

28 ()(*(*)
¨gs
[2]), ()*(*)args[3],

29 ()(*(sig√d *)
¨gs
[4]), ()(*(*)args[5]),

30 ()*(*)
¨gs
[6], ()(*(*)args[7]),

31 ()(*(*)
¨gs
[8]), ()*(*)args[9],

32 ()(*(*)
¨gs
[10]), ()(*(*)args[11]),

33 ()*(*)
¨gs
[12], ()(*(*)args[13]),

34 ()(*(*)
¨gs
[14]), *(*)args[15],

35 ()(
öçå_t
)
u£rd©a
, ()*(
ffi_¨g
 *)
ª•
);

36 
	}
}

38 (*
	t˛osuª_ã°_ty≥1
)(, , , , signed ,

41 
	$maö
 ()

43 
ffi_cif
 
cif
;

44 *
code
;

45 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

46 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

47 
ªs
;

49 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_Êﬂt
;

50 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_Êﬂt
;

51 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_Êﬂt
;

52 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_Êﬂt
;

53 
˛_¨g_ty≥s
[4] = &
ffi_ty≥_ssh‹t
;

54 
˛_¨g_ty≥s
[5] = &
ffi_ty≥_Êﬂt
;

55 
˛_¨g_ty≥s
[6] = &
ffi_ty≥_Êﬂt
;

56 
˛_¨g_ty≥s
[7] = &
ffi_ty≥_söt
;

57 
˛_¨g_ty≥s
[8] = &
ffi_ty≥_doubÀ
;

58 
˛_¨g_ty≥s
[9] = &
ffi_ty≥_söt
;

59 
˛_¨g_ty≥s
[10] = &
ffi_ty≥_söt
;

60 
˛_¨g_ty≥s
[11] = &
ffi_ty≥_Êﬂt
;

61 
˛_¨g_ty≥s
[12] = &
ffi_ty≥_söt
;

62 
˛_¨g_ty≥s
[13] = &
ffi_ty≥_söt
;

63 
˛_¨g_ty≥s
[14] = &
ffi_ty≥_söt
;

64 
˛_¨g_ty≥s
[15] = &
ffi_ty≥_söt
;

65 
˛_¨g_ty≥s
[16] = 
NULL
;

68 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 16,

69 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

71 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°_‚1
,

72 (*Ë3 , 
code
Ë=
FFI_OK
);

74 
ªs
 = (*((
˛osuª_ã°_ty≥1
)
code
))

78 
	`¥ötf
("ªs: %d\n",
ªs
);

80 
	`exô
(0);

81 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn2.c

10 
	~"ffôe°.h
"

12 
	$˛osuª_ã°_‚2
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

13 * 
u£rd©a
)

15 *(
ffi_¨g
*)
ª•
 =

16 ()*(*)
¨gs
[0] +()(*(*)args[1]) +

17 ()(*(*)
¨gs
[2]) + ()*(*)args[3] +

18 ()(*(sig√d *)
¨gs
[4]) + ()(*(*)args[5]) +

19 ()*(*)
¨gs
[6] + ()(*(*)args[7]) +

20 ()(*(*)
¨gs
[8]) + ()*(*)args[9] +

21 ()(*(*)
¨gs
[10]) + ()(*(*)args[11]) +

22 ()*(*)
¨gs
[12] + ()(*(*)args[13]) +

23 ()(*(*)
¨gs
[14]Ë+ *(*Ôrgs[15] + (
öçå_t
)
u£rd©a
;

25 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d\n",

26 ()*(*)
¨gs
[0], ()(*(*)args[1]),

27 ()(*(*)
¨gs
[2]), ()*(*)args[3],

28 ()(*(sig√d *)
¨gs
[4]), ()(*(*)args[5]),

29 ()*(*)
¨gs
[6], ()(*(*)args[7]),

30 ()(*(*)
¨gs
[8]), ()*(*)args[9],

31 ()(*(*)
¨gs
[10]), ()(*(*)args[11]),

32 ()*(*)
¨gs
[12], ()(*(*)args[13]),

33 ()(*(*)
¨gs
[14]), *(*Ôrgs[15], ()(
öçå_t
)
u£rd©a
,

34 ()*(
ffi_¨g
 *)
ª•
);

35 
	}
}

37 (*
	t˛osuª_ã°_ty≥2
)(, , , , signed ,

41 
	$maö
 ()

43 
ffi_cif
 
cif
;

44 *
code
;

45 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

46 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

47 
ªs
;

49 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_doubÀ
;

50 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_doubÀ
;

51 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_doubÀ
;

52 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_doubÀ
;

53 
˛_¨g_ty≥s
[4] = &
ffi_ty≥_ssh‹t
;

54 
˛_¨g_ty≥s
[5] = &
ffi_ty≥_doubÀ
;

55 
˛_¨g_ty≥s
[6] = &
ffi_ty≥_doubÀ
;

56 
˛_¨g_ty≥s
[7] = &
ffi_ty≥_söt
;

57 
˛_¨g_ty≥s
[8] = &
ffi_ty≥_doubÀ
;

58 
˛_¨g_ty≥s
[9] = &
ffi_ty≥_söt
;

59 
˛_¨g_ty≥s
[10] = &
ffi_ty≥_söt
;

60 
˛_¨g_ty≥s
[11] = &
ffi_ty≥_Êﬂt
;

61 
˛_¨g_ty≥s
[12] = &
ffi_ty≥_söt
;

62 
˛_¨g_ty≥s
[13] = &
ffi_ty≥_Êﬂt
;

63 
˛_¨g_ty≥s
[14] = &
ffi_ty≥_söt
;

64 
˛_¨g_ty≥s
[15] = &
ffi_ty≥_söt
;

65 
˛_¨g_ty≥s
[16] = 
NULL
;

68 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 16,

69 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

71 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°_‚2
,

72 (*Ë3 , 
code
Ë=
FFI_OK
);

74 
ªs
 = (*((
˛osuª_ã°_ty≥2
)
code
))

78 
	`¥ötf
("ªs: %d\n",
ªs
);

80 
	`exô
(0);

81 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn3.c

10 
	~"ffôe°.h
"

12 
	$˛osuª_ã°_‚3
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

13 * 
u£rd©a
)

15 *(
ffi_¨g
*)
ª•
 =

16 ()*(*)
¨gs
[0] +()(*(*)args[1]) +

17 ()(*(*)
¨gs
[2]) + ()*(*)args[3] +

18 ()(*(*)
¨gs
[4]) + ()(*(*)args[5]) +

19 ()*(*)
¨gs
[6] + ()(*(*)args[7]) +

20 ()(*(*)
¨gs
[8]) + ()*(*)args[9] +

21 ()(*(*)
¨gs
[10]) + ()(*(*)args[11]) +

22 ()*(*)
¨gs
[12] + ()(*(*)args[13]) +

23 ()(*(*)
¨gs
[14]Ë+ *(*Ôrgs[15] + (
öçå_t
)
u£rd©a
;

25 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d\n",

26 ()*(*)
¨gs
[0], ()(*(*)args[1]),

27 ()(*(*)
¨gs
[2]), ()*(*)args[3],

28 ()(*(*)
¨gs
[4]), ()(*(*)args[5]),

29 ()*(*)
¨gs
[6], ()(*(*)args[7]),

30 ()(*(*)
¨gs
[8]), ()*(*)args[9],

31 ()(*(*)
¨gs
[10]), ()(*(*)args[11]),

32 ()*(*)
¨gs
[12], ()(*(*)args[13]),

33 ()(*(*)
¨gs
[14]), *(*Ôrgs[15], ()(
öçå_t
)
u£rd©a
,

34 ()*(
ffi_¨g
 *)
ª•
);

36 
	}
}

38 (*
	t˛osuª_ã°_ty≥3
)(, , , , , ,

42 
	$maö
 ()

44 
ffi_cif
 
cif
;

45 *
code
;

46 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

47 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

48 
ªs
;

50 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_Êﬂt
;

51 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_Êﬂt
;

52 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_Êﬂt
;

53 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_Êﬂt
;

54 
˛_¨g_ty≥s
[4] = &
ffi_ty≥_Êﬂt
;

55 
˛_¨g_ty≥s
[5] = &
ffi_ty≥_Êﬂt
;

56 
˛_¨g_ty≥s
[6] = &
ffi_ty≥_Êﬂt
;

57 
˛_¨g_ty≥s
[7] = &
ffi_ty≥_Êﬂt
;

58 
˛_¨g_ty≥s
[8] = &
ffi_ty≥_doubÀ
;

59 
˛_¨g_ty≥s
[9] = &
ffi_ty≥_söt
;

60 
˛_¨g_ty≥s
[10] = &
ffi_ty≥_Êﬂt
;

61 
˛_¨g_ty≥s
[11] = &
ffi_ty≥_Êﬂt
;

62 
˛_¨g_ty≥s
[12] = &
ffi_ty≥_söt
;

63 
˛_¨g_ty≥s
[13] = &
ffi_ty≥_Êﬂt
;

64 
˛_¨g_ty≥s
[14] = &
ffi_ty≥_Êﬂt
;

65 
˛_¨g_ty≥s
[15] = &
ffi_ty≥_söt
;

66 
˛_¨g_ty≥s
[16] = 
NULL
;

69 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 16,

70 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

72 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°_‚3
,

73 (*Ë3 , 
code
Ë=
FFI_OK
);

75 
ªs
 = (*((
˛osuª_ã°_ty≥3
)
code
))

79 
	`¥ötf
("ªs: %d\n",
ªs
);

81 
	`exô
(0);

82 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn4.c

11 
	~"ffôe°.h
"

14 
	$˛osuª_ã°_‚0
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

15 * 
u£rd©a
)

17 *(
ffi_¨g
*)
ª•
 =

18 ()*(*)
¨gs
[0] + ()*(*)args[1] +

19 ()*(*)
¨gs
[2] + ()*(*)args[3] +

20 ()*(*)
¨gs
[4] + ()*(*)args[5] +

21 ()*(*)
¨gs
[6] + ()*(*)args[7] +

22 ()*(*)
¨gs
[8] + ()*(*)args[9] +

23 ()*(*)
¨gs
[10] +

24 ()*(*)
¨gs
[11] +

25 ()*(*)
¨gs
[12] +

26 ()*(*)
¨gs
[13] +

27 ()*(*)
¨gs
[14] +

28 *(*)
¨gs
[15] + (
öçå_t
)
u£rd©a
;

30 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d\n",

31 ()*(*)
¨gs
[0],

32 ()*(*)
¨gs
[1],

33 ()*(*)
¨gs
[2],

34 ()*(*)
¨gs
[3],

35 ()*(*)
¨gs
[4],

36 ()*(*)
¨gs
[5],

37 ()*(*)
¨gs
[6],

38 ()*(*)
¨gs
[7],

39 ()*(*)
¨gs
[8],

40 ()*(*)
¨gs
[9],

41 ()*(*)
¨gs
[10],

42 ()*(*)
¨gs
[11],

43 ()*(*)
¨gs
[12],

44 ()*(*)
¨gs
[13],

45 ()*(*)
¨gs
[14],

46 *(*)
¨gs
[15],

47 ()(
öçå_t
)
u£rd©a
, ()*(
ffi_¨g
 *)
ª•
);

49 
	}
}

51 (*
	t˛osuª_ã°_ty≥0
)(, ,

60 
	$maö
 ()

62 
ffi_cif
 
cif
;

63 *
code
;

64 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

65 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

66 
i
, 
ªs
;

68 
i
 = 0; i < 15; i++) {

69 
˛_¨g_ty≥s
[
i
] = &
ffi_ty≥_uöt64
;

71 
˛_¨g_ty≥s
[15] = &
ffi_ty≥_söt
;

72 
˛_¨g_ty≥s
[16] = 
NULL
;

75 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 16,

76 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

78 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°_‚0
,

79 (*Ë3 , 
code
Ë=
FFI_OK
);

81 
ªs
 = (*((
˛osuª_ã°_ty≥0
)
code
))

85 
	`¥ötf
("ªs: %d\n",
ªs
);

88 
	`exô
(0);

89 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn5.c

10 
	~"ffôe°.h
"

13 
	$˛osuª_ã°_‚5
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

14 * 
u£rd©a
)

16 *(
ffi_¨g
*)
ª•
 =

17 ()*(*)
¨gs
[0] + ()*(*)args[1] +

18 ()*(*)
¨gs
[2] + ()*(*)args[3] +

19 ()*(*)
¨gs
[4] + ()*(*)args[5] +

20 ()*(*)
¨gs
[6] + ()*(*)args[7] +

21 ()*(*)
¨gs
[8] + ()*(*)args[9] +

22 ()*(*)
¨gs
[10] +

23 ()*(*)
¨gs
[11] +

24 ()*(*)
¨gs
[12] +

25 ()*(*)
¨gs
[13] +

26 ()*(*)
¨gs
[14] +

27 *(*)
¨gs
[15] + (
öçå_t
)
u£rd©a
;

29 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d\n",

30 ()*(*)
¨gs
[0],

31 ()*(*)
¨gs
[1],

32 ()*(*)
¨gs
[2],

33 ()*(*)
¨gs
[3],

34 ()*(*)
¨gs
[4],

35 ()*(*)
¨gs
[5],

36 ()*(*)
¨gs
[6],

37 ()*(*)
¨gs
[7],

38 ()*(*)
¨gs
[8],

39 ()*(*)
¨gs
[9],

40 ()*(*)
¨gs
[10],

41 ()*(*)
¨gs
[11],

42 ()*(*)
¨gs
[12],

43 ()*(*)
¨gs
[13],

44 ()*(*)
¨gs
[14],

45 *(*)
¨gs
[15],

46 ()(
öçå_t
)
u£rd©a
, ()*(
ffi_¨g
 *)
ª•
);

48 
	}
}

50 (*
	t˛osuª_ã°_ty≥0
)(, ,

59 
	$maö
 ()

61 
ffi_cif
 
cif
;

62 *
code
;

63 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

64 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

65 
i
, 
ªs
;

67 
i
 = 0; i < 10; i++) {

68 
˛_¨g_ty≥s
[
i
] = &
ffi_ty≥_uöt64
;

70 
˛_¨g_ty≥s
[10] = &
ffi_ty≥_söt
;

71 
i
 = 11; i < 15; i++) {

72 
˛_¨g_ty≥s
[
i
] = &
ffi_ty≥_uöt64
;

74 
˛_¨g_ty≥s
[15] = &
ffi_ty≥_söt
;

75 
˛_¨g_ty≥s
[16] = 
NULL
;

78 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 16,

79 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

81 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°_‚5
,

82 (*Ë3 , 
code
Ë=
FFI_OK
);

84 
ªs
 = (*((
˛osuª_ã°_ty≥0
)
code
))

88 
	`¥ötf
("ªs: %d\n",
ªs
);

91 
	`exô
(0);

92 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn6.c

9 
	~"ffôe°.h
"

12 
	$˛osuª_ã°_‚0
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

13 * 
u£rd©a
)

15 *(
ffi_¨g
*)
ª•
 =

16 ()*(*)
¨gs
[0] +

17 ()(*(*)
¨gs
[1]) +

18 ()(*(*)
¨gs
[2]) +

19 ()*(*)
¨gs
[3] +

20 ()(*(*)
¨gs
[4]) + ()(*(*)args[5]) +

21 ()*(*)
¨gs
[6] + ()(*(*)args[7]) +

22 ()(*(*)
¨gs
[8]) + ()*(*)args[9] +

23 ()(*(*)
¨gs
[10]) + ()(*(*)args[11]) +

24 ()*(*)
¨gs
[12] + ()(*(*)args[13]) +

25 ()(*(*)
¨gs
[14]) + ()*(*)args[15] +

26 (
öçå_t
)
u£rd©a
;

28 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d\n",

29 ()*(*)
¨gs
[0],

30 ()(*(*)
¨gs
[1]),

31 ()(*(*)
¨gs
[2]),

32 ()*(*)
¨gs
[3],

33 ()(*(*)
¨gs
[4]), ()(*(*)args[5]),

34 ()*(*)
¨gs
[6], ()(*(*)args[7]),

35 ()(*(*)
¨gs
[8]), ()*(*)args[9],

36 ()(*(*)
¨gs
[10]), ()(*(*)args[11]),

37 ()*(*)
¨gs
[12], ()(*(*)args[13]),

38 ()(*(*)
¨gs
[14]), ()(*(*)args[15]),

39 ()(
öçå_t
)
u£rd©a
, ()*(
ffi_¨g
 *)
ª•
);

41 
	}
}

43 (*
	t˛osuª_ã°_ty≥0
)(,

50 
	$maö
 ()

52 
ffi_cif
 
cif
;

53 *
code
;

54 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

55 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

56 
ªs
;

58 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uöt64
;

59 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_uöt64
;

60 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_uöt64
;

61 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_uöt64
;

62 
˛_¨g_ty≥s
[4] = &
ffi_ty≥_söt
;

63 
˛_¨g_ty≥s
[5] = &
ffi_ty≥_doubÀ
;

64 
˛_¨g_ty≥s
[6] = &
ffi_ty≥_doubÀ
;

65 
˛_¨g_ty≥s
[7] = &
ffi_ty≥_Êﬂt
;

66 
˛_¨g_ty≥s
[8] = &
ffi_ty≥_doubÀ
;

67 
˛_¨g_ty≥s
[9] = &
ffi_ty≥_doubÀ
;

68 
˛_¨g_ty≥s
[10] = &
ffi_ty≥_söt
;

69 
˛_¨g_ty≥s
[11] = &
ffi_ty≥_Êﬂt
;

70 
˛_¨g_ty≥s
[12] = &
ffi_ty≥_söt
;

71 
˛_¨g_ty≥s
[13] = &
ffi_ty≥_söt
;

72 
˛_¨g_ty≥s
[14] = &
ffi_ty≥_doubÀ
;

73 
˛_¨g_ty≥s
[15] = &
ffi_ty≥_doubÀ
;

74 
˛_¨g_ty≥s
[16] = 
NULL
;

77 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 16,

78 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

80 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°_‚0
,

81 (*Ë3 , 
code
Ë=
FFI_OK
);

83 
ªs
 = (*((
˛osuª_ã°_ty≥0
)
code
))

87 
	`¥ötf
("ªs: %d\n",
ªs
);

89 
	`exô
(0);

90 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_loc_fn0.c

13 
	~"ffôe°.h
"

16 
	$˛osuª_loc_ã°_‚0
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

17 * 
u£rd©a
)

19 *(
ffi_¨g
*)
ª•
 =

20 ()*(*)
¨gs
[0] + ()(*(*)args[1]) +

21 ()(*(*)
¨gs
[2]) + ()*(*)args[3] +

22 ()(*(sig√d *)
¨gs
[4]) +

23 ()(*(*)
¨gs
[5]) +

24 ()*(*)
¨gs
[6] + ()(*(*)args[7]) +

25 ()(*(*)
¨gs
[8]) + ()*(*)args[9] +

26 ()(*(*)
¨gs
[10]) + ()(*(*)args[11]) +

27 ()*(*)
¨gs
[12] + ()(*(*)args[13]) +

28 ()(*(*)
¨gs
[14]Ë+ *(*Ôrgs[15] + (
öçå_t
)
u£rd©a
;

30 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d\n",

31 ()*(*)
¨gs
[0], ()(*(*)args[1]),

32 ()(*(*)
¨gs
[2]),

33 ()*(*)
¨gs
[3], ()(*(signed *)args[4]),

34 ()(*(*)
¨gs
[5]),

35 ()*(*)
¨gs
[6], ()(*(*)args[7]),

36 ()(*(*)
¨gs
[8]), ()*(*)args[9],

37 ()(*(*)
¨gs
[10]), ()(*(*)args[11]),

38 ()*(*)
¨gs
[12], ()(*(*)args[13]),

39 ()(*(*)
¨gs
[14]),*(*)args[15],

40 ()(
öçå_t
)
u£rd©a
, ()*(
ffi_¨g
 *)
ª•
);

42 
	}
}

44 (*
	t˛osuª_loc_ã°_ty≥0
)(, , ,

49 
	$maö
 ()

51 
ffi_cif
 
cif
;

52 
ffi_˛osuª
 *
p˛
;

53 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

54 
ªs
;

55 *
codñoc
;

57 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uöt64
;

58 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_söt
;

59 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_uöt64
;

60 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_söt
;

61 
˛_¨g_ty≥s
[4] = &
ffi_ty≥_ssh‹t
;

62 
˛_¨g_ty≥s
[5] = &
ffi_ty≥_uöt64
;

63 
˛_¨g_ty≥s
[6] = &
ffi_ty≥_söt
;

64 
˛_¨g_ty≥s
[7] = &
ffi_ty≥_söt
;

65 
˛_¨g_ty≥s
[8] = &
ffi_ty≥_doubÀ
;

66 
˛_¨g_ty≥s
[9] = &
ffi_ty≥_söt
;

67 
˛_¨g_ty≥s
[10] = &
ffi_ty≥_söt
;

68 
˛_¨g_ty≥s
[11] = &
ffi_ty≥_Êﬂt
;

69 
˛_¨g_ty≥s
[12] = &
ffi_ty≥_söt
;

70 
˛_¨g_ty≥s
[13] = &
ffi_ty≥_söt
;

71 
˛_¨g_ty≥s
[14] = &
ffi_ty≥_söt
;

72 
˛_¨g_ty≥s
[15] = &
ffi_ty≥_söt
;

73 
˛_¨g_ty≥s
[16] = 
NULL
;

76 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 16,

77 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

79 
p˛
 = 
	`ffi_˛osuª_Æloc
((
ffi_˛osuª
), &
codñoc
);

80 
	`CHECK
(
p˛
 !
NULL
);

81 
	`CHECK
(
codñoc
 !
NULL
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_loc_ã°_‚0
,

84 (*Ë3 , 
codñoc
Ë=
FFI_OK
);

86 
	`CHECK
(
	`memcmp
(
p˛
, 
codñoc
, (*pcl)) == 0);

88 
ªs
 = (*((
˛osuª_loc_ã°_ty≥0
)
codñoc
))

92 
	`¥ötf
("ªs: %d\n",
ªs
);

94 
	`exô
(0);

95 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_simple.c

8 
	~"ffôe°.h
"

11 
	$˛osuª_ã°
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
, * 
u£rd©a
)

13 *(
ffi_¨g
*)
ª•
 =

14 ()*(*)
¨gs
[0] + ()(*(*)args[1])

15 + ()(*(*)
¨gs
[2]) + ()(*(*)args[3])

16 + ()(
öçå_t
)
u£rd©a
;

18 
	`¥ötf
("%d %d %d %d: %d\n",

19 ()*(*)
¨gs
[0], ()(*(*)args[1]),

20 ()(*(*)
¨gs
[2]), ()(*(*)args[3]),

21 ()*(
ffi_¨g
 *)
ª•
);

23 
	}
}

25 (
	tABI_ATTR
 *
	t˛osuª_ã°_ty≥0
)(, , , );

27 
	$maö
 ()

29 
ffi_cif
 
cif
;

30 *
code
;

31 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

32 
ffi_ty≥
 * 
˛_¨g_ty≥s
[17];

33 
ªs
;

35 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uöt
;

36 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_uöt
;

37 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_uöt
;

38 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_uöt
;

39 
˛_¨g_ty≥s
[4] = 
NULL
;

42 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 4,

43 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

45 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°
,

46 (*Ë3 , 
code
Ë=
FFI_OK
);

48 
ªs
 = (*(
˛osuª_ã°_ty≥0
)
code
)(0, 1, 2, 3);

51 
	`¥ötf
("ªs: %d\n",
ªs
);

54 
	`exô
(0);

55 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_12byte.c

8 
	~"ffôe°.h
"

10 
	s˛s_°ru˘_12byã
 {

11 
	ma
;

12 
	mb
;

13 
	mc
;

14 } 
	t˛s_°ru˘_12byã
;

16 
˛s_°ru˘_12byã
 
	$˛s_°ru˘_12byã_‚
(
˛s_°ru˘_12byã
 
b1
,

17 
˛s_°ru˘_12byã
 
b2
)

19 
˛s_°ru˘_12byã
 
ªsu…
;

21 
ªsu…
.
a
 = 
b1
.®+ 
b2
.a;

22 
ªsu…
.
b
 = 
b1
.b + 
b2
.b;

23 
ªsu…
.
c
 = 
b1
.¯+ 
b2
.c;

25 
	`¥ötf
("%d %d %d %d %d %d: %d %d %d\n", 
b1
.
a
, b1.
b
, b1.
c
, 
b2
.a, b2.b, b2.c,

26 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
);

28  
ªsu…
;

29 
	}
}

31 
	$˛s_°ru˘_12byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

32 ** 
¨gs
 , * 
u£rd©a
 
__UNUSED__
)

34 
˛s_°ru˘_12byã
 
b1
, 
b2
;

36 
b1
 = *(
˛s_°ru˘_12byã
*)(
¨gs
[0]);

37 
b2
 = *(
˛s_°ru˘_12byã
*)(
¨gs
[1]);

39 *(
˛s_°ru˘_12byã
*)
ª•
 = 
	`˛s_°ru˘_12byã_‚
(
b1
, 
b2
);

40 
	}
}

42 
	$maö
 ()

44 
ffi_cif
 
cif
;

45 *
code
;

46 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

47 * 
¨gs_dbl
[5];

48 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

49 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

50 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

52 
˛s_°ru˘_12byã
 
h_dbl
 = { 7, 4, 9 };

53 
˛s_°ru˘_12byã
 
j_dbl
 = { 1, 5, 3 };

54 
˛s_°ru˘_12byã
 
ªs_dbl
;

56 
˛s_°ru˘_ty≥
.
size
 = 0;

57 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

58 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

59 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

61 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_söt
;

62 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_söt
;

63 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_söt
;

64 
˛s_°ru˘_fõlds
[3] = 
NULL
;

66 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[2] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

71 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

73 
¨gs_dbl
[0] = &
h_dbl
;

74 
¨gs_dbl
[1] = &
j_dbl
;

75 
¨gs_dbl
[2] = 
NULL
;

77 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_12byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

79 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

82 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_12byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

84 
ªs_dbl
.
a
 = 0;

85 
ªs_dbl
.
b
 = 0;

86 
ªs_dbl
.
c
 = 0;

88 
ªs_dbl
 = ((
	`˛s_°ru˘_12byã
(*)(
˛s_°ru˘_12byã
, cls_°ru˘_12byã))(
code
))(
h_dbl
, 
j_dbl
);

90 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

93 
	`exô
(0);

94 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_16byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_16byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 } 
	t˛s_°ru˘_16byã
;

17 
˛s_°ru˘_16byã
 
	$˛s_°ru˘_16byã_‚
(
˛s_°ru˘_16byã
 
b1
,

18 
˛s_°ru˘_16byã
 
b2
)

20 
˛s_°ru˘_16byã
 
ªsu…
;

22 
ªsu…
.
a
 = 
b1
.®+ 
b2
.a;

23 
ªsu…
.
b
 = 
b1
.b + 
b2
.b;

24 
ªsu…
.
c
 = 
b1
.¯+ 
b2
.c;

26 
	`¥ötf
("%d %g %d %d %g %d: %d %g %d\n", 
b1
.
a
, b1.
b
, b1.
c
, 
b2
.a, b2.b, b2.c,

27 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
);

29  
ªsu…
;

30 
	}
}

32 
	$˛s_°ru˘_16byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

33 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_16byã
 
b1
, 
b2
;

37 
b1
 = *(
˛s_°ru˘_16byã
*)(
¨gs
[0]);

38 
b2
 = *(
˛s_°ru˘_16byã
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_16byã
*)
ª•
 = 
	`˛s_°ru˘_16byã_‚
(
b1
, 
b2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_16byã
 
h_dbl
 = { 7, 8.0, 9 };

54 
˛s_°ru˘_16byã
 
j_dbl
 = { 1, 9.0, 3 };

55 
˛s_°ru˘_16byã
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_söt
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

64 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_söt
;

65 
˛s_°ru˘_fõlds
[3] = 
NULL
;

67 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[2] = 
NULL
;

71 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

72 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

74 
¨gs_dbl
[0] = &
h_dbl
;

75 
¨gs_dbl
[1] = &
j_dbl
;

76 
¨gs_dbl
[2] = 
NULL
;

78 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_16byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

80 
	`¥ötf
("ªs: %d %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

83 
ªs_dbl
.
a
 = 0;

84 
ªs_dbl
.
b
 = 0.0;

85 
ªs_dbl
.
c
 = 0;

87 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_16byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

89 
ªs_dbl
 = ((
	`˛s_°ru˘_16byã
(*)(
˛s_°ru˘_16byã
, cls_°ru˘_16byã))(
code
))(
h_dbl
, 
j_dbl
);

91 
	`¥ötf
("ªs: %d %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

94 
	`exô
(0);

95 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_18byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_18byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 
	md
;

16 } 
	t˛s_°ru˘_18byã
;

18 
˛s_°ru˘_18byã
 
	$˛s_°ru˘_18byã_‚
(
˛s_°ru˘_18byã
 
a1
,

19 
˛s_°ru˘_18byã
 
a2
)

21 
˛s_°ru˘_18byã
 
ªsu…
;

23 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

24 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

26 
ªsu…
.
d
 = 
a1
.d + 
a2
.d;

29 
	`¥ötf
("%g %d %d %g %g %d %d %g: %g %d %d %g\n", 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,

30 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,

31 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
);

32  
ªsu…
;

33 
	}
}

36 
	$˛s_°ru˘_18byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

37 * 
u£rd©a
 
__UNUSED__
)

39 
˛s_°ru˘_18byã
 
a1
, 
a2
;

41 
a1
 = *(
˛s_°ru˘_18byã
*)(
¨gs
[0]);

42 
a2
 = *(
˛s_°ru˘_18byã
*)(
¨gs
[1]);

44 *(
˛s_°ru˘_18byã
*)
ª•
 = 
	`˛s_°ru˘_18byã_‚
(
a1
, 
a2
);

45 
	}
}

47 
	$maö
 ()

49 
ffi_cif
 
cif
;

50 *
code
;

51 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

52 * 
¨gs_dbl
[3];

53 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[5];

54 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

55 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

57 
˛s_°ru˘_18byã
 
g_dbl
 = { 1.0, 127, 126, 3.0 };

58 
˛s_°ru˘_18byã
 
f_dbl
 = { 4.0, 125, 124, 5.0 };

59 
˛s_°ru˘_18byã
 
ªs_dbl
;

61 
˛s_°ru˘_ty≥
.
size
 = 0;

62 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

63 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

64 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

66 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

67 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

68 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

69 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_doubÀ
;

70 
˛s_°ru˘_fõlds
[4] = 
NULL
;

72 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

73 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

74 
dbl_¨g_ty≥s
[2] = 
NULL
;

76 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

77 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

79 
¨gs_dbl
[0] = &
g_dbl
;

80 
¨gs_dbl
[1] = &
f_dbl
;

81 
¨gs_dbl
[2] = 
NULL
;

83 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_18byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

85 
	`¥ötf
("ªs: %g %d %d %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

88 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_18byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

90 
ªs_dbl
 = ((
	`˛s_°ru˘_18byã
(*)(
˛s_°ru˘_18byã
, cls_°ru˘_18byã))(
code
))(
g_dbl
, 
f_dbl
);

92 
	`¥ötf
("ªs: %g %d %d %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

95 
	`exô
(0);

96 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_19byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_19byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 
	md
;

16 
	me
;

17 } 
	t˛s_°ru˘_19byã
;

19 
˛s_°ru˘_19byã
 
	$˛s_°ru˘_19byã_‚
(
˛s_°ru˘_19byã
 
a1
,

20 
˛s_°ru˘_19byã
 
a2
)

22 
˛s_°ru˘_19byã
 
ªsu…
;

24 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

25 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

26 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

27 
ªsu…
.
d
 = 
a1
.d + 
a2
.d;

28 
ªsu…
.
e
 = 
a1
.ê+ 
a2
.e;

31 
	`¥ötf
("%g %d %d %g %d %g %d %d %g %d: %g %d %d %g %d\n",

32 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,á1.
e
,

33 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,á2.
e
,

34 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
,Ñesu….
e
);

35  
ªsu…
;

36 
	}
}

39 
	$˛s_°ru˘_19byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

40 * 
u£rd©a
 
__UNUSED__
)

42 
˛s_°ru˘_19byã
 
a1
, 
a2
;

44 
a1
 = *(
˛s_°ru˘_19byã
*)(
¨gs
[0]);

45 
a2
 = *(
˛s_°ru˘_19byã
*)(
¨gs
[1]);

47 *(
˛s_°ru˘_19byã
*)
ª•
 = 
	`˛s_°ru˘_19byã_‚
(
a1
, 
a2
);

48 
	}
}

50 
	$maö
 ()

52 
ffi_cif
 
cif
;

53 *
code
;

54 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

55 * 
¨gs_dbl
[3];

56 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[6];

57 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

58 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

60 
˛s_°ru˘_19byã
 
g_dbl
 = { 1.0, 127, 126, 3.0, 120 };

61 
˛s_°ru˘_19byã
 
f_dbl
 = { 4.0, 125, 124, 5.0, 119 };

62 
˛s_°ru˘_19byã
 
ªs_dbl
;

64 
˛s_°ru˘_ty≥
.
size
 = 0;

65 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

66 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

67 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

69 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

70 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

71 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

72 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_doubÀ
;

73 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_uch¨
;

74 
˛s_°ru˘_fõlds
[5] = 
NULL
;

76 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

77 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

78 
dbl_¨g_ty≥s
[2] = 
NULL
;

80 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

81 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

83 
¨gs_dbl
[0] = &
g_dbl
;

84 
¨gs_dbl
[1] = &
f_dbl
;

85 
¨gs_dbl
[2] = 
NULL
;

87 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_19byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

89 
	`¥ötf
("ªs: %g %d %d %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

90 
ªs_dbl
.
d
,Ñes_dbl.
e
);

93 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_19byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

95 
ªs_dbl
 = ((
	`˛s_°ru˘_19byã
(*)(
˛s_°ru˘_19byã
, cls_°ru˘_19byã))(
code
))(
g_dbl
, 
f_dbl
);

97 
	`¥ötf
("ªs: %g %d %d %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

98 
ªs_dbl
.
d
,Ñes_dbl.
e
);

101 
	`exô
(0);

102 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_1_1byte.c

12 
	~"ffôe°.h
"

14 
	s˛s_°ru˘_1_1byã
 {

15 
	ma
;

16 } 
	t˛s_°ru˘_1_1byã
;

18 
˛s_°ru˘_1_1byã
 
	$˛s_°ru˘_1_1byã_‚
(
˛s_°ru˘_1_1byã
 
a1
,

19 
˛s_°ru˘_1_1byã
 
a2
)

21 
˛s_°ru˘_1_1byã
 
ªsu…
;

23 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

25 
	`¥ötf
("%d %d: %d\n", 
a1
.
a
, 
a2
.a, 
ªsu…
.a);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_1_1byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_1_1byã
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_1_1byã
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_1_1byã
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_1_1byã
*)
ª•
 = 
	`˛s_°ru˘_1_1byã_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[2];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_1_1byã
 
g_dbl
 = { 12 };

54 
˛s_°ru˘_1_1byã
 
f_dbl
 = { 178 };

55 
˛s_°ru˘_1_1byã
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

63 
˛s_°ru˘_fõlds
[1] = 
NULL
;

65 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

66 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[2] = 
NULL
;

69 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

70 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

72 
¨gs_dbl
[0] = &
g_dbl
;

73 
¨gs_dbl
[1] = &
f_dbl
;

74 
¨gs_dbl
[2] = 
NULL
;

76 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_1_1byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

78 
	`¥ötf
("ªs: %d\n", 
ªs_dbl
.
a
);

81 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_1_1byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

83 
ªs_dbl
 = ((
	`˛s_°ru˘_1_1byã
(*)(
˛s_°ru˘_1_1byã
, cls_°ru˘_1_1byã))(
code
))(
g_dbl
, 
f_dbl
);

85 
	`¥ötf
("ªs: %d\n", 
ªs_dbl
.
a
);

88 
	`exô
(0);

89 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_20byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_20byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 } 
	t˛s_°ru˘_20byã
;

17 
˛s_°ru˘_20byã
 
	$˛s_°ru˘_20byã_‚
(
˛s_°ru˘_20byã
 
a1
,

18 
˛s_°ru˘_20byã
 
a2
)

20 
˛s_°ru˘_20byã
 
ªsu…
;

22 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

23 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

24 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

26 
	`¥ötf
("%g %g %d %g %g %d: %g %g %d\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c,

27 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
);

28  
ªsu…
;

29 
	}
}

32 
	$˛s_°ru˘_20byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

33 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_20byã
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_20byã
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_20byã
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_20byã
*)
ª•
 = 
	`˛s_°ru˘_20byã_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_20byã
 
g_dbl
 = { 1.0, 2.0, 3 };

54 
˛s_°ru˘_20byã
 
f_dbl
 = { 4.0, 5.0, 7 };

55 
˛s_°ru˘_20byã
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

64 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_söt
;

65 
˛s_°ru˘_fõlds
[3] = 
NULL
;

67 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[2] = 
NULL
;

71 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

72 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

74 
¨gs_dbl
[0] = &
g_dbl
;

75 
¨gs_dbl
[1] = &
f_dbl
;

76 
¨gs_dbl
[2] = 
NULL
;

78 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_20byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

80 
	`¥ötf
("ªs: %g %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_20byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

85 
ªs_dbl
 = ((
	`˛s_°ru˘_20byã
(*)(
˛s_°ru˘_20byã
, cls_°ru˘_20byã))(
code
))(
g_dbl
, 
f_dbl
);

87 
	`¥ötf
("ªs: %g %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

90 
	`exô
(0);

91 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_20byte1.c

11 
	~"ffôe°.h
"

13 
	s˛s_°ru˘_20byã
 {

14 
	ma
;

15 
	mb
;

16 
	mc
;

17 } 
	t˛s_°ru˘_20byã
;

19 
˛s_°ru˘_20byã
 
	$˛s_°ru˘_20byã_‚
(
˛s_°ru˘_20byã
 
a1
,

20 
˛s_°ru˘_20byã
 
a2
)

22 
˛s_°ru˘_20byã
 
ªsu…
;

24 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

25 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

26 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

28 
	`¥ötf
("%d %g %g %d %g %g: %d %g %g\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c,

29 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
);

30  
ªsu…
;

31 
	}
}

34 
	$˛s_°ru˘_20byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

35 * 
u£rd©a
 
__UNUSED__
)

37 
˛s_°ru˘_20byã
 
a1
, 
a2
;

39 
a1
 = *(
˛s_°ru˘_20byã
*)(
¨gs
[0]);

40 
a2
 = *(
˛s_°ru˘_20byã
*)(
¨gs
[1]);

42 *(
˛s_°ru˘_20byã
*)
ª•
 = 
	`˛s_°ru˘_20byã_‚
(
a1
, 
a2
);

43 
	}
}

45 
	$maö
 ()

47 
ffi_cif
 
cif
;

48 *
code
;

49 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

50 * 
¨gs_dbl
[3];

51 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

52 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

53 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

55 
˛s_°ru˘_20byã
 
g_dbl
 = { 1, 2.0, 3.0 };

56 
˛s_°ru˘_20byã
 
f_dbl
 = { 4, 5.0, 7.0 };

57 
˛s_°ru˘_20byã
 
ªs_dbl
;

59 
˛s_°ru˘_ty≥
.
size
 = 0;

60 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

61 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

62 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

64 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_söt
;

65 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

66 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_doubÀ
;

67 
˛s_°ru˘_fõlds
[3] = 
NULL
;

69 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

70 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

71 
dbl_¨g_ty≥s
[2] = 
NULL
;

73 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

74 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

76 
¨gs_dbl
[0] = &
g_dbl
;

77 
¨gs_dbl
[1] = &
f_dbl
;

78 
¨gs_dbl
[2] = 
NULL
;

80 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_20byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

82 
	`¥ötf
("ªs: %d %g %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

85 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_20byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

87 
ªs_dbl
 = ((
	`˛s_°ru˘_20byã
(*)(
˛s_°ru˘_20byã
, cls_°ru˘_20byã))(
code
))(
g_dbl
, 
f_dbl
);

89 
	`¥ötf
("ªs: %d %g %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

92 
	`exô
(0);

93 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_24byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_24byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 
	md
;

16 } 
	t˛s_°ru˘_24byã
;

18 
˛s_°ru˘_24byã
 
	$˛s_°ru˘_24byã_‚
(
˛s_°ru˘_24byã
 
b0
,

19 
˛s_°ru˘_24byã
 
b1
,

20 
˛s_°ru˘_24byã
 
b2
,

21 
˛s_°ru˘_24byã
 
b3
)

23 
˛s_°ru˘_24byã
 
ªsu…
;

25 
ªsu…
.
a
 = 
b0
.®+ 
b1
.®+ 
b2
.®+ 
b3
.a;

26 
ªsu…
.
b
 = 
b0
.b + 
b1
.b + 
b2
.b + 
b3
.b;

27 
ªsu…
.
c
 = 
b0
.¯+ 
b1
.¯+ 
b2
.¯+ 
b3
.c;

28 
ªsu…
.
d
 = 
b0
.d + 
b1
.d + 
b2
.d + 
b3
.d;

30 
	`¥ötf
("%g %g %d %g %g %g %d %g %g %g %d %g %g %g %d %g: %g %g %d %g\n",

31 
b0
.
a
, b0.
b
, b0.
c
, b0.
d
,

32 
b1
.
a
, b1.
b
, b1.
c
, b1.
d
,

33 
b2
.
a
, b2.
b
, b2.
c
, b2.
d
,

34 
b3
.
a
, b3.
b
, b3.
c
, 
b2
.
d
,

35 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
);

37  
ªsu…
;

38 
	}
}

41 
	$˛s_°ru˘_24byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

42 * 
u£rd©a
 
__UNUSED__
)

44 
˛s_°ru˘_24byã
 
b0
, 
b1
, 
b2
, 
b3
;

46 
b0
 = *(
˛s_°ru˘_24byã
*)(
¨gs
[0]);

47 
b1
 = *(
˛s_°ru˘_24byã
*)(
¨gs
[1]);

48 
b2
 = *(
˛s_°ru˘_24byã
*)(
¨gs
[2]);

49 
b3
 = *(
˛s_°ru˘_24byã
*)(
¨gs
[3]);

51 *(
˛s_°ru˘_24byã
*)
ª•
 = 
	`˛s_°ru˘_24byã_‚
(
b0
, 
b1
, 
b2
, 
b3
);

52 
	}
}

54 
	$maö
 ()

56 
ffi_cif
 
cif
;

57 *
code
;

58 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

59 * 
¨gs_dbl
[5];

60 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[5];

61 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

62 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

64 
˛s_°ru˘_24byã
 
e_dbl
 = { 9.0, 2.0, 6, 5.0 };

65 
˛s_°ru˘_24byã
 
f_dbl
 = { 1.0, 2.0, 3, 7.0 };

66 
˛s_°ru˘_24byã
 
g_dbl
 = { 4.0, 5.0, 7, 9.0 };

67 
˛s_°ru˘_24byã
 
h_dbl
 = { 8.0, 6.0, 1, 4.0 };

68 
˛s_°ru˘_24byã
 
ªs_dbl
;

70 
˛s_°ru˘_ty≥
.
size
 = 0;

71 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

72 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

73 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

75 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

76 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

77 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_söt
;

78 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_Êﬂt
;

79 
˛s_°ru˘_fõlds
[4] = 
NULL
;

81 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

82 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

83 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥
;

84 
dbl_¨g_ty≥s
[3] = &
˛s_°ru˘_ty≥
;

85 
dbl_¨g_ty≥s
[4] = 
NULL
;

87 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4, &
˛s_°ru˘_ty≥
,

88 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

90 
¨gs_dbl
[0] = &
e_dbl
;

91 
¨gs_dbl
[1] = &
f_dbl
;

92 
¨gs_dbl
[2] = &
g_dbl
;

93 
¨gs_dbl
[3] = &
h_dbl
;

94 
¨gs_dbl
[4] = 
NULL
;

96 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_24byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

98 
	`¥ötf
("ªs: %g %g %d %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

101 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_24byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

103 
ªs_dbl
 = ((
	`˛s_°ru˘_24byã
(*)(
˛s_°ru˘_24byã
,

104 
˛s_°ru˘_24byã
,

105 
˛s_°ru˘_24byã
,

106 
˛s_°ru˘_24byã
))

107 (
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
, 
h_dbl
);

109 
	`¥ötf
("ªs: %g %g %d %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

112 
	`exô
(0);

113 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_2byte.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_2byã
 {

13 
	ma
;

14 
	mb
;

15 } 
	t˛s_°ru˘_2byã
;

17 
˛s_°ru˘_2byã
 
	$˛s_°ru˘_2byã_‚
(
˛s_°ru˘_2byã
 
a1
,

18 
˛s_°ru˘_2byã
 
a2
)

20 
˛s_°ru˘_2byã
 
ªsu…
;

22 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

23 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
	`¥ötf
("%d %d %d %d: %d %d\n", 
a1
.
a
,á1.
b
, 
a2
.a,á2.b, 
ªsu…
.a,Ñesult.b);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_2byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_2byã
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_2byã
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_2byã
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_2byã
*)
ª•
 = 
	`˛s_°ru˘_2byã_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_2byã
 
g_dbl
 = { 12, 127 };

54 
˛s_°ru˘_2byã
 
f_dbl
 = { 1, 13 };

55 
˛s_°ru˘_2byã
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

64 
˛s_°ru˘_fõlds
[2] = 
NULL
;

66 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[2] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

71 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

73 
¨gs_dbl
[0] = &
g_dbl
;

74 
¨gs_dbl
[1] = &
f_dbl
;

75 
¨gs_dbl
[2] = 
NULL
;

77 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_2byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

79 
	`¥ötf
("ªs: %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

82 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_2byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

84 
ªs_dbl
 = ((
	`˛s_°ru˘_2byã
(*)(
˛s_°ru˘_2byã
, cls_°ru˘_2byã))(
code
))(
g_dbl
, 
f_dbl
);

86 
	`¥ötf
("ªs: %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

89 
	`exô
(0);

90 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_3_1byte.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_3_1byã
 {

13 
	ma
;

14 
	mb
;

15 
	mc
;

16 } 
	t˛s_°ru˘_3_1byã
;

18 
˛s_°ru˘_3_1byã
 
	$˛s_°ru˘_3_1byã_‚
(
˛s_°ru˘_3_1byã
 
a1
,

19 
˛s_°ru˘_3_1byã
 
a2
)

21 
˛s_°ru˘_3_1byã
 
ªsu…
;

23 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

24 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

27 
	`¥ötf
("%d %d %d %d %d %d: %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
,

28 
a2
.
a
,á2.
b
,á2.
c
,

29 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
);

31  
ªsu…
;

32 
	}
}

35 
	$˛s_°ru˘_3_1byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

36 * 
u£rd©a
 
__UNUSED__
)

39 
˛s_°ru˘_3_1byã
 
a1
, 
a2
;

41 
a1
 = *(
˛s_°ru˘_3_1byã
*)(
¨gs
[0]);

42 
a2
 = *(
˛s_°ru˘_3_1byã
*)(
¨gs
[1]);

44 *(
˛s_°ru˘_3_1byã
*)
ª•
 = 
	`˛s_°ru˘_3_1byã_‚
(
a1
, 
a2
);

45 
	}
}

47 
	$maö
 ()

49 
ffi_cif
 
cif
;

50 *
code
;

51 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

52 * 
¨gs_dbl
[5];

53 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

54 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

55 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

57 
˛s_°ru˘_3_1byã
 
g_dbl
 = { 12, 13, 14 };

58 
˛s_°ru˘_3_1byã
 
f_dbl
 = { 178, 179, 180 };

59 
˛s_°ru˘_3_1byã
 
ªs_dbl
;

61 
˛s_°ru˘_ty≥
.
size
 = 0;

62 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

63 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

64 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

66 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

67 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

68 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

69 
˛s_°ru˘_fõlds
[3] = 
NULL
;

71 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

72 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

73 
dbl_¨g_ty≥s
[2] = 
NULL
;

75 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

76 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

78 
¨gs_dbl
[0] = &
g_dbl
;

79 
¨gs_dbl
[1] = &
f_dbl
;

80 
¨gs_dbl
[2] = 
NULL
;

82 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_3_1byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

84 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

87 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_3_1byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

89 
ªs_dbl
 = ((
	`˛s_°ru˘_3_1byã
(*)(
˛s_°ru˘_3_1byã
, cls_°ru˘_3_1byã))(
code
))(
g_dbl
, 
f_dbl
);

91 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

94 
	`exô
(0);

95 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_3byte1.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_3byã
 {

13 
	ma
;

14 
	mb
;

15 } 
	t˛s_°ru˘_3byã
;

17 
˛s_°ru˘_3byã
 
	$˛s_°ru˘_3byã_‚
(
˛s_°ru˘_3byã
 
a1
,

18 
˛s_°ru˘_3byã
 
a2
)

20 
˛s_°ru˘_3byã
 
ªsu…
;

22 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

23 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
	`¥ötf
("%d %d %d %d: %d %d\n", 
a1
.
a
,á1.
b
, 
a2
.a,á2.b, 
ªsu…
.a,Ñesult.b);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_3byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_3byã
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_3byã
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_3byã
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_3byã
*)
ª•
 = 
	`˛s_°ru˘_3byã_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_3byã
 
g_dbl
 = { 12, 119 };

54 
˛s_°ru˘_3byã
 
f_dbl
 = { 1, 15 };

55 
˛s_°ru˘_3byã
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_ush‹t
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

64 
˛s_°ru˘_fõlds
[2] = 
NULL
;

66 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[2] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

71 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

73 
¨gs_dbl
[0] = &
g_dbl
;

74 
¨gs_dbl
[1] = &
f_dbl
;

75 
¨gs_dbl
[2] = 
NULL
;

77 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_3byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

79 
	`¥ötf
("ªs: %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

82 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_3byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

84 
ªs_dbl
 = ((
	`˛s_°ru˘_3byã
(*)(
˛s_°ru˘_3byã
, cls_°ru˘_3byã))(
code
))(
g_dbl
, 
f_dbl
);

86 
	`¥ötf
("ªs: %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

89 
	`exô
(0);

90 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_3byte2.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_3byã_1
 {

13 
	ma
;

14 
	mb
;

15 } 
	t˛s_°ru˘_3byã_1
;

17 
˛s_°ru˘_3byã_1
 
	$˛s_°ru˘_3byã_‚1
(
˛s_°ru˘_3byã_1
 
a1
,

18 
˛s_°ru˘_3byã_1
 
a2
)

20 
˛s_°ru˘_3byã_1
 
ªsu…
;

22 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

23 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
	`¥ötf
("%d %d %d %d: %d %d\n", 
a1
.
a
,á1.
b
, 
a2
.a,á2.b, 
ªsu…
.a,Ñesult.b);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_3byã_gn1
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_3byã_1
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_3byã_1
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_3byã_1
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_3byã_1
*)
ª•
 = 
	`˛s_°ru˘_3byã_‚1
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_3byã_1
 
g_dbl
 = { 15, 125 };

54 
˛s_°ru˘_3byã_1
 
f_dbl
 = { 9, 19 };

55 
˛s_°ru˘_3byã_1
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_ush‹t
;

64 
˛s_°ru˘_fõlds
[2] = 
NULL
;

66 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[2] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

71 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

73 
¨gs_dbl
[0] = &
g_dbl
;

74 
¨gs_dbl
[1] = &
f_dbl
;

75 
¨gs_dbl
[2] = 
NULL
;

77 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_3byã_‚1
), &
ªs_dbl
, 
¨gs_dbl
);

79 
	`¥ötf
("ªs: %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

82 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_3byã_gn1
, 
NULL
, 
code
Ë=
FFI_OK
);

84 
ªs_dbl
 = ((
	`˛s_°ru˘_3byã_1
(*)(
˛s_°ru˘_3byã_1
, cls_°ru˘_3byã_1))(
code
))(
g_dbl
, 
f_dbl
);

86 
	`¥ötf
("ªs: %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

89 
	`exô
(0);

90 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_4_1byte.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_4_1byã
 {

13 
	ma
;

14 
	mb
;

15 
	mc
;

16 
	md
;

17 } 
	t˛s_°ru˘_4_1byã
;

19 
˛s_°ru˘_4_1byã
 
	$˛s_°ru˘_4_1byã_‚
(
˛s_°ru˘_4_1byã
 
a1
,

20 
˛s_°ru˘_4_1byã
 
a2
)

22 
˛s_°ru˘_4_1byã
 
ªsu…
;

24 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

25 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

26 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

27 
ªsu…
.
d
 = 
a1
.d + 
a2
.d;

29 
	`¥ötf
("%d %d %d %d %d %d %d %d: %d %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,

30 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,

31 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
);

33  
ªsu…
;

34 
	}
}

37 
	$˛s_°ru˘_4_1byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

38 * 
u£rd©a
 
__UNUSED__
)

41 
˛s_°ru˘_4_1byã
 
a1
, 
a2
;

43 
a1
 = *(
˛s_°ru˘_4_1byã
*)(
¨gs
[0]);

44 
a2
 = *(
˛s_°ru˘_4_1byã
*)(
¨gs
[1]);

46 *(
˛s_°ru˘_4_1byã
*)
ª•
 = 
	`˛s_°ru˘_4_1byã_‚
(
a1
, 
a2
);

47 
	}
}

49 
	$maö
 ()

51 
ffi_cif
 
cif
;

52 *
code
;

53 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

54 * 
¨gs_dbl
[5];

55 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[5];

56 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

57 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

59 
˛s_°ru˘_4_1byã
 
g_dbl
 = { 12, 13, 14, 15 };

60 
˛s_°ru˘_4_1byã
 
f_dbl
 = { 178, 179, 180, 181 };

61 
˛s_°ru˘_4_1byã
 
ªs_dbl
;

63 
˛s_°ru˘_ty≥
.
size
 = 0;

64 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

65 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

66 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

68 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

69 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

70 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

71 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_uch¨
;

72 
˛s_°ru˘_fõlds
[4] = 
NULL
;

74 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

75 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

76 
dbl_¨g_ty≥s
[2] = 
NULL
;

78 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

79 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

81 
¨gs_dbl
[0] = &
g_dbl
;

82 
¨gs_dbl
[1] = &
f_dbl
;

83 
¨gs_dbl
[2] = 
NULL
;

85 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_4_1byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

87 
	`¥ötf
("ªs: %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

90 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_4_1byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

92 
ªs_dbl
 = ((
	`˛s_°ru˘_4_1byã
(*)(
˛s_°ru˘_4_1byã
, cls_°ru˘_4_1byã))(
code
))(
g_dbl
, 
f_dbl
);

94 
	`¥ötf
("ªs: %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

97 
	`exô
(0);

98 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_4byte.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_4byã
 {

13 
	ma
;

14 
	mb
;

15 } 
	t˛s_°ru˘_4byã
;

17 
˛s_°ru˘_4byã
 
	$˛s_°ru˘_4byã_‚
(
˛s_°ru˘_4byã
 
a1
,

18 
˛s_°ru˘_4byã
 
a2
)

20 
˛s_°ru˘_4byã
 
ªsu…
;

22 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

23 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
	`¥ötf
("%d %d %d %d: %d %d\n", 
a1
.
a
,á1.
b
, 
a2
.a,á2.b, 
ªsu…
.a,Ñesult.b);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_4byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_4byã
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_4byã
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_4byã
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_4byã
*)
ª•
 = 
	`˛s_°ru˘_4byã_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_4byã
 
g_dbl
 = { 127, 120 };

54 
˛s_°ru˘_4byã
 
f_dbl
 = { 12, 128 };

55 
˛s_°ru˘_4byã
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_ush‹t
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_ush‹t
;

64 
˛s_°ru˘_fõlds
[2] = 
NULL
;

66 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[2] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

71 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

73 
¨gs_dbl
[0] = &
g_dbl
;

74 
¨gs_dbl
[1] = &
f_dbl
;

75 
¨gs_dbl
[2] = 
NULL
;

77 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_4byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

79 
	`¥ötf
("ªs: %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

82 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_4byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

84 
ªs_dbl
 = ((
	`˛s_°ru˘_4byã
(*)(
˛s_°ru˘_4byã
, cls_°ru˘_4byã))(
code
))(
g_dbl
, 
f_dbl
);

86 
	`¥ötf
("ªs: %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

89 
	`exô
(0);

90 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_5_1_byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_5byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 
	md
;

16 
	me
;

17 } 
	t˛s_°ru˘_5byã
;

19 
˛s_°ru˘_5byã
 
	$˛s_°ru˘_5byã_‚
(
˛s_°ru˘_5byã
 
a1
,

20 
˛s_°ru˘_5byã
 
a2
)

22 
˛s_°ru˘_5byã
 
ªsu…
;

24 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

25 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

26 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

27 
ªsu…
.
d
 = 
a1
.d + 
a2
.d;

28 
ªsu…
.
e
 = 
a1
.ê+ 
a2
.e;

30 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d: %d %d %d %d %d\n",

31 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,á1.
e
,

32 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,á2.
e
,

33 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
,Ñesu….
e
);

35  
ªsu…
;

36 
	}
}

39 
	$˛s_°ru˘_5byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

40 * 
u£rd©a
 
__UNUSED__
)

43 
˛s_°ru˘_5byã
 
a1
, 
a2
;

45 
a1
 = *(
˛s_°ru˘_5byã
*)(
¨gs
[0]);

46 
a2
 = *(
˛s_°ru˘_5byã
*)(
¨gs
[1]);

48 *(
˛s_°ru˘_5byã
*)
ª•
 = 
	`˛s_°ru˘_5byã_‚
(
a1
, 
a2
);

49 
	}
}

51 
	$maö
 ()

53 
ffi_cif
 
cif
;

54 *
code
;

55 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

56 * 
¨gs_dbl
[5];

57 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[6];

58 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

59 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

61 
˛s_°ru˘_5byã
 
g_dbl
 = { 127, 120, 1, 3, 4 };

62 
˛s_°ru˘_5byã
 
f_dbl
 = { 12, 128, 9, 3, 4 };

63 
˛s_°ru˘_5byã
 
ªs_dbl
 = { 0, 0, 0, 0, 0 };

65 
˛s_°ru˘_ty≥
.
size
 = 0;

66 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

67 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

68 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

70 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

71 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

72 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

73 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_uch¨
;

74 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_uch¨
;

75 
˛s_°ru˘_fõlds
[5] = 
NULL
;

77 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

78 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

79 
dbl_¨g_ty≥s
[2] = 
NULL
;

81 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

82 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

84 
¨gs_dbl
[0] = &
g_dbl
;

85 
¨gs_dbl
[1] = &
f_dbl
;

86 
¨gs_dbl
[2] = 
NULL
;

88 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_5byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

90 
	`¥ötf
("ªs: %d %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

91 
ªs_dbl
.
d
,Ñes_dbl.
e
);

94 
ªs_dbl
.
a
 = 0;

95 
ªs_dbl
.
b
 = 0;

96 
ªs_dbl
.
c
 = 0;

97 
ªs_dbl
.
d
 = 0;

98 
ªs_dbl
.
e
 = 0;

100 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_5byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

102 
ªs_dbl
 = ((
	`˛s_°ru˘_5byã
(*)(
˛s_°ru˘_5byã
, cls_°ru˘_5byã))(
code
))(
g_dbl
, 
f_dbl
);

104 
	`¥ötf
("ªs: %d %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

105 
ªs_dbl
.
d
,Ñes_dbl.
e
);

108 
	`exô
(0);

109 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_5byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_5byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 } 
	t˛s_°ru˘_5byã
;

17 
˛s_°ru˘_5byã
 
	$˛s_°ru˘_5byã_‚
(
˛s_°ru˘_5byã
 
a1
,

18 
˛s_°ru˘_5byã
 
a2
)

20 
˛s_°ru˘_5byã
 
ªsu…
;

22 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

23 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

24 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

26 
	`¥ötf
("%d %d %d %d %d %d: %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
,

27 
a2
.
a
,á2.
b
,á2.
c
,

28 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
);

30  
ªsu…
;

31 
	}
}

34 
	$˛s_°ru˘_5byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

35 * 
u£rd©a
 
__UNUSED__
)

38 
˛s_°ru˘_5byã
 
a1
, 
a2
;

40 
a1
 = *(
˛s_°ru˘_5byã
*)(
¨gs
[0]);

41 
a2
 = *(
˛s_°ru˘_5byã
*)(
¨gs
[1]);

43 *(
˛s_°ru˘_5byã
*)
ª•
 = 
	`˛s_°ru˘_5byã_‚
(
a1
, 
a2
);

44 
	}
}

46 
	$maö
 ()

48 
ffi_cif
 
cif
;

49 *
code
;

50 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

51 * 
¨gs_dbl
[5];

52 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

53 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

54 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

56 
˛s_°ru˘_5byã
 
g_dbl
 = { 127, 120, 1 };

57 
˛s_°ru˘_5byã
 
f_dbl
 = { 12, 128, 9 };

58 
˛s_°ru˘_5byã
 
ªs_dbl
 = { 0, 0, 0 };

60 
˛s_°ru˘_ty≥
.
size
 = 0;

61 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

62 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

63 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

65 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_ush‹t
;

66 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_ush‹t
;

67 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

68 
˛s_°ru˘_fõlds
[3] = 
NULL
;

70 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

71 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

72 
dbl_¨g_ty≥s
[2] = 
NULL
;

74 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

75 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

77 
¨gs_dbl
[0] = &
g_dbl
;

78 
¨gs_dbl
[1] = &
f_dbl
;

79 
¨gs_dbl
[2] = 
NULL
;

81 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_5byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

83 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

86 
ªs_dbl
.
a
 = 0;

87 
ªs_dbl
.
b
 = 0;

88 
ªs_dbl
.
c
 = 0;

90 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_5byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

92 
ªs_dbl
 = ((
	`˛s_°ru˘_5byã
(*)(
˛s_°ru˘_5byã
, cls_°ru˘_5byã))(
code
))(
g_dbl
, 
f_dbl
);

94 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

97 
	`exô
(0);

98 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_64byte.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_64byã
 {

13 
	ma
;

14 
	mb
;

15 
	mc
;

16 
	md
;

17 
	me
;

18 
	mf
;

19 
	mg
;

20 
	mh
;

21 } 
	t˛s_°ru˘_64byã
;

23 
˛s_°ru˘_64byã
 
	$˛s_°ru˘_64byã_‚
(
˛s_°ru˘_64byã
 
b0
,

24 
˛s_°ru˘_64byã
 
b1
,

25 
˛s_°ru˘_64byã
 
b2
,

26 
˛s_°ru˘_64byã
 
b3
)

28 
˛s_°ru˘_64byã
 
ªsu…
;

30 
ªsu…
.
a
 = 
b0
.®+ 
b1
.®+ 
b2
.®+ 
b3
.a;

31 
ªsu…
.
b
 = 
b0
.b + 
b1
.b + 
b2
.b + 
b3
.b;

32 
ªsu…
.
c
 = 
b0
.¯+ 
b1
.¯+ 
b2
.¯+ 
b3
.c;

33 
ªsu…
.
d
 = 
b0
.d + 
b1
.d + 
b2
.d + 
b3
.d;

34 
ªsu…
.
e
 = 
b0
.ê+ 
b1
.ê+ 
b2
.ê+ 
b3
.e;

35 
ªsu…
.
f
 = 
b0
.‡+ 
b1
.‡+ 
b2
.‡+ 
b3
.f;

36 
ªsu…
.
g
 = 
b0
.g + 
b1
.g + 
b2
.g + 
b3
.g;

37 
ªsu…
.
h
 = 
b0
.h + 
b1
.h + 
b2
.h + 
b3
.h;

39 
	`¥ötf
("%g %g %g %g %g %g %g %g\n", 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,

40 
ªsu…
.
d
,Ñesu….
e
,Ñesu….
f
,Ñesu….
g
,Ñesu….
h
);

42  
ªsu…
;

43 
	}
}

46 
	$˛s_°ru˘_64byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

47 * 
u£rd©a
 
__UNUSED__
)

49 
˛s_°ru˘_64byã
 
b0
, 
b1
, 
b2
, 
b3
;

51 
b0
 = *(
˛s_°ru˘_64byã
*)(
¨gs
[0]);

52 
b1
 = *(
˛s_°ru˘_64byã
*)(
¨gs
[1]);

53 
b2
 = *(
˛s_°ru˘_64byã
*)(
¨gs
[2]);

54 
b3
 = *(
˛s_°ru˘_64byã
*)(
¨gs
[3]);

56 *(
˛s_°ru˘_64byã
*)
ª•
 = 
	`˛s_°ru˘_64byã_‚
(
b0
, 
b1
, 
b2
, 
b3
);

57 
	}
}

59 
	$maö
 ()

61 
ffi_cif
 
cif
;

62 *
code
;

63 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

64 * 
¨gs_dbl
[5];

65 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[9];

66 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

67 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

69 
˛s_°ru˘_64byã
 
e_dbl
 = { 9.0, 2.0, 6.0, 5.0, 3.0, 4.0, 8.0, 1.0 };

70 
˛s_°ru˘_64byã
 
f_dbl
 = { 1.0, 2.0, 3.0, 7.0, 2.0, 5.0, 6.0, 7.0 };

71 
˛s_°ru˘_64byã
 
g_dbl
 = { 4.0, 5.0, 7.0, 9.0, 1.0, 1.0, 2.0, 9.0 };

72 
˛s_°ru˘_64byã
 
h_dbl
 = { 8.0, 6.0, 1.0, 4.0, 0.0, 3.0, 3.0, 1.0 };

73 
˛s_°ru˘_64byã
 
ªs_dbl
;

75 
˛s_°ru˘_ty≥
.
size
 = 0;

76 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

77 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

78 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

80 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

81 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

82 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_doubÀ
;

83 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_doubÀ
;

84 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_doubÀ
;

85 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_doubÀ
;

86 
˛s_°ru˘_fõlds
[6] = &
ffi_ty≥_doubÀ
;

87 
˛s_°ru˘_fõlds
[7] = &
ffi_ty≥_doubÀ
;

88 
˛s_°ru˘_fõlds
[8] = 
NULL
;

90 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

91 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

92 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥
;

93 
dbl_¨g_ty≥s
[3] = &
˛s_°ru˘_ty≥
;

94 
dbl_¨g_ty≥s
[4] = 
NULL
;

96 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4, &
˛s_°ru˘_ty≥
,

97 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

99 
¨gs_dbl
[0] = &
e_dbl
;

100 
¨gs_dbl
[1] = &
f_dbl
;

101 
¨gs_dbl
[2] = &
g_dbl
;

102 
¨gs_dbl
[3] = &
h_dbl
;

103 
¨gs_dbl
[4] = 
NULL
;

105 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_64byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

107 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

108 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
);

111 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_64byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

113 
ªs_dbl
 = ((
	`˛s_°ru˘_64byã
(*)(
˛s_°ru˘_64byã
,

114 
˛s_°ru˘_64byã
,

115 
˛s_°ru˘_64byã
,

116 
˛s_°ru˘_64byã
))

117 (
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
, 
h_dbl
);

119 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

120 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
);

123 
	`exô
(0);

124 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_6_1_byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_6byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 
	md
;

16 
	me
;

17 
	mf
;

18 } 
	t˛s_°ru˘_6byã
;

20 
˛s_°ru˘_6byã
 
	$˛s_°ru˘_6byã_‚
(
˛s_°ru˘_6byã
 
a1
,

21 
˛s_°ru˘_6byã
 
a2
)

23 
˛s_°ru˘_6byã
 
ªsu…
;

25 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

26 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

27 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

28 
ªsu…
.
d
 = 
a1
.d + 
a2
.d;

29 
ªsu…
.
e
 = 
a1
.ê+ 
a2
.e;

30 
ªsu…
.
f
 = 
a1
.‡+ 
a2
.f;

32 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d: %d %d %d %d %d %d\n",

33 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,á1.
e
,á1.
f
,

34 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,á2.
e
,á2.
f
,

35 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
,Ñesu….
e
,Ñesu….
f
);

37  
ªsu…
;

38 
	}
}

41 
	$˛s_°ru˘_6byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

42 * 
u£rd©a
 
__UNUSED__
)

45 
˛s_°ru˘_6byã
 
a1
, 
a2
;

47 
a1
 = *(
˛s_°ru˘_6byã
*)(
¨gs
[0]);

48 
a2
 = *(
˛s_°ru˘_6byã
*)(
¨gs
[1]);

50 *(
˛s_°ru˘_6byã
*)
ª•
 = 
	`˛s_°ru˘_6byã_‚
(
a1
, 
a2
);

51 
	}
}

53 
	$maö
 ()

55 
ffi_cif
 
cif
;

56 *
code
;

57 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

58 * 
¨gs_dbl
[5];

59 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[7];

60 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

61 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

63 
˛s_°ru˘_6byã
 
g_dbl
 = { 127, 120, 1, 3, 4, 5 };

64 
˛s_°ru˘_6byã
 
f_dbl
 = { 12, 128, 9, 3, 4, 5 };

65 
˛s_°ru˘_6byã
 
ªs_dbl
 = { 0, 0, 0, 0, 0, 0 };

67 
˛s_°ru˘_ty≥
.
size
 = 0;

68 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

69 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

70 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

72 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

73 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

74 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

75 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_uch¨
;

76 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_uch¨
;

77 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_uch¨
;

78 
˛s_°ru˘_fõlds
[6] = 
NULL
;

80 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

81 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

82 
dbl_¨g_ty≥s
[2] = 
NULL
;

84 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

85 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

87 
¨gs_dbl
[0] = &
g_dbl
;

88 
¨gs_dbl
[1] = &
f_dbl
;

89 
¨gs_dbl
[2] = 
NULL
;

91 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_6byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

93 
	`¥ötf
("ªs: %d %d %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

94 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
);

97 
ªs_dbl
.
a
 = 0;

98 
ªs_dbl
.
b
 = 0;

99 
ªs_dbl
.
c
 = 0;

100 
ªs_dbl
.
d
 = 0;

101 
ªs_dbl
.
e
 = 0;

102 
ªs_dbl
.
f
 = 0;

104 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_6byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

106 
ªs_dbl
 = ((
	`˛s_°ru˘_6byã
(*)(
˛s_°ru˘_6byã
, cls_°ru˘_6byã))(
code
))(
g_dbl
, 
f_dbl
);

108 
	`¥ötf
("ªs: %d %d %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

109 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
);

112 
	`exô
(0);

113 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_6byte.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_6byã
 {

13 
	ma
;

14 
	mb
;

15 
	mc
;

16 
	md
;

17 } 
	t˛s_°ru˘_6byã
;

19 
˛s_°ru˘_6byã
 
	$˛s_°ru˘_6byã_‚
(
˛s_°ru˘_6byã
 
a1
,

20 
˛s_°ru˘_6byã
 
a2
)

22 
˛s_°ru˘_6byã
 
ªsu…
;

24 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

25 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

26 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

27 
ªsu…
.
d
 = 
a1
.d + 
a2
.d;

29 
	`¥ötf
("%d %d %d %d %d %d %d %d: %d %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,

30 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,

31 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
);

33  
ªsu…
;

34 
	}
}

37 
	$˛s_°ru˘_6byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

38 * 
u£rd©a
 
__UNUSED__
)

41 
˛s_°ru˘_6byã
 
a1
, 
a2
;

43 
a1
 = *(
˛s_°ru˘_6byã
*)(
¨gs
[0]);

44 
a2
 = *(
˛s_°ru˘_6byã
*)(
¨gs
[1]);

46 *(
˛s_°ru˘_6byã
*)
ª•
 = 
	`˛s_°ru˘_6byã_‚
(
a1
, 
a2
);

47 
	}
}

49 
	$maö
 ()

51 
ffi_cif
 
cif
;

52 *
code
;

53 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

54 * 
¨gs_dbl
[5];

55 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[5];

56 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

57 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

59 
˛s_°ru˘_6byã
 
g_dbl
 = { 127, 120, 1, 128 };

60 
˛s_°ru˘_6byã
 
f_dbl
 = { 12, 128, 9, 127 };

61 
˛s_°ru˘_6byã
 
ªs_dbl
;

63 
˛s_°ru˘_ty≥
.
size
 = 0;

64 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

65 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

66 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

68 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_ush‹t
;

69 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_ush‹t
;

70 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

71 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_uch¨
;

72 
˛s_°ru˘_fõlds
[4] = 
NULL
;

74 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

75 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

76 
dbl_¨g_ty≥s
[2] = 
NULL
;

78 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

79 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

81 
¨gs_dbl
[0] = &
g_dbl
;

82 
¨gs_dbl
[1] = &
f_dbl
;

83 
¨gs_dbl
[2] = 
NULL
;

85 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_6byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

87 
	`¥ötf
("ªs: %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

90 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_6byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

92 
ªs_dbl
 = ((
	`˛s_°ru˘_6byã
(*)(
˛s_°ru˘_6byã
, cls_°ru˘_6byã))(
code
))(
g_dbl
, 
f_dbl
);

94 
	`¥ötf
("ªs: %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

98 
	`exô
(0);

99 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_7_1_byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_7byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 
	md
;

16 
	me
;

17 
	mf
;

18 
	mg
;

19 } 
	t˛s_°ru˘_7byã
;

21 
˛s_°ru˘_7byã
 
	$˛s_°ru˘_7byã_‚
(
˛s_°ru˘_7byã
 
a1
,

22 
˛s_°ru˘_7byã
 
a2
)

24 
˛s_°ru˘_7byã
 
ªsu…
;

26 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

27 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

28 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

29 
ªsu…
.
d
 = 
a1
.d + 
a2
.d;

30 
ªsu…
.
e
 = 
a1
.ê+ 
a2
.e;

31 
ªsu…
.
f
 = 
a1
.‡+ 
a2
.f;

32 
ªsu…
.
g
 = 
a1
.g + 
a2
.g;

34 
	`¥ötf
("%d %d %d %d %d %d %d %d %d %d %d %d %d %d: %d %d %d %d %d %d %d\n",

35 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,á1.
e
,á1.
f
,á1.
g
,

36 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,á2.
e
,á2.
f
,á2.
g
,

37 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
,Ñesu….
e
,Ñesu….
f
,Ñesu….
g
);

39  
ªsu…
;

40 
	}
}

43 
	$˛s_°ru˘_7byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

44 * 
u£rd©a
 
__UNUSED__
)

47 
˛s_°ru˘_7byã
 
a1
, 
a2
;

49 
a1
 = *(
˛s_°ru˘_7byã
*)(
¨gs
[0]);

50 
a2
 = *(
˛s_°ru˘_7byã
*)(
¨gs
[1]);

52 *(
˛s_°ru˘_7byã
*)
ª•
 = 
	`˛s_°ru˘_7byã_‚
(
a1
, 
a2
);

53 
	}
}

55 
	$maö
 ()

57 
ffi_cif
 
cif
;

58 *
code
;

59 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

60 * 
¨gs_dbl
[5];

61 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[8];

62 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

63 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

65 
˛s_°ru˘_7byã
 
g_dbl
 = { 127, 120, 1, 3, 4, 5, 6 };

66 
˛s_°ru˘_7byã
 
f_dbl
 = { 12, 128, 9, 3, 4, 5, 6 };

67 
˛s_°ru˘_7byã
 
ªs_dbl
 = { 0, 0, 0, 0, 0, 0, 0 };

69 
˛s_°ru˘_ty≥
.
size
 = 0;

70 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

71 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

72 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

74 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

75 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

76 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

77 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_uch¨
;

78 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_uch¨
;

79 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_uch¨
;

80 
˛s_°ru˘_fõlds
[6] = &
ffi_ty≥_uch¨
;

81 
˛s_°ru˘_fõlds
[7] = 
NULL
;

83 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

84 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

85 
dbl_¨g_ty≥s
[2] = 
NULL
;

87 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

88 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

90 
¨gs_dbl
[0] = &
g_dbl
;

91 
¨gs_dbl
[1] = &
f_dbl
;

92 
¨gs_dbl
[2] = 
NULL
;

94 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_7byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

96 
	`¥ötf
("ªs: %d %d %d %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

97 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
);

100 
ªs_dbl
.
a
 = 0;

101 
ªs_dbl
.
b
 = 0;

102 
ªs_dbl
.
c
 = 0;

103 
ªs_dbl
.
d
 = 0;

104 
ªs_dbl
.
e
 = 0;

105 
ªs_dbl
.
f
 = 0;

106 
ªs_dbl
.
g
 = 0;

108 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_7byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

110 
ªs_dbl
 = ((
	`˛s_°ru˘_7byã
(*)(
˛s_°ru˘_7byã
, cls_°ru˘_7byã))(
code
))(
g_dbl
, 
f_dbl
);

112 
	`¥ötf
("ªs: %d %d %d %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

113 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
);

116 
	`exô
(0);

117 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_7byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_7byã
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 
	md
;

16 } 
	t˛s_°ru˘_7byã
;

18 
˛s_°ru˘_7byã
 
	$˛s_°ru˘_7byã_‚
(
˛s_°ru˘_7byã
 
a1
,

19 
˛s_°ru˘_7byã
 
a2
)

21 
˛s_°ru˘_7byã
 
ªsu…
;

23 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

24 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

26 
ªsu…
.
d
 = 
a1
.d + 
a2
.d;

28 
	`¥ötf
("%d %d %d %d %d %d %d %d: %d %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,

29 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,

30 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,Ñesu….
d
);

32  
ªsu…
;

33 
	}
}

36 
	$˛s_°ru˘_7byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

37 * 
u£rd©a
 
__UNUSED__
)

40 
˛s_°ru˘_7byã
 
a1
, 
a2
;

42 
a1
 = *(
˛s_°ru˘_7byã
*)(
¨gs
[0]);

43 
a2
 = *(
˛s_°ru˘_7byã
*)(
¨gs
[1]);

45 *(
˛s_°ru˘_7byã
*)
ª•
 = 
	`˛s_°ru˘_7byã_‚
(
a1
, 
a2
);

46 
	}
}

48 
	$maö
 ()

50 
ffi_cif
 
cif
;

51 *
code
;

52 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

53 * 
¨gs_dbl
[5];

54 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[5];

55 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

56 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

58 
˛s_°ru˘_7byã
 
g_dbl
 = { 127, 120, 1, 254 };

59 
˛s_°ru˘_7byã
 
f_dbl
 = { 12, 128, 9, 255 };

60 
˛s_°ru˘_7byã
 
ªs_dbl
;

62 
˛s_°ru˘_ty≥
.
size
 = 0;

63 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

64 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

65 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

67 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_ush‹t
;

68 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_ush‹t
;

69 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

70 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_ush‹t
;

71 
˛s_°ru˘_fõlds
[4] = 
NULL
;

73 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

74 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

75 
dbl_¨g_ty≥s
[2] = 
NULL
;

77 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

78 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

80 
¨gs_dbl
[0] = &
g_dbl
;

81 
¨gs_dbl
[1] = &
f_dbl
;

82 
¨gs_dbl
[2] = 
NULL
;

84 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_7byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

86 
	`¥ötf
("ªs: %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

89 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_7byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

91 
ªs_dbl
 = ((
	`˛s_°ru˘_7byã
(*)(
˛s_°ru˘_7byã
, cls_°ru˘_7byã))(
code
))(
g_dbl
, 
f_dbl
);

93 
	`¥ötf
("ªs: %d %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,Ñes_dbl.
d
);

96 
	`exô
(0);

97 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_8byte.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_8byã
 {

12 
	ma
;

13 
	mb
;

14 } 
	t˛s_°ru˘_8byã
;

16 
˛s_°ru˘_8byã
 
	$˛s_°ru˘_8byã_‚
(
˛s_°ru˘_8byã
 
a1
,

17 
˛s_°ru˘_8byã
 
a2
)

19 
˛s_°ru˘_8byã
 
ªsu…
;

21 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

22 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

24 
	`¥ötf
("%d %g %d %g: %d %g\n", 
a1
.
a
,á1.
b
, 
a2
.a,á2.b, 
ªsu…
.a,Ñesult.b);

26  
ªsu…
;

27 
	}
}

30 
	$˛s_°ru˘_8byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

31 * 
u£rd©a
 
__UNUSED__
)

34 
˛s_°ru˘_8byã
 
a1
, 
a2
;

36 
a1
 = *(
˛s_°ru˘_8byã
*)(
¨gs
[0]);

37 
a2
 = *(
˛s_°ru˘_8byã
*)(
¨gs
[1]);

39 *(
˛s_°ru˘_8byã
*)
ª•
 = 
	`˛s_°ru˘_8byã_‚
(
a1
, 
a2
);

40 
	}
}

42 
	$maö
 ()

44 
ffi_cif
 
cif
;

45 *
code
;

46 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

47 * 
¨gs_dbl
[5];

48 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

49 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

50 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

52 
˛s_°ru˘_8byã
 
g_dbl
 = { 1, 2.0 };

53 
˛s_°ru˘_8byã
 
f_dbl
 = { 4, 5.0 };

54 
˛s_°ru˘_8byã
 
ªs_dbl
;

56 
˛s_°ru˘_ty≥
.
size
 = 0;

57 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

58 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

59 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

61 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_söt
;

62 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_Êﬂt
;

63 
˛s_°ru˘_fõlds
[2] = 
NULL
;

65 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

66 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[2] = 
NULL
;

69 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

70 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

72 
¨gs_dbl
[0] = &
g_dbl
;

73 
¨gs_dbl
[1] = &
f_dbl
;

74 
¨gs_dbl
[2] = 
NULL
;

76 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_8byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

78 
	`¥ötf
("ªs: %d %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

80 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_8byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

82 
ªs_dbl
 = ((
	`˛s_°ru˘_8byã
(*)(
˛s_°ru˘_8byã
, cls_°ru˘_8byã))(
code
))(
g_dbl
, 
f_dbl
);

84 
	`¥ötf
("ªs: %d %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

87 
	`exô
(0);

88 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_9byte1.c

11 
	~"ffôe°.h
"

13 
	s˛s_°ru˘_9byã
 {

14 
	ma
;

15 
	mb
;

16 } 
	t˛s_°ru˘_9byã
;

18 
˛s_°ru˘_9byã
 
	$˛s_°ru˘_9byã_‚
(
˛s_°ru˘_9byã
 
b1
,

19 
˛s_°ru˘_9byã
 
b2
)

21 
˛s_°ru˘_9byã
 
ªsu…
;

23 
ªsu…
.
a
 = 
b1
.®+ 
b2
.a;

24 
ªsu…
.
b
 = 
b1
.b + 
b2
.b;

26 
	`¥ötf
("%d %g %d %g: %d %g\n", 
b1
.
a
, b1.
b
, 
b2
.a, b2.b,

27 
ªsu…
.
a
,Ñesu….
b
);

29  
ªsu…
;

30 
	}
}

32 
	$˛s_°ru˘_9byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

33 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_9byã
 
b1
, 
b2
;

37 
b1
 = *(
˛s_°ru˘_9byã
*)(
¨gs
[0]);

38 
b2
 = *(
˛s_°ru˘_9byã
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_9byã
*)
ª•
 = 
	`˛s_°ru˘_9byã_‚
(
b1
, 
b2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[3];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

53 
˛s_°ru˘_9byã
 
h_dbl
 = { 7, 8.0};

54 
˛s_°ru˘_9byã
 
j_dbl
 = { 1, 9.0};

55 
˛s_°ru˘_9byã
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_söt
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

64 
˛s_°ru˘_fõlds
[2] = 
NULL
;

66 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[2] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

71 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

73 
¨gs_dbl
[0] = &
h_dbl
;

74 
¨gs_dbl
[1] = &
j_dbl
;

75 
¨gs_dbl
[2] = 
NULL
;

77 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_9byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

79 
	`¥ötf
("ªs: %d %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

82 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_9byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

84 
ªs_dbl
 = ((
	`˛s_°ru˘_9byã
(*)(
˛s_°ru˘_9byã
, cls_°ru˘_9byã))(
code
))(
h_dbl
, 
j_dbl
);

86 
	`¥ötf
("ªs: %d %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

89 
	`exô
(0);

90 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_9byte2.c

11 
	~"ffôe°.h
"

13 
	s˛s_°ru˘_9byã
 {

14 
	ma
;

15 
	mb
;

16 } 
	t˛s_°ru˘_9byã
;

18 
˛s_°ru˘_9byã
 
	$˛s_°ru˘_9byã_‚
(
˛s_°ru˘_9byã
 
b1
,

19 
˛s_°ru˘_9byã
 
b2
)

21 
˛s_°ru˘_9byã
 
ªsu…
;

23 
ªsu…
.
a
 = 
b1
.®+ 
b2
.a;

24 
ªsu…
.
b
 = 
b1
.b + 
b2
.b;

26 
	`¥ötf
("%g %d %g %d: %g %d\n", 
b1
.
a
, b1.
b
, 
b2
.a, b2.b,

27 
ªsu…
.
a
,Ñesu….
b
);

29  
ªsu…
;

30 
	}
}

32 
	$˛s_°ru˘_9byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

33 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_9byã
 
b1
, 
b2
;

37 
b1
 = *(
˛s_°ru˘_9byã
*)(
¨gs
[0]);

38 
b2
 = *(
˛s_°ru˘_9byã
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_9byã
*)
ª•
 = 
	`˛s_°ru˘_9byã_‚
(
b1
, 
b2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[3];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

53 
˛s_°ru˘_9byã
 
h_dbl
 = { 7.0, 8};

54 
˛s_°ru˘_9byã
 
j_dbl
 = { 1.0, 9};

55 
˛s_°ru˘_9byã
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_söt
;

64 
˛s_°ru˘_fõlds
[2] = 
NULL
;

66 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

67 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[2] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

71 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

73 
¨gs_dbl
[0] = &
h_dbl
;

74 
¨gs_dbl
[1] = &
j_dbl
;

75 
¨gs_dbl
[2] = 
NULL
;

77 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_9byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

79 
	`¥ötf
("ªs: %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_9byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

85 
ªs_dbl
 = ((
	`˛s_°ru˘_9byã
(*)(
˛s_°ru˘_9byã
, cls_°ru˘_9byã))(
code
))(
h_dbl
, 
j_dbl
);

87 
	`¥ötf
("ªs: %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
);

90 
	`exô
(0);

91 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_double.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_Æign
 {

13 
	ma
;

14 
	mb
;

15 
	mc
;

16 } 
	t˛s_°ru˘_Æign
;

18 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

19 
˛s_°ru˘_Æign
 
a2
)

21 
˛s_°ru˘_Æign
 
ªsu…
;

23 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

24 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

27 
	`¥ötf
("%d %g %d %d %g %d: %d %g %d\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c, 
ªsu…
.a,Ñesult.b,Ñesult.c);

29  
ªsu…
;

30 
	}
}

33 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

34 * 
u£rd©a
 
__UNUSED__
)

37 
˛s_°ru˘_Æign
 
a1
, 
a2
;

39 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

40 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

42 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

43 
	}
}

45 
	$maö
 ()

47 
ffi_cif
 
cif
;

48 *
code
;

49 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

50 * 
¨gs_dbl
[5];

51 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

52 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

53 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

55 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

56 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

57 
˛s_°ru˘_Æign
 
ªs_dbl
;

59 
˛s_°ru˘_ty≥
.
size
 = 0;

60 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

61 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

62 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

64 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

65 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

66 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

67 
˛s_°ru˘_fõlds
[3] = 
NULL
;

69 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

70 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

71 
dbl_¨g_ty≥s
[2] = 
NULL
;

73 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

74 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

76 
¨gs_dbl
[0] = &
g_dbl
;

77 
¨gs_dbl
[1] = &
f_dbl
;

78 
¨gs_dbl
[2] = 
NULL
;

80 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

82 
	`¥ötf
("ªs: %d %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

85 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

87 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

89 
	`¥ötf
("ªs: %d %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

92 
	`exô
(0);

93 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_float.c

8 
	~"ffôe°.h
"

10 
	s˛s_°ru˘_Æign
 {

11 
	ma
;

12 
	mb
;

13 
	mc
;

14 } 
	t˛s_°ru˘_Æign
;

16 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

17 
˛s_°ru˘_Æign
 
a2
)

19 
˛s_°ru˘_Æign
 
ªsu…
;

21 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

22 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

23 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

25 
	`¥ötf
("%d %g %d %d %g %d: %d %g %d\n", 
a1
.
a
, (Ô1.
b
,á1.
c
, 
a2
.a, (Ô2.b,á2.c, 
ªsu…
.a, ()result.b,Ñesult.c);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_Æign
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

54 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

55 
˛s_°ru˘_Æign
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_Êﬂt
;

64 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

65 
˛s_°ru˘_fõlds
[3] = 
NULL
;

67 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[2] = 
NULL
;

71 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

72 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

74 
¨gs_dbl
[0] = &
g_dbl
;

75 
¨gs_dbl
[1] = &
f_dbl
;

76 
¨gs_dbl
[2] = 
NULL
;

78 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

80 
	`¥ötf
("ªs: %d %g %d\n", 
ªs_dbl
.
a
, (Ïes_dbl.
b
,Ñes_dbl.
c
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

85 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

87 
	`¥ötf
("ªs: %d %g %d\n", 
ªs_dbl
.
a
, (Ïes_dbl.
b
,Ñes_dbl.
c
);

90 
	`exô
(0);

91 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_longdouble.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_Æign
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 } 
	t˛s_°ru˘_Æign
;

17 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

18 
˛s_°ru˘_Æign
 
a2
)

20 
˛s_°ru˘_Æign
 
ªsu…
;

22 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

23 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

24 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

26 
	`¥ötf
("%d %g %d %d %g %d: %d %g %d\n", 
a1
.
a
, (Ô1.
b
,á1.
c
, 
a2
.a, (Ô2.b,á2.c, 
ªsu…
.a, ()result.b,Ñesult.c);

28  
ªsu…
;

29 
	}
}

32 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

33 * 
u£rd©a
 
__UNUSED__
)

36 
˛s_°ru˘_Æign
 
a1
, 
a2
;

38 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

39 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

41 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

42 
	}
}

44 
	$maö
 ()

46 
ffi_cif
 
cif
;

47 *
code
;

48 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

49 * 
¨gs_dbl
[5];

50 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

51 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

52 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

54 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

55 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

56 
˛s_°ru˘_Æign
 
ªs_dbl
;

58 
˛s_°ru˘_ty≥
.
size
 = 0;

59 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

60 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

61 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

63 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

64 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_l⁄gdoubÀ
;

65 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

66 
˛s_°ru˘_fõlds
[3] = 
NULL
;

68 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

70 
dbl_¨g_ty≥s
[2] = 
NULL
;

72 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

73 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

75 
¨gs_dbl
[0] = &
g_dbl
;

76 
¨gs_dbl
[1] = &
f_dbl
;

77 
¨gs_dbl
[2] = 
NULL
;

79 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

81 
	`¥ötf
("ªs: %d %g %d\n", 
ªs_dbl
.
a
, (Ïes_dbl.
b
,Ñes_dbl.
c
);

84 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

86 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

88 
	`¥ötf
("ªs: %d %g %d\n", 
ªs_dbl
.
a
, (Ïes_dbl.
b
,Ñes_dbl.
c
);

91 
	`exô
(0);

92 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_longdouble_split.c

12 
	~"ffôe°.h
"

14 
	s˛s_°ru˘_Æign
 {

15 
	ma
;

16 
	mb
;

17 
	mc
;

18 
	md
;

19 
	me
;

20 
	mf
;

21 
	mg
;

22 } 
	t˛s_°ru˘_Æign
;

24 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(

25 
˛s_°ru˘_Æign
 
a1
,

26 
˛s_°ru˘_Æign
 
a2
)

28 
˛s_°ru˘_Æign
 
r
;

30 
r
.
a
 = 
a1
.®+ 
a2
.a;

31 
r
.
b
 = 
a1
.b + 
a2
.b;

32 
r
.
c
 = 
a1
.¯+ 
a2
.c;

33 
r
.
d
 = 
a1
.d + 
a2
.d;

34 
r
.
e
 = 
a1
.ê+ 
a2
.e;

35 
r
.
f
 = 
a1
.‡+ 
a2
.f;

36 
r
.
g
 = 
a1
.g + 
a2
.g;

38 
	`¥ötf
("%Lg %Lg %Lg %Lg %Lg %Lg %Lg %Lg %Lg %Lg %Lg %Lg %Lg %Lg: "

40 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,á1.
e
,á1.
f
,á1.
g
,

41 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,á2.
e
,á2.
f
,á2.
g
,

42 
r
.
a
,Ñ.
b
,Ñ.
c
,Ñ.
d
,Ñ.
e
,Ñ.
f
,Ñ.
g
);

44  
r
;

45 
	}
}

47 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚2
(

48 
˛s_°ru˘_Æign
 
a1
)

50 
˛s_°ru˘_Æign
 
r
;

52 
r
.
a
 = 
a1
.a + 1;

53 
r
.
b
 = 
a1
.b + 1;

54 
r
.
c
 = 
a1
.c + 1;

55 
r
.
d
 = 
a1
.d + 1;

56 
r
.
e
 = 
a1
.e + 1;

57 
r
.
f
 = 
a1
.f + 1;

58 
r
.
g
 = 
a1
.g + 1;

60 
	`¥ötf
("%Lg %Lg %Lg %Lg %Lg %Lg %Lg: "

62 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,á1.
e
,á1.
f
,á1.
g
,

63 
r
.
a
,Ñ.
b
,Ñ.
c
,Ñ.
d
,Ñ.
e
,Ñ.
f
,Ñ.
g
);

65  
r
;

66 
	}
}

69 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

70 * 
u£rd©a
 
__UNUSED__
)

72 
˛s_°ru˘_Æign
 
a1
, 
a2
;

74 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

75 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

77 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

78 
	}
}

80 
	$maö
 ()

82 
ffi_cif
 
cif
;

83 *
code
;

84 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

85 * 
¨gs_dbl
[3];

86 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[8];

87 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

88 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

90 
˛s_°ru˘_Æign
 
g_dbl
 = { 1, 2, 3, 4, 5, 6, 7 };

91 
˛s_°ru˘_Æign
 
f_dbl
 = { 8, 9, 10, 11, 12, 13, 14 };

92 
˛s_°ru˘_Æign
 
ªs_dbl
;

94 
˛s_°ru˘_ty≥
.
size
 = 0;

95 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

96 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

97 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

99 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_l⁄gdoubÀ
;

100 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_l⁄gdoubÀ
;

101 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_l⁄gdoubÀ
;

102 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_l⁄gdoubÀ
;

103 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_l⁄gdoubÀ
;

104 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_l⁄gdoubÀ
;

105 
˛s_°ru˘_fõlds
[6] = &
ffi_ty≥_l⁄gdoubÀ
;

106 
˛s_°ru˘_fõlds
[7] = 
NULL
;

108 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

109 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

110 
dbl_¨g_ty≥s
[2] = 
NULL
;

112 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

113 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

115 
¨gs_dbl
[0] = &
g_dbl
;

116 
¨gs_dbl
[1] = &
f_dbl
;

117 
¨gs_dbl
[2] = 
NULL
;

119 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

121 
	`¥ötf
("ªs: %Lg %Lg %Lg %Lg %Lg %Lg %Lg\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,

122 
ªs_dbl
.
c
,Ñes_dbl.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
);

125 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

127 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

129 
	`¥ötf
("ªs: %Lg %Lg %Lg %Lg %Lg %Lg %Lg\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,

130 
ªs_dbl
.
c
,Ñes_dbl.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
);

133 
	`exô
(0);

134 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_longdouble_split2.c

13 
	~"ffôe°.h
"

15 
	s˛s_°ru˘_Æign
 {

16 
	ma
;

17 
	mb
;

18 
	mc
;

19 
	md
;

20 
	me
;

21 
	mf
;

22 
	mg
;

23 } 
	t˛s_°ru˘_Æign
;

25 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(

26 
˛s_°ru˘_Æign
 
a1
,

27 
˛s_°ru˘_Æign
 
a2
)

29 
˛s_°ru˘_Æign
 
r
;

31 
r
.
a
 = 
a1
.®+ 
a2
.a;

32 
r
.
b
 = 
a1
.b + 
a2
.b;

33 
r
.
c
 = 
a1
.¯+ 
a2
.c;

34 
r
.
d
 = 
a1
.d + 
a2
.d;

35 
r
.
e
 = 
a1
.ê+ 
a2
.e;

36 
r
.
f
 = 
a1
.‡+ 
a2
.f;

37 
r
.
g
 = 
a1
.g + 
a2
.g;

39 
	`¥ötf
("%Lg %Lg %Lg %Lg %Lg %g %Lg %Lg %Lg %Lg %Lg %Lg %g %Lg: "

41 
a1
.
a
,á1.
b
,á1.
c
,á1.
d
,á1.
e
,á1.
f
,á1.
g
,

42 
a2
.
a
,á2.
b
,á2.
c
,á2.
d
,á2.
e
,á2.
f
,á2.
g
,

43 
r
.
a
,Ñ.
b
,Ñ.
c
,Ñ.
d
,Ñ.
e
,Ñ.
f
,Ñ.
g
);

45  
r
;

46 
	}
}

49 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

50 * 
u£rd©a
 
__UNUSED__
)

52 
˛s_°ru˘_Æign
 
a1
, 
a2
;

54 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

55 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

57 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

58 
	}
}

60 
	$maö
 ()

62 
ffi_cif
 
cif
;

63 *
code
;

64 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

65 * 
¨gs_dbl
[3];

66 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[8];

67 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

68 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

70 
˛s_°ru˘_Æign
 
g_dbl
 = { 1, 2, 3, 4, 5, 6, 7 };

71 
˛s_°ru˘_Æign
 
f_dbl
 = { 8, 9, 10, 11, 12, 13, 14 };

72 
˛s_°ru˘_Æign
 
ªs_dbl
;

74 
˛s_°ru˘_ty≥
.
size
 = 0;

75 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

76 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

77 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

79 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_l⁄gdoubÀ
;

80 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_l⁄gdoubÀ
;

81 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_l⁄gdoubÀ
;

82 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_l⁄gdoubÀ
;

83 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_l⁄gdoubÀ
;

84 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_doubÀ
;

85 
˛s_°ru˘_fõlds
[6] = &
ffi_ty≥_l⁄gdoubÀ
;

86 
˛s_°ru˘_fõlds
[7] = 
NULL
;

88 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

89 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

90 
dbl_¨g_ty≥s
[2] = 
NULL
;

92 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

93 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

95 
¨gs_dbl
[0] = &
g_dbl
;

96 
¨gs_dbl
[1] = &
f_dbl
;

97 
¨gs_dbl
[2] = 
NULL
;

99 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

101 
	`¥ötf
("ªs: %Lg %Lg %Lg %Lg %Lg %g %Lg\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,

102 
ªs_dbl
.
c
,Ñes_dbl.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
);

105 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

107 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

109 
	`¥ötf
("ªs: %Lg %Lg %Lg %Lg %Lg %g %Lg\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,

110 
ªs_dbl
.
c
,Ñes_dbl.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
);

113 
	`exô
(0);

114 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_pointer.c

8 
	~"ffôe°.h
"

10 
	s˛s_°ru˘_Æign
 {

11 
	ma
;

12 *
	mb
;

13 
	mc
;

14 } 
	t˛s_°ru˘_Æign
;

16 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

17 
˛s_°ru˘_Æign
 
a2
)

19 
˛s_°ru˘_Æign
 
ªsu…
;

21 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

22 
ªsu…
.
b
 = (*)((
uöçå_t
)
a1
.b + (uöçå_t)
a2
.b);

23 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

25 
	`¥ötf
("%d %" 
PRIuPTR
 " %d %d %" PRIuPTR " %d: %d %" PRIuPTR " %d\n",

26 
a1
.
a
, (
uöçå_t
Ô1.
b
,á1.
c
,

27 
a2
.
a
, (
uöçå_t
Ô2.
b
,á2.
c
,

28 
ªsu…
.
a
, (
uöçå_t
Ïesu….
b
,

29 
ªsu…
.
c
);

31  
ªsu…
;

32 
	}
}

35 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

36 * 
u£rd©a
 
__UNUSED__
)

39 
˛s_°ru˘_Æign
 
a1
, 
a2
;

41 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

42 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

44 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

45 
	}
}

47 
	$maö
 ()

49 
ffi_cif
 
cif
;

50 *
code
;

51 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

52 * 
¨gs_dbl
[5];

53 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

54 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

55 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

57 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, (*)4951, 127 };

58 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, (*)9320, 13 };

59 
˛s_°ru˘_Æign
 
ªs_dbl
;

61 
˛s_°ru˘_ty≥
.
size
 = 0;

62 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

63 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

64 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

66 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

67 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_poöãr
;

68 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

69 
˛s_°ru˘_fõlds
[3] = 
NULL
;

71 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

72 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

73 
dbl_¨g_ty≥s
[2] = 
NULL
;

75 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

76 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

78 
¨gs_dbl
[0] = &
g_dbl
;

79 
¨gs_dbl
[1] = &
f_dbl
;

80 
¨gs_dbl
[2] = 
NULL
;

82 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

84 
	`¥ötf
("ªs: %d %" 
PRIuPTR
 " %d\n", 
ªs_dbl
.
a
, (
uöçå_t
Ïes_dbl.
b
,Ñes_dbl.
c
);

87 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

89 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

91 
	`¥ötf
("ªs: %d %" 
PRIuPTR
 " %d\n", 
ªs_dbl
.
a
, (
uöçå_t
Ïes_dbl.
b
,Ñes_dbl.
c
);

94 
	`exô
(0);

95 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_sint16.c

8 
	~"ffôe°.h
"

10 
	s˛s_°ru˘_Æign
 {

11 
	ma
;

12 sig√d 
	mb
;

13 
	mc
;

14 } 
	t˛s_°ru˘_Æign
;

16 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

17 
˛s_°ru˘_Æign
 
a2
)

19 
˛s_°ru˘_Æign
 
ªsu…
;

21 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

22 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

23 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

25 
	`¥ötf
("%d %d %d %d %d %d: %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c, 
ªsu…
.a,Ñesult.b,Ñesult.c);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_Æign
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

54 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

55 
˛s_°ru˘_Æign
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_ssh‹t
;

64 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

65 
˛s_°ru˘_fõlds
[3] = 
NULL
;

67 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[2] = 
NULL
;

71 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

72 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

74 
¨gs_dbl
[0] = &
g_dbl
;

75 
¨gs_dbl
[1] = &
f_dbl
;

76 
¨gs_dbl
[2] = 
NULL
;

78 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

80 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

85 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

87 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

90 
	`exô
(0);

91 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_sint32.c

8 
	~"ffôe°.h
"

10 
	s˛s_°ru˘_Æign
 {

11 
	ma
;

12 sig√d 
	mb
;

13 
	mc
;

14 } 
	t˛s_°ru˘_Æign
;

16 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

17 
˛s_°ru˘_Æign
 
a2
)

19 
˛s_°ru˘_Æign
 
ªsu…
;

21 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

22 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

23 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

25 
	`¥ötf
("%d %d %d %d %d %d: %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c, 
ªsu…
.a,Ñesult.b,Ñesult.c);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_Æign
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

54 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

55 
˛s_°ru˘_Æign
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_söt
;

64 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

65 
˛s_°ru˘_fõlds
[3] = 
NULL
;

67 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[2] = 
NULL
;

71 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

72 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

74 
¨gs_dbl
[0] = &
g_dbl
;

75 
¨gs_dbl
[1] = &
f_dbl
;

76 
¨gs_dbl
[2] = 
NULL
;

78 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

80 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

85 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

87 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

90 
	`exô
(0);

91 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_sint64.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_Æign
 {

12 
	ma
;

13 sig√d 
	mb
;

14 
	mc
;

15 } 
	t˛s_°ru˘_Æign
;

17 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

18 
˛s_°ru˘_Æign
 
a2
)

20 
˛s_°ru˘_Æign
 
ªsu…
;

22 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

23 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

24 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

26 
	`¥ötf
("%d %" 
PRIdLL
 " %d %d %" PRIdLL " %d: %d %" PRIdLL " %d\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c, 
ªsu…
.a,Ñesult.b,Ñesult.c);

28  
ªsu…
;

29 
	}
}

32 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

33 * 
u£rd©a
 
__UNUSED__
)

36 
˛s_°ru˘_Æign
 
a1
, 
a2
;

38 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

39 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

41 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

42 
	}
}

44 
	$maö
 ()

46 
ffi_cif
 
cif
;

47 *
code
;

48 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

49 * 
¨gs_dbl
[5];

50 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

51 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

52 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

54 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

55 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

56 
˛s_°ru˘_Æign
 
ªs_dbl
;

58 
˛s_°ru˘_ty≥
.
size
 = 0;

59 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

60 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

61 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

63 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

64 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_söt64
;

65 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

66 
˛s_°ru˘_fõlds
[3] = 
NULL
;

68 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

70 
dbl_¨g_ty≥s
[2] = 
NULL
;

72 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

73 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

75 
¨gs_dbl
[0] = &
g_dbl
;

76 
¨gs_dbl
[1] = &
f_dbl
;

77 
¨gs_dbl
[2] = 
NULL
;

79 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

81 
	`¥ötf
("ªs: %d %" 
PRIdLL
 " %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

84 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

86 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

88 
	`¥ötf
("ªs: %d %" 
PRIdLL
 " %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

91 
	`exô
(0);

92 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_uint16.c

8 
	~"ffôe°.h
"

10 
	s˛s_°ru˘_Æign
 {

11 
	ma
;

12 
	mb
;

13 
	mc
;

14 } 
	t˛s_°ru˘_Æign
;

16 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

17 
˛s_°ru˘_Æign
 
a2
)

19 
˛s_°ru˘_Æign
 
ªsu…
;

21 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

22 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

23 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

25 
	`¥ötf
("%d %d %d %d %d %d: %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c, 
ªsu…
.a,Ñesult.b,Ñesult.c);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_Æign
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

54 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

55 
˛s_°ru˘_Æign
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_ush‹t
;

64 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

65 
˛s_°ru˘_fõlds
[3] = 
NULL
;

67 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[2] = 
NULL
;

71 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

72 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

74 
¨gs_dbl
[0] = &
g_dbl
;

75 
¨gs_dbl
[1] = &
f_dbl
;

76 
¨gs_dbl
[2] = 
NULL
;

78 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

80 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

85 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

87 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

90 
	`exô
(0);

91 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_uint32.c

8 
	~"ffôe°.h
"

10 
	s˛s_°ru˘_Æign
 {

11 
	ma
;

12 
	mb
;

13 
	mc
;

14 } 
	t˛s_°ru˘_Æign
;

16 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

17 
˛s_°ru˘_Æign
 
a2
)

19 
˛s_°ru˘_Æign
 
ªsu…
;

21 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

22 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

23 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

25 
	`¥ötf
("%d %d %d %d %d %d: %d %d %d\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c, 
ªsu…
.a,Ñesult.b,Ñesult.c);

27  
ªsu…
;

28 
	}
}

31 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

32 * 
u£rd©a
 
__UNUSED__
)

35 
˛s_°ru˘_Æign
 
a1
, 
a2
;

37 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

38 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

40 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

41 
	}
}

43 
	$maö
 ()

45 
ffi_cif
 
cif
;

46 *
code
;

47 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

48 * 
¨gs_dbl
[5];

49 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

50 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

51 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

53 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

54 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

55 
˛s_°ru˘_Æign
 
ªs_dbl
;

57 
˛s_°ru˘_ty≥
.
size
 = 0;

58 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

59 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

62 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

63 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uöt
;

64 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

65 
˛s_°ru˘_fõlds
[3] = 
NULL
;

67 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

68 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

69 
dbl_¨g_ty≥s
[2] = 
NULL
;

71 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

72 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

74 
¨gs_dbl
[0] = &
g_dbl
;

75 
¨gs_dbl
[1] = &
f_dbl
;

76 
¨gs_dbl
[2] = 
NULL
;

78 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

80 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

85 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

87 
	`¥ötf
("ªs: %d %d %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

90 
	`exô
(0);

91 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_uint64.c

10 
	~"ffôe°.h
"

12 
	s˛s_°ru˘_Æign
 {

13 
	ma
;

14 
	mb
;

15 
	mc
;

16 } 
	t˛s_°ru˘_Æign
;

18 
˛s_°ru˘_Æign
 
	$˛s_°ru˘_Æign_‚
(
˛s_°ru˘_Æign
 
a1
,

19 
˛s_°ru˘_Æign
 
a2
)

21 
˛s_°ru˘_Æign
 
ªsu…
;

23 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

24 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

25 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

27 
	`¥ötf
("%d %" 
PRIdLL
 " %d %d %" PRIdLL " %d: %d %" PRIdLL " %d\n", 
a1
.
a
,á1.
b
,á1.
c
, 
a2
.a,á2.b,á2.c, 
ªsu…
.a,Ñesult.b,Ñesult.c);

29  
ªsu…
;

30 
	}
}

33 
	$˛s_°ru˘_Æign_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

34 * 
u£rd©a
 
__UNUSED__
)

37 
˛s_°ru˘_Æign
 
a1
, 
a2
;

39 
a1
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[0]);

40 
a2
 = *(
˛s_°ru˘_Æign
*)(
¨gs
[1]);

42 *(
˛s_°ru˘_Æign
*)
ª•
 = 
	`˛s_°ru˘_Æign_‚
(
a1
, 
a2
);

43 
	}
}

45 
	$maö
 ()

47 
ffi_cif
 
cif
;

48 *
code
;

49 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

50 * 
¨gs_dbl
[5];

51 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[4];

52 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

53 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

55 
˛s_°ru˘_Æign
 
g_dbl
 = { 12, 4951, 127 };

56 
˛s_°ru˘_Æign
 
f_dbl
 = { 1, 9320, 13 };

57 
˛s_°ru˘_Æign
 
ªs_dbl
;

59 
˛s_°ru˘_ty≥
.
size
 = 0;

60 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

61 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

62 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

64 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

65 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uöt64
;

66 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_uch¨
;

67 
˛s_°ru˘_fõlds
[3] = 
NULL
;

69 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

70 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

71 
dbl_¨g_ty≥s
[2] = 
NULL
;

73 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥
,

74 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

76 
¨gs_dbl
[0] = &
g_dbl
;

77 
¨gs_dbl
[1] = &
f_dbl
;

78 
¨gs_dbl
[2] = 
NULL
;

80 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_Æign_‚
), &
ªs_dbl
, 
¨gs_dbl
);

82 
	`¥ötf
("ªs: %d %" 
PRIdLL
 " %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

85 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_Æign_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

87 
ªs_dbl
 = ((
	`˛s_°ru˘_Æign
(*)(
˛s_°ru˘_Æign
, cls_°ru˘_Æign))(
code
))(
g_dbl
, 
f_dbl
);

89 
	`¥ötf
("ªs: %d %" 
PRIdLL
 " %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
);

92 
	`exô
(0);

93 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_dbls_struct.c

9 
	~"ffôe°.h
"

11 
	sDbls
 {

12 
	mx
;

13 
	my
;

14 } 
	tDbls
;

17 
	$˛osuª_ã°_‚
(
Dbls
 
p
)

19 
	`¥ötf
("%.1‡%.1f\n", 
p
.
x
,Ö.
y
);

20 
	}
}

23 
	$˛osuª_ã°_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
 __UNUSED__,

24 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

26 
	`˛osuª_ã°_‚
(*(
Dbls
*)
¨gs
[0]);

27 
	}
}

29 
	$maö
(
¨gc
 
__UNUSED__
, ** 
¨gv
 __UNUSED__)

31 
ffi_cif
 
cif
;

33 *
code
;

34 
ffi_˛osuª
* 
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

35 
ffi_ty≥
* 
˛_¨g_ty≥s
[1];

37 
ffi_ty≥
 
ts1_ty≥
;

38 
ffi_ty≥
* 
ts1_ty≥_ñemíts
[4];

40 
Dbls
 
¨g
 = { 1.0, 2.0 };

42 
ts1_ty≥
.
size
 = 0;

43 
ts1_ty≥
.
Æignmít
 = 0;

44 
ts1_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

45 
ts1_ty≥
.
ñemíts
 = 
ts1_ty≥_ñemíts
;

47 
ts1_ty≥_ñemíts
[0] = &
ffi_ty≥_doubÀ
;

48 
ts1_ty≥_ñemíts
[1] = &
ffi_ty≥_doubÀ
;

49 
ts1_ty≥_ñemíts
[2] = 
NULL
;

51 
˛_¨g_ty≥s
[0] = &
ts1_ty≥
;

54 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

55 &
ffi_ty≥_void
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

57 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛osuª_ã°_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

59 ((*(*)(
Dbls
))(
code
))(
¨g
);

62 
	`˛osuª_ã°_‚
(
¨g
);

66 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_double.c

8 
	~"ffôe°.h
"

10 
	$˛s_ªt_doubÀ_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

11 * 
u£rd©a
 
__UNUSED__
)

13 *(*)
ª•
 = *(*)
¨gs
[0];

15 
	`¥ötf
("%f: %f\n",*(*)
¨gs
[0],

16 *(*)
ª•
);

17 
	}
}

18 (*
	t˛s_ªt_doubÀ
)();

20 
	$maö
 ()

22 
ffi_cif
 
cif
;

23 *
code
;

24 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

25 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

26 
ªs
;

28 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_doubÀ
;

29 
˛_¨g_ty≥s
[1] = 
NULL
;

32 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

33 &
ffi_ty≥_doubÀ
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

35 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_doubÀ_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

37 
ªs
 = (*((
˛s_ªt_doubÀ
)
code
))(21474.789);

39 
	`¥ötf
("ªs: %.6f\n", 
ªs
);

42 
	`exô
(0);

43 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_double_va.c

11 
	~"ffôe°.h
"

14 
	$˛s_doubÀ_va_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

15 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

17 * 
f‹m©
 = *(**)
¨gs
[0];

18 
doubÀVÆue
 = *(*)
¨gs
[1];

20 *(
ffi_¨g
*)
ª•
 = 
	`¥ötf
(
f‹m©
, 
doubÀVÆue
);

21 
	}
}

23 
	$maö
 ()

25 
ffi_cif
 
cif
;

26 *
code
;

27 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

28 * 
¨gs
[3];

29 
ffi_ty≥
* 
¨g_ty≥s
[3];

31 * 
f‹m©
 = "%.1f\n";

32 
doubÀArg
 = 7;

33 
ffi_¨g
 
ªs
 = 0;

35 
¨g_ty≥s
[0] = &
ffi_ty≥_poöãr
;

36 
¨g_ty≥s
[1] = &
ffi_ty≥_doubÀ
;

37 
¨g_ty≥s
[2] = 
NULL
;

40 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 2, &
ffi_ty≥_söt
,

41 
¨g_ty≥s
Ë=
FFI_OK
);

43 
¨gs
[0] = &
f‹m©
;

44 
¨gs
[1] = &
doubÀArg
;

45 
¨gs
[2] = 
NULL
;

47 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
¥ötf
), &
ªs
, 
¨gs
);

49 
	`¥ötf
("ªs: %d\n", (Ë
ªs
);

52 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_doubÀ_va_‚
, 
NULL
,

53 
code
Ë=
FFI_OK
);

55 
ªs
 = (((*)(*, ...))(
code
))(
f‹m©
, 
doubÀArg
);

57 
	`¥ötf
("ªs: %d\n", (Ë
ªs
);

60 
	`exô
(0);

61 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_float.c

8 
	~"ffôe°.h
"

10 
	$˛s_ªt_Êﬂt_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

11 * 
u£rd©a
 
__UNUSED__
)

13 *(*)
ª•
 = *(*)
¨gs
[0];

15 
	`¥ötf
("%g: %g\n",*(*)
¨gs
[0],

16 *(*)
ª•
);

17 
	}
}

19 (*
	t˛s_ªt_Êﬂt
)();

21 
	$maö
 ()

23 
ffi_cif
 
cif
;

24 *
code
;

25 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

26 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

27 
ªs
;

29 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_Êﬂt
;

30 
˛_¨g_ty≥s
[1] = 
NULL
;

33 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

34 &
ffi_ty≥_Êﬂt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

36 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_Êﬂt_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

37 
ªs
 = ((((
˛s_ªt_Êﬂt
)
code
)(-2122.12)));

39 
	`¥ötf
("ªs: %.6f\n", 
ªs
);

41 
	`exô
(0);

42 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_longdouble.c

14 
	~"ffôe°.h
"

16 
	$˛s_ldoubÀ_‚
(

17 
a1
,

18 
a2
,

19 
a3
,

20 
a4
,

21 
a5
,

22 
a6
,

23 
a7
,

24 
a8
)

26 
r
 = 
a1
 + 
a2
 + 
a3
 + 
a4
 + 
a5
 + 
a6
 + 
a7
 + 
a8
;

28 
	`¥ötf
("%Lg %Lg %Lg %Lg %Lg %Lg %Lg %Lg: %Lg\n",

29 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
, 
r
);

31  
r
;

32 
	}
}

35 
	$˛s_ldoubÀ_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

36 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

38 
a1
 = *(*)
¨gs
[0];

39 
a2
 = *(*)
¨gs
[1];

40 
a3
 = *(*)
¨gs
[2];

41 
a4
 = *(*)
¨gs
[3];

42 
a5
 = *(*)
¨gs
[4];

43 
a6
 = *(*)
¨gs
[5];

44 
a7
 = *(*)
¨gs
[6];

45 
a8
 = *(*)
¨gs
[7];

47 *(*)
ª•
 = 
	`˛s_ldoubÀ_‚
(

48 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
);

49 
	}
}

51 
	$maö
()

53 
ffi_cif
 
cif
;

54 * 
code
;

55 
ffi_˛osuª
* 
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

56 * 
¨gs
[9];

57 
ffi_ty≥
* 
¨g_ty≥s
[9];

58 
ªs
 = 0;

60 
¨g1
 = 1;

61 
¨g2
 = 2;

62 
¨g3
 = 3;

63 
¨g4
 = 4;

64 
¨g5
 = 5;

65 
¨g6
 = 6;

66 
¨g7
 = 7;

67 
¨g8
 = 8;

69 
¨g_ty≥s
[0] = &
ffi_ty≥_l⁄gdoubÀ
;

70 
¨g_ty≥s
[1] = &
ffi_ty≥_l⁄gdoubÀ
;

71 
¨g_ty≥s
[2] = &
ffi_ty≥_l⁄gdoubÀ
;

72 
¨g_ty≥s
[3] = &
ffi_ty≥_l⁄gdoubÀ
;

73 
¨g_ty≥s
[4] = &
ffi_ty≥_l⁄gdoubÀ
;

74 
¨g_ty≥s
[5] = &
ffi_ty≥_l⁄gdoubÀ
;

75 
¨g_ty≥s
[6] = &
ffi_ty≥_l⁄gdoubÀ
;

76 
¨g_ty≥s
[7] = &
ffi_ty≥_l⁄gdoubÀ
;

77 
¨g_ty≥s
[8] = 
NULL
;

79 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 8, &
ffi_ty≥_l⁄gdoubÀ
,

80 
¨g_ty≥s
Ë=
FFI_OK
);

82 
¨gs
[0] = &
¨g1
;

83 
¨gs
[1] = &
¨g2
;

84 
¨gs
[2] = &
¨g3
;

85 
¨gs
[3] = &
¨g4
;

86 
¨gs
[4] = &
¨g5
;

87 
¨gs
[5] = &
¨g6
;

88 
¨gs
[6] = &
¨g7
;

89 
¨gs
[7] = &
¨g8
;

90 
¨gs
[8] = 
NULL
;

92 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_ldoubÀ_‚
), &
ªs
, 
¨gs
);

94 
	`¥ötf
("ªs: %Lg\n", 
ªs
);

97 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ldoubÀ_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

99 
ªs
 = (((*)(, , , ,

100 , , , ))(
code
))(
¨g1
, 
¨g2
,

101 
¨g3
, 
¨g4
, 
¨g5
, 
¨g6
, 
¨g7
, 
¨g8
);

103 
	`¥ötf
("ªs: %Lg\n", 
ªs
);

107 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_longdouble_va.c

11 
	~"ffôe°.h
"

14 
	$˛s_l⁄gdoubÀ_va_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

15 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

17 * 
f‹m©
 = *(**)
¨gs
[0];

18 
ldVÆue
 = *(*)
¨gs
[1];

20 *(
ffi_¨g
*)
ª•
 = 
	`¥ötf
(
f‹m©
, 
ldVÆue
);

21 
	}
}

23 
	$maö
 ()

25 
ffi_cif
 
cif
;

26 *
code
;

27 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

28 * 
¨gs
[3];

29 
ffi_ty≥
* 
¨g_ty≥s
[3];

31 * 
f‹m©
 = "%.1Lf\n";

32 
ldArg
 = 7;

33 
ffi_¨g
 
ªs
 = 0;

35 
¨g_ty≥s
[0] = &
ffi_ty≥_poöãr
;

36 
¨g_ty≥s
[1] = &
ffi_ty≥_l⁄gdoubÀ
;

37 
¨g_ty≥s
[2] = 
NULL
;

40 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 2, &
ffi_ty≥_söt
,

41 
¨g_ty≥s
Ë=
FFI_OK
);

43 
¨gs
[0] = &
f‹m©
;

44 
¨gs
[1] = &
ldArg
;

45 
¨gs
[2] = 
NULL
;

47 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
¥ötf
), &
ªs
, 
¨gs
);

49 
	`¥ötf
("ªs: %d\n", (Ë
ªs
);

52 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_l⁄gdoubÀ_va_‚
, 
NULL
,

53 
code
Ë=
FFI_OK
);

55 
ªs
 = (((*)(*, ...))(
code
))(
f‹m©
, 
ldArg
);

57 
	`¥ötf
("ªs: %d\n", (Ë
ªs
);

60 
	`exô
(0);

61 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_schar.c

8 
	~"ffôe°.h
"

10 sig√d 
	$ã°_func_‚
(sig√d 
a1
, sig√d 
a2
)

12 sig√d 
ªsu…
;

14 
ªsu…
 = 
a1
 + 
a2
;

16 
	`¥ötf
("%d %d: %d\n", 
a1
, 
a2
, 
ªsu…
);

18  
ªsu…
;

20 
	}
}

22 
	$ã°_func_gn
(
ffi_cif
 *
cif
 
__UNUSED__
, *
rvÆ
, **
avÆs
,

23 *
d©a
 
__UNUSED__
)

25 sig√d 
a1
, 
a2
;

27 
a1
 = *(sig√d *)
avÆs
[0];

28 
a2
 = *(sig√d *)
avÆs
[1];

30 *(
ffi_¨g
 *)
rvÆ
 = 
	`ã°_func_‚
(
a1
, 
a2
);

32 
	}
}

34 sig√d (*
	tã°_ty≥
)(signed , signed );

36 
	$maö
 ()

38 
ffi_cif
 
cif
;

39 *
code
;

40 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

41 * 
¨gs_dbl
[3];

42 
ffi_ty≥
 * 
˛_¨g_ty≥s
[3];

43 
ffi_¨g
 
ªs_ˇŒ
;

44 sig√d 
a
, 
b
, 
ªs_˛osuª
;

46 
a
 = 2;

47 
b
 = 125;

49 
¨gs_dbl
[0] = &
a
;

50 
¨gs_dbl
[1] = &
b
;

51 
¨gs_dbl
[2] = 
NULL
;

53 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_sch¨
;

54 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_sch¨
;

55 
˛_¨g_ty≥s
[2] = 
NULL
;

58 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2,

59 &
ffi_ty≥_sch¨
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

61 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_func_‚
), &
ªs_ˇŒ
, 
¨gs_dbl
);

63 
	`¥ötf
("ªs: %d\n", (sig√d )
ªs_ˇŒ
);

66 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
ã°_func_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

68 
ªs_˛osuª
 = (*((
ã°_ty≥
)
code
))(2, 125);

70 
	`¥ötf
("ªs: %d\n", 
ªs_˛osuª
);

73 
	`exô
(0);

74 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_sshort.c

8 
	~"ffôe°.h
"

10 sig√d 
	$ã°_func_‚
(sig√d 
a1
, sig√d 
a2
)

12 sig√d 
ªsu…
;

14 
ªsu…
 = 
a1
 + 
a2
;

16 
	`¥ötf
("%d %d: %d\n", 
a1
, 
a2
, 
ªsu…
);

18  
ªsu…
;

20 
	}
}

22 
	$ã°_func_gn
(
ffi_cif
 *
cif
 
__UNUSED__
, *
rvÆ
, **
avÆs
,

23 *
d©a
 
__UNUSED__
)

25 sig√d 
a1
, 
a2
;

27 
a1
 = *(sig√d *)
avÆs
[0];

28 
a2
 = *(sig√d *)
avÆs
[1];

30 *(
ffi_¨g
 *)
rvÆ
 = 
	`ã°_func_‚
(
a1
, 
a2
);

32 
	}
}

34 sig√d (*
	tã°_ty≥
)(signed , signed );

36 
	$maö
 ()

38 
ffi_cif
 
cif
;

39 *
code
;

40 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

41 * 
¨gs_dbl
[3];

42 
ffi_ty≥
 * 
˛_¨g_ty≥s
[3];

43 
ffi_¨g
 
ªs_ˇŒ
;

44 
a
, 
b
, 
ªs_˛osuª
;

46 
a
 = 2;

47 
b
 = 32765;

49 
¨gs_dbl
[0] = &
a
;

50 
¨gs_dbl
[1] = &
b
;

51 
¨gs_dbl
[2] = 
NULL
;

53 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_ssh‹t
;

54 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_ssh‹t
;

55 
˛_¨g_ty≥s
[2] = 
NULL
;

58 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2,

59 &
ffi_ty≥_ssh‹t
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

61 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_func_‚
), &
ªs_ˇŒ
, 
¨gs_dbl
);

63 
	`¥ötf
("ªs: %d\n", ()
ªs_ˇŒ
);

66 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
ã°_func_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

68 
ªs_˛osuª
 = (*((
ã°_ty≥
)
code
))(2, 32765);

70 
	`¥ötf
("ªs: %d\n", 
ªs_˛osuª
);

73 
	`exô
(0);

74 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_sshortchar.c

8 
	~"ffôe°.h
"

10 sig√d 
	$ã°_func_‚
(sig√d 
a1
, sig√d 
a2
,

11 sig√d 
a3
, sig√d 
a4
)

13 sig√d 
ªsu…
;

15 
ªsu…
 = 
a1
 + 
a2
 + 
a3
 + 
a4
;

17 
	`¥ötf
("%d %d %d %d: %d\n", 
a1
, 
a2
, 
a3
, 
a4
, 
ªsu…
);

19  
ªsu…
;

21 
	}
}

23 
	$ã°_func_gn
(
ffi_cif
 *
cif
 
__UNUSED__
, *
rvÆ
, **
avÆs
,

24 *
d©a
 
__UNUSED__
)

26 sig√d 
a1
, 
a3
;

27 sig√d 
a2
, 
a4
;

29 
a1
 = *(sig√d *)
avÆs
[0];

30 
a2
 = *(sig√d *)
avÆs
[1];

31 
a3
 = *(sig√d *)
avÆs
[2];

32 
a4
 = *(sig√d *)
avÆs
[3];

34 *(
ffi_¨g
 *)
rvÆ
 = 
	`ã°_func_‚
(
a1
, 
a2
, 
a3
, 
a4
);

36 
	}
}

38 sig√d (*
	tã°_ty≥
)(signed , signed ,

41 
	$maö
 ()

43 
ffi_cif
 
cif
;

44 *
code
;

45 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

46 * 
¨gs_dbl
[5];

47 
ffi_ty≥
 * 
˛_¨g_ty≥s
[5];

48 
ffi_¨g
 
ªs_ˇŒ
;

49 sig√d 
a
, 
c
;

50 sig√d 
b
, 
d
, 
ªs_˛osuª
;

52 
a
 = 1;

53 
b
 = 32765;

54 
c
 = 127;

55 
d
 = -128;

57 
¨gs_dbl
[0] = &
a
;

58 
¨gs_dbl
[1] = &
b
;

59 
¨gs_dbl
[2] = &
c
;

60 
¨gs_dbl
[3] = &
d
;

61 
¨gs_dbl
[4] = 
NULL
;

63 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_sch¨
;

64 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_ssh‹t
;

65 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_sch¨
;

66 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_ssh‹t
;

67 
˛_¨g_ty≥s
[4] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

71 &
ffi_ty≥_ssh‹t
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

73 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_func_‚
), &
ªs_ˇŒ
, 
¨gs_dbl
);

75 
	`¥ötf
("ªs: %d\n", (sig√d )
ªs_ˇŒ
);

78 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
ã°_func_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

80 
ªs_˛osuª
 = (*((
ã°_ty≥
)
code
))(1, 32765, 127, -128);

82 
	`¥ötf
("ªs: %d\n", 
ªs_˛osuª
);

85 
	`exô
(0);

86 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_uchar.c

8 
	~"ffôe°.h
"

10 
	$ã°_func_‚
(
a1
, 
a2
,

11 
a3
, 
a4
)

13 
ªsu…
;

15 
ªsu…
 = 
a1
 + 
a2
 + 
a3
 + 
a4
;

17 
	`¥ötf
("%d %d %d %d: %d\n", 
a1
, 
a2
, 
a3
, 
a4
, 
ªsu…
);

19  
ªsu…
;

21 
	}
}

23 
	$ã°_func_gn
(
ffi_cif
 *
cif
 
__UNUSED__
, *
rvÆ
, **
avÆs
,

24 *
d©a
 
__UNUSED__
)

26 
a1
, 
a2
, 
a3
, 
a4
;

28 
a1
 = *(*)
avÆs
[0];

29 
a2
 = *(*)
avÆs
[1];

30 
a3
 = *(*)
avÆs
[2];

31 
a4
 = *(*)
avÆs
[3];

33 *(
ffi_¨g
 *)
rvÆ
 = 
	`ã°_func_‚
(
a1
, 
a2
, 
a3
, 
a4
);

35 
	}
}

37 (*
	tã°_ty≥
)(, ,

40 
	$ã°_func
(
ffi_cif
 *
cif
 
__UNUSED__
, *
rvÆ
 __UNUSED__, **
avÆs
,

41 *
d©a
 
__UNUSED__
)

43 
	`¥ötf
("%d %d %d %d\n", *(*)
avÆs
[0],

44 *(*)
avÆs
[1], *(*)avals[2],

45 *(*)
avÆs
[3]);

46 
	}
}

47 
	$maö
 ()

49 
ffi_cif
 
cif
;

50 *
code
;

51 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

52 * 
¨gs_dbl
[5];

53 
ffi_ty≥
 * 
˛_¨g_ty≥s
[5];

54 
ffi_¨g
 
ªs_ˇŒ
;

55 
a
, 
b
, 
c
, 
d
, 
ªs_˛osuª
;

57 
a
 = 1;

58 
b
 = 2;

59 
c
 = 127;

60 
d
 = 125;

62 
¨gs_dbl
[0] = &
a
;

63 
¨gs_dbl
[1] = &
b
;

64 
¨gs_dbl
[2] = &
c
;

65 
¨gs_dbl
[3] = &
d
;

66 
¨gs_dbl
[4] = 
NULL
;

68 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uch¨
;

69 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_uch¨
;

70 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_uch¨
;

71 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_uch¨
;

72 
˛_¨g_ty≥s
[4] = 
NULL
;

75 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

76 &
ffi_ty≥_uch¨
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

78 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_func_‚
), &
ªs_ˇŒ
, 
¨gs_dbl
);

80 
	`¥ötf
("ªs: %d\n", ()
ªs_ˇŒ
);

83 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
ã°_func_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

85 
ªs_˛osuª
 = (*((
ã°_ty≥
)
code
))(1, 2, 127, 125);

87 
	`¥ötf
("ªs: %d\n", 
ªs_˛osuª
);

90 
	`exô
(0);

91 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_ushort.c

8 
	~"ffôe°.h
"

10 
	$ã°_func_‚
(
a1
, 
a2
)

12 
ªsu…
;

14 
ªsu…
 = 
a1
 + 
a2
;

16 
	`¥ötf
("%d %d: %d\n", 
a1
, 
a2
, 
ªsu…
);

18  
ªsu…
;

20 
	}
}

22 
	$ã°_func_gn
(
ffi_cif
 *
cif
 
__UNUSED__
, *
rvÆ
, **
avÆs
,

23 *
d©a
 
__UNUSED__
)

25 
a1
, 
a2
;

27 
a1
 = *(*)
avÆs
[0];

28 
a2
 = *(*)
avÆs
[1];

30 *(
ffi_¨g
 *)
rvÆ
 = 
	`ã°_func_‚
(
a1
, 
a2
);

32 
	}
}

34 (*
	tã°_ty≥
)(, );

36 
	$maö
 ()

38 
ffi_cif
 
cif
;

39 *
code
;

40 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

41 * 
¨gs_dbl
[3];

42 
ffi_ty≥
 * 
˛_¨g_ty≥s
[3];

43 
ffi_¨g
 
ªs_ˇŒ
;

44 
a
, 
b
, 
ªs_˛osuª
;

46 
a
 = 2;

47 
b
 = 32765;

49 
¨gs_dbl
[0] = &
a
;

50 
¨gs_dbl
[1] = &
b
;

51 
¨gs_dbl
[2] = 
NULL
;

53 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_ush‹t
;

54 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_ush‹t
;

55 
˛_¨g_ty≥s
[2] = 
NULL
;

58 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2,

59 &
ffi_ty≥_ush‹t
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

61 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_func_‚
), &
ªs_ˇŒ
, 
¨gs_dbl
);

63 
	`¥ötf
("ªs: %d\n", ()
ªs_ˇŒ
);

66 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
ã°_func_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

68 
ªs_˛osuª
 = (*((
ã°_ty≥
)
code
))(2, 32765);

70 
	`¥ötf
("ªs: %d\n", 
ªs_˛osuª
);

73 
	`exô
(0);

74 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_ushortchar.c

8 
	~"ffôe°.h
"

10 
	$ã°_func_‚
(
a1
, 
a2
,

11 
a3
, 
a4
)

13 
ªsu…
;

15 
ªsu…
 = 
a1
 + 
a2
 + 
a3
 + 
a4
;

17 
	`¥ötf
("%d %d %d %d: %d\n", 
a1
, 
a2
, 
a3
, 
a4
, 
ªsu…
);

19  
ªsu…
;

21 
	}
}

23 
	$ã°_func_gn
(
ffi_cif
 *
cif
 
__UNUSED__
, *
rvÆ
, **
avÆs
,

24 *
d©a
 
__UNUSED__
)

26 
a1
, 
a3
;

27 
a2
, 
a4
;

29 
a1
 = *(*)
avÆs
[0];

30 
a2
 = *(*)
avÆs
[1];

31 
a3
 = *(*)
avÆs
[2];

32 
a4
 = *(*)
avÆs
[3];

34 *(
ffi_¨g
 *)
rvÆ
 = 
	`ã°_func_‚
(
a1
, 
a2
, 
a3
, 
a4
);

36 
	}
}

38 (*
	tã°_ty≥
)(, ,

41 
	$maö
 ()

43 
ffi_cif
 
cif
;

44 *
code
;

45 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

46 * 
¨gs_dbl
[5];

47 
ffi_ty≥
 * 
˛_¨g_ty≥s
[5];

48 
ffi_¨g
 
ªs_ˇŒ
;

49 
a
, 
c
;

50 
b
, 
d
, 
ªs_˛osuª
;

52 
a
 = 1;

53 
b
 = 2;

54 
c
 = 127;

55 
d
 = 128;

57 
¨gs_dbl
[0] = &
a
;

58 
¨gs_dbl
[1] = &
b
;

59 
¨gs_dbl
[2] = &
c
;

60 
¨gs_dbl
[3] = &
d
;

61 
¨gs_dbl
[4] = 
NULL
;

63 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uch¨
;

64 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_ush‹t
;

65 
˛_¨g_ty≥s
[2] = &
ffi_ty≥_uch¨
;

66 
˛_¨g_ty≥s
[3] = &
ffi_ty≥_ush‹t
;

67 
˛_¨g_ty≥s
[4] = 
NULL
;

70 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

71 &
ffi_ty≥_ush‹t
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

73 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_func_‚
), &
ªs_ˇŒ
, 
¨gs_dbl
);

75 
	`¥ötf
("ªs: %d\n", ()
ªs_ˇŒ
);

78 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
ã°_func_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

80 
ªs_˛osuª
 = (*((
ã°_ty≥
)
code
))(1, 2, 127, 128);

82 
	`¥ötf
("ªs: %d\n", 
ªs_˛osuª
);

85 
	`exô
(0);

86 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_pointer.c

8 
	~"ffôe°.h
"

10 * 
	$˛s_poöãr_‚
(* 
a1
, * 
a2
)

12 * 
ªsu…
 = (*)((
öçå_t
)
a1
 + (öçå_t)
a2
);

14 
	`¥ötf
("0x%08x 0x%08x: 0x%08x\n",

15 ()(
uöçå_t
Ë
a1
,

16 ()(
uöçå_t
Ë
a2
,

17 ()(
uöçå_t
Ë
ªsu…
);

19  
ªsu…
;

20 
	}
}

23 
	$˛s_poöãr_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

24 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

26 * 
a1
 = *(**)(
¨gs
[0]);

27 * 
a2
 = *(**)(
¨gs
[1]);

29 *(**)
ª•
 = 
	`˛s_poöãr_‚
(
a1
, 
a2
);

30 
	}
}

32 
	$maö
 ()

34 
ffi_cif
 
cif
;

35 *
code
;

36 
ffi_˛osuª
* 
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

37 * 
¨gs
[3];

39 
ffi_ty≥
* 
¨g_ty≥s
[3];

46 * 
¨g1
 = (*)0x12345678;

47 * 
¨g2
 = (*)0x89abcdef;

48 
ffi_¨g
 
ªs
 = 0;

50 
¨g_ty≥s
[0] = &
ffi_ty≥_poöãr
;

51 
¨g_ty≥s
[1] = &
ffi_ty≥_poöãr
;

52 
¨g_ty≥s
[2] = 
NULL
;

54 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
ffi_ty≥_poöãr
,

55 
¨g_ty≥s
Ë=
FFI_OK
);

57 
¨gs
[0] = &
¨g1
;

58 
¨gs
[1] = &
¨g2
;

59 
¨gs
[2] = 
NULL
;

61 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_poöãr_‚
), &
ªs
, 
¨gs
);

63 
	`¥ötf
("ªs: 0x%08x\n", (Ë
ªs
);

66 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_poöãr_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

68 
ªs
 = (
ffi_¨g
)(
uöçå_t
)((*(*)(*, *))(
code
))(
¨g1
, 
¨g2
);

70 
	`¥ötf
("ªs: 0x%08x\n", (Ë
ªs
);

73 
	`exô
(0);

74 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_pointer_stack.c

8 
	~"ffôe°.h
"

10 
	gdummyV¨
;

12 
	$dummy_func
(

13 
a1
, 
b1
,

14 
a2
, 
b2
,

15 
a3
, 
b3
,

16 
a4
, 
b4
)

18  
a1
 + 
b1
 + 
a2
 + 
b2
 + 
a3
 + 
b3
 + 
a4
 + 
b4
;

19 
	}
}

21 * 
	$˛s_poöãr_‚2
(* 
a1
, * 
a2
)

23 
åam∂e1
 = (
öçå_t
)
a1
 + (öçå_t)
a2
;

24 
åam∂e2
 = ((*)&
a1
)[0] + ((*)&
a2
)[0];

25 
åam∂e3
 = (
öçå_t
)
åam∂e1
 + (öçå_t)
a1
;

26 
åam∂e4
 = 
åam∂e2
 + ((*)&
a1
)[1];

27 
åam∂e5
 = (
öçå_t
)
åam∂e3
 + (öçå_t)
a2
;

28 
åam∂e6
 = 
åam∂e4
 + ((*)&
a2
)[1];

29 
åam∂e7
 = (
öçå_t
)
åam∂e5
 + (öçå_t)
åam∂e1
;

30 
åam∂e8
 = 
åam∂e6
 + 
åam∂e2
;

31 * 
ªsu…
;

33 
dummyV¨
 = 
	`dummy_func
(
åam∂e1
, 
åam∂e2
, 
åam∂e3
, 
åam∂e4
,

34 
åam∂e5
, 
åam∂e6
, 
åam∂e7
, 
åam∂e8
);

36 
ªsu…
 = (*)((
öçå_t
)
a1
 + (öçå_t)
a2
);

38 
	`¥ötf
("0x%08x 0x%08x: 0x%08x\n",

39 ()(
uöçå_t
Ë
a1
,

40 ()(
uöçå_t
Ë
a2
,

41 ()(
uöçå_t
Ë
ªsu…
);

43  
ªsu…
;

44 
	}
}

46 * 
	$˛s_poöãr_‚1
(* 
a1
, * 
a2
)

48 
åam∂e1
 = (
öçå_t
)
a1
 + (öçå_t)
a2
;

49 
åam∂e2
 = ((*)&
a1
)[0] + ((*)&
a2
)[0];

50 
åam∂e3
 = (
öçå_t
)
åam∂e1
 + (öçå_t)
a1
;

51 
åam∂e4
 = 
åam∂e2
 + ((*)&
a1
)[1];

52 
åam∂e5
 = (
öçå_t
)
åam∂e3
 + (öçå_t)
a2
;

53 
åam∂e6
 = 
åam∂e4
 + ((*)&
a2
)[1];

54 
åam∂e7
 = (
öçå_t
)
åam∂e5
 + (öçå_t)
åam∂e1
;

55 
åam∂e8
 = 
åam∂e6
 + 
åam∂e2
;

56 * 
ªsu…
;

58 
dummyV¨
 = 
	`dummy_func
(
åam∂e1
, 
åam∂e2
, 
åam∂e3
, 
åam∂e4
,

59 
åam∂e5
, 
åam∂e6
, 
åam∂e7
, 
åam∂e8
);

61 
ªsu…
 = (*)((
öçå_t
)
a1
 + (öçå_t)
a2
);

63 
	`¥ötf
("0x%08x 0x%08x: 0x%08x\n",

64 ()(
öçå_t
Ë
a1
,

65 ()(
öçå_t
Ë
a2
,

66 ()(
öçå_t
Ë
ªsu…
);

68 
ªsu…
 = 
	`˛s_poöãr_‚2
‘esu…, 
a1
);

70  
ªsu…
;

71 
	}
}

74 
	$˛s_poöãr_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

75 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

77 * 
a1
 = *(**)(
¨gs
[0]);

78 * 
a2
 = *(**)(
¨gs
[1]);

80 
åam∂e1
 = (
öçå_t
)
a1
 + (öçå_t)
a2
;

81 
åam∂e2
 = ((*)&
a1
)[0] + ((*)&
a2
)[0];

82 
åam∂e3
 = (
öçå_t
)
åam∂e1
 + (öçå_t)
a1
;

83 
åam∂e4
 = 
åam∂e2
 + ((*)&
a1
)[1];

84 
åam∂e5
 = (
öçå_t
)
åam∂e3
 + (öçå_t)
a2
;

85 
åam∂e6
 = 
åam∂e4
 + ((*)&
a2
)[1];

86 
åam∂e7
 = (
öçå_t
)
åam∂e5
 + (öçå_t)
åam∂e1
;

87 
åam∂e8
 = 
åam∂e6
 + 
åam∂e2
;

89 
dummyV¨
 = 
	`dummy_func
(
åam∂e1
, 
åam∂e2
, 
åam∂e3
, 
åam∂e4
,

90 
åam∂e5
, 
åam∂e6
, 
åam∂e7
, 
åam∂e8
);

92 *(**)
ª•
 = 
	`˛s_poöãr_‚1
(
a1
, 
a2
);

93 
	}
}

95 
	$maö
 ()

97 
ffi_cif
 
cif
;

98 *
code
;

99 
ffi_˛osuª
* 
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

100 * 
¨gs
[3];

102 
ffi_ty≥
* 
¨g_ty≥s
[3];

109 * 
¨g1
 = (*)0x01234567;

110 * 
¨g2
 = (*)0x89abcdef;

111 
ffi_¨g
 
ªs
 = 0;

113 
¨g_ty≥s
[0] = &
ffi_ty≥_poöãr
;

114 
¨g_ty≥s
[1] = &
ffi_ty≥_poöãr
;

115 
¨g_ty≥s
[2] = 
NULL
;

117 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
ffi_ty≥_poöãr
,

118 
¨g_ty≥s
Ë=
FFI_OK
);

120 
¨gs
[0] = &
¨g1
;

121 
¨gs
[1] = &
¨g2
;

122 
¨gs
[2] = 
NULL
;

124 
	`¥ötf
("\n");

125 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_poöãr_‚1
), &
ªs
, 
¨gs
);

127 
	`¥ötf
("ªs: 0x%08x\n", (Ë
ªs
);

132 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_poöãr_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

134 
ªs
 = (
ffi_¨g
)(
uöçå_t
)((*(*)(*, *))(
code
))(
¨g1
, 
¨g2
);

136 
	`¥ötf
("ªs: 0x%08x\n", (Ë
ªs
);

141 
	`exô
(0);

142 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_schar.c

10 
	~"ffôe°.h
"

12 
	$˛s_ªt_sch¨_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

13 * 
u£rd©a
 
__UNUSED__
)

15 *(
ffi_¨g
*)
ª•
 = *(sig√d *)
¨gs
[0];

16 
	`¥ötf
("%d: %d\n",*(sig√d *)
¨gs
[0],

17 ()*(
ffi_¨g
 *)(
ª•
));

18 
	}
}

19 sig√d (*
	t˛s_ªt_sch¨
)(signed );

21 
	$maö
 ()

23 
ffi_cif
 
cif
;

24 *
code
;

25 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

26 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

27 sig√d 
ªs
;

29 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_sch¨
;

30 
˛_¨g_ty≥s
[1] = 
NULL
;

33 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

34 &
ffi_ty≥_sch¨
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

36 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_sch¨_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

38 
ªs
 = (*((
˛s_ªt_sch¨
)
code
))(127);

40 
	`¥ötf
("ªs: %d\n", 
ªs
);

43 
	`exô
(0);

44 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_sint.c

8 
	~"ffôe°.h
"

10 
	$˛s_ªt_söt_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

11 * 
u£rd©a
 
__UNUSED__
)

13 *(
ffi_¨g
*)
ª•
 = *(sig√d *)
¨gs
[0];

14 
	`¥ötf
("%d: %d\n",*(sig√d *)
¨gs
[0],

15 ()*(
ffi_¨g
 *)(
ª•
));

16 
	}
}

17 sig√d (*
	t˛s_ªt_söt
)(signed );

19 
	$maö
 ()

21 
ffi_cif
 
cif
;

22 *
code
;

23 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

24 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

25 sig√d 
ªs
;

27 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_söt
;

28 
˛_¨g_ty≥s
[1] = 
NULL
;

31 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

32 &
ffi_ty≥_söt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

34 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_söt_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

36 
ªs
 = (*((
˛s_ªt_söt
)
code
))(65534);

38 
	`¥ötf
("ªs: %d\n",
ªs
);

41 
	`exô
(0);

42 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_sshort.c

8 
	~"ffôe°.h
"

10 
	$˛s_ªt_ssh‹t_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

11 * 
u£rd©a
 
__UNUSED__
)

13 *(
ffi_¨g
*)
ª•
 = *(sig√d *)
¨gs
[0];

14 
	`¥ötf
("%d: %d\n",*(sig√d *)
¨gs
[0],

15 ()*(
ffi_¨g
 *)(
ª•
));

16 
	}
}

17 sig√d (*
	t˛s_ªt_ssh‹t
)(signed );

19 
	$maö
 ()

21 
ffi_cif
 
cif
;

22 *
code
;

23 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

24 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

25 sig√d 
ªs
;

27 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_ssh‹t
;

28 
˛_¨g_ty≥s
[1] = 
NULL
;

31 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

32 &
ffi_ty≥_ssh‹t
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

34 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_ssh‹t_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

36 
ªs
 = (*((
˛s_ªt_ssh‹t
)
code
))(255);

38 
	`¥ötf
("ªs: %d\n",
ªs
);

41 
	`exô
(0);

42 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_struct_va1.c

9 
	~"ffôe°.h
"

11 
	ssmÆl_èg


13 
	ma
;

14 
	mb
;

17 
	sœrge_èg


19 
	ma
;

20 
	mb
;

21 
	mc
;

22 
	md
;

23 
	me
;

27 
	$ã°_‚
 (
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

28 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

30 
n
 = *(*)
¨gs
[0];

31 
smÆl_èg
 
s1
 = * (smÆl_èg *Ë
¨gs
[1];

32 
œrge_èg
 
l1
 = * (œrge_èg *Ë
¨gs
[2];

33 
smÆl_èg
 
s2
 = * (smÆl_èg *Ë
¨gs
[3];

35 
	`¥ötf
 ("%d %d %d %d %d %d %d %d %d %d\n", 
n
, 
s1
.
a
, s1.
b
,

36 
l1
.
a
,Ü1.
b
,Ü1.
c
,Ü1.
d
,Ü1.
e
,

37 
s2
.
a
, s2.
b
);

38 * (
ffi_¨g
*Ë
ª•
 = 42;

39 
	}
}

42 
	$maö
 ()

44 
ffi_cif
 
cif
;

45 *
code
;

46 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
 ( (ffi_˛osuª), &
code
);

47 
ffi_ty≥
* 
¨g_ty≥s
[5];

49 
ffi_¨g
 
ªs
 = 0;

51 
ffi_ty≥
 
s_ty≥
;

52 
ffi_ty≥
 *
s_ty≥_ñemíts
[3];

54 
ffi_ty≥
 
l_ty≥
;

55 
ffi_ty≥
 *
l_ty≥_ñemíts
[6];

57 
smÆl_èg
 
s1
;

58 
smÆl_èg
 
s2
;

59 
œrge_èg
 
l1
;

61 
si
;

63 
s_ty≥
.
size
 = 0;

64 
s_ty≥
.
Æignmít
 = 0;

65 
s_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

66 
s_ty≥
.
ñemíts
 = 
s_ty≥_ñemíts
;

68 
s_ty≥_ñemíts
[0] = &
ffi_ty≥_uch¨
;

69 
s_ty≥_ñemíts
[1] = &
ffi_ty≥_uch¨
;

70 
s_ty≥_ñemíts
[2] = 
NULL
;

72 
l_ty≥
.
size
 = 0;

73 
l_ty≥
.
Æignmít
 = 0;

74 
l_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

75 
l_ty≥
.
ñemíts
 = 
l_ty≥_ñemíts
;

77 
l_ty≥_ñemíts
[0] = &
ffi_ty≥_uöt
;

78 
l_ty≥_ñemíts
[1] = &
ffi_ty≥_uöt
;

79 
l_ty≥_ñemíts
[2] = &
ffi_ty≥_uöt
;

80 
l_ty≥_ñemíts
[3] = &
ffi_ty≥_uöt
;

81 
l_ty≥_ñemíts
[4] = &
ffi_ty≥_uöt
;

82 
l_ty≥_ñemíts
[5] = 
NULL
;

84 
¨g_ty≥s
[0] = &
ffi_ty≥_söt
;

85 
¨g_ty≥s
[1] = &
s_ty≥
;

86 
¨g_ty≥s
[2] = &
l_ty≥
;

87 
¨g_ty≥s
[3] = &
s_ty≥
;

88 
¨g_ty≥s
[4] = 
NULL
;

90 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 4, &
ffi_ty≥_söt
,

91 
¨g_ty≥s
Ë=
FFI_OK
);

93 
si
 = 4;

94 
s1
.
a
 = 5;

95 
s1
.
b
 = 6;

97 
s2
.
a
 = 20;

98 
s2
.
b
 = 21;

100 
l1
.
a
 = 10;

101 
l1
.
b
 = 11;

102 
l1
.
c
 = 12;

103 
l1
.
d
 = 13;

104 
l1
.
e
 = 14;

106 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
ã°_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

108 
ªs
 = (((*)(, ...))(
code
))(
si
, 
s1
, 
l1
, 
s2
);

110 
	`¥ötf
("ªs: %d\n", (Ë
ªs
);

113 
	`exô
(0);

114 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_uchar.c

8 
	~"ffôe°.h
"

10 
	$˛s_ªt_uch¨_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

11 * 
u£rd©a
 
__UNUSED__
)

13 *(
ffi_¨g
*)
ª•
 = *(*)
¨gs
[0];

14 
	`¥ötf
("%d: %d\n",*(*)
¨gs
[0],

15 ()*(
ffi_¨g
 *)(
ª•
));

16 
	}
}

17 (*
	t˛s_ªt_uch¨
)();

19 
	$maö
 ()

21 
ffi_cif
 
cif
;

22 *
code
;

23 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

24 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

25 
ªs
;

27 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uch¨
;

28 
˛_¨g_ty≥s
[1] = 
NULL
;

31 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

32 &
ffi_ty≥_uch¨
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

34 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_uch¨_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

36 
ªs
 = (*((
˛s_ªt_uch¨
)
code
))(127);

38 
	`¥ötf
("ªs: %d\n",
ªs
);

41 
	`exô
(0);

42 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_uchar_va.c

8 
	~"ffôe°.h
"

10 
	tT
;

12 
	$˛s_ªt_T_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

13 * 
u£rd©a
 
__UNUSED__
)

15 *(
ffi_¨g
 *)
ª•
 = *(
T
 *)
¨gs
[0];

17 
	`¥ötf
("%d: %d %d\n", ()(*(
ffi_¨g
 *)
ª•
), *(
T
 *)
¨gs
[0], *(T *)args[1]);

18 
	}
}

20 
	$T
 (*
	t˛s_ªt_T
)(
	tT
, ...);

22 
	$maö
 ()

24 
ffi_cif
 
cif
;

25 *
code
;

26 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

27 
ffi_ty≥
 * 
˛_¨g_ty≥s
[3];

28 
T
 
ªs
;

30 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uch¨
;

31 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_uch¨
;

32 
˛_¨g_ty≥s
[2] = 
NULL
;

35 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 2,

36 &
ffi_ty≥_uch¨
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

38 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_T_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

39 
ªs
 = ((((
˛s_ªt_T
)
code
)(67, 4)));

41 
	`¥ötf
("ªs: %d\n", 
ªs
);

43 
	`exô
(0);

44 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_uint.c

8 
	~"ffôe°.h
"

10 
	$˛s_ªt_uöt_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

11 * 
u£rd©a
 
__UNUSED__
)

13 *(
ffi_¨g
 *)
ª•
 = *(*)
¨gs
[0];

15 
	`¥ötf
("%d: %d\n",*(*)
¨gs
[0],

16 ()*(
ffi_¨g
 *)(
ª•
));

17 
	}
}

18 (*
	t˛s_ªt_uöt
)();

20 
	$maö
 ()

22 
ffi_cif
 
cif
;

23 *
code
;

24 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

25 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

26 
ªs
;

28 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uöt
;

29 
˛_¨g_ty≥s
[1] = 
NULL
;

32 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

33 &
ffi_ty≥_uöt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

35 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_uöt_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

37 
ªs
 = (*((
˛s_ªt_uöt
)
code
))(2147483647);

39 
	`¥ötf
("ªs: %d\n",
ªs
);

42 
	`exô
(0);

43 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_uint_va.c

9 
	~"ffôe°.h
"

11 
	tT
;

13 
	$˛s_ªt_T_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

14 * 
u£rd©a
 
__UNUSED__
)

16 *(
ffi_¨g
 *)
ª•
 = *(
T
 *)
¨gs
[0];

18 
	`¥ötf
("%d: %d %d\n", ()*(
ffi_¨g
 *)
ª•
, *(
T
 *)
¨gs
[0], *(T *)args[1]);

19 
	}
}

21 
	$T
 (*
	t˛s_ªt_T
)(
	tT
, ...);

23 
	$maö
 ()

25 
ffi_cif
 
cif
;

26 *
code
;

27 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

28 
ffi_ty≥
 * 
˛_¨g_ty≥s
[3];

29 
T
 
ªs
;

31 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uöt
;

32 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_uöt
;

33 
˛_¨g_ty≥s
[2] = 
NULL
;

36 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 2,

37 &
ffi_ty≥_uöt
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

39 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_T_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

40 
ªs
 = ((((
˛s_ªt_T
)
code
)(67, 4)));

42 
	`¥ötf
("ªs: %d\n", 
ªs
);

44 
	`exô
(0);

45 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_ulong_va.c

9 
	~"ffôe°.h
"

11 
	tT
;

13 
	$˛s_ªt_T_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

14 * 
u£rd©a
 
__UNUSED__
)

16 *(
T
 *)
ª•
 = *(T *)
¨gs
[0];

18 
	`¥ötf
("%ld: %ld %ld\n", *(
T
 *)
ª•
, *(T *)
¨gs
[0], *(T *)args[1]);

19 
	}
}

21 
	$T
 (*
	t˛s_ªt_T
)(
	tT
, ...);

23 
	$maö
 ()

25 
ffi_cif
 
cif
;

26 *
code
;

27 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

28 
ffi_ty≥
 * 
˛_¨g_ty≥s
[3];

29 
T
 
ªs
;

31 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_ul⁄g
;

32 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_ul⁄g
;

33 
˛_¨g_ty≥s
[2] = 
NULL
;

36 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 2,

37 &
ffi_ty≥_ul⁄g
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

39 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_T_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

40 
ªs
 = ((((
˛s_ªt_T
)
code
)(67, 4)));

42 
	`¥ötf
("ªs: %ld\n", 
ªs
);

44 
	`exô
(0);

45 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_ulonglong.c

9 
	~"ffôe°.h
"

11 
	$˛s_ªt_ul⁄gl⁄g_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
,

12 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

14 *(*)
ª•
0xfffffffffffffffLL ^ *(*)
¨gs
[0];

16 
	`¥ötf
("%" 
PRIuLL
 ": %" PRIuLL "\n",*(*)
¨gs
[0],

17 *(*)(
ª•
));

18 
	}
}

19 (*
	t˛s_ªt_ul⁄gl⁄g
)();

21 
	$maö
 ()

23 
ffi_cif
 
cif
;

24 *
code
;

25 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

26 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

27 
ªs
;

29 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_uöt64
;

30 
˛_¨g_ty≥s
[1] = 
NULL
;

33 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

34 &
ffi_ty≥_uöt64
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

35 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_ul⁄gl⁄g_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

36 
ªs
 = (*((
˛s_ªt_ul⁄gl⁄g
)
code
))(214LL);

38 
	`¥ötf
("ªs: %" 
PRIdLL
 "\n", 
ªs
);

41 
ªs
 = (*((
˛s_ªt_ul⁄gl⁄g
)
code
))(9223372035854775808LL);

43 
	`¥ötf
("ªs: %" 
PRIdLL
 "\n", 
ªs
);

46 
	`exô
(0);

47 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_ushort.c

8 
	~"ffôe°.h
"

10 
	$˛s_ªt_ush‹t_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

11 * 
u£rd©a
 
__UNUSED__
)

13 *(
ffi_¨g
*)
ª•
 = *(*)
¨gs
[0];

15 
	`¥ötf
("%d: %d\n",*(*)
¨gs
[0],

16 ()*(
ffi_¨g
 *)(
ª•
));

17 
	}
}

18 (*
	t˛s_ªt_ush‹t
)();

20 
	$maö
 ()

22 
ffi_cif
 
cif
;

23 *
code
;

24 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

25 
ffi_ty≥
 * 
˛_¨g_ty≥s
[2];

26 
ªs
;

28 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_ush‹t
;

29 
˛_¨g_ty≥s
[1] = 
NULL
;

32 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

33 &
ffi_ty≥_ush‹t
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

35 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_ush‹t_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

37 
ªs
 = (*((
˛s_ªt_ush‹t
)
code
))(65535);

39 
	`¥ötf
("ªs: %d\n",
ªs
);

42 
	`exô
(0);

43 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_ushort_va.c

8 
	~"ffôe°.h
"

10 
	tT
;

12 
	$˛s_ªt_T_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

13 * 
u£rd©a
 
__UNUSED__
)

15 *(
ffi_¨g
 *)
ª•
 = *(
T
 *)
¨gs
[0];

17 
	`¥ötf
("%d: %d %d\n", ()(*(
ffi_¨g
 *)
ª•
), *(
T
 *)
¨gs
[0], *(T *)args[1]);

18 
	}
}

20 
	$T
 (*
	t˛s_ªt_T
)(
	tT
, ...);

22 
	$maö
 ()

24 
ffi_cif
 
cif
;

25 *
code
;

26 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

27 
ffi_ty≥
 * 
˛_¨g_ty≥s
[3];

28 
T
 
ªs
;

30 
˛_¨g_ty≥s
[0] = &
ffi_ty≥_ush‹t
;

31 
˛_¨g_ty≥s
[1] = &
ffi_ty≥_ush‹t
;

32 
˛_¨g_ty≥s
[2] = 
NULL
;

35 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 2,

36 &
ffi_ty≥_ush‹t
, 
˛_¨g_ty≥s
Ë=
FFI_OK
);

38 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_ªt_T_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

39 
ªs
 = ((((
˛s_ªt_T
)
code
)(67, 4)));

41 
	`¥ötf
("ªs: %d\n", 
ªs
);

43 
	`exô
(0);

44 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/err_bad_abi.c

9 
	~"ffôe°.h
"

12 
	$dummy_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
 __UNUSED__,

13 ** 
¨gs
 
__UNUSED__
, * 
u£rd©a
 __UNUSED__)

14 {
	}
}

16 
	$maö
 ()

18 
ffi_cif
 
cif
;

19 *
code
;

20 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

21 
ffi_ty≥
* 
¨g_ty≥s
[1];

23 
¨g_ty≥s
[0] = 
NULL
;

25 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 255, 0, &
ffi_ty≥_void
,

26 
¨g_ty≥s
Ë=
FFI_BAD_ABI
);

28 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 0, &
ffi_ty≥_void
,

29 
¨g_ty≥s
Ë=
FFI_OK
);

31 
cif
.
abi
= 255;

33 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
dummy_‚
, 
NULL
, 
code
Ë=
FFI_BAD_ABI
);

35 
	`exô
(0);

36 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/err_bad_typedef.c

9 
	~"ffôe°.h
"

11 
	$maö
 ()

13 
ffi_cif
 
cif
;

14 
ffi_ty≥
* 
¨g_ty≥s
[1];

16 
ffi_ty≥
 
badTy≥
 = 
ffi_ty≥_void
;

18 
¨g_ty≥s
[0] = 
NULL
;

20 
badTy≥
.
size
 = 0;

22 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 0, &
badTy≥
,

23 
¨g_ty≥s
Ë=
FFI_BAD_TYPEDEF
);

25 
	`exô
(0);

26 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/ffitest.h

1 
	~<°dlib.h
>

2 
	~<°dio.h
>

3 
	~<°rög.h
>

4 
	~<f˙é.h
>

5 
	~<ffi.h
>

6 
	~"ffic⁄fig.h
"

8 #i‡
deföed
 
HAVE_STDINT_H


9 
	~<°döt.h
>

12 #i‡
deföed
 
HAVE_INTTYPES_H


13 
	~<öây≥s.h
>

16 
	#MAX_ARGS
 256

	)

18 
	#CHECK
(
x
Ë()(!(xË? (
	`ab‹t
(), 1Ë: 0)

	)

21 #unde‡
__UNUSED__


22 #i‡
deföed
(
__GNUC__
)

23 
	#__UNUSED__
 
	`__©åibuã__
((
__unu£d__
))

	)

24 
	#__STDCALL__
 
	`__©åibuã__
((
°dˇŒ
))

	)

25 
	#__THISCALL__
 
	`__©åibuã__
((
thisˇŒ
))

	)

26 
	#__FASTCALL__
 
	`__©åibuã__
((
Á°ˇŒ
))

	)

28 
	#__UNUSED__


	)

29 
	#__STDCALL__
 
__°dˇŒ


	)

30 
	#__THISCALL__
 
__thisˇŒ


	)

31 
	#__FASTCALL__
 
__Á°ˇŒ


	)

34 #i‚de‡
ABI_NUM


35 
	#ABI_NUM
 
FFI_DEFAULT_ABI


	)

36 
	#ABI_ATTR


	)

41 #ifde‡
HAVE_MMAP_ANON


42 #unde‡
HAVE_MMAP_DEV_ZERO


44 
	~<sys/mm™.h
>

45 #i‚de‡
MAP_FAILED


46 
	#MAP_FAILED
 -1

	)

48 #i‡!
deföed
 (
MAP_ANONYMOUS
Ë&& deföed (
MAP_ANON
)

49 
	#MAP_ANONYMOUS
 
MAP_ANON


	)

51 
	#USING_MMAP


	)

55 #ifde‡
HAVE_MMAP_DEV_ZERO


57 
	~<sys/mm™.h
>

58 #i‚de‡
MAP_FAILED


59 
	#MAP_FAILED
 -1

	)

61 
	#USING_MMAP


	)

66 #ifde‡
_WIN64


67 
	#PRIdLL
 "I64d"

	)

68 
	#PRIuLL
 "I64u"

	)

70 
	#PRIdLL
 "Œd"

	)

71 
	#PRIuLL
 "Œu"

	)

75 #i‡
deföed
(
__Æpha__
Ë&& deföed(
__osf__
)

77 #unde‡
PRIdLL


78 
	#PRIdLL
 "ld"

	)

79 #unde‡
PRIuLL


80 
	#PRIuLL
 "lu"

	)

81 
	#PRId8
 "hd"

	)

82 
	#PRIu8
 "hu"

	)

83 
	#PRId64
 "ld"

	)

84 
	#PRIu64
 "lu"

	)

85 
	#PRIuPTR
 "lu"

	)

89 #i‡
deföed
(
__hµa__
Ë&& deföed(
__hpux__
Ë&& !deföed(
PRIuPTR
)

90 
	#PRIuPTR
 "lu"

	)

94 #i‡
deföed
(
__sgi
)

97 
	#PRId8
 "hhd"

	)

98 
	#PRIu8
 "hhu"

	)

99 #i‡(
_MIPS_SZLONG
 == 32)

100 
	#PRId64
 "Œd"

	)

101 
	#PRIu64
 "Œu"

	)

106 #i‡(
_MIPS_SZLONG
 == 64)

107 
	#PRId64
 "ld"

	)

108 
	#PRIu64
 "lu"

	)

112 
	#PRIuPTR
 "lu"

	)

116 #i‡
deföed
(
__sun__
Ë&& deföed(
__svr4__
Ë&& !deföed(
PRIuPTR
)

117 #i‡
deföed
(
__¨ch64__
Ë|| deföed (
__x86_64__
)

118 
	#PRIuPTR
 "lu"

	)

120 
	#PRIuPTR
 "u"

	)

125 #i‡
deföed
 
_MSC_VER


126 
	#PRIuPTR
 "lu"

	)

127 
	#PRIu8
 "u"

	)

128 
	#PRId8
 "d"

	)

129 
	#PRIu64
 "I64u"

	)

130 
	#PRId64
 "I64d"

	)

133 #i‚de‡
PRIuPTR


134 
	#PRIuPTR
 "u"

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float.c

9 
	~"ffôe°.h
"

11 
	$Êﬂtög
(
a
, 
b
, 
c
, 
d
)

13 
i
;

15 
i
 = (Ë(()
a
/
b
 + (()
c
/()
d
));

17  
i
;

18 
	}
}

20 
	$maö
 ()

22 
ffi_cif
 
cif
;

23 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

24 *
vÆues
[
MAX_ARGS
];

25 
ffi_¨g
 
röt
;

27 
f
;

28 sig√d 
si1
;

29 
d
;

30 
ld
;

32 
¨gs
[0] = &
ffi_ty≥_söt
;

33 
vÆues
[0] = &
si1
;

34 
¨gs
[1] = &
ffi_ty≥_Êﬂt
;

35 
vÆues
[1] = &
f
;

36 
¨gs
[2] = &
ffi_ty≥_doubÀ
;

37 
vÆues
[2] = &
d
;

38 
¨gs
[3] = &
ffi_ty≥_l⁄gdoubÀ
;

39 
vÆues
[3] = &
ld
;

42 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

43 &
ffi_ty≥_söt
, 
¨gs
Ë=
FFI_OK
);

45 
si1
 = 6;

46 
f
 = 3.14159;

47 
d
 = ()1.0/()3.0;

48 
ld
 = 2.71828182846L;

50 
	`Êﬂtög
 (
si1
, 
f
, 
d
, 
ld
);

52 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
Êﬂtög
), &
röt
, 
vÆues
);

54 
	`¥ötf
 ("%d v†%d\n", ()
röt
, 
	`Êﬂtög
 (
si1
, 
f
, 
d
, 
ld
));

56 
	`CHECK
(()
röt
 =
	`Êﬂtög
(
si1
, 
f
, 
d
, 
ld
));

58 
	`exô
 (0);

59 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float1.c

8 
	~"ffôe°.h
"

9 
	~"Êﬂt.h
"

13 
	md
;

14 
	mc
[ ()];

15 } 
	tvÆue_ty≥
;

17 
	#CANARY
 0xba

	)

19 
	$dblô
(
f
)

21  
f
/3.0;

22 
	}
}

24 
	$maö
 ()

26 
ffi_cif
 
cif
;

27 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

28 *
vÆues
[
MAX_ARGS
];

29 
f
;

30 
vÆue_ty≥
 
ªsu…
[2];

31 
i
;

33 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

34 
vÆues
[0] = &
f
;

37 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

38 &
ffi_ty≥_doubÀ
, 
¨gs
Ë=
FFI_OK
);

40 
f
 = 3.14159;

44 
	`mem£t
(
ªsu…
[1].
c
, 
CANARY
,  ());

46 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
dblô
), &
ªsu…
[0].
d
, 
vÆues
);

50 
	`CHECK
(
ªsu…
[0].
d
 - 
	`dblô
(
f
Ë< 
DBL_EPSILON
);

53 
i
 = 0; i <  (); ++i)

54 
	`CHECK
(
ªsu…
[1].
c
[
i
] =
CANARY
);

56 
	`exô
(0);

58 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float2.c

10 
	~"ffôe°.h
"

11 
	~"Êﬂt.h
"

13 
	$ldblô
(
f
)

15  (Ë(((Ë
f
)/ () 3.0);

16 
	}
}

18 
	$maö
 ()

20 
ffi_cif
 
cif
;

21 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

22 *
vÆues
[
MAX_ARGS
];

23 
f
;

24 
ld
;

26 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

27 
vÆues
[0] = &
f
;

30 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

31 &
ffi_ty≥_l⁄gdoubÀ
, 
¨gs
Ë=
FFI_OK
);

33 
f
 = 3.14159;

39 
	`¥ötf
 ("%Lf\n", 
	`ldblô
(
f
));

41 
ld
 = 666;

42 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ldblô
), &
ld
, 
vÆues
);

48 
	`¥ötf
 ("%Lf, %Lf, %Lf, %Lf\n", 
ld
, 
	`ldblô
(
f
),Üd -Üdblô(f), 
LDBL_EPSILON
);

52 i‡(
ld
 - 
	`ldblô
(
f
Ë< 
LDBL_EPSILON
)

53 
	`puts
("long doubleÑeturn valueÅests ok!");

55 
	`CHECK
(0);

57 
	`exô
(0);

58 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float3.c

9 
	~"ffôe°.h
"

10 
	~"Êﬂt.h
"

12 
	$Êﬂtög_1
(
a
, 
b
, 
c
)

14  (Ë
a
 + 
b
 + (Ë
c
;

15 
	}
}

17 
	$Êﬂtög_2
(
a
, 
b
, 
c
)

19  (Ë
a
 + 
b
 + (Ë
c
;

20 
	}
}

22 
	$maö
 ()

24 
ffi_cif
 
cif
;

25 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

26 *
vÆues
[
MAX_ARGS
];

27 
rd
;

29 
f
;

30 
d
;

31 
ld
;

33 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

34 
vÆues
[0] = &
f
;

35 
¨gs
[1] = &
ffi_ty≥_doubÀ
;

36 
vÆues
[1] = &
d
;

37 
¨gs
[2] = &
ffi_ty≥_l⁄gdoubÀ
;

38 
vÆues
[2] = &
ld
;

41 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3,

42 &
ffi_ty≥_doubÀ
, 
¨gs
Ë=
FFI_OK
);

44 
f
 = 3.14159;

45 
d
 = ()1.0/()3.0;

46 
ld
 = 2.71828182846L;

48 
	`Êﬂtög_1
 (
f
, 
d
, 
ld
);

50 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
Êﬂtög_1
), &
rd
, 
vÆues
);

52 
	`CHECK
(
rd
 - 
	`Êﬂtög_1
(
f
, 
d
, 
ld
Ë< 
DBL_EPSILON
);

54 
¨gs
[0] = &
ffi_ty≥_l⁄gdoubÀ
;

55 
vÆues
[0] = &
ld
;

56 
¨gs
[1] = &
ffi_ty≥_doubÀ
;

57 
vÆues
[1] = &
d
;

58 
¨gs
[2] = &
ffi_ty≥_Êﬂt
;

59 
vÆues
[2] = &
f
;

62 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3,

63 &
ffi_ty≥_doubÀ
, 
¨gs
Ë=
FFI_OK
);

65 
	`Êﬂtög_2
 (
ld
, 
d
, 
f
);

67 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
Êﬂtög_2
), &
rd
, 
vÆues
);

69 
	`CHECK
(
rd
 - 
	`Êﬂtög_2
(
ld
, 
d
, 
f
Ë< 
DBL_EPSILON
);

71 
	`exô
 (0);

72 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float4.c

10 
	~"ffôe°.h
"

11 
	~"Êﬂt.h
"

15 
	md
;

16 
	mc
[ ()];

17 } 
	tvÆue_ty≥
;

19 
	#CANARY
 0xba

	)

21 
	$dblô
(
d
)

23  
d
;

24 
	}
}

26 
	$maö
 ()

28 
ffi_cif
 
cif
;

29 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

30 *
vÆues
[
MAX_ARGS
];

31 
d
;

32 
vÆue_ty≥
 
ªsu…
[2];

33 
i
;

35 
¨gs
[0] = &
ffi_ty≥_doubÀ
;

36 
vÆues
[0] = &
d
;

39 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

40 &
ffi_ty≥_doubÀ
, 
¨gs
Ë=
FFI_OK
);

42 
d
 = 
DBL_MIN
 / 2;

46 
	`mem£t
(
ªsu…
[1].
c
, 
CANARY
,  ());

48 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
dblô
), &
ªsu…
[0].
d
, 
vÆues
);

54 
	`CHECK
(
ªsu…
[0].
d
 =
	`dblô
(d));

57 
i
 = 0; i <  (); ++i)

58 
	`CHECK
(
ªsu…
[1].
c
[
i
] =
CANARY
);

60 
	`exô
(0);

62 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float_va.c

12 
	~<°d¨g.h
>

14 
	~"ffôe°.h
"

19 
	$Êﬂt_va_‚
(
x
, 
y
,...)

21 
tŸÆ
=0.0;

22 
va_li°
 
≠
;

23 
i
;

25 
tŸÆ
+=()
x
;

26 
tŸÆ
+=
y
;

28 
	`¥ötf
("%u: %.1‡:", 
x
, 
y
);

30 
	`va_°¨t
(
≠
, 
y
);

31 
i
=0;i<
x
;i++)

33 
¨g
=
	`va_¨g
(
≠
, );

34 
tŸÆ
+=
¨g
;

35 
	`¥ötf
(" %d:%.1‡", 
i
, 
¨g
);

37 
	`va_íd
(
≠
);

39 
	`¥ötf
("ÅŸÆ: %.1f\n", 
tŸÆ
);

41  
tŸÆ
;

42 
	}
}

44 
	$maö
 ()

46 
ffi_cif
 
cif
;

48 
ffi_ty≥
 *
¨g_ty≥s
[5];

49 *
vÆues
[5];

50 
doubÀs
[5];

51 
fú°¨g
;

52 
ªsÂ
;

58 
ªsÂ
=
	`Êﬂt_va_‚
(0,2.0);

60 
	`¥ötf
("compûed: %.1f\n", 
ªsÂ
);

63 
¨g_ty≥s
[0] = &
ffi_ty≥_uöt
;

64 
¨g_ty≥s
[1] = &
ffi_ty≥_doubÀ
;

65 
¨g_ty≥s
[2] = 
NULL
;

66 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 2, 2,

67 &
ffi_ty≥_doubÀ
, 
¨g_ty≥s
Ë=
FFI_OK
);

69 
fú°¨g
 = 0;

70 
doubÀs
[0] = 2.0;

71 
vÆues
[0] = &
fú°¨g
;

72 
vÆues
[1] = &
doubÀs
[0];

73 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
Êﬂt_va_‚
), &
ªsÂ
, 
vÆues
);

75 
	`¥ötf
("ffi: %.1f\n", 
ªsÂ
);

80 
ªsÂ
=
	`Êﬂt_va_‚
(2,2.0,3.0,4.0);

82 
	`¥ötf
("compûed: %.1f\n", 
ªsÂ
);

85 
¨g_ty≥s
[0] = &
ffi_ty≥_uöt
;

86 
¨g_ty≥s
[1] = &
ffi_ty≥_doubÀ
;

87 
¨g_ty≥s
[2] = &
ffi_ty≥_doubÀ
;

88 
¨g_ty≥s
[3] = &
ffi_ty≥_doubÀ
;

89 
¨g_ty≥s
[4] = 
NULL
;

90 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 2, 4,

91 &
ffi_ty≥_doubÀ
, 
¨g_ty≥s
Ë=
FFI_OK
);

93 
fú°¨g
 = 2;

94 
doubÀs
[0] = 2.0;

95 
doubÀs
[1] = 3.0;

96 
doubÀs
[2] = 4.0;

97 
vÆues
[0] = &
fú°¨g
;

98 
vÆues
[1] = &
doubÀs
[0];

99 
vÆues
[2] = &
doubÀs
[1];

100 
vÆues
[3] = &
doubÀs
[2];

101 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
Êﬂt_va_‚
), &
ªsÂ
, 
vÆues
);

103 
	`¥ötf
("ffi: %.1f\n", 
ªsÂ
);

106 
	`exô
(0);

107 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/huge_struct.c

14 
	~"ffôe°.h
"

16 
	sBigSåu˘
{

17 
uöt8_t
 
	ma
;

18 
öt8_t
 
	mb
;

19 
uöt16_t
 
	mc
;

20 
öt16_t
 
	md
;

21 
uöt32_t
 
	me
;

22 
öt32_t
 
	mf
;

23 
uöt64_t
 
	mg
;

24 
öt64_t
 
	mh
;

25 
	mi
;

26 
	mj
;

27 
	mk
;

28 * 
	ml
;

29 
uöt8_t
 
	mm
;

30 
öt8_t
 
	mn
;

31 
uöt16_t
 
	mo
;

32 
öt16_t
 
	mp
;

33 
uöt32_t
 
	mq
;

34 
öt32_t
 
	mr
;

35 
uöt64_t
 
	ms
;

36 
öt64_t
 
	mt
;

37 
	mu
;

38 
	mv
;

39 
	mw
;

40 * 
	mx
;

41 
uöt8_t
 
	my
;

42 
öt8_t
 
	mz
;

43 
uöt16_t
 
	mØ
;

44 
öt16_t
 
	mbb
;

45 
uöt32_t
 
	mcc
;

46 
öt32_t
 
	mdd
;

47 
uöt64_t
 
	mì
;

48 
öt64_t
 
	mff
;

49 
	mgg
;

50 
	mhh
;

51 
	mii
;

52 * 
	mjj
;

53 
uöt8_t
 
	mkk
;

54 
öt8_t
 
	mŒ
;

55 
uöt16_t
 
	mmm
;

56 
öt16_t
 
	m¬
;

57 
uöt32_t
 
	moo
;

58 
öt32_t
 
	mµ
;

59 
uöt64_t
 
	mqq
;

60 
öt64_t
 
	mº
;

61 
	mss
;

62 
	mâ
;

63 
	muu
;

64 * 
	mvv
;

65 
uöt8_t
 
	mww
;

66 
öt8_t
 
	mxx
;

67 } 
	tBigSåu˘
;

69 
BigSåu˘


70 
	$ã°_œrge_‚
(

71 
uöt8_t
 
ui8_1
,

72 
öt8_t
 
si8_1
,

73 
uöt16_t
 
ui16_1
,

74 
öt16_t
 
si16_1
,

75 
uöt32_t
 
ui32_1
,

76 
öt32_t
 
si32_1
,

77 
uöt64_t
 
ui64_1
,

78 
öt64_t
 
si64_1
,

79 
f_1
,

80 
d_1
,

81 
ld_1
,

82 * 
p_1
,

83 
uöt8_t
 
ui8_2
,

84 
öt8_t
 
si8_2
,

85 
uöt16_t
 
ui16_2
,

86 
öt16_t
 
si16_2
,

87 
uöt32_t
 
ui32_2
,

88 
öt32_t
 
si32_2
,

89 
uöt64_t
 
ui64_2
,

90 
öt64_t
 
si64_2
,

91 
f_2
,

92 
d_2
,

93 
ld_2
,

94 * 
p_2
,

95 
uöt8_t
 
ui8_3
,

96 
öt8_t
 
si8_3
,

97 
uöt16_t
 
ui16_3
,

98 
öt16_t
 
si16_3
,

99 
uöt32_t
 
ui32_3
,

100 
öt32_t
 
si32_3
,

101 
uöt64_t
 
ui64_3
,

102 
öt64_t
 
si64_3
,

103 
f_3
,

104 
d_3
,

105 
ld_3
,

106 * 
p_3
,

107 
uöt8_t
 
ui8_4
,

108 
öt8_t
 
si8_4
,

109 
uöt16_t
 
ui16_4
,

110 
öt16_t
 
si16_4
,

111 
uöt32_t
 
ui32_4
,

112 
öt32_t
 
si32_4
,

113 
uöt64_t
 
ui64_4
,

114 
öt64_t
 
si64_4
,

115 
f_4
,

116 
d_4
,

117 
ld_4
,

118 * 
p_4
,

119 
uöt8_t
 
ui8_5
,

120 
öt8_t
 
si8_5
)

122 
BigSåu˘
 
ªtVÆ
 = {

123 
ui8_1
 + 1, 
si8_1
 + 1, 
ui16_1
 + 1, 
si16_1
 + 1, 
ui32_1
 + 1, 
si32_1
 + 1,

124 
ui64_1
 + 1, 
si64_1
 + 1, 
f_1
 + 1, 
d_1
 + 1, 
ld_1
 + 1, (*)((
öçå_t
)
p_1
 + 1),

125 
ui8_2
 + 2, 
si8_2
 + 2, 
ui16_2
 + 2, 
si16_2
 + 2, 
ui32_2
 + 2, 
si32_2
 + 2,

126 
ui64_2
 + 2, 
si64_2
 + 2, 
f_2
 + 2, 
d_2
 + 2, 
ld_2
 + 2, (*)((
öçå_t
)
p_2
 + 2),

127 
ui8_3
 + 3, 
si8_3
 + 3, 
ui16_3
 + 3, 
si16_3
 + 3, 
ui32_3
 + 3, 
si32_3
 + 3,

128 
ui64_3
 + 3, 
si64_3
 + 3, 
f_3
 + 3, 
d_3
 + 3, 
ld_3
 + 3, (*)((
öçå_t
)
p_3
 + 3),

129 
ui8_4
 + 4, 
si8_4
 + 4, 
ui16_4
 + 4, 
si16_4
 + 4, 
ui32_4
 + 4, 
si32_4
 + 4,

130 
ui64_4
 + 4, 
si64_4
 + 4, 
f_4
 + 4, 
d_4
 + 4, 
ld_4
 + 4, (*)((
öçå_t
)
p_4
 + 4),

131 
ui8_5
 + 5, 
si8_5
 + 5};

133 
	`¥ötf
("%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

134 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

135 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

136 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx %" PRIu8 " %" PRId8 ": "

137 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

138 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

139 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

140 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx %" PRIu8 " %" PRId8 "\n",

141 
ui8_1
, 
si8_1
, 
ui16_1
, 
si16_1
, 
ui32_1
, 
si32_1
, 
ui64_1
, 
si64_1
, 
f_1
, 
d_1
, 
ld_1
, ()
p_1
,

142 
ui8_2
, 
si8_2
, 
ui16_2
, 
si16_2
, 
ui32_2
, 
si32_2
, 
ui64_2
, 
si64_2
, 
f_2
, 
d_2
, 
ld_2
, ()
p_2
,

143 
ui8_3
, 
si8_3
, 
ui16_3
, 
si16_3
, 
ui32_3
, 
si32_3
, 
ui64_3
, 
si64_3
, 
f_3
, 
d_3
, 
ld_3
, ()
p_3
,

144 
ui8_4
, 
si8_4
, 
ui16_4
, 
si16_4
, 
ui32_4
, 
si32_4
, 
ui64_4
, 
si64_4
, 
f_4
, 
d_4
, 
ld_4
, ()
p_4
, 
ui8_5
, 
si8_5
,

145 
ªtVÆ
.
a
,ÑëVÆ.
b
,ÑëVÆ.
c
,ÑëVÆ.
d
,ÑëVÆ.
e
,ÑëVÆ.
f
,

146 
ªtVÆ
.
g
,ÑëVÆ.
h
,ÑëVÆ.
i
,ÑëVÆ.
j
,ÑëVÆ.
k
, (ÏëVÆ.
l
,

147 
ªtVÆ
.
m
,ÑëVÆ.
n
,ÑëVÆ.
o
,ÑëVÆ.
p
,ÑëVÆ.
q
,ÑëVÆ.
r
,

148 
ªtVÆ
.
s
,ÑëVÆ.
t
,ÑëVÆ.
u
,ÑëVÆ.
v
,ÑëVÆ.
w
, (ÏëVÆ.
x
,

149 
ªtVÆ
.
y
,ÑëVÆ.
z
,ÑëVÆ.
Ø
,ÑëVÆ.
bb
,ÑëVÆ.
cc
,ÑëVÆ.
dd
,

150 
ªtVÆ
.
ì
,ÑëVÆ.
ff
,ÑëVÆ.
gg
,ÑëVÆ.
hh
,ÑëVÆ.
ii
, (ÏëVÆ.
jj
,

151 
ªtVÆ
.
kk
,ÑëVÆ.
Œ
,ÑëVÆ.
mm
,ÑëVÆ.
¬
,ÑëVÆ.
oo
,ÑëVÆ.
µ
,

152 
ªtVÆ
.
qq
,ÑëVÆ.
º
,ÑëVÆ.
ss
,ÑëVÆ.
â
,ÑëVÆ.
uu
, (ÏëVÆ.
vv
,ÑëVÆ.
ww
,ÑëVÆ.
xx
);

154  
ªtVÆ
;

155 
	}
}

158 
	$˛s_œrge_‚
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
, * 
u£rd©a
 __UNUSED__)

160 
uöt8_t
 
ui8_1
 = *(uöt8_t*)
¨gs
[0];

161 
öt8_t
 
si8_1
 = *(öt8_t*)
¨gs
[1];

162 
uöt16_t
 
ui16_1
 = *(uöt16_t*)
¨gs
[2];

163 
öt16_t
 
si16_1
 = *(öt16_t*)
¨gs
[3];

164 
uöt32_t
 
ui32_1
 = *(uöt32_t*)
¨gs
[4];

165 
öt32_t
 
si32_1
 = *(öt32_t*)
¨gs
[5];

166 
uöt64_t
 
ui64_1
 = *(uöt64_t*)
¨gs
[6];

167 
öt64_t
 
si64_1
 = *(öt64_t*)
¨gs
[7];

168 
f_1
 = *(*)
¨gs
[8];

169 
d_1
 = *(*)
¨gs
[9];

170 
ld_1
 = *(*)
¨gs
[10];

171 * 
p_1
 = *(**)
¨gs
[11];

172 
uöt8_t
 
ui8_2
 = *(uöt8_t*)
¨gs
[12];

173 
öt8_t
 
si8_2
 = *(öt8_t*)
¨gs
[13];

174 
uöt16_t
 
ui16_2
 = *(uöt16_t*)
¨gs
[14];

175 
öt16_t
 
si16_2
 = *(öt16_t*)
¨gs
[15];

176 
uöt32_t
 
ui32_2
 = *(uöt32_t*)
¨gs
[16];

177 
öt32_t
 
si32_2
 = *(öt32_t*)
¨gs
[17];

178 
uöt64_t
 
ui64_2
 = *(uöt64_t*)
¨gs
[18];

179 
öt64_t
 
si64_2
 = *(öt64_t*)
¨gs
[19];

180 
f_2
 = *(*)
¨gs
[20];

181 
d_2
 = *(*)
¨gs
[21];

182 
ld_2
 = *(*)
¨gs
[22];

183 * 
p_2
 = *(**)
¨gs
[23];

184 
uöt8_t
 
ui8_3
 = *(uöt8_t*)
¨gs
[24];

185 
öt8_t
 
si8_3
 = *(öt8_t*)
¨gs
[25];

186 
uöt16_t
 
ui16_3
 = *(uöt16_t*)
¨gs
[26];

187 
öt16_t
 
si16_3
 = *(öt16_t*)
¨gs
[27];

188 
uöt32_t
 
ui32_3
 = *(uöt32_t*)
¨gs
[28];

189 
öt32_t
 
si32_3
 = *(öt32_t*)
¨gs
[29];

190 
uöt64_t
 
ui64_3
 = *(uöt64_t*)
¨gs
[30];

191 
öt64_t
 
si64_3
 = *(öt64_t*)
¨gs
[31];

192 
f_3
 = *(*)
¨gs
[32];

193 
d_3
 = *(*)
¨gs
[33];

194 
ld_3
 = *(*)
¨gs
[34];

195 * 
p_3
 = *(**)
¨gs
[35];

196 
uöt8_t
 
ui8_4
 = *(uöt8_t*)
¨gs
[36];

197 
öt8_t
 
si8_4
 = *(öt8_t*)
¨gs
[37];

198 
uöt16_t
 
ui16_4
 = *(uöt16_t*)
¨gs
[38];

199 
öt16_t
 
si16_4
 = *(öt16_t*)
¨gs
[39];

200 
uöt32_t
 
ui32_4
 = *(uöt32_t*)
¨gs
[40];

201 
öt32_t
 
si32_4
 = *(öt32_t*)
¨gs
[41];

202 
uöt64_t
 
ui64_4
 = *(uöt64_t*)
¨gs
[42];

203 
öt64_t
 
si64_4
 = *(öt64_t*)
¨gs
[43];

204 
f_4
 = *(*)
¨gs
[44];

205 
d_4
 = *(*)
¨gs
[45];

206 
ld_4
 = *(*)
¨gs
[46];

207 * 
p_4
 = *(**)
¨gs
[47];

208 
uöt8_t
 
ui8_5
 = *(uöt8_t*)
¨gs
[48];

209 
öt8_t
 
si8_5
 = *(öt8_t*)
¨gs
[49];

211 *(
BigSåu˘
*)
ª•
 = 
	`ã°_œrge_‚
(

212 
ui8_1
, 
si8_1
, 
ui16_1
, 
si16_1
, 
ui32_1
, 
si32_1
, 
ui64_1
, 
si64_1
, 
f_1
, 
d_1
, 
ld_1
, 
p_1
,

213 
ui8_2
, 
si8_2
, 
ui16_2
, 
si16_2
, 
ui32_2
, 
si32_2
, 
ui64_2
, 
si64_2
, 
f_2
, 
d_2
, 
ld_2
, 
p_2
,

214 
ui8_3
, 
si8_3
, 
ui16_3
, 
si16_3
, 
ui32_3
, 
si32_3
, 
ui64_3
, 
si64_3
, 
f_3
, 
d_3
, 
ld_3
, 
p_3
,

215 
ui8_4
, 
si8_4
, 
ui16_4
, 
si16_4
, 
ui32_4
, 
si32_4
, 
ui64_4
, 
si64_4
, 
f_4
, 
d_4
, 
ld_4
, 
p_4
,

216 
ui8_5
, 
si8_5
);

217 
	}
}

220 
	$maö
(
¨gc
 
__UNUSED__
, c⁄° ** 
¨gv
 __UNUSED__)

222 *
code
;

223 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

225 
ffi_cif
 
cif
;

226 
ffi_ty≥
* 
¨gTy≥s
[51];

227 * 
¨gVÆues
[51];

229 
ffi_ty≥
 
ªt_°ru˘_ty≥
;

230 
ffi_ty≥
* 
°_fõlds
[51];

231 
BigSåu˘
 
ªtVÆ
;

233 
uöt8_t
 
ui8
 = 1;

234 
öt8_t
 
si8
 = 2;

235 
uöt16_t
 
ui16
 = 3;

236 
öt16_t
 
si16
 = 4;

237 
uöt32_t
 
ui32
 = 5;

238 
öt32_t
 
si32
 = 6;

239 
uöt64_t
 
ui64
 = 7;

240 
öt64_t
 
si64
 = 8;

241 
f
 = 9;

242 
d
 = 10;

243 
ld
 = 11;

244 * 
p
 = (*)0x12345678;

246 
	`mem£t
 (&
ªtVÆ
, 0, (retVal));

248 
ªt_°ru˘_ty≥
.
size
 = 0;

249 
ªt_°ru˘_ty≥
.
Æignmít
 = 0;

250 
ªt_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

251 
ªt_°ru˘_ty≥
.
ñemíts
 = 
°_fõlds
;

253 
°_fõlds
[0] = st_fõlds[12] = st_fõlds[24] = st_fõlds[36] = st_fõlds[48] = &
ffi_ty≥_uöt8
;

254 
°_fõlds
[1] = st_fõlds[13] = st_fõlds[25] = st_fõlds[37] = st_fõlds[49] = &
ffi_ty≥_söt8
;

255 
°_fõlds
[2] = st_fõlds[14] = st_fõlds[26] = st_fõlds[38] = &
ffi_ty≥_uöt16
;

256 
°_fõlds
[3] = st_fõlds[15] = st_fõlds[27] = st_fõlds[39] = &
ffi_ty≥_söt16
;

257 
°_fõlds
[4] = st_fõlds[16] = st_fõlds[28] = st_fõlds[40] = &
ffi_ty≥_uöt32
;

258 
°_fõlds
[5] = st_fõlds[17] = st_fõlds[29] = st_fõlds[41] = &
ffi_ty≥_söt32
;

259 
°_fõlds
[6] = st_fõlds[18] = st_fõlds[30] = st_fõlds[42] = &
ffi_ty≥_uöt64
;

260 
°_fõlds
[7] = st_fõlds[19] = st_fõlds[31] = st_fõlds[43] = &
ffi_ty≥_söt64
;

261 
°_fõlds
[8] = st_fõlds[20] = st_fõlds[32] = st_fõlds[44] = &
ffi_ty≥_Êﬂt
;

262 
°_fõlds
[9] = st_fõlds[21] = st_fõlds[33] = st_fõlds[45] = &
ffi_ty≥_doubÀ
;

263 
°_fõlds
[10] = st_fõlds[22] = st_fõlds[34] = st_fõlds[46] = &
ffi_ty≥_l⁄gdoubÀ
;

264 
°_fõlds
[11] = st_fõlds[23] = st_fõlds[35] = st_fõlds[47] = &
ffi_ty≥_poöãr
;

266 
°_fõlds
[50] = 
NULL
;

268 
¨gTy≥s
[0] =árgTy≥s[12] =árgTy≥s[24] =árgTy≥s[36] =árgTy≥s[48] = &
ffi_ty≥_uöt8
;

269 
¨gVÆues
[0] =árgVÆues[12] =árgVÆues[24] =árgVÆues[36] =árgVÆues[48] = &
ui8
;

270 
¨gTy≥s
[1] =árgTy≥s[13] =árgTy≥s[25] =árgTy≥s[37] =árgTy≥s[49] = &
ffi_ty≥_söt8
;

271 
¨gVÆues
[1] =árgVÆues[13] =árgVÆues[25] =árgVÆues[37] =árgVÆues[49] = &
si8
;

272 
¨gTy≥s
[2] =árgTy≥s[14] =árgTy≥s[26] =árgTy≥s[38] = &
ffi_ty≥_uöt16
;

273 
¨gVÆues
[2] =árgVÆues[14] =árgVÆues[26] =árgVÆues[38] = &
ui16
;

274 
¨gTy≥s
[3] =árgTy≥s[15] =árgTy≥s[27] =árgTy≥s[39] = &
ffi_ty≥_söt16
;

275 
¨gVÆues
[3] =árgVÆues[15] =árgVÆues[27] =árgVÆues[39] = &
si16
;

276 
¨gTy≥s
[4] =árgTy≥s[16] =árgTy≥s[28] =árgTy≥s[40] = &
ffi_ty≥_uöt32
;

277 
¨gVÆues
[4] =árgVÆues[16] =árgVÆues[28] =árgVÆues[40] = &
ui32
;

278 
¨gTy≥s
[5] =árgTy≥s[17] =árgTy≥s[29] =árgTy≥s[41] = &
ffi_ty≥_söt32
;

279 
¨gVÆues
[5] =árgVÆues[17] =árgVÆues[29] =árgVÆues[41] = &
si32
;

280 
¨gTy≥s
[6] =árgTy≥s[18] =árgTy≥s[30] =árgTy≥s[42] = &
ffi_ty≥_uöt64
;

281 
¨gVÆues
[6] =árgVÆues[18] =árgVÆues[30] =árgVÆues[42] = &
ui64
;

282 
¨gTy≥s
[7] =árgTy≥s[19] =árgTy≥s[31] =árgTy≥s[43] = &
ffi_ty≥_söt64
;

283 
¨gVÆues
[7] =árgVÆues[19] =árgVÆues[31] =árgVÆues[43] = &
si64
;

284 
¨gTy≥s
[8] =árgTy≥s[20] =árgTy≥s[32] =árgTy≥s[44] = &
ffi_ty≥_Êﬂt
;

285 
¨gVÆues
[8] =árgVÆues[20] =árgVÆues[32] =árgVÆues[44] = &
f
;

286 
¨gTy≥s
[9] =árgTy≥s[21] =árgTy≥s[33] =árgTy≥s[45] = &
ffi_ty≥_doubÀ
;

287 
¨gVÆues
[9] =árgVÆues[21] =árgVÆues[33] =árgVÆues[45] = &
d
;

288 
¨gTy≥s
[10] =árgTy≥s[22] =árgTy≥s[34] =árgTy≥s[46] = &
ffi_ty≥_l⁄gdoubÀ
;

289 
¨gVÆues
[10] =árgVÆues[22] =árgVÆues[34] =árgVÆues[46] = &
ld
;

290 
¨gTy≥s
[11] =árgTy≥s[23] =árgTy≥s[35] =árgTy≥s[47] = &
ffi_ty≥_poöãr
;

291 
¨gVÆues
[11] =árgVÆues[23] =árgVÆues[35] =árgVÆues[47] = &
p
;

293 
¨gTy≥s
[50] = 
NULL
;

294 
¨gVÆues
[50] = 
NULL
;

296 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 50, &
ªt_°ru˘_ty≥
, 
¨gTy≥s
Ë=
FFI_OK
);

298 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_œrge_‚
), &
ªtVÆ
, 
¨gVÆues
);

300 
	`¥ötf
("ªs: %" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

301 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

302 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

303 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx %" PRIu8 " %" PRId8 "\n",

304 
ªtVÆ
.
a
,ÑëVÆ.
b
,ÑëVÆ.
c
,ÑëVÆ.
d
,ÑëVÆ.
e
,ÑëVÆ.
f
,

305 
ªtVÆ
.
g
,ÑëVÆ.
h
,ÑëVÆ.
i
,ÑëVÆ.
j
,ÑëVÆ.
k
, (ÏëVÆ.
l
,

306 
ªtVÆ
.
m
,ÑëVÆ.
n
,ÑëVÆ.
o
,ÑëVÆ.
p
,ÑëVÆ.
q
,ÑëVÆ.
r
,

307 
ªtVÆ
.
s
,ÑëVÆ.
t
,ÑëVÆ.
u
,ÑëVÆ.
v
,ÑëVÆ.
w
, (ÏëVÆ.
x
,

308 
ªtVÆ
.
y
,ÑëVÆ.
z
,ÑëVÆ.
Ø
,ÑëVÆ.
bb
,ÑëVÆ.
cc
,ÑëVÆ.
dd
,

309 
ªtVÆ
.
ì
,ÑëVÆ.
ff
,ÑëVÆ.
gg
,ÑëVÆ.
hh
,ÑëVÆ.
ii
, (ÏëVÆ.
jj
,

310 
ªtVÆ
.
kk
,ÑëVÆ.
Œ
,ÑëVÆ.
mm
,ÑëVÆ.
¬
,ÑëVÆ.
oo
,ÑëVÆ.
µ
,

311 
ªtVÆ
.
qq
,ÑëVÆ.
º
,ÑëVÆ.
ss
,ÑëVÆ.
â
,ÑëVÆ.
uu
, (ÏëVÆ.
vv
,ÑëVÆ.
ww
,ÑëVÆ.
xx
);

314 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_œrge_‚
, 
NULL
, 
code
Ë=
FFI_OK
);

316 
ªtVÆ
 = ((
	`BigSåu˘
(*)(

317 
uöt8_t
, 
öt8_t
, 
uöt16_t
, 
öt16_t
, 
uöt32_t
, 
öt32_t
, 
uöt64_t
, 
öt64_t
, , , , *,

318 
uöt8_t
, 
öt8_t
, 
uöt16_t
, 
öt16_t
, 
uöt32_t
, 
öt32_t
, 
uöt64_t
, 
öt64_t
, , , , *,

319 
uöt8_t
, 
öt8_t
, 
uöt16_t
, 
öt16_t
, 
uöt32_t
, 
öt32_t
, 
uöt64_t
, 
öt64_t
, , , , *,

320 
uöt8_t
, 
öt8_t
, 
uöt16_t
, 
öt16_t
, 
uöt32_t
, 
öt32_t
, 
uöt64_t
, 
öt64_t
, , , , *,

321 
uöt8_t
, 
öt8_t
))(
code
))(

322 
ui8
, 
si8
, 
ui16
, 
si16
, 
ui32
, 
si32
, 
ui64
, 
si64
, 
f
, 
d
, 
ld
, 
p
,

323 
ui8
, 
si8
, 
ui16
, 
si16
, 
ui32
, 
si32
, 
ui64
, 
si64
, 
f
, 
d
, 
ld
, 
p
,

324 
ui8
, 
si8
, 
ui16
, 
si16
, 
ui32
, 
si32
, 
ui64
, 
si64
, 
f
, 
d
, 
ld
, 
p
,

325 
ui8
, 
si8
, 
ui16
, 
si16
, 
ui32
, 
si32
, 
ui64
, 
si64
, 
f
, 
d
, 
ld
, 
p
,

326 
ui8
, 
si8
);

328 
	`¥ötf
("ªs: %" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

329 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

330 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx "

331 "%" 
PRIu8
 " %" 
PRId8
 " %hu %hd %u %d %" 
PRIu64
 " %" 
PRId64
 " %.0f %.0f %.0Lf %#lx %" PRIu8 " %" PRId8 "\n",

332 
ªtVÆ
.
a
,ÑëVÆ.
b
,ÑëVÆ.
c
,ÑëVÆ.
d
,ÑëVÆ.
e
,ÑëVÆ.
f
,

333 
ªtVÆ
.
g
,ÑëVÆ.
h
,ÑëVÆ.
i
,ÑëVÆ.
j
,ÑëVÆ.
k
, (ÏëVÆ.
l
,

334 
ªtVÆ
.
m
,ÑëVÆ.
n
,ÑëVÆ.
o
,ÑëVÆ.
p
,ÑëVÆ.
q
,ÑëVÆ.
r
,

335 
ªtVÆ
.
s
,ÑëVÆ.
t
,ÑëVÆ.
u
,ÑëVÆ.
v
,ÑëVÆ.
w
, (ÏëVÆ.
x
,

336 
ªtVÆ
.
y
,ÑëVÆ.
z
,ÑëVÆ.
Ø
,ÑëVÆ.
bb
,ÑëVÆ.
cc
,ÑëVÆ.
dd
,

337 
ªtVÆ
.
ì
,ÑëVÆ.
ff
,ÑëVÆ.
gg
,ÑëVÆ.
hh
,ÑëVÆ.
ii
, (ÏëVÆ.
jj
,

338 
ªtVÆ
.
kk
,ÑëVÆ.
Œ
,ÑëVÆ.
mm
,ÑëVÆ.
¬
,ÑëVÆ.
oo
,ÑëVÆ.
µ
,

339 
ªtVÆ
.
qq
,ÑëVÆ.
º
,ÑëVÆ.
ss
,ÑëVÆ.
â
,ÑëVÆ.
uu
, (ÏëVÆ.
vv
,ÑëVÆ.
ww
,ÑëVÆ.
xx
);

343 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/many.c

8 
	~"ffôe°.h
"

10 
	~<°dlib.h
>

11 
	~<Êﬂt.h
>

12 
	~<m©h.h
>

14 
ABI_ATTR
 
	$m™y
(
f1
, 
f2
, 
f3
, 
f4
, 
f5
, 
f6
, 
f7
, 
f8
, 
f9
, 
f10
, 
f11
, 
f12
, 
f13
)

17 
	`¥ötf
("%f %f %f %f %f %f %f %f %f %f %f %f %f\n",

18 (Ë
f1
, (Ë
f2
, (Ë
f3
, (Ë
f4
, (Ë
f5
,

19 (Ë
f6
, (Ë
f7
, (Ë
f8
, (Ë
f9
, (Ë
f10
,

20 (Ë
f11
, (Ë
f12
, (Ë
f13
);

23  
f1
+
f2
+
f3
+
f4
+
f5
+
f6
+
f7
+
f8
+
f9
+
f10
+
f11
+
f12
+
f13
;

24 
	}
}

26 
	$maö
 ()

28 
ffi_cif
 
cif
;

29 
ffi_ty≥
 *
¨gs
[13];

30 *
vÆues
[13];

31 
Á
[13];

32 
f
, 
ff
;

33 
i
;

35 
i
 = 0; i < 13; i++)

37 
¨gs
[
i
] = &
ffi_ty≥_Êﬂt
;

38 
vÆues
[
i
] = &
Á
[i];

39 
Á
[
i
] = () i;

43 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 13,

44 &
ffi_ty≥_Êﬂt
, 
¨gs
Ë=
FFI_OK
);

46 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
m™y
), &
f
, 
vÆues
);

48 
ff
 = 
	`m™y
(
Á
[0], fa[1],

49 
Á
[2], fa[3],

50 
Á
[4], fa[5],

51 
Á
[6], fa[7],

52 
Á
[8], fa[9],

53 
Á
[10],fa[11],fa[12]);

55 i‡(
	`Ábs
(
f
 - 
ff
Ë< 
FLT_EPSILON
)

56 
	`exô
(0);

58 
	`ab‹t
();

59 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/many2.c

9 
	~"ffôe°.h
"

11 
	#NARGS
 7

	)

13 
	tu8
;

15 #ifde‡
__GNUC__


16 
__©åibuã__
((
noölöe
))

18 
uöt8_t


19 
	$foo
 (
uöt8_t
 
a
, uöt8_à
b
, uöt8_à
c
, uöt8_à
d
,

20 
uöt8_t
 
e
, uöt8_à
f
, uöt8_à
g
)

22  
a
 + 
b
 + 
c
 + 
d
 + 
e
 + 
f
 + 
g
;

23 
	}
}

25 
uöt8_t
 
ABI_ATTR


26 
	$b¨
 (
uöt8_t
 
a
, uöt8_à
b
, uöt8_à
c
, uöt8_à
d
,

27 
uöt8_t
 
e
, uöt8_à
f
, uöt8_à
g
)

29  
	`foo
 (
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
);

30 
	}
}

33 
	$maö
 ()

35 
ffi_ty≥
 *
ffôy≥s
[
NARGS
];

36 
i
;

37 
ffi_cif
 
cif
;

38 
ffi_¨g
 
ªsu…
 = 0;

39 
uöt8_t
 
¨gs
[
NARGS
];

40 *
¨g±rs
[
NARGS
];

42 
i
 = 0; i < 
NARGS
; ++i)

43 
ffôy≥s
[
i
] = &
ffi_ty≥_uöt8
;

45 
	`CHECK
 (
	`ffi_¥ï_cif
 (&
cif
, 
ABI_NUM
, 
NARGS
,

46 &
ffi_ty≥_uöt8
, 
ffôy≥s
Ë=
FFI_OK
);

48 
i
 = 0; i < 
NARGS
; ++i)

50 
¨gs
[
i
] = i;

51 
¨g±rs
[
i
] = &
¨gs
[i];

53 
	`ffi_ˇŒ
 (&
cif
, 
	`FFI_FN
 (
b¨
), &
ªsu…
, 
¨g±rs
);

55 
	`CHECK
 (
ªsu…
 == 21);

57 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/negint.c

9 
	~"ffôe°.h
"

11 
	$checkög
(
a
, 
b
, sig√d 
c
)

14  (
a
 < 0 && 
b
 < 0 && 
c
 < 0);

15 
	}
}

17 
	$maö
 ()

19 
ffi_cif
 
cif
;

20 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

21 *
vÆues
[
MAX_ARGS
];

22 
ffi_¨g
 
röt
;

24 sig√d 
si
;

25 sig√d 
ss
;

26 sig√d 
sc
;

28 
¨gs
[0] = &
ffi_ty≥_söt
;

29 
vÆues
[0] = &
si
;

30 
¨gs
[1] = &
ffi_ty≥_ssh‹t
;

31 
vÆues
[1] = &
ss
;

32 
¨gs
[2] = &
ffi_ty≥_sch¨
;

33 
vÆues
[2] = &
sc
;

36 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3,

37 &
ffi_ty≥_söt
, 
¨gs
Ë=
FFI_OK
);

39 
si
 = -6;

40 
ss
 = -12;

41 
sc
 = -1;

43 
	`checkög
 (
si
, 
ss
, 
sc
);

45 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
checkög
), &
röt
, 
vÆues
);

47 
	`¥ötf
 ("%d v†%d\n", ()
röt
, 
	`checkög
 (
si
, 
ss
, 
sc
));

49 
	`CHECK
(
röt
 != 0);

51 
	`exô
 (0);

52 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_16byã1
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 } 
	t˛s_°ru˘_16byã1
;

17 
	s˛s_°ru˘_16byã2
 {

18 
	mii
;

19 
	mdd
;

20 
	mff
;

21 } 
	t˛s_°ru˘_16byã2
;

23 
	s˛s_°ru˘_comböed
 {

24 
˛s_°ru˘_16byã1
 
	md
;

25 
˛s_°ru˘_16byã2
 
	me
;

26 } 
	t˛s_°ru˘_comböed
;

28 
˛s_°ru˘_comböed
 
	$˛s_°ru˘_comböed_‚
(
˛s_°ru˘_16byã1
 
b0
,

29 
˛s_°ru˘_16byã2
 
b1
,

30 
˛s_°ru˘_comböed
 
b2
)

32 
˛s_°ru˘_comböed
 
ªsu…
;

34 
ªsu…
.
d
.
a
 = 
b0
.®+ 
b1
.
dd
 + 
b2
.d.a;

35 
ªsu…
.
d
.
b
 = 
b0
.b + 
b1
.
ff
 + 
b2
.d.b;

36 
ªsu…
.
d
.
c
 = 
b0
.¯+ 
b1
.
ii
 + 
b2
.d.c;

37 
ªsu…
.
e
.
ii
 = 
b0
.
c
 + 
b1
.iò+ 
b2
.e.ii;

38 
ªsu…
.
e
.
dd
 = 
b0
.
a
 + 
b1
.dd + 
b2
.e.dd;

39 
ªsu…
.
e
.
ff
 = 
b0
.
b
 + 
b1
.f‡+ 
b2
.e.ff;

41 
	`¥ötf
("%g %g %d %d %g %g %g %g %d %d %g %g: %g %g %d %d %g %g\n",

42 
b0
.
a
, b0.
b
, b0.
c
,

43 
b1
.
ii
, b1.
dd
, b1.
ff
,

44 
b2
.
d
.
a
, b2.d.
b
, b2.d.
c
,

45 
b2
.
e
.
ii
, b2.e.
dd
, b2.e.
ff
,

46 
ªsu…
.
d
.
a
,Ñesu….d.
b
,Ñesu….d.
c
,

47 
ªsu…
.
e
.
ii
,Ñesu….e.
dd
,Ñesu….e.
ff
);

49  
ªsu…
;

50 
	}
}

53 
	$˛s_°ru˘_comböed_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

54 * 
u£rd©a
 
__UNUSED__
)

56 
˛s_°ru˘_16byã1
 
b0
;

57 
˛s_°ru˘_16byã2
 
b1
;

58 
˛s_°ru˘_comböed
 
b2
;

60 
b0
 = *(
˛s_°ru˘_16byã1
*)(
¨gs
[0]);

61 
b1
 = *(
˛s_°ru˘_16byã2
*)(
¨gs
[1]);

62 
b2
 = *(
˛s_°ru˘_comböed
*)(
¨gs
[2]);

65 *(
˛s_°ru˘_comböed
*)
ª•
 = 
	`˛s_°ru˘_comböed_‚
(
b0
, 
b1
, 
b2
);

66 
	}
}

68 
	$maö
 ()

70 
ffi_cif
 
cif
;

71 *
code
;

72 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

73 * 
¨gs_dbl
[5];

74 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[5];

75 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[5];

76 
ffi_ty≥
* 
˛s_°ru˘_fõlds2
[5];

77 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
, 
˛s_°ru˘_ty≥2
;

78 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

80 
˛s_°ru˘_16byã1
 
e_dbl
 = { 9.0, 2.0, 6};

81 
˛s_°ru˘_16byã2
 
f_dbl
 = { 1, 2.0, 3.0};

82 
˛s_°ru˘_comböed
 
g_dbl
 = {{4.0, 5.0, 6},

84 
˛s_°ru˘_comböed
 
ªs_dbl
;

86 
˛s_°ru˘_ty≥
.
size
 = 0;

87 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

88 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

89 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

91 
˛s_°ru˘_ty≥1
.
size
 = 0;

92 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

93 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

94 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

96 
˛s_°ru˘_ty≥2
.
size
 = 0;

97 
˛s_°ru˘_ty≥2
.
Æignmít
 = 0;

98 
˛s_°ru˘_ty≥2
.
ty≥
 = 
FFI_TYPE_STRUCT
;

99 
˛s_°ru˘_ty≥2
.
ñemíts
 = 
˛s_°ru˘_fõlds2
;

101 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

102 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_Êﬂt
;

103 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_söt
;

104 
˛s_°ru˘_fõlds
[3] = 
NULL
;

106 
˛s_°ru˘_fõlds1
[0] = &
ffi_ty≥_söt
;

107 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_doubÀ
;

108 
˛s_°ru˘_fõlds1
[2] = &
ffi_ty≥_Êﬂt
;

109 
˛s_°ru˘_fõlds1
[3] = 
NULL
;

111 
˛s_°ru˘_fõlds2
[0] = &
˛s_°ru˘_ty≥
;

112 
˛s_°ru˘_fõlds2
[1] = &
˛s_°ru˘_ty≥1
;

113 
˛s_°ru˘_fõlds2
[2] = 
NULL
;

116 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

117 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

118 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥2
;

119 
dbl_¨g_ty≥s
[3] = 
NULL
;

121 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3, &
˛s_°ru˘_ty≥2
,

122 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

124 
¨gs_dbl
[0] = &
e_dbl
;

125 
¨gs_dbl
[1] = &
f_dbl
;

126 
¨gs_dbl
[2] = &
g_dbl
;

127 
¨gs_dbl
[3] = 
NULL
;

129 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_comböed_‚
), &
ªs_dbl
, 
¨gs_dbl
);

131 
	`CHECK
–
ªs_dbl
.
d
.
a
 =(
e_dbl
.®+ 
f_dbl
.
dd
 + 
g_dbl
.d.a));

132 
	`CHECK
–
ªs_dbl
.
d
.
b
 =(
e_dbl
.b + 
f_dbl
.
ff
 + 
g_dbl
.d.b));

133 
	`CHECK
–
ªs_dbl
.
d
.
c
 =(
e_dbl
.¯+ 
f_dbl
.
ii
 + 
g_dbl
.d.c));

134 
	`CHECK
–
ªs_dbl
.
e
.
ii
 =(
e_dbl
.
c
 + 
f_dbl
.iò+ 
g_dbl
.e.ii));

135 
	`CHECK
–
ªs_dbl
.
e
.
dd
 =(
e_dbl
.
a
 + 
f_dbl
.dd + 
g_dbl
.e.dd));

136 
	`CHECK
–
ªs_dbl
.
e
.
ff
 =(
e_dbl
.
b
 + 
f_dbl
.f‡+ 
g_dbl
.e.ff));

138 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_comböed_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

140 
ªs_dbl
 = ((
	`˛s_°ru˘_comböed
(*)(
˛s_°ru˘_16byã1
,

141 
˛s_°ru˘_16byã2
,

142 
˛s_°ru˘_comböed
))

143 (
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
);

145 
	`CHECK
–
ªs_dbl
.
d
.
a
 =(
e_dbl
.®+ 
f_dbl
.
dd
 + 
g_dbl
.d.a));

146 
	`CHECK
–
ªs_dbl
.
d
.
b
 =(
e_dbl
.b + 
f_dbl
.
ff
 + 
g_dbl
.d.b));

147 
	`CHECK
–
ªs_dbl
.
d
.
c
 =(
e_dbl
.¯+ 
f_dbl
.
ii
 + 
g_dbl
.d.c));

148 
	`CHECK
–
ªs_dbl
.
e
.
ii
 =(
e_dbl
.
c
 + 
f_dbl
.iò+ 
g_dbl
.e.ii));

149 
	`CHECK
–
ªs_dbl
.
e
.
dd
 =(
e_dbl
.
a
 + 
f_dbl
.dd + 
g_dbl
.e.dd));

150 
	`CHECK
–
ªs_dbl
.
e
.
ff
 =(
e_dbl
.
b
 + 
f_dbl
.f‡+ 
g_dbl
.e.ff));

151 
	`exô
(0);

152 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct1.c

9 
	~"ffôe°.h
"

11 
	s˛s_°ru˘_16byã1
 {

12 
	ma
;

13 
	mb
;

14 
	mc
;

15 } 
	t˛s_°ru˘_16byã1
;

17 
	s˛s_°ru˘_16byã2
 {

18 
	mii
;

19 
	mdd
;

20 
	mff
;

21 } 
	t˛s_°ru˘_16byã2
;

23 
	s˛s_°ru˘_comböed
 {

24 
˛s_°ru˘_16byã1
 
	md
;

25 
˛s_°ru˘_16byã2
 
	me
;

26 } 
	t˛s_°ru˘_comböed
;

28 
˛s_°ru˘_comböed
 
	$˛s_°ru˘_comböed_‚
(
˛s_°ru˘_16byã1
 
b0
,

29 
˛s_°ru˘_16byã2
 
b1
,

30 
˛s_°ru˘_comböed
 
b2
,

31 
˛s_°ru˘_16byã1
 
b3
)

33 
˛s_°ru˘_comböed
 
ªsu…
;

35 
ªsu…
.
d
.
a
 = 
b0
.®+ 
b1
.
dd
 + 
b2
.d.a;

36 
ªsu…
.
d
.
b
 = 
b0
.b + 
b1
.
ff
 + 
b2
.d.b;

37 
ªsu…
.
d
.
c
 = 
b0
.¯+ 
b1
.
ii
 + 
b2
.d.c;

38 
ªsu…
.
e
.
ii
 = 
b0
.
c
 + 
b1
.iò+ 
b2
.e.ii;

39 
ªsu…
.
e
.
dd
 = 
b0
.
a
 + 
b1
.dd + 
b2
.e.dd;

40 
ªsu…
.
e
.
ff
 = 
b0
.
b
 + 
b1
.f‡+ 
b2
.e.ff;

42 
	`¥ötf
("%g %g %d %d %g %g %g %g %d %d %g %g %g %g %d: %g %g %d %d %g %g\n",

43 
b0
.
a
, b0.
b
, b0.
c
,

44 
b1
.
ii
, b1.
dd
, b1.
ff
,

45 
b2
.
d
.
a
, b2.d.
b
, b2.d.
c
,

46 
b2
.
e
.
ii
, b2.e.
dd
, b2.e.
ff
,

47 
b3
.
a
, b3.
b
, b3.
c
,

48 
ªsu…
.
d
.
a
,Ñesu….d.
b
,Ñesu….d.
c
,

49 
ªsu…
.
e
.
ii
,Ñesu….e.
dd
,Ñesu….e.
ff
);

51  
ªsu…
;

52 
	}
}

55 
	$˛s_°ru˘_comböed_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

56 * 
u£rd©a
 
__UNUSED__
)

58 
˛s_°ru˘_16byã1
 
b0
;

59 
˛s_°ru˘_16byã2
 
b1
;

60 
˛s_°ru˘_comböed
 
b2
;

61 
˛s_°ru˘_16byã1
 
b3
;

63 
b0
 = *(
˛s_°ru˘_16byã1
*)(
¨gs
[0]);

64 
b1
 = *(
˛s_°ru˘_16byã2
*)(
¨gs
[1]);

65 
b2
 = *(
˛s_°ru˘_comböed
*)(
¨gs
[2]);

66 
b3
 = *(
˛s_°ru˘_16byã1
*)(
¨gs
[3]);

69 *(
˛s_°ru˘_comböed
*)
ª•
 = 
	`˛s_°ru˘_comböed_‚
(
b0
, 
b1
, 
b2
, 
b3
);

70 
	}
}

72 
	$maö
 ()

74 
ffi_cif
 
cif
;

75 *
code
;

76 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

77 * 
¨gs_dbl
[5];

78 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[5];

79 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[5];

80 
ffi_ty≥
* 
˛s_°ru˘_fõlds2
[5];

81 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
, 
˛s_°ru˘_ty≥2
;

82 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

84 
˛s_°ru˘_16byã1
 
e_dbl
 = { 9.0, 2.0, 6};

85 
˛s_°ru˘_16byã2
 
f_dbl
 = { 1, 2.0, 3.0};

86 
˛s_°ru˘_comböed
 
g_dbl
 = {{4.0, 5.0, 6},

88 
˛s_°ru˘_16byã1
 
h_dbl
 = { 3.0, 2.0, 4};

89 
˛s_°ru˘_comböed
 
ªs_dbl
;

91 
˛s_°ru˘_ty≥
.
size
 = 0;

92 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

93 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

94 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

96 
˛s_°ru˘_ty≥1
.
size
 = 0;

97 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

98 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

99 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

101 
˛s_°ru˘_ty≥2
.
size
 = 0;

102 
˛s_°ru˘_ty≥2
.
Æignmít
 = 0;

103 
˛s_°ru˘_ty≥2
.
ty≥
 = 
FFI_TYPE_STRUCT
;

104 
˛s_°ru˘_ty≥2
.
ñemíts
 = 
˛s_°ru˘_fõlds2
;

106 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

107 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_Êﬂt
;

108 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_söt
;

109 
˛s_°ru˘_fõlds
[3] = 
NULL
;

111 
˛s_°ru˘_fõlds1
[0] = &
ffi_ty≥_söt
;

112 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_doubÀ
;

113 
˛s_°ru˘_fõlds1
[2] = &
ffi_ty≥_Êﬂt
;

114 
˛s_°ru˘_fõlds1
[3] = 
NULL
;

116 
˛s_°ru˘_fõlds2
[0] = &
˛s_°ru˘_ty≥
;

117 
˛s_°ru˘_fõlds2
[1] = &
˛s_°ru˘_ty≥1
;

118 
˛s_°ru˘_fõlds2
[2] = 
NULL
;

121 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

122 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

123 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥2
;

124 
dbl_¨g_ty≥s
[3] = &
˛s_°ru˘_ty≥
;

125 
dbl_¨g_ty≥s
[4] = 
NULL
;

127 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4, &
˛s_°ru˘_ty≥2
,

128 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

130 
¨gs_dbl
[0] = &
e_dbl
;

131 
¨gs_dbl
[1] = &
f_dbl
;

132 
¨gs_dbl
[2] = &
g_dbl
;

133 
¨gs_dbl
[3] = &
h_dbl
;

134 
¨gs_dbl
[4] = 
NULL
;

136 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_comböed_‚
), &
ªs_dbl
, 
¨gs_dbl
);

138 
	`CHECK
–
ªs_dbl
.
d
.
a
 =(
e_dbl
.®+ 
f_dbl
.
dd
 + 
g_dbl
.d.a));

139 
	`CHECK
–
ªs_dbl
.
d
.
b
 =(
e_dbl
.b + 
f_dbl
.
ff
 + 
g_dbl
.d.b));

140 
	`CHECK
–
ªs_dbl
.
d
.
c
 =(
e_dbl
.¯+ 
f_dbl
.
ii
 + 
g_dbl
.d.c));

141 
	`CHECK
–
ªs_dbl
.
e
.
ii
 =(
e_dbl
.
c
 + 
f_dbl
.iò+ 
g_dbl
.e.ii));

142 
	`CHECK
–
ªs_dbl
.
e
.
dd
 =(
e_dbl
.
a
 + 
f_dbl
.dd + 
g_dbl
.e.dd));

143 
	`CHECK
–
ªs_dbl
.
e
.
ff
 =(
e_dbl
.
b
 + 
f_dbl
.f‡+ 
g_dbl
.e.ff));

145 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_comböed_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

147 
ªs_dbl
 = ((
	`˛s_°ru˘_comböed
(*)(
˛s_°ru˘_16byã1
,

148 
˛s_°ru˘_16byã2
,

149 
˛s_°ru˘_comböed
,

150 
˛s_°ru˘_16byã1
))

151 (
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
, 
h_dbl
);

153 
	`CHECK
–
ªs_dbl
.
d
.
a
 =(
e_dbl
.®+ 
f_dbl
.
dd
 + 
g_dbl
.d.a));

154 
	`CHECK
–
ªs_dbl
.
d
.
b
 =(
e_dbl
.b + 
f_dbl
.
ff
 + 
g_dbl
.d.b));

155 
	`CHECK
–
ªs_dbl
.
d
.
c
 =(
e_dbl
.¯+ 
f_dbl
.
ii
 + 
g_dbl
.d.c));

156 
	`CHECK
–
ªs_dbl
.
e
.
ii
 =(
e_dbl
.
c
 + 
f_dbl
.iò+ 
g_dbl
.e.ii));

157 
	`CHECK
–
ªs_dbl
.
e
.
dd
 =(
e_dbl
.
a
 + 
f_dbl
.dd + 
g_dbl
.e.dd));

158 
	`CHECK
–
ªs_dbl
.
e
.
ff
 =(
e_dbl
.
b
 + 
f_dbl
.f‡+ 
g_dbl
.e.ff));

160 
	`exô
(0);

161 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct10.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
	my
;

19 
A
 
	mx
;

20 
	mz
;

21 } 
	tB
;

23 
	sC
 {

24 
	md
;

25 
	me
;

26 } 
	tC
;

28 
B
 
	$B_‚
(
A
 
b2
, 
B
 
b3
, 
C
 
b4
)

30 
B
 
ªsu…
;

32 
ªsu…
.
x
.
a
 = 
b2
.®+ 
b3
.x.®+ b3.
z
 + 
b4
.
d
;

33 
ªsu…
.
x
.
b
 = 
b2
.b + 
b3
.x.b + b3.
y
 + 
b4
.
e
;

34 
ªsu…
.
y
 = 
b2
.
b
 + 
b3
.
x
.b + 
b4
.
e
;

36 
	`¥ötf
("%d %d %d %d %d %d %d %d: %d %d %d\n", ()
b2
.
a
, b2.
b
,

37 ()
b3
.
x
.
a
, b3.x.
b
, b3.
y
, b3.
z
, ()
b4
.
d
, b4.
e
,

38 ()
ªsu…
.
x
.
a
,Ñesu….x.
b
,Ñesu….
y
);

40  
ªsu…
;

41 
	}
}

44 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

45 * 
u£rd©a
 
__UNUSED__
)

47 
A
 
b0
;

48 
B
 
b1
;

49 
C
 
b2
;

51 
b0
 = *(
A
*)(
¨gs
[0]);

52 
b1
 = *(
B
*)(
¨gs
[1]);

53 
b2
 = *(
C
*)(
¨gs
[2]);

55 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
, 
b2
);

56 
	}
}

58 
	$maö
 ()

60 
ffi_cif
 
cif
;

61 *
code
;

62 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

63 * 
¨gs_dbl
[4];

64 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

65 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[4];

66 
ffi_ty≥
* 
˛s_°ru˘_fõlds2
[3];

67 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
, 
˛s_°ru˘_ty≥2
;

68 
ffi_ty≥
* 
dbl_¨g_ty≥s
[4];

70 
A
 
e_dbl
 = { 1LL, 7};

71 
B
 
f_dbl
 = { 99, {12LL , 127}, 255};

72 
C
 
g_dbl
 = { 2LL, 9};

74 
B
 
ªs_dbl
;

76 
˛s_°ru˘_ty≥
.
size
 = 0;

77 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

78 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

79 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

81 
˛s_°ru˘_ty≥1
.
size
 = 0;

82 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

83 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

84 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

86 
˛s_°ru˘_ty≥2
.
size
 = 0;

87 
˛s_°ru˘_ty≥2
.
Æignmít
 = 0;

88 
˛s_°ru˘_ty≥2
.
ty≥
 = 
FFI_TYPE_STRUCT
;

89 
˛s_°ru˘_ty≥2
.
ñemíts
 = 
˛s_°ru˘_fõlds2
;

91 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uöt64
;

92 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

93 
˛s_°ru˘_fõlds
[2] = 
NULL
;

95 
˛s_°ru˘_fõlds1
[0] = &
ffi_ty≥_uch¨
;

96 
˛s_°ru˘_fõlds1
[1] = &
˛s_°ru˘_ty≥
;

97 
˛s_°ru˘_fõlds1
[2] = &
ffi_ty≥_uöt
;

98 
˛s_°ru˘_fõlds1
[3] = 
NULL
;

100 
˛s_°ru˘_fõlds2
[0] = &
ffi_ty≥_uöt64
;

101 
˛s_°ru˘_fõlds2
[1] = &
ffi_ty≥_uch¨
;

102 
˛s_°ru˘_fõlds2
[2] = 
NULL
;

105 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

106 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

107 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥2
;

108 
dbl_¨g_ty≥s
[3] = 
NULL
;

110 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3, &
˛s_°ru˘_ty≥1
,

111 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

113 
¨gs_dbl
[0] = &
e_dbl
;

114 
¨gs_dbl
[1] = &
f_dbl
;

115 
¨gs_dbl
[2] = &
g_dbl
;

116 
¨gs_dbl
[3] = 
NULL
;

118 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

120 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.®+ f_dbl.
z
 + 
g_dbl
.
d
));

121 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
 + 
g_dbl
.
e
));

122 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b + 
g_dbl
.
e
));

124 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

126 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
, 
C
))(
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
);

128 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.®+ f_dbl.
z
 + 
g_dbl
.
d
));

129 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
 + 
g_dbl
.
e
));

130 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b + 
g_dbl
.
e
));

132 
	`exô
(0);

133 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct11.c

11 
	~"ffôe°.h
"

13 
	sA
 {

14 
	ma_x
;

15 
	ma_y
;

16 } 
	tA
;

18 
	sB
 {

19 
	mb_x
;

20 
	mb_y
;

21 } 
	tB
;

23 
	sC
 {

24 
A
 
	ma
;

25 
B
 
	mb
;

26 } 
	tC
;

28 
C
 
	$C_‚
 (
x
, 
y
, 
z
, 
C
 
sour˚
, 
i
, 
j
, 
k
)

30 
C
 
ªsu…
;

31 
ªsu…
.
a
.
a_x
 = 
sour˚
.a.a_x;

32 
ªsu…
.
a
.
a_y
 = 
sour˚
.a.a_y;

33 
ªsu…
.
b
.
b_x
 = 
sour˚
.b.b_x;

34 
ªsu…
.
b
.
b_y
 = 
sour˚
.b.b_y;

36 
	`¥ötf
 ("%d, %d, %d, %d, %d, %d\n", 
x
, 
y
, 
z
, 
i
, 
j
, 
k
);

38 
	`¥ötf
 ("%.1f, %.1f, %.1f, %.1f, "

40 
sour˚
.
a
.
a_x
, sour˚.a.
a_y
,

41 
sour˚
.
b
.
b_x
, sour˚.b.
b_y
,

42 
ªsu…
.
a
.
a_x
,Ñesu….a.
a_y
,

43 
ªsu…
.
b
.
b_x
,Ñesu….b.
b_y
);

45  
ªsu…
;

46 
	}
}

48 
	$maö
 ()

50 
ffi_cif
 
cif
;

52 
ffi_ty≥
* 
°ru˘_fõlds_sour˚_a
[3];

53 
ffi_ty≥
* 
°ru˘_fõlds_sour˚_b
[3];

54 
ffi_ty≥
* 
°ru˘_fõlds_sour˚_c
[3];

55 
ffi_ty≥
* 
¨g_ty≥s
[8];

57 
ffi_ty≥
 
°ru˘_ty≥_a
, 
°ru˘_ty≥_b
, 
°ru˘_ty≥_c
;

59 
A
 
sour˚_Êd_a
 = {1.0, 2.0};

60 
B
 
sour˚_Êd_b
 = {4.0, 8.0};

61 
k
 = 1;

63 
C
 
ªsu…
;

64 
C
 
sour˚
 = {
sour˚_Êd_a
, 
sour˚_Êd_b
};

66 
°ru˘_ty≥_a
.
size
 = 0;

67 
°ru˘_ty≥_a
.
Æignmít
 = 0;

68 
°ru˘_ty≥_a
.
ty≥
 = 
FFI_TYPE_STRUCT
;

69 
°ru˘_ty≥_a
.
ñemíts
 = 
°ru˘_fõlds_sour˚_a
;

71 
°ru˘_ty≥_b
.
size
 = 0;

72 
°ru˘_ty≥_b
.
Æignmít
 = 0;

73 
°ru˘_ty≥_b
.
ty≥
 = 
FFI_TYPE_STRUCT
;

74 
°ru˘_ty≥_b
.
ñemíts
 = 
°ru˘_fõlds_sour˚_b
;

76 
°ru˘_ty≥_c
.
size
 = 0;

77 
°ru˘_ty≥_c
.
Æignmít
 = 0;

78 
°ru˘_ty≥_c
.
ty≥
 = 
FFI_TYPE_STRUCT
;

79 
°ru˘_ty≥_c
.
ñemíts
 = 
°ru˘_fõlds_sour˚_c
;

81 
°ru˘_fõlds_sour˚_a
[0] = &
ffi_ty≥_Êﬂt
;

82 
°ru˘_fõlds_sour˚_a
[1] = &
ffi_ty≥_Êﬂt
;

83 
°ru˘_fõlds_sour˚_a
[2] = 
NULL
;

85 
°ru˘_fõlds_sour˚_b
[0] = &
ffi_ty≥_Êﬂt
;

86 
°ru˘_fõlds_sour˚_b
[1] = &
ffi_ty≥_Êﬂt
;

87 
°ru˘_fõlds_sour˚_b
[2] = 
NULL
;

89 
°ru˘_fõlds_sour˚_c
[0] = &
°ru˘_ty≥_a
;

90 
°ru˘_fõlds_sour˚_c
[1] = &
°ru˘_ty≥_b
;

91 
°ru˘_fõlds_sour˚_c
[2] = 
NULL
;

93 
¨g_ty≥s
[0] = &
ffi_ty≥_söt32
;

94 
¨g_ty≥s
[1] = &
ffi_ty≥_söt32
;

95 
¨g_ty≥s
[2] = &
ffi_ty≥_söt32
;

96 
¨g_ty≥s
[3] = &
°ru˘_ty≥_c
;

97 
¨g_ty≥s
[4] = &
ffi_ty≥_söt32
;

98 
¨g_ty≥s
[5] = &
ffi_ty≥_söt32
;

99 
¨g_ty≥s
[6] = &
ffi_ty≥_söt32
;

100 
¨g_ty≥s
[7] = 
NULL
;

102 *
¨gs
[7];

103 
¨gs
[0] = &
k
;

104 
¨gs
[1] = &
k
;

105 
¨gs
[2] = &
k
;

106 
¨gs
[3] = &
sour˚
;

107 
¨gs
[4] = &
k
;

108 
¨gs
[5] = &
k
;

109 
¨gs
[6] = &
k
;

110 
	`CHECK
 (
	`ffi_¥ï_cif
 (&
cif
, 
FFI_DEFAULT_ABI
, 7, &
°ru˘_ty≥_c
,

111 
¨g_ty≥s
Ë=
FFI_OK
);

113 
	`ffi_ˇŒ
 (&
cif
, 
	`FFI_FN
 (
C_‚
), &
ªsu…
, 
¨gs
);

116 
	`CHECK
 (
ªsu…
.
a
.
a_x
 =
sour˚
.a.a_x);

117 
	`CHECK
 (
ªsu…
.
a
.
a_y
 =
sour˚
.a.a_y);

118 
	`CHECK
 (
ªsu…
.
b
.
b_x
 =
sour˚
.b.b_x);

119 
	`CHECK
 (
ªsu…
.
b
.
b_y
 =
sour˚
.b.b_y);

120 
	`exô
 (0);

121 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct2.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
A
 
	mx
;

19 
	my
;

20 } 
	tB
;

22 
B
 
	$B_‚
(
A
 
b0
, 
B
 
b1
)

24 
B
 
ªsu…
;

26 
ªsu…
.
x
.
a
 = 
b0
.®+ 
b1
.x.a;

27 
ªsu…
.
x
.
b
 = 
b0
.b + 
b1
.x.b + b1.
y
;

28 
ªsu…
.
y
 = 
b0
.
b
 + 
b1
.
x
.b;

30 
	`¥ötf
("%lu %d %lu %d %d: %lu %d %d\n", 
b0
.
a
, b0.
b
, 
b1
.
x
.a, b1.x.b, b1.
y
,

31 
ªsu…
.
x
.
a
,Ñesu….x.
b
,Ñesu….
y
);

33  
ªsu…
;

34 
	}
}

37 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

38 * 
u£rd©a
 
__UNUSED__
)

40 
A
 
b0
;

41 
B
 
b1
;

43 
b0
 = *(
A
*)(
¨gs
[0]);

44 
b1
 = *(
B
*)(
¨gs
[1]);

46 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
);

47 
	}
}

49 
	$maö
 ()

51 
ffi_cif
 
cif
;

52 *
code
;

53 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

54 * 
¨gs_dbl
[3];

55 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

56 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[3];

57 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
;

58 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

60 
A
 
e_dbl
 = { 1, 7};

61 
B
 
f_dbl
 = {{12 , 127}, 99};

63 
B
 
ªs_dbl
;

65 
˛s_°ru˘_ty≥
.
size
 = 0;

66 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

67 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

68 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

70 
˛s_°ru˘_ty≥1
.
size
 = 0;

71 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

72 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

73 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

75 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_ul⁄g
;

76 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

77 
˛s_°ru˘_fõlds
[2] = 
NULL
;

79 
˛s_°ru˘_fõlds1
[0] = &
˛s_°ru˘_ty≥
;

80 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_uch¨
;

81 
˛s_°ru˘_fõlds1
[2] = 
NULL
;

84 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

85 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

86 
dbl_¨g_ty≥s
[2] = 
NULL
;

88 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥1
,

89 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

91 
¨gs_dbl
[0] = &
e_dbl
;

92 
¨gs_dbl
[1] = &
f_dbl
;

93 
¨gs_dbl
[2] = 
NULL
;

95 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

97 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

98 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

99 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

101 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

103 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
))(
code
))(
e_dbl
, 
f_dbl
);

105 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

106 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

107 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

109 
	`exô
(0);

110 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct3.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
A
 
	mx
;

19 
	my
;

20 } 
	tB
;

22 
B
 
	$B_‚
(
A
 
b0
, 
B
 
b1
)

24 
B
 
ªsu…
;

26 
ªsu…
.
x
.
a
 = 
b0
.®+ 
b1
.x.a;

27 
ªsu…
.
x
.
b
 = 
b0
.b + 
b1
.x.b + b1.
y
;

28 
ªsu…
.
y
 = 
b0
.
b
 + 
b1
.
x
.b;

30 
	`¥ötf
("%d %d %d %d %d: %d %d %d\n", ()
b0
.
a
, b0.
b
,

31 ()
b1
.
x
.
a
, b1.x.
b
, b1.
y
,

32 ()
ªsu…
.
x
.
a
,Ñesu….x.
b
,Ñesu….
y
);

34  
ªsu…
;

35 
	}
}

38 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

39 * 
u£rd©a
 
__UNUSED__
)

41 
A
 
b0
;

42 
B
 
b1
;

44 
b0
 = *(
A
*)(
¨gs
[0]);

45 
b1
 = *(
B
*)(
¨gs
[1]);

47 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
);

48 
	}
}

50 
	$maö
 ()

52 
ffi_cif
 
cif
;

53 *
code
;

54 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

55 * 
¨gs_dbl
[3];

56 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

57 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[3];

58 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
;

59 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

61 
A
 
e_dbl
 = { 1LL, 7};

62 
B
 
f_dbl
 = {{12LL , 127}, 99};

64 
B
 
ªs_dbl
;

66 
˛s_°ru˘_ty≥
.
size
 = 0;

67 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

68 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

69 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

71 
˛s_°ru˘_ty≥1
.
size
 = 0;

72 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

73 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

74 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

76 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uöt64
;

77 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

78 
˛s_°ru˘_fõlds
[2] = 
NULL
;

80 
˛s_°ru˘_fõlds1
[0] = &
˛s_°ru˘_ty≥
;

81 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_uch¨
;

82 
˛s_°ru˘_fõlds1
[2] = 
NULL
;

85 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

86 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

87 
dbl_¨g_ty≥s
[2] = 
NULL
;

89 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥1
,

90 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

92 
¨gs_dbl
[0] = &
e_dbl
;

93 
¨gs_dbl
[1] = &
f_dbl
;

94 
¨gs_dbl
[2] = 
NULL
;

96 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

98 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

99 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

100 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

103 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

105 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
))(
code
))(
e_dbl
, 
f_dbl
);

107 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

108 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

109 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

110 
	`exô
(0);

111 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct4.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
A
 
	mx
;

19 
	my
;

20 } 
	tB
;

22 
B
 
	$B_‚
(
A
 
b2
, 
B
 
b3
)

24 
B
 
ªsu…
;

26 
ªsu…
.
x
.
a
 = 
b2
.®+ 
b3
.x.a;

27 
ªsu…
.
x
.
b
 = 
b2
.b + 
b3
.x.b + b3.
y
;

28 
ªsu…
.
y
 = 
b2
.
b
 + 
b3
.
x
.b;

30 
	`¥ötf
("%d %d %d %d %d: %d %d %d\n", ()
b2
.
a
, b2.
b
,

31 ()
b3
.
x
.
a
, b3.x.
b
, b3.
y
,

32 ()
ªsu…
.
x
.
a
,Ñesu….x.
b
,Ñesu….
y
);

34  
ªsu…
;

35 
	}
}

38 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

39 * 
u£rd©a
 
__UNUSED__
)

41 
A
 
b0
;

42 
B
 
b1
;

44 
b0
 = *(
A
*)(
¨gs
[0]);

45 
b1
 = *(
B
*)(
¨gs
[1]);

47 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
);

48 
	}
}

50 
	$maö
 ()

52 
ffi_cif
 
cif
;

53 *
code
;

54 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

55 * 
¨gs_dbl
[3];

56 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

57 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[3];

58 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
;

59 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

61 
A
 
e_dbl
 = { 1.0, 7};

62 
B
 
f_dbl
 = {{12.0 , 127}, 99};

64 
B
 
ªs_dbl
;

66 
˛s_°ru˘_ty≥
.
size
 = 0;

67 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

68 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

69 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

71 
˛s_°ru˘_ty≥1
.
size
 = 0;

72 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

73 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

74 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

76 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

77 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

78 
˛s_°ru˘_fõlds
[2] = 
NULL
;

80 
˛s_°ru˘_fõlds1
[0] = &
˛s_°ru˘_ty≥
;

81 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_uch¨
;

82 
˛s_°ru˘_fõlds1
[2] = 
NULL
;

85 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

86 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

87 
dbl_¨g_ty≥s
[2] = 
NULL
;

89 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥1
,

90 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

92 
¨gs_dbl
[0] = &
e_dbl
;

93 
¨gs_dbl
[1] = &
f_dbl
;

94 
¨gs_dbl
[2] = 
NULL
;

96 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

98 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

99 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

100 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

102 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

104 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
))(
code
))(
e_dbl
, 
f_dbl
);

106 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

107 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

108 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

110 
	`exô
(0);

111 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct5.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
A
 
	mx
;

19 
	my
;

20 } 
	tB
;

22 
B
 
	$B_‚
(
A
 
b2
, 
B
 
b3
)

24 
B
 
ªsu…
;

26 
ªsu…
.
x
.
a
 = 
b2
.®+ 
b3
.x.a;

27 
ªsu…
.
x
.
b
 = 
b2
.b + 
b3
.x.b + b3.
y
;

28 
ªsu…
.
y
 = 
b2
.
b
 + 
b3
.
x
.b;

30 
	`¥ötf
("%d %d %d %d %d: %d %d %d\n", ()
b2
.
a
, b2.
b
,

31 ()
b3
.
x
.
a
, b3.x.
b
, b3.
y
,

32 ()
ªsu…
.
x
.
a
,Ñesu….x.
b
,Ñesu….
y
);

34  
ªsu…
;

35 
	}
}

38 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

39 * 
u£rd©a
 
__UNUSED__
)

41 
A
 
b0
;

42 
B
 
b1
;

44 
b0
 = *(
A
*)(
¨gs
[0]);

45 
b1
 = *(
B
*)(
¨gs
[1]);

47 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
);

48 
	}
}

50 
	$maö
 ()

52 
ffi_cif
 
cif
;

53 *
code
;

54 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

55 * 
¨gs_dbl
[3];

56 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

57 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[3];

58 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
;

59 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

61 
A
 
e_dbl
 = { 1.0, 7};

62 
B
 
f_dbl
 = {{12.0 , 127}, 99};

64 
B
 
ªs_dbl
;

66 
˛s_°ru˘_ty≥
.
size
 = 0;

67 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

68 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

69 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

71 
˛s_°ru˘_ty≥1
.
size
 = 0;

72 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

73 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

74 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

76 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_l⁄gdoubÀ
;

77 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

78 
˛s_°ru˘_fõlds
[2] = 
NULL
;

80 
˛s_°ru˘_fõlds1
[0] = &
˛s_°ru˘_ty≥
;

81 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_uch¨
;

82 
˛s_°ru˘_fõlds1
[2] = 
NULL
;

85 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

86 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

87 
dbl_¨g_ty≥s
[2] = 
NULL
;

89 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥1
,

90 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

92 
¨gs_dbl
[0] = &
e_dbl
;

93 
¨gs_dbl
[1] = &
f_dbl
;

94 
¨gs_dbl
[2] = 
NULL
;

96 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

98 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

99 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

100 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

103 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

105 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
))(
code
))(
e_dbl
, 
f_dbl
);

107 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

108 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

109 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

111 
	`exô
(0);

112 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct6.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
A
 
	mx
;

19 
	my
;

20 } 
	tB
;

22 
	sC
 {

23 
	md
;

24 
	me
;

25 } 
	tC
;

27 
B
 
	$B_‚
(
A
 
b2
, 
B
 
b3
, 
C
 
b4
)

29 
B
 
ªsu…
;

31 
ªsu…
.
x
.
a
 = 
b2
.®+ 
b3
.x.®+ 
b4
.
d
;

32 
ªsu…
.
x
.
b
 = 
b2
.b + 
b3
.x.b + b3.
y
 + 
b4
.
e
;

33 
ªsu…
.
y
 = 
b2
.
b
 + 
b3
.
x
.b + 
b4
.
e
;

35 
	`¥ötf
("%d %d %d %d %d %d %d: %d %d %d\n", ()
b2
.
a
, b2.
b
,

36 ()
b3
.
x
.
a
, b3.x.
b
, b3.
y
, ()
b4
.
d
, b4.
e
,

37 ()
ªsu…
.
x
.
a
,Ñesu….x.
b
,Ñesu….
y
);

39  
ªsu…
;

40 
	}
}

43 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

44 * 
u£rd©a
 
__UNUSED__
)

46 
A
 
b0
;

47 
B
 
b1
;

48 
C
 
b2
;

50 
b0
 = *(
A
*)(
¨gs
[0]);

51 
b1
 = *(
B
*)(
¨gs
[1]);

52 
b2
 = *(
C
*)(
¨gs
[2]);

54 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
, 
b2
);

55 
	}
}

57 
	$maö
 ()

59 
ffi_cif
 
cif
;

60 *
code
;

61 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

62 * 
¨gs_dbl
[4];

63 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

64 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[3];

65 
ffi_ty≥
* 
˛s_°ru˘_fõlds2
[3];

66 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
, 
˛s_°ru˘_ty≥2
;

67 
ffi_ty≥
* 
dbl_¨g_ty≥s
[4];

69 
A
 
e_dbl
 = { 1.0, 7};

70 
B
 
f_dbl
 = {{12.0 , 127}, 99};

71 
C
 
g_dbl
 = { 2, 9};

73 
B
 
ªs_dbl
;

75 
˛s_°ru˘_ty≥
.
size
 = 0;

76 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

77 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

78 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

80 
˛s_°ru˘_ty≥1
.
size
 = 0;

81 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

82 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

83 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

85 
˛s_°ru˘_ty≥2
.
size
 = 0;

86 
˛s_°ru˘_ty≥2
.
Æignmít
 = 0;

87 
˛s_°ru˘_ty≥2
.
ty≥
 = 
FFI_TYPE_STRUCT
;

88 
˛s_°ru˘_ty≥2
.
ñemíts
 = 
˛s_°ru˘_fõlds2
;

90 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

91 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

92 
˛s_°ru˘_fõlds
[2] = 
NULL
;

94 
˛s_°ru˘_fõlds1
[0] = &
˛s_°ru˘_ty≥
;

95 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_uch¨
;

96 
˛s_°ru˘_fõlds1
[2] = 
NULL
;

98 
˛s_°ru˘_fõlds2
[0] = &
ffi_ty≥_¶⁄g
;

99 
˛s_°ru˘_fõlds2
[1] = &
ffi_ty≥_uch¨
;

100 
˛s_°ru˘_fõlds2
[2] = 
NULL
;

103 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

104 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

105 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥2
;

106 
dbl_¨g_ty≥s
[3] = 
NULL
;

108 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3, &
˛s_°ru˘_ty≥1
,

109 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

111 
¨gs_dbl
[0] = &
e_dbl
;

112 
¨gs_dbl
[1] = &
f_dbl
;

113 
¨gs_dbl
[2] = &
g_dbl
;

114 
¨gs_dbl
[3] = 
NULL
;

116 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

118 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.®+ 
g_dbl
.
d
));

119 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
 + 
g_dbl
.
e
));

120 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b + 
g_dbl
.
e
));

122 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

124 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
, 
C
))(
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
);

126 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.®+ 
g_dbl
.
d
));

127 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
 + 
g_dbl
.
e
));

128 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b + 
g_dbl
.
e
));

130 
	`exô
(0);

131 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct7.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
A
 
	mx
;

19 
	my
;

20 } 
	tB
;

22 
B
 
	$B_‚
(
A
 
b2
, 
B
 
b3
)

24 
B
 
ªsu…
;

26 
ªsu…
.
x
.
a
 = 
b2
.®+ 
b3
.x.a;

27 
ªsu…
.
x
.
b
 = 
b2
.b + 
b3
.x.b + b3.
y
;

28 
ªsu…
.
y
 = 
b2
.
b
 + 
b3
.
x
.b;

30 
	`¥ötf
("%d %d %d %d %d: %d %d %d\n", ()
b2
.
a
, b2.
b
,

31 ()
b3
.
x
.
a
, b3.x.
b
, b3.
y
,

32 ()
ªsu…
.
x
.
a
,Ñesu….x.
b
,Ñesu….
y
);

34  
ªsu…
;

35 
	}
}

38 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

39 * 
u£rd©a
 
__UNUSED__
)

41 
A
 
b0
;

42 
B
 
b1
;

44 
b0
 = *(
A
*)(
¨gs
[0]);

45 
b1
 = *(
B
*)(
¨gs
[1]);

47 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
);

48 
	}
}

50 
	$maö
 ()

52 
ffi_cif
 
cif
;

53 *
code
;

54 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

55 * 
¨gs_dbl
[3];

56 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

57 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[3];

58 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
;

59 
ffi_ty≥
* 
dbl_¨g_ty≥s
[3];

61 
A
 
e_dbl
 = { 1LL, 7};

62 
B
 
f_dbl
 = {{12.0 , 127}, 99};

64 
B
 
ªs_dbl
;

66 
˛s_°ru˘_ty≥
.
size
 = 0;

67 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

68 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

69 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

71 
˛s_°ru˘_ty≥1
.
size
 = 0;

72 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

73 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

74 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

76 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uöt64
;

77 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

78 
˛s_°ru˘_fõlds
[2] = 
NULL
;

80 
˛s_°ru˘_fõlds1
[0] = &
˛s_°ru˘_ty≥
;

81 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_uch¨
;

82 
˛s_°ru˘_fõlds1
[2] = 
NULL
;

85 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

86 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

87 
dbl_¨g_ty≥s
[2] = 
NULL
;

89 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
˛s_°ru˘_ty≥1
,

90 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

92 
¨gs_dbl
[0] = &
e_dbl
;

93 
¨gs_dbl
[1] = &
f_dbl
;

94 
¨gs_dbl
[2] = 
NULL
;

96 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

98 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

99 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

100 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

102 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

104 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
))(
code
))(
e_dbl
, 
f_dbl
);

106 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.a));

107 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
));

108 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b));

110 
	`exô
(0);

111 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct8.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
A
 
	mx
;

19 
	my
;

20 } 
	tB
;

22 
	sC
 {

23 
	md
;

24 
	me
;

25 } 
	tC
;

27 
B
 
	$B_‚
(
A
 
b2
, 
B
 
b3
, 
C
 
b4
)

29 
B
 
ªsu…
;

31 
ªsu…
.
x
.
a
 = 
b2
.®+ 
b3
.x.®+ 
b4
.
d
;

32 
ªsu…
.
x
.
b
 = 
b2
.b + 
b3
.x.b + b3.
y
 + 
b4
.
e
;

33 
ªsu…
.
y
 = 
b2
.
b
 + 
b3
.
x
.b + 
b4
.
e
;

35 
	`¥ötf
("%d %d %d %d %d %d %d: %d %d %d\n", ()
b2
.
a
, b2.
b
,

36 ()
b3
.
x
.
a
, b3.x.
b
, b3.
y
, ()
b4
.
d
, b4.
e
,

37 ()
ªsu…
.
x
.
a
,Ñesu….x.
b
,Ñesu….
y
);

39  
ªsu…
;

40 
	}
}

43 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

44 * 
u£rd©a
 
__UNUSED__
)

46 
A
 
b0
;

47 
B
 
b1
;

48 
C
 
b2
;

50 
b0
 = *(
A
*)(
¨gs
[0]);

51 
b1
 = *(
B
*)(
¨gs
[1]);

52 
b2
 = *(
C
*)(
¨gs
[2]);

54 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
, 
b2
);

55 
	}
}

57 
	$maö
 ()

59 
ffi_cif
 
cif
;

60 *
code
;

61 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

62 * 
¨gs_dbl
[4];

63 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

64 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[3];

65 
ffi_ty≥
* 
˛s_°ru˘_fõlds2
[3];

66 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
, 
˛s_°ru˘_ty≥2
;

67 
ffi_ty≥
* 
dbl_¨g_ty≥s
[4];

69 
A
 
e_dbl
 = { 1LL, 7};

70 
B
 
f_dbl
 = {{12LL , 127}, 99};

71 
C
 
g_dbl
 = { 2LL, 9};

73 
B
 
ªs_dbl
;

75 
˛s_°ru˘_ty≥
.
size
 = 0;

76 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

77 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

78 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

80 
˛s_°ru˘_ty≥1
.
size
 = 0;

81 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

82 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

83 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

85 
˛s_°ru˘_ty≥2
.
size
 = 0;

86 
˛s_°ru˘_ty≥2
.
Æignmít
 = 0;

87 
˛s_°ru˘_ty≥2
.
ty≥
 = 
FFI_TYPE_STRUCT
;

88 
˛s_°ru˘_ty≥2
.
ñemíts
 = 
˛s_°ru˘_fõlds2
;

90 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uöt64
;

91 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uch¨
;

92 
˛s_°ru˘_fõlds
[2] = 
NULL
;

94 
˛s_°ru˘_fõlds1
[0] = &
˛s_°ru˘_ty≥
;

95 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_uch¨
;

96 
˛s_°ru˘_fõlds1
[2] = 
NULL
;

98 
˛s_°ru˘_fõlds2
[0] = &
ffi_ty≥_uöt64
;

99 
˛s_°ru˘_fõlds2
[1] = &
ffi_ty≥_uch¨
;

100 
˛s_°ru˘_fõlds2
[2] = 
NULL
;

103 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

104 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

105 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥2
;

106 
dbl_¨g_ty≥s
[3] = 
NULL
;

108 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3, &
˛s_°ru˘_ty≥1
,

109 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

111 
¨gs_dbl
[0] = &
e_dbl
;

112 
¨gs_dbl
[1] = &
f_dbl
;

113 
¨gs_dbl
[2] = &
g_dbl
;

114 
¨gs_dbl
[3] = 
NULL
;

116 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

118 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.®+ 
g_dbl
.
d
));

119 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
 + 
g_dbl
.
e
));

120 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b + 
g_dbl
.
e
));

122 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

124 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
, 
C
))(
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
);

126 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.®+ 
g_dbl
.
d
));

127 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
 + 
g_dbl
.
e
));

128 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b + 
g_dbl
.
e
));

130 
	`exô
(0);

131 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct9.c

10 
	~"ffôe°.h
"

12 
	sA
 {

13 
	ma
;

14 
	mb
;

15 } 
	tA
;

17 
	sB
 {

18 
A
 
	mx
;

19 
	my
;

20 } 
	tB
;

22 
	sC
 {

23 
	md
;

24 
	me
;

25 } 
	tC
;

27 
B
 
	$B_‚
(
A
 
b2
, 
B
 
b3
, 
C
 
b4
)

29 
B
 
ªsu…
;

31 
ªsu…
.
x
.
a
 = 
b2
.®+ 
b3
.x.®+ 
b4
.
d
;

32 
ªsu…
.
x
.
b
 = 
b2
.b + 
b3
.x.b + b3.
y
 + 
b4
.
e
;

33 
ªsu…
.
y
 = 
b2
.
b
 + 
b3
.
x
.b + 
b4
.
e
;

35 
	`¥ötf
("%d %d %d %d %d %d %d: %d %d %d\n", 
b2
.
a
, ()b2.
b
,

36 
b3
.
x
.
a
, ()b3.x.
b
, b3.
y
, ()
b4
.
d
, b4.
e
,

37 
ªsu…
.
x
.
a
, (Ïesu….x.
b
,Ñesu….
y
);

39  
ªsu…
;

40 
	}
}

43 
	$B_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

44 * 
u£rd©a
 
__UNUSED__
)

46 
A
 
b0
;

47 
B
 
b1
;

48 
C
 
b2
;

50 
b0
 = *(
A
*)(
¨gs
[0]);

51 
b1
 = *(
B
*)(
¨gs
[1]);

52 
b2
 = *(
C
*)(
¨gs
[2]);

54 *(
B
*)
ª•
 = 
	`B_‚
(
b0
, 
b1
, 
b2
);

55 
	}
}

57 
	$maö
 ()

59 
ffi_cif
 
cif
;

60 *
code
;

61 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

62 * 
¨gs_dbl
[4];

63 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[3];

64 
ffi_ty≥
* 
˛s_°ru˘_fõlds1
[3];

65 
ffi_ty≥
* 
˛s_°ru˘_fõlds2
[3];

66 
ffi_ty≥
 
˛s_°ru˘_ty≥
, 
˛s_°ru˘_ty≥1
, 
˛s_°ru˘_ty≥2
;

67 
ffi_ty≥
* 
dbl_¨g_ty≥s
[4];

69 
A
 
e_dbl
 = { 1, 7LL};

70 
B
 
f_dbl
 = {{12.0 , 127}, 99};

71 
C
 
g_dbl
 = { 2, 9};

73 
B
 
ªs_dbl
;

75 
˛s_°ru˘_ty≥
.
size
 = 0;

76 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

77 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

78 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

80 
˛s_°ru˘_ty≥1
.
size
 = 0;

81 
˛s_°ru˘_ty≥1
.
Æignmít
 = 0;

82 
˛s_°ru˘_ty≥1
.
ty≥
 = 
FFI_TYPE_STRUCT
;

83 
˛s_°ru˘_ty≥1
.
ñemíts
 = 
˛s_°ru˘_fõlds1
;

85 
˛s_°ru˘_ty≥2
.
size
 = 0;

86 
˛s_°ru˘_ty≥2
.
Æignmít
 = 0;

87 
˛s_°ru˘_ty≥2
.
ty≥
 = 
FFI_TYPE_STRUCT
;

88 
˛s_°ru˘_ty≥2
.
ñemíts
 = 
˛s_°ru˘_fõlds2
;

90 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_uch¨
;

91 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_uöt64
;

92 
˛s_°ru˘_fõlds
[2] = 
NULL
;

94 
˛s_°ru˘_fõlds1
[0] = &
˛s_°ru˘_ty≥
;

95 
˛s_°ru˘_fõlds1
[1] = &
ffi_ty≥_uch¨
;

96 
˛s_°ru˘_fõlds1
[2] = 
NULL
;

98 
˛s_°ru˘_fõlds2
[0] = &
ffi_ty≥_ul⁄g
;

99 
˛s_°ru˘_fõlds2
[1] = &
ffi_ty≥_uch¨
;

100 
˛s_°ru˘_fõlds2
[2] = 
NULL
;

103 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

104 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥1
;

105 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥2
;

106 
dbl_¨g_ty≥s
[3] = 
NULL
;

108 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3, &
˛s_°ru˘_ty≥1
,

109 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

111 
¨gs_dbl
[0] = &
e_dbl
;

112 
¨gs_dbl
[1] = &
f_dbl
;

113 
¨gs_dbl
[2] = &
g_dbl
;

114 
¨gs_dbl
[3] = 
NULL
;

116 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
B_‚
), &
ªs_dbl
, 
¨gs_dbl
);

118 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.®+ 
g_dbl
.
d
));

119 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
 + 
g_dbl
.
e
));

120 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b + 
g_dbl
.
e
));

122 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
B_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

124 
ªs_dbl
 = ((
	`B
(*)(
A
, 
B
, 
C
))(
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
);

126 
	`CHECK
–
ªs_dbl
.
x
.
a
 =(
e_dbl
.®+ 
f_dbl
.x.®+ 
g_dbl
.
d
));

127 
	`CHECK
–
ªs_dbl
.
x
.
b
 =(
e_dbl
.b + 
f_dbl
.x.b + f_dbl.
y
 + 
g_dbl
.
e
));

128 
	`CHECK
–
ªs_dbl
.
y
 =(
e_dbl
.
b
 + 
f_dbl
.
x
.b + 
g_dbl
.
e
));

130 
	`exô
(0);

131 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/problem1.c

8 
	~"ffôe°.h
"

10 
	smy_ffi_°ru˘
 {

11 
	ma
;

12 
	mb
;

13 
	mc
;

14 } 
	tmy_ffi_°ru˘
;

16 
my_ffi_°ru˘
 
	$ˇŒì
(
my_ffi_°ru˘
 
a1
, my_ffi_°ru˘ 
a2
)

18 
my_ffi_°ru˘
 
ªsu…
;

19 
ªsu…
.
a
 = 
a1
.®+ 
a2
.a;

20 
ªsu…
.
b
 = 
a1
.b + 
a2
.b;

21 
ªsu…
.
c
 = 
a1
.¯+ 
a2
.c;

24 
	`¥ötf
("%g %g %g %g %g %g: %g %g %g\n", 
a1
.
a
,á1.
b
,á1.
c
,

25 
a2
.
a
,á2.
b
,á2.
c
, 
ªsu…
.a,Ñesult.b,Ñesult.c);

27  
ªsu…
;

28 
	}
}

30 
	$°ub
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
,

31 * 
u£rd©a
 
__UNUSED__
)

33 
my_ffi_°ru˘
 
a1
;

34 
my_ffi_°ru˘
 
a2
;

36 
a1
 = *(
my_ffi_°ru˘
*)(
¨gs
[0]);

37 
a2
 = *(
my_ffi_°ru˘
*)(
¨gs
[1]);

39 *(
my_ffi_°ru˘
 *)
ª•
 = 
	`ˇŒì
(
a1
, 
a2
);

40 
	}
}

43 
	$maö
()

45 
ffi_ty≥
* 
my_ffi_°ru˘_fõlds
[4];

46 
ffi_ty≥
 
my_ffi_°ru˘_ty≥
;

47 
ffi_cif
 
cif
;

48 *
code
;

49 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

50 * 
¨gs
[4];

51 
ffi_ty≥
* 
¨g_ty≥s
[3];

53 
my_ffi_°ru˘
 
g
 = { 1.0, 2.0, 3.0 };

54 
my_ffi_°ru˘
 
f
 = { 1.0, 2.0, 3.0 };

55 
my_ffi_°ru˘
 
ªs
;

57 
my_ffi_°ru˘_ty≥
.
size
 = 0;

58 
my_ffi_°ru˘_ty≥
.
Æignmít
 = 0;

59 
my_ffi_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

60 
my_ffi_°ru˘_ty≥
.
ñemíts
 = 
my_ffi_°ru˘_fõlds
;

62 
my_ffi_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

63 
my_ffi_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

64 
my_ffi_°ru˘_fõlds
[2] = &
ffi_ty≥_doubÀ
;

65 
my_ffi_°ru˘_fõlds
[3] = 
NULL
;

67 
¨g_ty≥s
[0] = &
my_ffi_°ru˘_ty≥
;

68 
¨g_ty≥s
[1] = &
my_ffi_°ru˘_ty≥
;

69 
¨g_ty≥s
[2] = 
NULL
;

71 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2, &
my_ffi_°ru˘_ty≥
,

72 
¨g_ty≥s
Ë=
FFI_OK
);

74 
¨gs
[0] = &
g
;

75 
¨gs
[1] = &
f
;

76 
¨gs
[2] = 
NULL
;

77 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ˇŒì
), &
ªs
, 
¨gs
);

79 
	`¥ötf
("ªs: %g %g %g\n", 
ªs
.
a
,Ñes.
b
,Ñes.
c
);

82 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
°ub
, 
NULL
, 
code
Ë=
FFI_OK
);

84 
ªs
 = ((
	`my_ffi_°ru˘
(*)(
my_ffi_°ru˘
, my_ffi_°ru˘))(
code
))(
g
, 
f
);

86 
	`¥ötf
("ªs: %g %g %g\n", 
ªs
.
a
,Ñes.
b
,Ñes.
c
);

89 
	`exô
(0);;

90 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/promotion.c

8 
	~"ffôe°.h
"

9 
	$¥omŸi⁄
(sig√d 
sc
, sig√d 
ss
,

10 
uc
, 
us
)

12 
r
 = (Ë
sc
 + (Ë
ss
 + (Ë
uc
 + (Ë
us
;

14  
r
;

15 
	}
}

17 
	$maö
 ()

19 
ffi_cif
 
cif
;

20 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

21 *
vÆues
[
MAX_ARGS
];

22 
ffi_¨g
 
röt
;

23 sig√d 
sc
;

24 
uc
;

25 sig√d 
ss
;

26 
us
;

27 
ul
;

29 
¨gs
[0] = &
ffi_ty≥_sch¨
;

30 
¨gs
[1] = &
ffi_ty≥_ssh‹t
;

31 
¨gs
[2] = &
ffi_ty≥_uch¨
;

32 
¨gs
[3] = &
ffi_ty≥_ush‹t
;

33 
vÆues
[0] = &
sc
;

34 
vÆues
[1] = &
ss
;

35 
vÆues
[2] = &
uc
;

36 
vÆues
[3] = &
us
;

39 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

40 &
ffi_ty≥_söt
, 
¨gs
Ë=
FFI_OK
);

42 
us
 = 0;

43 
ul
 = 0;

45 
sc
 = (signed ) -127;

46 
sc
 <= (signed ) 120; sc += 1)

47 
ss
 = -30000; ss <= 30000; ss += 10000)

48 
uc
 = () 0;

49 
uc
 <= () 200; uc += 20)

50 
us
 = 0; us <= 60000; us += 10000)

52 
ul
++;

53 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
¥omŸi⁄
), &
röt
, 
vÆues
);

54 
	`CHECK
(()
röt
 =(sig√d Ë
sc
 + (sig√d Ë
ss
 +

55 (Ë
uc
 + (Ë
us
);

57 
	`¥ötf
("%luÖromŸi⁄Åe°†run\n", 
ul
);

58 
	`exô
(0);

59 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/pyobjc-tc.c

8 
	~"ffôe°.h
"

10 
	sPoöt
 {

11 
	mx
;

12 
	my
;

13 } 
	tPoöt
;

15 
	sSize
 {

16 
	mh
;

17 
	mw
;

18 } 
	tSize
;

20 
	sRe˘
 {

21 
Poöt
 
	mo
;

22 
Size
 
	ms
;

23 } 
	tRe˘
;

25 
	$doô
(
o
, * 
s
, 
Poöt
 
p
, 
Re˘
 
r
, 
œ°
)

27 
	`¥ötf
("CALLED WITH %d %s {%f %f} {{%f %f} {%f %f}} %d\n",

28 
o
, 
s
, 
p
.
x
,Ö.
y
, 
r
.o.x,Ñ.o.y,Ñ.s.
h
,Ñ.s.
w
, 
œ°
);

30 
	}
}

33 
	$maö
()

35 
ffi_ty≥
 
poöt_ty≥
;

36 
ffi_ty≥
 
size_ty≥
;

37 
ffi_ty≥
 
ª˘_ty≥
;

38 
ffi_cif
 
cif
;

39 
ffi_ty≥
* 
¨gli°
[6];

40 * 
vÆues
[6];

41 
r
;

47 
poöt_ty≥
.
size
 = 0;

48 
poöt_ty≥
.
Æignmít
 = 0;

49 
poöt_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

50 
poöt_ty≥
.
ñemíts
 = 
	`mÆloc
(3 * (
ffi_ty≥
*));

51 
poöt_ty≥
.
ñemíts
[0] = &
ffi_ty≥_Êﬂt
;

52 
poöt_ty≥
.
ñemíts
[1] = &
ffi_ty≥_Êﬂt
;

53 
poöt_ty≥
.
ñemíts
[2] = 
NULL
;

55 
size_ty≥
.
size
 = 0;

56 
size_ty≥
.
Æignmít
 = 0;

57 
size_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

58 
size_ty≥
.
ñemíts
 = 
	`mÆloc
(3 * (
ffi_ty≥
*));

59 
size_ty≥
.
ñemíts
[0] = &
ffi_ty≥_Êﬂt
;

60 
size_ty≥
.
ñemíts
[1] = &
ffi_ty≥_Êﬂt
;

61 
size_ty≥
.
ñemíts
[2] = 
NULL
;

63 
ª˘_ty≥
.
size
 = 0;

64 
ª˘_ty≥
.
Æignmít
 =0;

65 
ª˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

66 
ª˘_ty≥
.
ñemíts
 = 
	`mÆloc
(3 * (
ffi_ty≥
*));

67 
ª˘_ty≥
.
ñemíts
[0] = &
poöt_ty≥
;

68 
ª˘_ty≥
.
ñemíts
[1] = &
size_ty≥
;

69 
ª˘_ty≥
.
ñemíts
[2] = 
NULL
;

74 
¨gli°
[0] = &
ffi_ty≥_söt
;

75 
¨gli°
[1] = &
ffi_ty≥_poöãr
;

76 
¨gli°
[2] = &
poöt_ty≥
;

77 
¨gli°
[3] = &
ª˘_ty≥
;

78 
¨gli°
[4] = &
ffi_ty≥_söt
;

79 
¨gli°
[5] = 
NULL
;

81 
r
 = 
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
,

82 5, &
ffi_ty≥_söt
, 
¨gli°
);

83 i‡(
r
 !
FFI_OK
) {

84 
	`ab‹t
();

91 
Poöt
 
p
 = { 1.0, 2.0 };

92 
Re˘
 
r
 = { { 9.0, 10.0}, { -1.0, -2.0 } };

93 
o
 = 0;

94 
l
 = 42;

95 * 
m
 = "myMethod";

96 
ffi_¨g
 
ªsu…
;

98 
vÆues
[0] = &
o
;

99 
vÆues
[1] = &
m
;

100 
vÆues
[2] = &
p
;

101 
vÆues
[3] = &
r
;

102 
vÆues
[4] = &
l
;

103 
vÆues
[5] = 
NULL
;

105 
	`¥ötf
("CALLING WITH %d %s {%f %f} {{%f %f} {%f %f}} %d\n",

106 
o
, 
m
, 
p
.
x
,Ö.
y
, 
r
.o.x,Ñ.o.y,Ñ.
s
.
h
,Ñ.s.
w
, 
l
);

108 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
doô
), &
ªsu…
, 
vÆues
);

110 
	`¥ötf
 ("Thêªsu… i†%d\n", ()
ªsu…
);

113 
	`exô
(0);

114 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_dbl.c

8 
	~"ffôe°.h
"

10 
	$ªtu∫_dbl
(
dbl
)

12 
	`¥ötf
 ("%f\n", 
dbl
);

13  2 * 
dbl
;

14 
	}
}

15 
	$maö
 ()

17 
ffi_cif
 
cif
;

18 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

19 *
vÆues
[
MAX_ARGS
];

20 
dbl
, 
rdbl
;

22 
¨gs
[0] = &
ffi_ty≥_doubÀ
;

23 
vÆues
[0] = &
dbl
;

26 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

27 &
ffi_ty≥_doubÀ
, 
¨gs
Ë=
FFI_OK
);

29 
dbl
 = -127.3; dbl < 127; dbl++)

31 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_dbl
), &
rdbl
, 
vÆues
);

32 
	`¥ötf
 ("%‡v†%f\n", 
rdbl
, 
	`ªtu∫_dbl
(
dbl
));

33 
	`CHECK
(
rdbl
 =2 * 
dbl
);

35 
	`exô
(0);

36 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_dbl1.c

8 
	~"ffôe°.h
"

10 
	$ªtu∫_dbl
(
dbl1
, 
Ê2
, 
ö3
, 
dbl4
)

12  
dbl1
 + 
Ê2
 + 
ö3
 + 
dbl4
;

13 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
dbl1
, 
dbl4
, 
rdbl
;

20 
Ê2
;

21 
ö3
;

22 
¨gs
[0] = &
ffi_ty≥_doubÀ
;

23 
¨gs
[1] = &
ffi_ty≥_Êﬂt
;

24 
¨gs
[2] = &
ffi_ty≥_uöt
;

25 
¨gs
[3] = &
ffi_ty≥_doubÀ
;

26 
vÆues
[0] = &
dbl1
;

27 
vÆues
[1] = &
Ê2
;

28 
vÆues
[2] = &
ö3
;

29 
vÆues
[3] = &
dbl4
;

32 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

33 &
ffi_ty≥_doubÀ
, 
¨gs
Ë=
FFI_OK
);

34 
dbl1
 = 127.0;

35 
Ê2
 = 128.0;

36 
ö3
 = 255;

37 
dbl4
 = 512.7;

39 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_dbl
), &
rdbl
, 
vÆues
);

40 
	`¥ötf
 ("%‡v†%f\n", 
rdbl
, 
	`ªtu∫_dbl
(
dbl1
, 
Ê2
, 
ö3
, 
dbl4
));

41 
	`CHECK
(
rdbl
 =
dbl1
 + 
Ê2
 + 
ö3
 + 
dbl4
);

42 
	`exô
(0);

43 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_dbl2.c

8 
	~"ffôe°.h
"

10 
	$ªtu∫_dbl
(
dbl1
, 
dbl2
, 
ö3
, 
dbl4
)

12  
dbl1
 + 
dbl2
 + 
ö3
 + 
dbl4
;

13 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
dbl1
, 
dbl2
, 
dbl4
, 
rdbl
;

20 
ö3
;

21 
¨gs
[0] = &
ffi_ty≥_doubÀ
;

22 
¨gs
[1] = &
ffi_ty≥_doubÀ
;

23 
¨gs
[2] = &
ffi_ty≥_uöt
;

24 
¨gs
[3] = &
ffi_ty≥_doubÀ
;

25 
vÆues
[0] = &
dbl1
;

26 
vÆues
[1] = &
dbl2
;

27 
vÆues
[2] = &
ö3
;

28 
vÆues
[3] = &
dbl4
;

31 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

32 &
ffi_ty≥_doubÀ
, 
¨gs
Ë=
FFI_OK
);

33 
dbl1
 = 127.0;

34 
dbl2
 = 128.0;

35 
ö3
 = 255;

36 
dbl4
 = 512.7;

38 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_dbl
), &
rdbl
, 
vÆues
);

39 
	`¥ötf
 ("%‡v†%f\n", 
rdbl
, 
	`ªtu∫_dbl
(
dbl1
, 
dbl2
, 
ö3
, 
dbl4
));

40 
	`CHECK
(
rdbl
 =
dbl1
 + 
dbl2
 + 
ö3
 + 
dbl4
);

41 
	`exô
(0);

42 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_fl.c

8 
	~"ffôe°.h
"

10 
	$ªtu∫_Ê
(
Ê
)

12  2 * 
Ê
;

13 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
Ê
, 
rÊ
;

21 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

22 
vÆues
[0] = &
Ê
;

25 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

26 &
ffi_ty≥_Êﬂt
, 
¨gs
Ë=
FFI_OK
);

28 
Ê
 = -127.0; fl < 127; fl++)

30 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_Ê
), &
rÊ
, 
vÆues
);

31 
	`¥ötf
 ("%‡v†%f\n", 
rÊ
, 
	`ªtu∫_Ê
(
Ê
));

32 
	`CHECK
(
rÊ
 =2 * 
Ê
);

34 
	`exô
(0);

35 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_fl1.c

8 
	~"ffôe°.h
"

10 
	$ªtu∫_Ê
(
Ê1
, 
Ê2
)

12  
Ê1
 + 
Ê2
;

13 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
Ê1
, 
Ê2
, 
rÊ
;

21 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

22 
¨gs
[1] = &
ffi_ty≥_Êﬂt
;

23 
vÆues
[0] = &
Ê1
;

24 
vÆues
[1] = &
Ê2
;

27 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2,

28 &
ffi_ty≥_Êﬂt
, 
¨gs
Ë=
FFI_OK
);

29 
Ê1
 = 127.0;

30 
Ê2
 = 128.0;

32 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_Ê
), &
rÊ
, 
vÆues
);

33 
	`¥ötf
 ("%‡v†%f\n", 
rÊ
, 
	`ªtu∫_Ê
(
Ê1
, 
Ê2
));

34 
	`CHECK
(
rÊ
 =
Ê1
 + 
Ê2
);

35 
	`exô
(0);

36 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_fl2.c

8 
	~"ffôe°.h
"

11 
	$ªtu∫_Ê
(
Ê1
, 
Ê2
, 
Ê3
, 
Ê4
)

13 vﬁ©ûê
sum
;

15 
sum
 = 
Ê1
 + 
Ê2
 + 
Ê3
 + 
Ê4
;

16  
sum
;

17 
	}
}

18 
	$maö
 ()

20 
ffi_cif
 
cif
;

21 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

22 *
vÆues
[
MAX_ARGS
];

23 
Ê1
, 
Ê2
, 
Ê3
, 
Ê4
, 
rÊ
;

24 vﬁ©ûê
sum
;

26 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

27 
¨gs
[1] = &
ffi_ty≥_Êﬂt
;

28 
¨gs
[2] = &
ffi_ty≥_Êﬂt
;

29 
¨gs
[3] = &
ffi_ty≥_Êﬂt
;

30 
vÆues
[0] = &
Ê1
;

31 
vÆues
[1] = &
Ê2
;

32 
vÆues
[2] = &
Ê3
;

33 
vÆues
[3] = &
Ê4
;

36 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

37 &
ffi_ty≥_Êﬂt
, 
¨gs
Ë=
FFI_OK
);

38 
Ê1
 = 127.0;

39 
Ê2
 = 128.0;

40 
Ê3
 = 255.1;

41 
Ê4
 = 512.7;

43 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_Ê
), &
rÊ
, 
vÆues
);

44 
	`¥ötf
 ("%‡v†%f\n", 
rÊ
, 
	`ªtu∫_Ê
(
Ê1
, 
Ê2
, 
Ê3
, 
Ê4
));

46 
sum
 = 
Ê1
 + 
Ê2
 + 
Ê3
 + 
Ê4
;

47 
	`CHECK
(
rÊ
 =
sum
);

48 
	`exô
(0);

49 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_fl3.c

8 
	~"ffôe°.h
"

10 
	$ªtu∫_Ê
(
Ê1
, 
Ê2
, 
ö3
, 
Ê4
)

12  
Ê1
 + 
Ê2
 + 
ö3
 + 
Ê4
;

13 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
Ê1
, 
Ê2
, 
Ê4
, 
rÊ
;

20 
ö3
;

21 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

22 
¨gs
[1] = &
ffi_ty≥_Êﬂt
;

23 
¨gs
[2] = &
ffi_ty≥_uöt
;

24 
¨gs
[3] = &
ffi_ty≥_Êﬂt
;

25 
vÆues
[0] = &
Ê1
;

26 
vÆues
[1] = &
Ê2
;

27 
vÆues
[2] = &
ö3
;

28 
vÆues
[3] = &
Ê4
;

31 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4,

32 &
ffi_ty≥_Êﬂt
, 
¨gs
Ë=
FFI_OK
);

33 
Ê1
 = 127.0;

34 
Ê2
 = 128.0;

35 
ö3
 = 255;

36 
Ê4
 = 512.7;

38 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_Ê
), &
rÊ
, 
vÆues
);

39 
	`¥ötf
 ("%‡v†%f\n", 
rÊ
, 
	`ªtu∫_Ê
(
Ê1
, 
Ê2
, 
ö3
, 
Ê4
));

40 
	`CHECK
(
rÊ
 =
Ê1
 + 
Ê2
 + 
ö3
 + 
Ê4
);

41 
	`exô
(0);

42 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_ldl.c

8 
	~"ffôe°.h
"

10 
	$ªtu∫_ldl
(
ldl
)

12  2*
ldl
;

13 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
ldl
, 
ædl
;

21 
¨gs
[0] = &
ffi_ty≥_l⁄gdoubÀ
;

22 
vÆues
[0] = &
ldl
;

25 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

26 &
ffi_ty≥_l⁄gdoubÀ
, 
¨gs
Ë=
FFI_OK
);

28 
ldl
 = -127.0;Üdl < 127.0;Üdl++)

30 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_ldl
), &
ædl
, 
vÆues
);

31 
	`CHECK
(
ædl
 =2 * 
ldl
);

33 
	`exô
(0);

34 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_ll.c

8 
	~"ffôe°.h
"

9 
	$ªtu∫_Œ
(
Œ
)

11  
Œ
;

12 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
æ⁄gl⁄g
;

20 
Œ
;

22 
¨gs
[0] = &
ffi_ty≥_söt64
;

23 
vÆues
[0] = &
Œ
;

26 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

27 &
ffi_ty≥_söt64
, 
¨gs
Ë=
FFI_OK
);

29 
Œ
 = 0LL;Ül < 100LL;Ül++)

31 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_Œ
), &
æ⁄gl⁄g
, 
vÆues
);

32 
	`CHECK
(
æ⁄gl⁄g
 =
Œ
);

35 
Œ
 = 55555555555000LL;Ül < 55555555555100LL;Ül++)

37 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_Œ
), &
æ⁄gl⁄g
, 
vÆues
);

38 
	`CHECK
(
æ⁄gl⁄g
 =
Œ
);

40 
	`exô
(0);

41 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_ll1.c

9 
	~"ffôe°.h
"

10 
	$ªtu∫_Œ
(
Œ0
, 
Œ1
, 
Œ2
)

12  
Œ0
 + 
Œ1
 + 
Œ2
;

13 
	}
}

15 
	$maö
 ()

17 
ffi_cif
 
cif
;

18 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

19 *
vÆues
[
MAX_ARGS
];

20 
æ⁄gl⁄g
;

21 
Œ1
;

22 
Œ0
, 
Œ2
;

24 
¨gs
[0] = &
ffi_ty≥_söt
;

25 
¨gs
[1] = &
ffi_ty≥_söt64
;

26 
¨gs
[2] = &
ffi_ty≥_söt
;

27 
vÆues
[0] = &
Œ0
;

28 
vÆues
[1] = &
Œ1
;

29 
vÆues
[2] = &
Œ2
;

32 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 3,

33 &
ffi_ty≥_söt64
, 
¨gs
Ë=
FFI_OK
);

35 
Œ0
 = 11111111;

36 
Œ1
 = 11111111111000LL;

37 
Œ2
 = 11111111;

39 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_Œ
), &
æ⁄gl⁄g
, 
vÆues
);

40 
	`¥ötf
("ªs: %" 
PRIdLL
 ", %" PRIdLL "\n", 
æ⁄gl⁄g
, 
Œ0
 + 
Œ1
 + 
Œ2
);

42 
	`exô
(0);

43 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_sc.c

8 
	~"ffôe°.h
"

10 sig√d 
	$ªtu∫_sc
(sig√d 
sc
)

12  
sc
;

13 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
ffi_¨g
 
röt
;

20 sig√d 
sc
;

22 
¨gs
[0] = &
ffi_ty≥_sch¨
;

23 
vÆues
[0] = &
sc
;

26 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

27 &
ffi_ty≥_sch¨
, 
¨gs
Ë=
FFI_OK
);

29 
sc
 = (signed ) -127;

30 
sc
 < (signed ) 127; sc++)

32 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_sc
), &
röt
, 
vÆues
);

33 
	`CHECK
((sig√d )
röt
 =
sc
);

35 
	`exô
(0);

36 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_sl.c

8 
	~"ffôe°.h
"

9 
	$ªtu∫_¶
(
l1
, 
l2
)

11  
l1
 - 
l2
;

12 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
ffi_¨g
 
ªs
;

20 
l1
, 
l2
;

22 
¨gs
[0] = &
ffi_ty≥_¶⁄g
;

23 
¨gs
[1] = &
ffi_ty≥_¶⁄g
;

24 
vÆues
[0] = &
l1
;

25 
vÆues
[1] = &
l2
;

27 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2,

28 &
ffi_ty≥_¶⁄g
, 
¨gs
Ë=
FFI_OK
);

30 
l1
 = 1073741823L;

31 
l2
 = 1073741824L;

33 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_¶
), &
ªs
, 
vÆues
);

34 
	`¥ötf
("ªs: %ld, %ld\n", ()
ªs
, 
l1
 - 
l2
);

37 
	`exô
(0);

38 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_uc.c

8 
	~"ffôe°.h
"

10 
	$ªtu∫_uc
(
uc
)

12  
uc
;

13 
	}
}

15 
	$maö
 ()

17 
ffi_cif
 
cif
;

18 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

19 *
vÆues
[
MAX_ARGS
];

20 
ffi_¨g
 
röt
;

22 
uc
;

24 
¨gs
[0] = &
ffi_ty≥_uch¨
;

25 
vÆues
[0] = &
uc
;

28 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

29 &
ffi_ty≥_uch¨
, 
¨gs
Ë=
FFI_OK
);

31 
uc
 = () '\x00';

32 
uc
 < () '\xff'; uc++)

34 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_uc
), &
röt
, 
vÆues
);

35 
	`CHECK
(()
röt
 =
uc
);

37 
	`exô
(0);

38 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_ul.c

8 
	~"ffôe°.h
"

9 
	$ªtu∫_ul
(
ul1
, 
ul2
)

11  
ul1
 + 
ul2
;

12 
	}
}

14 
	$maö
 ()

16 
ffi_cif
 
cif
;

17 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

18 *
vÆues
[
MAX_ARGS
];

19 
ffi_¨g
 
ªs
;

20 
ul1
, 
ul2
;

22 
¨gs
[0] = &
ffi_ty≥_ul⁄g
;

23 
¨gs
[1] = &
ffi_ty≥_ul⁄g
;

24 
vÆues
[0] = &
ul1
;

25 
vÆues
[1] = &
ul2
;

27 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 2,

28 &
ffi_ty≥_ul⁄g
, 
¨gs
Ë=
FFI_OK
);

30 
ul1
 = 1073741823L;

31 
ul2
 = 1073741824L;

33 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ªtu∫_ul
), &
ªs
, 
vÆues
);

34 
	`¥ötf
("ªs: %lu, %lu\n", ()
ªs
, 
ul1
 + 
ul2
);

37 
	`exô
(0);

38 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/stret_large.c

10 
	~"ffôe°.h
"

15 
	s°ru˘_108byã
 {

16 
	ma
;

17 
	mb
;

18 
	mc
;

19 
	md
;

20 
	me
;

21 
	mf
;

22 
	mg
;

23 
	mh
;

24 
	mi
;

25 
	mj
;

26 
	mk
;

27 
	ml
;

28 
	mm
;

29 
	mn
;

30 } 
	t°ru˘_108byã
;

32 
°ru˘_108byã
 
	$˛s_°ru˘_108byã_‚
(

33 
°ru˘_108byã
 
b0
,

34 
°ru˘_108byã
 
b1
,

35 
°ru˘_108byã
 
b2
,

36 
°ru˘_108byã
 
b3
)

38 
°ru˘_108byã
 
ªsu…
;

40 
ªsu…
.
a
 = 
b0
.®+ 
b1
.®+ 
b2
.®+ 
b3
.a;

41 
ªsu…
.
b
 = 
b0
.b + 
b1
.b + 
b2
.b + 
b3
.b;

42 
ªsu…
.
c
 = 
b0
.¯+ 
b1
.¯+ 
b2
.¯+ 
b3
.c;

43 
ªsu…
.
d
 = 
b0
.d + 
b1
.d + 
b2
.d + 
b3
.d;

44 
ªsu…
.
e
 = 
b0
.ê+ 
b1
.ê+ 
b2
.ê+ 
b3
.e;

45 
ªsu…
.
f
 = 
b0
.‡+ 
b1
.‡+ 
b2
.‡+ 
b3
.f;

46 
ªsu…
.
g
 = 
b0
.g + 
b1
.g + 
b2
.g + 
b3
.g;

47 
ªsu…
.
h
 = 
b0
.h + 
b1
.h + 
b2
.h + 
b3
.h;

48 
ªsu…
.
i
 = 
b0
.ò+ 
b1
.ò+ 
b2
.ò+ 
b3
.i;

49 
ªsu…
.
j
 = 
b0
.j + 
b1
.j + 
b2
.j + 
b3
.j;

50 
ªsu…
.
k
 = 
b0
.k + 
b1
.k + 
b2
.k + 
b3
.k;

51 
ªsu…
.
l
 = 
b0
.»+ 
b1
.»+ 
b2
.»+ 
b3
.l;

52 
ªsu…
.
m
 = 
b0
.m + 
b1
.m + 
b2
.m + 
b3
.m;

53 
ªsu…
.
n
 = 
b0
.¿+ 
b1
.¿+ 
b2
.¿+ 
b3
.n;

55 
	`¥ötf
("%g %g %g %g %g %g %g %g %g %g %g %g %g %d\n", 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,

56 
ªsu…
.
d
,Ñesu….
e
,Ñesu….
f
,Ñesu….
g
,Ñesu….
h
,Ñesu….
i
,

57 
ªsu…
.
j
,Ñesu….
k
,Ñesu….
l
,Ñesu….
m
,Ñesu….
n
);

59  
ªsu…
;

60 
	}
}

63 
	$˛s_°ru˘_108byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
, * 
u£rd©a
 __UNUSED__)

65 
°ru˘_108byã
 
b0
, 
b1
, 
b2
, 
b3
;

67 
b0
 = *(
°ru˘_108byã
*)(
¨gs
[0]);

68 
b1
 = *(
°ru˘_108byã
*)(
¨gs
[1]);

69 
b2
 = *(
°ru˘_108byã
*)(
¨gs
[2]);

70 
b3
 = *(
°ru˘_108byã
*)(
¨gs
[3]);

72 *(
°ru˘_108byã
*)
ª•
 = 
	`˛s_°ru˘_108byã_‚
(
b0
, 
b1
, 
b2
, 
b3
);

73 
	}
}

75 
	$maö
 ()

77 
ffi_cif
 
cif
;

78 *
code
;

79 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

80 * 
¨gs_dbl
[5];

81 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[15];

82 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

83 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

85 
°ru˘_108byã
 
e_dbl
 = { 9.0, 2.0, 6.0, 5.0, 3.0, 4.0, 8.0, 1.0, 1.0, 2.0, 3.0, 7.0, 2.0, 7 };

86 
°ru˘_108byã
 
f_dbl
 = { 1.0, 2.0, 3.0, 7.0, 2.0, 5.0, 6.0, 7.0, 4.0, 5.0, 7.0, 9.0, 1.0, 4 };

87 
°ru˘_108byã
 
g_dbl
 = { 4.0, 5.0, 7.0, 9.0, 1.0, 1.0, 2.0, 9.0, 8.0, 6.0, 1.0, 4.0, 0.0, 3 };

88 
°ru˘_108byã
 
h_dbl
 = { 8.0, 6.0, 1.0, 4.0, 0.0, 3.0, 3.0, 1.0, 9.0, 2.0, 6.0, 5.0, 3.0, 2 };

89 
°ru˘_108byã
 
ªs_dbl
;

91 
˛s_°ru˘_ty≥
.
size
 = 0;

92 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

93 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

94 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

96 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

97 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

98 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_doubÀ
;

99 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_doubÀ
;

100 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_doubÀ
;

101 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_doubÀ
;

102 
˛s_°ru˘_fõlds
[6] = &
ffi_ty≥_doubÀ
;

103 
˛s_°ru˘_fõlds
[7] = &
ffi_ty≥_doubÀ
;

104 
˛s_°ru˘_fõlds
[8] = &
ffi_ty≥_doubÀ
;

105 
˛s_°ru˘_fõlds
[9] = &
ffi_ty≥_doubÀ
;

106 
˛s_°ru˘_fõlds
[10] = &
ffi_ty≥_doubÀ
;

107 
˛s_°ru˘_fõlds
[11] = &
ffi_ty≥_doubÀ
;

108 
˛s_°ru˘_fõlds
[12] = &
ffi_ty≥_doubÀ
;

109 
˛s_°ru˘_fõlds
[13] = &
ffi_ty≥_söt32
;

110 
˛s_°ru˘_fõlds
[14] = 
NULL
;

112 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

113 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

114 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥
;

115 
dbl_¨g_ty≥s
[3] = &
˛s_°ru˘_ty≥
;

116 
dbl_¨g_ty≥s
[4] = 
NULL
;

118 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4, &
˛s_°ru˘_ty≥
,

119 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

121 
¨gs_dbl
[0] = &
e_dbl
;

122 
¨gs_dbl
[1] = &
f_dbl
;

123 
¨gs_dbl
[2] = &
g_dbl
;

124 
¨gs_dbl
[3] = &
h_dbl
;

125 
¨gs_dbl
[4] = 
NULL
;

127 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_108byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

129 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g %g %g %g %g %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,

130 
ªs_dbl
.
c
,Ñes_dbl.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
,Ñes_dbl.
i
,

131 
ªs_dbl
.
j
,Ñes_dbl.
k
,Ñes_dbl.
l
,Ñes_dbl.
m
,Ñes_dbl.
n
);

134 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_108byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

136 
ªs_dbl
 = ((
	`°ru˘_108byã
(*)(
°ru˘_108byã
, struct_108byte,

137 
°ru˘_108byã
, såu˘_108byã))(
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
, 
h_dbl
);

139 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g %g %g %g %g %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,

140 
ªs_dbl
.
c
,Ñes_dbl.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
,Ñes_dbl.
i
,

141 
ªs_dbl
.
j
,Ñes_dbl.
k
,Ñes_dbl.
l
,Ñes_dbl.
m
,Ñes_dbl.
n
);

144 
	`exô
(0);

145 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/stret_large2.c

10 
	~"ffôe°.h
"

15 
	s°ru˘_116byã
 {

16 
	ma
;

17 
	mb
;

18 
	mc
;

19 
	md
;

20 
	me
;

21 
	mf
;

22 
	mg
;

23 
	mh
;

24 
	mi
;

25 
	mj
;

26 
	mk
;

27 
	ml
;

28 
	mm
;

29 
	mn
;

30 
	mo
;

31 } 
	t°ru˘_116byã
;

33 
°ru˘_116byã
 
	$˛s_°ru˘_116byã_‚
(

34 
°ru˘_116byã
 
b0
,

35 
°ru˘_116byã
 
b1
,

36 
°ru˘_116byã
 
b2
,

37 
°ru˘_116byã
 
b3
)

39 
°ru˘_116byã
 
ªsu…
;

41 
ªsu…
.
a
 = 
b0
.®+ 
b1
.®+ 
b2
.®+ 
b3
.a;

42 
ªsu…
.
b
 = 
b0
.b + 
b1
.b + 
b2
.b + 
b3
.b;

43 
ªsu…
.
c
 = 
b0
.¯+ 
b1
.¯+ 
b2
.¯+ 
b3
.c;

44 
ªsu…
.
d
 = 
b0
.d + 
b1
.d + 
b2
.d + 
b3
.d;

45 
ªsu…
.
e
 = 
b0
.ê+ 
b1
.ê+ 
b2
.ê+ 
b3
.e;

46 
ªsu…
.
f
 = 
b0
.‡+ 
b1
.‡+ 
b2
.‡+ 
b3
.f;

47 
ªsu…
.
g
 = 
b0
.g + 
b1
.g + 
b2
.g + 
b3
.g;

48 
ªsu…
.
h
 = 
b0
.h + 
b1
.h + 
b2
.h + 
b3
.h;

49 
ªsu…
.
i
 = 
b0
.ò+ 
b1
.ò+ 
b2
.ò+ 
b3
.i;

50 
ªsu…
.
j
 = 
b0
.j + 
b1
.j + 
b2
.j + 
b3
.j;

51 
ªsu…
.
k
 = 
b0
.k + 
b1
.k + 
b2
.k + 
b3
.k;

52 
ªsu…
.
l
 = 
b0
.»+ 
b1
.»+ 
b2
.»+ 
b3
.l;

53 
ªsu…
.
m
 = 
b0
.m + 
b1
.m + 
b2
.m + 
b3
.m;

54 
ªsu…
.
n
 = 
b0
.¿+ 
b1
.¿+ 
b2
.¿+ 
b3
.n;

55 
ªsu…
.
o
 = 
b0
.ÿ+ 
b1
.ÿ+ 
b2
.ÿ+ 
b3
.o;

57 
	`¥ötf
("%g %g %g %g %g %g %g %g %g %g %g %g %g %g %d\n", 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,

58 
ªsu…
.
d
,Ñesu….
e
,Ñesu….
f
,Ñesu….
g
,Ñesu….
h
,Ñesu….
i
,

59 
ªsu…
.
j
,Ñesu….
k
,Ñesu….
l
,Ñesu….
m
,Ñesu….
n
,Ñesu….
o
);

61  
ªsu…
;

62 
	}
}

65 
	$˛s_°ru˘_116byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
, * 
u£rd©a
 __UNUSED__)

67 
°ru˘_116byã
 
b0
, 
b1
, 
b2
, 
b3
;

69 
b0
 = *(
°ru˘_116byã
*)(
¨gs
[0]);

70 
b1
 = *(
°ru˘_116byã
*)(
¨gs
[1]);

71 
b2
 = *(
°ru˘_116byã
*)(
¨gs
[2]);

72 
b3
 = *(
°ru˘_116byã
*)(
¨gs
[3]);

74 *(
°ru˘_116byã
*)
ª•
 = 
	`˛s_°ru˘_116byã_‚
(
b0
, 
b1
, 
b2
, 
b3
);

75 
	}
}

77 
	$maö
 ()

79 
ffi_cif
 
cif
;

80 *
code
;

81 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

82 * 
¨gs_dbl
[5];

83 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[16];

84 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

85 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

87 
°ru˘_116byã
 
e_dbl
 = { 9.0, 2.0, 6.0, 5.0, 3.0, 4.0, 8.0, 1.0, 1.0, 2.0, 3.0, 7.0, 2.0, 5.0, 7 };

88 
°ru˘_116byã
 
f_dbl
 = { 1.0, 2.0, 3.0, 7.0, 2.0, 5.0, 6.0, 7.0, 4.0, 5.0, 7.0, 9.0, 1.0, 6.0, 4 };

89 
°ru˘_116byã
 
g_dbl
 = { 4.0, 5.0, 7.0, 9.0, 1.0, 1.0, 2.0, 9.0, 8.0, 6.0, 1.0, 4.0, 0.0, 7.0, 3 };

90 
°ru˘_116byã
 
h_dbl
 = { 8.0, 6.0, 1.0, 4.0, 0.0, 3.0, 3.0, 1.0, 9.0, 2.0, 6.0, 5.0, 3.0, 8.0, 2 };

91 
°ru˘_116byã
 
ªs_dbl
;

93 
˛s_°ru˘_ty≥
.
size
 = 0;

94 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

95 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

96 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

98 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

99 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

100 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_doubÀ
;

101 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_doubÀ
;

102 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_doubÀ
;

103 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_doubÀ
;

104 
˛s_°ru˘_fõlds
[6] = &
ffi_ty≥_doubÀ
;

105 
˛s_°ru˘_fõlds
[7] = &
ffi_ty≥_doubÀ
;

106 
˛s_°ru˘_fõlds
[8] = &
ffi_ty≥_doubÀ
;

107 
˛s_°ru˘_fõlds
[9] = &
ffi_ty≥_doubÀ
;

108 
˛s_°ru˘_fõlds
[10] = &
ffi_ty≥_doubÀ
;

109 
˛s_°ru˘_fõlds
[11] = &
ffi_ty≥_doubÀ
;

110 
˛s_°ru˘_fõlds
[12] = &
ffi_ty≥_doubÀ
;

111 
˛s_°ru˘_fõlds
[13] = &
ffi_ty≥_doubÀ
;

112 
˛s_°ru˘_fõlds
[14] = &
ffi_ty≥_söt32
;

113 
˛s_°ru˘_fõlds
[15] = 
NULL
;

115 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

116 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

117 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥
;

118 
dbl_¨g_ty≥s
[3] = &
˛s_°ru˘_ty≥
;

119 
dbl_¨g_ty≥s
[4] = 
NULL
;

121 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4, &
˛s_°ru˘_ty≥
,

122 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

124 
¨gs_dbl
[0] = &
e_dbl
;

125 
¨gs_dbl
[1] = &
f_dbl
;

126 
¨gs_dbl
[2] = &
g_dbl
;

127 
¨gs_dbl
[3] = &
h_dbl
;

128 
¨gs_dbl
[4] = 
NULL
;

130 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_116byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

132 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g %g %g %g %g %g %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,

133 
ªs_dbl
.
c
,Ñes_dbl.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
,Ñes_dbl.
i
,

134 
ªs_dbl
.
j
,Ñes_dbl.
k
,Ñes_dbl.
l
,Ñes_dbl.
m
,Ñes_dbl.
n
,Ñes_dbl.
o
);

137 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_116byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

139 
ªs_dbl
 = ((
	`°ru˘_116byã
(*)(
°ru˘_116byã
, struct_116byte,

140 
°ru˘_116byã
, såu˘_116byã))(
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
, 
h_dbl
);

142 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g %g %g %g %g %g %g %d\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,

143 
ªs_dbl
.
c
,Ñes_dbl.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
,Ñes_dbl.
i
,

144 
ªs_dbl
.
j
,Ñes_dbl.
k
,Ñes_dbl.
l
,Ñes_dbl.
m
,Ñes_dbl.
n
,Ñes_dbl.
o
);

147 
	`exô
(0);

148 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/stret_medium.c

10 
	~"ffôe°.h
"

12 
	s°ru˘_72byã
 {

13 
	ma
;

14 
	mb
;

15 
	mc
;

16 
	md
;

17 
	me
;

18 
	mf
;

19 
	mg
;

20 
	mh
;

21 
	mi
;

22 } 
	t°ru˘_72byã
;

24 
°ru˘_72byã
 
	$˛s_°ru˘_72byã_‚
(

25 
°ru˘_72byã
 
b0
,

26 
°ru˘_72byã
 
b1
,

27 
°ru˘_72byã
 
b2
,

28 
°ru˘_72byã
 
b3
)

30 
°ru˘_72byã
 
ªsu…
;

32 
ªsu…
.
a
 = 
b0
.®+ 
b1
.®+ 
b2
.®+ 
b3
.a;

33 
ªsu…
.
b
 = 
b0
.b + 
b1
.b + 
b2
.b + 
b3
.b;

34 
ªsu…
.
c
 = 
b0
.¯+ 
b1
.¯+ 
b2
.¯+ 
b3
.c;

35 
ªsu…
.
d
 = 
b0
.d + 
b1
.d + 
b2
.d + 
b3
.d;

36 
ªsu…
.
e
 = 
b0
.ê+ 
b1
.ê+ 
b2
.ê+ 
b3
.e;

37 
ªsu…
.
f
 = 
b0
.‡+ 
b1
.‡+ 
b2
.‡+ 
b3
.f;

38 
ªsu…
.
g
 = 
b0
.g + 
b1
.g + 
b2
.g + 
b3
.g;

39 
ªsu…
.
h
 = 
b0
.h + 
b1
.h + 
b2
.h + 
b3
.h;

40 
ªsu…
.
i
 = 
b0
.ò+ 
b1
.ò+ 
b2
.ò+ 
b3
.i;

42 
	`¥ötf
("%g %g %g %g %g %g %g %g %g\n", 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,

43 
ªsu…
.
d
,Ñesu….
e
,Ñesu….
f
,Ñesu….
g
,Ñesu….
h
,Ñesu….
i
);

45  
ªsu…
;

46 
	}
}

49 
	$˛s_°ru˘_72byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
, * 
u£rd©a
 __UNUSED__)

51 
°ru˘_72byã
 
b0
, 
b1
, 
b2
, 
b3
;

53 
b0
 = *(
°ru˘_72byã
*)(
¨gs
[0]);

54 
b1
 = *(
°ru˘_72byã
*)(
¨gs
[1]);

55 
b2
 = *(
°ru˘_72byã
*)(
¨gs
[2]);

56 
b3
 = *(
°ru˘_72byã
*)(
¨gs
[3]);

58 *(
°ru˘_72byã
*)
ª•
 = 
	`˛s_°ru˘_72byã_‚
(
b0
, 
b1
, 
b2
, 
b3
);

59 
	}
}

61 
	$maö
 ()

63 
ffi_cif
 
cif
;

64 *
code
;

65 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

66 * 
¨gs_dbl
[5];

67 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[10];

68 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

69 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

71 
°ru˘_72byã
 
e_dbl
 = { 9.0, 2.0, 6.0, 5.0, 3.0, 4.0, 8.0, 1.0, 7.0 };

72 
°ru˘_72byã
 
f_dbl
 = { 1.0, 2.0, 3.0, 7.0, 2.0, 5.0, 6.0, 7.0, 4.0 };

73 
°ru˘_72byã
 
g_dbl
 = { 4.0, 5.0, 7.0, 9.0, 1.0, 1.0, 2.0, 9.0, 3.0 };

74 
°ru˘_72byã
 
h_dbl
 = { 8.0, 6.0, 1.0, 4.0, 0.0, 3.0, 3.0, 1.0, 2.0 };

75 
°ru˘_72byã
 
ªs_dbl
;

77 
˛s_°ru˘_ty≥
.
size
 = 0;

78 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

79 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

80 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

82 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

83 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

84 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_doubÀ
;

85 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_doubÀ
;

86 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_doubÀ
;

87 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_doubÀ
;

88 
˛s_°ru˘_fõlds
[6] = &
ffi_ty≥_doubÀ
;

89 
˛s_°ru˘_fõlds
[7] = &
ffi_ty≥_doubÀ
;

90 
˛s_°ru˘_fõlds
[8] = &
ffi_ty≥_doubÀ
;

91 
˛s_°ru˘_fõlds
[9] = 
NULL
;

93 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

94 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

95 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥
;

96 
dbl_¨g_ty≥s
[3] = &
˛s_°ru˘_ty≥
;

97 
dbl_¨g_ty≥s
[4] = 
NULL
;

99 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4, &
˛s_°ru˘_ty≥
,

100 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

102 
¨gs_dbl
[0] = &
e_dbl
;

103 
¨gs_dbl
[1] = &
f_dbl
;

104 
¨gs_dbl
[2] = &
g_dbl
;

105 
¨gs_dbl
[3] = &
h_dbl
;

106 
¨gs_dbl
[4] = 
NULL
;

108 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_72byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

110 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

111 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
,Ñes_dbl.
i
);

114 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_72byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

116 
ªs_dbl
 = ((
	`°ru˘_72byã
(*)(
°ru˘_72byã
, struct_72byte,

117 
°ru˘_72byã
, såu˘_72byã))(
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
, 
h_dbl
);

119 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g %g\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

120 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
,Ñes_dbl.
i
);

123 
	`exô
(0);

124 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/stret_medium2.c

11 
	~"ffôe°.h
"

13 
	s°ru˘_72byã
 {

14 
	ma
;

15 
	mb
;

16 
	mc
;

17 
	md
;

18 
	me
;

19 
	mf
;

20 
	mg
;

21 
	mh
;

22 
	mi
;

23 } 
	t°ru˘_72byã
;

25 
°ru˘_72byã
 
	$˛s_°ru˘_72byã_‚
(

26 
°ru˘_72byã
 
b0
,

27 
°ru˘_72byã
 
b1
,

28 
°ru˘_72byã
 
b2
,

29 
°ru˘_72byã
 
b3
)

31 
°ru˘_72byã
 
ªsu…
;

33 
ªsu…
.
a
 = 
b0
.®+ 
b1
.®+ 
b2
.®+ 
b3
.a;

34 
ªsu…
.
b
 = 
b0
.b + 
b1
.b + 
b2
.b + 
b3
.b;

35 
ªsu…
.
c
 = 
b0
.¯+ 
b1
.¯+ 
b2
.¯+ 
b3
.c;

36 
ªsu…
.
d
 = 
b0
.d + 
b1
.d + 
b2
.d + 
b3
.d;

37 
ªsu…
.
e
 = 
b0
.ê+ 
b1
.ê+ 
b2
.ê+ 
b3
.e;

38 
ªsu…
.
f
 = 
b0
.‡+ 
b1
.‡+ 
b2
.‡+ 
b3
.f;

39 
ªsu…
.
g
 = 
b0
.g + 
b1
.g + 
b2
.g + 
b3
.g;

40 
ªsu…
.
h
 = 
b0
.h + 
b1
.h + 
b2
.h + 
b3
.h;

41 
ªsu…
.
i
 = 
b0
.ò+ 
b1
.ò+ 
b2
.ò+ 
b3
.i;

43 
	`¥ötf
("%g %g %g %g %g %g %g %g %" 
PRIdLL
 "\n", 
ªsu…
.
a
,Ñesu….
b
,Ñesu….
c
,

44 
ªsu…
.
d
,Ñesu….
e
,Ñesu….
f
,Ñesu….
g
,Ñesu….
h
,Ñesu….
i
);

46  
ªsu…
;

47 
	}
}

50 
	$˛s_°ru˘_72byã_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
, ** 
¨gs
, * 
u£rd©a
 __UNUSED__)

52 
°ru˘_72byã
 
b0
, 
b1
, 
b2
, 
b3
;

54 
b0
 = *(
°ru˘_72byã
*)(
¨gs
[0]);

55 
b1
 = *(
°ru˘_72byã
*)(
¨gs
[1]);

56 
b2
 = *(
°ru˘_72byã
*)(
¨gs
[2]);

57 
b3
 = *(
°ru˘_72byã
*)(
¨gs
[3]);

59 *(
°ru˘_72byã
*)
ª•
 = 
	`˛s_°ru˘_72byã_‚
(
b0
, 
b1
, 
b2
, 
b3
);

60 
	}
}

62 
	$maö
 ()

64 
ffi_cif
 
cif
;

65 *
code
;

66 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

67 * 
¨gs_dbl
[5];

68 
ffi_ty≥
* 
˛s_°ru˘_fõlds
[10];

69 
ffi_ty≥
 
˛s_°ru˘_ty≥
;

70 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

72 
°ru˘_72byã
 
e_dbl
 = { 9.0, 2.0, 6.0, 5.0, 3.0, 4.0, 8.0, 1.0, 7 };

73 
°ru˘_72byã
 
f_dbl
 = { 1.0, 2.0, 3.0, 7.0, 2.0, 5.0, 6.0, 7.0, 4 };

74 
°ru˘_72byã
 
g_dbl
 = { 4.0, 5.0, 7.0, 9.0, 1.0, 1.0, 2.0, 9.0, 3 };

75 
°ru˘_72byã
 
h_dbl
 = { 8.0, 6.0, 1.0, 4.0, 0.0, 3.0, 3.0, 1.0, 2 };

76 
°ru˘_72byã
 
ªs_dbl
;

78 
˛s_°ru˘_ty≥
.
size
 = 0;

79 
˛s_°ru˘_ty≥
.
Æignmít
 = 0;

80 
˛s_°ru˘_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

81 
˛s_°ru˘_ty≥
.
ñemíts
 = 
˛s_°ru˘_fõlds
;

83 
˛s_°ru˘_fõlds
[0] = &
ffi_ty≥_doubÀ
;

84 
˛s_°ru˘_fõlds
[1] = &
ffi_ty≥_doubÀ
;

85 
˛s_°ru˘_fõlds
[2] = &
ffi_ty≥_doubÀ
;

86 
˛s_°ru˘_fõlds
[3] = &
ffi_ty≥_doubÀ
;

87 
˛s_°ru˘_fõlds
[4] = &
ffi_ty≥_doubÀ
;

88 
˛s_°ru˘_fõlds
[5] = &
ffi_ty≥_doubÀ
;

89 
˛s_°ru˘_fõlds
[6] = &
ffi_ty≥_doubÀ
;

90 
˛s_°ru˘_fõlds
[7] = &
ffi_ty≥_doubÀ
;

91 
˛s_°ru˘_fõlds
[8] = &
ffi_ty≥_söt64
;

92 
˛s_°ru˘_fõlds
[9] = 
NULL
;

94 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥
;

95 
dbl_¨g_ty≥s
[1] = &
˛s_°ru˘_ty≥
;

96 
dbl_¨g_ty≥s
[2] = &
˛s_°ru˘_ty≥
;

97 
dbl_¨g_ty≥s
[3] = &
˛s_°ru˘_ty≥
;

98 
dbl_¨g_ty≥s
[4] = 
NULL
;

100 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 4, &
˛s_°ru˘_ty≥
,

101 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

103 
¨gs_dbl
[0] = &
e_dbl
;

104 
¨gs_dbl
[1] = &
f_dbl
;

105 
¨gs_dbl
[2] = &
g_dbl
;

106 
¨gs_dbl
[3] = &
h_dbl
;

107 
¨gs_dbl
[4] = 
NULL
;

109 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
˛s_°ru˘_72byã_‚
), &
ªs_dbl
, 
¨gs_dbl
);

111 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g %" 
PRIdLL
 "\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

112 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
,Ñes_dbl.
i
);

115 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_72byã_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

117 
ªs_dbl
 = ((
	`°ru˘_72byã
(*)(
°ru˘_72byã
, struct_72byte,

118 
°ru˘_72byã
, såu˘_72byã))(
code
))(
e_dbl
, 
f_dbl
, 
g_dbl
, 
h_dbl
);

120 
	`¥ötf
("ªs: %g %g %g %g %g %g %g %g %" 
PRIdLL
 "\n", 
ªs_dbl
.
a
,Ñes_dbl.
b
,Ñes_dbl.
c
,

121 
ªs_dbl
.
d
,Ñes_dbl.
e
,Ñes_dbl.
f
,Ñes_dbl.
g
,Ñes_dbl.
h
,Ñes_dbl.
i
);

124 
	`exô
(0);

125 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/strlen.c

8 
	~"ffôe°.h
"

10 
size_t
 
ABI_ATTR
 
	$my_°æí
(*
s
)

12  (
	`°æí
(
s
));

13 
	}
}

15 
	$maö
 ()

17 
ffi_cif
 
cif
;

18 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

19 *
vÆues
[
MAX_ARGS
];

20 
ffi_¨g
 
röt
;

21 *
s
;

23 
¨gs
[0] = &
ffi_ty≥_poöãr
;

24 
vÆues
[0] = (*Ë&
s
;

27 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1,

28 &
ffi_ty≥_söt
, 
¨gs
Ë=
FFI_OK
);

30 
s
 = "a";

31 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_°æí
), &
röt
, 
vÆues
);

32 
	`CHECK
(
röt
 == 1);

34 
s
 = "1234567";

35 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_°æí
), &
röt
, 
vÆues
);

36 
	`CHECK
(
röt
 == 7);

38 
s
 = "1234567890123456789012345";

39 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_°æí
), &
röt
, 
vÆues
);

40 
	`CHECK
(
röt
 == 25);

42 
	`exô
 (0);

43 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/strlen2.c

9 
	~"ffôe°.h
"

11 
size_t
 
ABI_ATTR
 
	$my_f
(*
s
, 
a
)

13  (
size_t
Ë((Ë
	`°æí
(
s
Ë+ (Ë
a
);

14 
	}
}

16 
	$maö
 ()

18 
ffi_cif
 
cif
;

19 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

20 *
vÆues
[
MAX_ARGS
];

21 
ffi_¨g
 
röt
;

22 *
s
;

23 
v2
;

24 
¨gs
[0] = &
ffi_ty≥_poöãr
;

25 
¨gs
[1] = &
ffi_ty≥_Êﬂt
;

26 
vÆues
[0] = (*Ë&
s
;

27 
vÆues
[1] = (*Ë&
v2
;

30 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 2,

31 &
ffi_ty≥_söt
, 
¨gs
Ë=
FFI_OK
);

33 
s
 = "a";

34 
v2
 = 0.0;

35 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

36 
	`CHECK
(
röt
 == 1);

38 
s
 = "1234567";

39 
v2
 = -1.0;

40 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

41 
	`CHECK
(
röt
 == 6);

43 
s
 = "1234567890123456789012345";

44 
v2
 = 1.0;

45 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

46 
	`CHECK
(
röt
 == 26);

48 
	`exô
(0);

49 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/strlen3.c

9 
	~"ffôe°.h
"

11 
size_t
 
ABI_ATTR
 
	$my_f
(
a
, *
s
)

13  (
size_t
Ë((Ë
	`°æí
(
s
Ë+ (Ë
a
);

14 
	}
}

16 
	$maö
 ()

18 
ffi_cif
 
cif
;

19 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

20 *
vÆues
[
MAX_ARGS
];

21 
ffi_¨g
 
röt
;

22 *
s
;

23 
v2
;

24 
¨gs
[1] = &
ffi_ty≥_poöãr
;

25 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

26 
vÆues
[1] = (*Ë&
s
;

27 
vÆues
[0] = (*Ë&
v2
;

30 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 2,

31 &
ffi_ty≥_söt
, 
¨gs
Ë=
FFI_OK
);

33 
s
 = "a";

34 
v2
 = 0.0;

35 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

36 
	`CHECK
(
röt
 == 1);

38 
s
 = "1234567";

39 
v2
 = -1.0;

40 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

41 
	`CHECK
(
röt
 == 6);

43 
s
 = "1234567890123456789012345";

44 
v2
 = 1.0;

45 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

46 
	`CHECK
(
röt
 == 26);

48 
	`exô
(0);

49 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/strlen4.c

9 
	~"ffôe°.h
"

11 
size_t
 
ABI_ATTR
 
	$my_f
(
a
, *
s
, 
i
)

13  (
size_t
Ë((Ë
	`°æí
(
s
Ë+ (Ë
a
 + 
i
);

14 
	}
}

16 
	$maö
 ()

18 
ffi_cif
 
cif
;

19 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

20 *
vÆues
[
MAX_ARGS
];

21 
ffi_¨g
 
röt
;

22 *
s
;

23 
v1
;

24 
v2
;

25 
¨gs
[2] = &
ffi_ty≥_söt
;

26 
¨gs
[1] = &
ffi_ty≥_poöãr
;

27 
¨gs
[0] = &
ffi_ty≥_Êﬂt
;

28 
vÆues
[2] = (*Ë&
v1
;

29 
vÆues
[1] = (*Ë&
s
;

30 
vÆues
[0] = (*Ë&
v2
;

33 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 3,

34 &
ffi_ty≥_söt
, 
¨gs
Ë=
FFI_OK
);

36 
s
 = "a";

37 
v1
 = 1;

38 
v2
 = 0.0;

39 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

40 
	`CHECK
(
röt
 == 2);

42 
s
 = "1234567";

43 
v2
 = -1.0;

44 
v1
 = -2;

45 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

46 
	`CHECK
(
röt
 == 4);

48 
s
 = "1234567890123456789012345";

49 
v2
 = 1.0;

50 
v1
 = 2;

51 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
my_f
), &
röt
, 
vÆues
);

52 
	`CHECK
(
röt
 == 28);

54 
	`exô
(0);

55 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct1.c

8 
	~"ffôe°.h
"

12 
	muc
;

13 
	md
;

14 
	mui
;

15 } 
	tã°_°ru˘uª_1
;

17 
ã°_°ru˘uª_1
 
ABI_ATTR
 
	$°ru˘1
(
ã°_°ru˘uª_1
 
ts
)

19 
ts
.
uc
++;

20 
ts
.
d
--;

21 
ts
.
ui
++;

23  
ts
;

24 
	}
}

26 
	$maö
 ()

28 
ffi_cif
 
cif
;

29 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

30 *
vÆues
[
MAX_ARGS
];

31 
ffi_ty≥
 
ts1_ty≥
;

32 
ffi_ty≥
 *
ts1_ty≥_ñemíts
[4];

34 
ã°_°ru˘uª_1
 
ts1_¨g
;

37 
ã°_°ru˘uª_1
 *
ts1_ªsu…
 =

38 (
ã°_°ru˘uª_1
 *Ë
	`mÆloc
 ((test_structure_1));

40 
ts1_ty≥
.
size
 = 0;

41 
ts1_ty≥
.
Æignmít
 = 0;

42 
ts1_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

43 
ts1_ty≥
.
ñemíts
 = 
ts1_ty≥_ñemíts
;

44 
ts1_ty≥_ñemíts
[0] = &
ffi_ty≥_uch¨
;

45 
ts1_ty≥_ñemíts
[1] = &
ffi_ty≥_doubÀ
;

46 
ts1_ty≥_ñemíts
[2] = &
ffi_ty≥_uöt
;

47 
ts1_ty≥_ñemíts
[3] = 
NULL
;

49 
¨gs
[0] = &
ts1_ty≥
;

50 
vÆues
[0] = &
ts1_¨g
;

53 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1,

54 &
ts1_ty≥
, 
¨gs
Ë=
FFI_OK
);

56 
ts1_¨g
.
uc
 = '\x01';

57 
ts1_¨g
.
d
 = 3.14159;

58 
ts1_¨g
.
ui
 = 555;

60 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
°ru˘1
), 
ts1_ªsu…
, 
vÆues
);

62 
	`CHECK
(
ts1_ªsu…
->
ui
 == 556);

63 
	`CHECK
(
ts1_ªsu…
->
d
 == 3.14159 - 1);

65 
	`‰ì
 (
ts1_ªsu…
);

66 
	`exô
(0);

67 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct2.c

8 
	~"ffôe°.h
"

12 
	md1
;

13 
	md2
;

14 } 
	tã°_°ru˘uª_2
;

16 
ã°_°ru˘uª_2
 
ABI_ATTR
 
	$°ru˘2
(
ã°_°ru˘uª_2
 
ts
)

18 
ts
.
d1
--;

19 
ts
.
d2
--;

21  
ts
;

22 
	}
}

24 
	$maö
 ()

26 
ffi_cif
 
cif
;

27 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

28 *
vÆues
[
MAX_ARGS
];

29 
ã°_°ru˘uª_2
 
ts2_¨g
;

30 
ffi_ty≥
 
ts2_ty≥
;

31 
ffi_ty≥
 *
ts2_ty≥_ñemíts
[3];

34 
ã°_°ru˘uª_2
 *
ts2_ªsu…
 =

35 (
ã°_°ru˘uª_2
 *Ë
	`mÆloc
 ((test_structure_2));

37 
ts2_ty≥
.
size
 = 0;

38 
ts2_ty≥
.
Æignmít
 = 0;

39 
ts2_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

40 
ts2_ty≥
.
ñemíts
 = 
ts2_ty≥_ñemíts
;

41 
ts2_ty≥_ñemíts
[0] = &
ffi_ty≥_doubÀ
;

42 
ts2_ty≥_ñemíts
[1] = &
ffi_ty≥_doubÀ
;

43 
ts2_ty≥_ñemíts
[2] = 
NULL
;

45 
¨gs
[0] = &
ts2_ty≥
;

46 
vÆues
[0] = &
ts2_¨g
;

49 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1, &
ts2_ty≥
, 
¨gs
Ë=
FFI_OK
);

51 
ts2_¨g
.
d1
 = 5.55;

52 
ts2_¨g
.
d2
 = 6.66;

54 
	`¥ötf
 ("%g\n", 
ts2_¨g
.
d1
);

55 
	`¥ötf
 ("%g\n", 
ts2_¨g
.
d2
);

57 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
°ru˘2
), 
ts2_ªsu…
, 
vÆues
);

59 
	`¥ötf
 ("%g\n", 
ts2_ªsu…
->
d1
);

60 
	`¥ötf
 ("%g\n", 
ts2_ªsu…
->
d2
);

62 
	`CHECK
(
ts2_ªsu…
->
d1
 == 5.55 - 1);

63 
	`CHECK
(
ts2_ªsu…
->
d2
 == 6.66 - 1);

65 
	`‰ì
 (
ts2_ªsu…
);

66 
	`exô
(0);

67 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct3.c

8 
	~"ffôe°.h
"

12 
	msi
;

13 } 
	tã°_°ru˘uª_3
;

15 
ã°_°ru˘uª_3
 
ABI_ATTR
 
	$°ru˘3
(
ã°_°ru˘uª_3
 
ts
)

17 
ts
.
si
 = -(ts.si*2);

19  
ts
;

20 
	}
}

22 
	$maö
 ()

24 
ffi_cif
 
cif
;

25 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

26 *
vÆues
[
MAX_ARGS
];

27 
com∑ª_vÆue
;

28 
ffi_ty≥
 
ts3_ty≥
;

29 
ffi_ty≥
 *
ts3_ty≥_ñemíts
[2];

31 
ã°_°ru˘uª_3
 
ts3_¨g
;

32 
ã°_°ru˘uª_3
 *
ts3_ªsu…
 =

33 (
ã°_°ru˘uª_3
 *Ë
	`mÆloc
 ((test_structure_3));

35 
ts3_ty≥
.
size
 = 0;

36 
ts3_ty≥
.
Æignmít
 = 0;

37 
ts3_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

38 
ts3_ty≥
.
ñemíts
 = 
ts3_ty≥_ñemíts
;

39 
ts3_ty≥_ñemíts
[0] = &
ffi_ty≥_söt
;

40 
ts3_ty≥_ñemíts
[1] = 
NULL
;

42 
¨gs
[0] = &
ts3_ty≥
;

43 
vÆues
[0] = &
ts3_¨g
;

46 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1,

47 &
ts3_ty≥
, 
¨gs
Ë=
FFI_OK
);

49 
ts3_¨g
.
si
 = -123;

50 
com∑ª_vÆue
 = 
ts3_¨g
.
si
;

52 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
°ru˘3
), 
ts3_ªsu…
, 
vÆues
);

54 
	`¥ötf
 ("%d %d\n", 
ts3_ªsu…
->
si
, -(
com∑ª_vÆue
*2));

56 
	`CHECK
(
ts3_ªsu…
->
si
 =-(
com∑ª_vÆue
*2));

58 
	`‰ì
 (
ts3_ªsu…
);

59 
	`exô
(0);

60 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct4.c

8 
	~"ffôe°.h
"

12 
	mui1
;

13 
	mui2
;

14 
	mui3
;

15 } 
	tã°_°ru˘uª_4
;

17 
ã°_°ru˘uª_4
 
ABI_ATTR
 
	$°ru˘4
(
ã°_°ru˘uª_4
 
ts
)

19 
ts
.
ui3
 =Ås.
ui1
 *Ås.
ui2
 *Ås.ui3;

21  
ts
;

22 
	}
}

24 
	$maö
 ()

26 
ffi_cif
 
cif
;

27 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

28 *
vÆues
[
MAX_ARGS
];

29 
ffi_ty≥
 
ts4_ty≥
;

30 
ffi_ty≥
 *
ts4_ty≥_ñemíts
[4];

32 
ã°_°ru˘uª_4
 
ts4_¨g
;

35 
ã°_°ru˘uª_4
 *
ts4_ªsu…
 =

36 (
ã°_°ru˘uª_4
 *Ë
	`mÆloc
 ((test_structure_4));

38 
ts4_ty≥
.
size
 = 0;

39 
ts4_ty≥
.
Æignmít
 = 0;

40 
ts4_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

41 
ts4_ty≥
.
ñemíts
 = 
ts4_ty≥_ñemíts
;

42 
ts4_ty≥_ñemíts
[0] = &
ffi_ty≥_uöt
;

43 
ts4_ty≥_ñemíts
[1] = &
ffi_ty≥_uöt
;

44 
ts4_ty≥_ñemíts
[2] = &
ffi_ty≥_uöt
;

45 
ts4_ty≥_ñemíts
[3] = 
NULL
;

47 
¨gs
[0] = &
ts4_ty≥
;

48 
vÆues
[0] = &
ts4_¨g
;

51 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1, &
ts4_ty≥
, 
¨gs
Ë=
FFI_OK
);

53 
ts4_¨g
.
ui1
 = 2;

54 
ts4_¨g
.
ui2
 = 3;

55 
ts4_¨g
.
ui3
 = 4;

57 
	`ffi_ˇŒ
 (&
cif
, 
	`FFI_FN
(
°ru˘4
), 
ts4_ªsu…
, 
vÆues
);

59 
	`CHECK
(
ts4_ªsu…
->
ui3
 == 2U * 3U * 4U);

62 
	`‰ì
 (
ts4_ªsu…
);

63 
	`exô
(0);

64 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct5.c

8 
	~"ffôe°.h
"

11 
	mc1
;

12 
	mc2
;

13 } 
	tã°_°ru˘uª_5
;

15 
ã°_°ru˘uª_5
 
ABI_ATTR
 
	$°ru˘5
(
ã°_°ru˘uª_5
 
ts1
,Åe°_°ru˘uª_5 
ts2
)

17 
ts1
.
c1
 +
ts2
.c1;

18 
ts1
.
c2
 -
ts2
.c2;

20  
ts1
;

21 
	}
}

23 
	$maö
 ()

25 
ffi_cif
 
cif
;

26 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

27 *
vÆues
[
MAX_ARGS
];

28 
ffi_ty≥
 
ts5_ty≥
;

29 
ffi_ty≥
 *
ts5_ty≥_ñemíts
[3];

31 
ã°_°ru˘uª_5
 
ts5_¨g1
, 
ts5_¨g2
;

34 
ã°_°ru˘uª_5
 *
ts5_ªsu…
 =

35 (
ã°_°ru˘uª_5
 *Ë
	`mÆloc
 ((test_structure_5));

37 
ts5_ty≥
.
size
 = 0;

38 
ts5_ty≥
.
Æignmít
 = 0;

39 
ts5_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

40 
ts5_ty≥
.
ñemíts
 = 
ts5_ty≥_ñemíts
;

41 
ts5_ty≥_ñemíts
[0] = &
ffi_ty≥_sch¨
;

42 
ts5_ty≥_ñemíts
[1] = &
ffi_ty≥_sch¨
;

43 
ts5_ty≥_ñemíts
[2] = 
NULL
;

45 
¨gs
[0] = &
ts5_ty≥
;

46 
¨gs
[1] = &
ts5_ty≥
;

47 
vÆues
[0] = &
ts5_¨g1
;

48 
vÆues
[1] = &
ts5_¨g2
;

51 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 2, &
ts5_ty≥
, 
¨gs
Ë=
FFI_OK
);

53 
ts5_¨g1
.
c1
 = 2;

54 
ts5_¨g1
.
c2
 = 6;

55 
ts5_¨g2
.
c1
 = 5;

56 
ts5_¨g2
.
c2
 = 3;

58 
	`ffi_ˇŒ
 (&
cif
, 
	`FFI_FN
(
°ru˘5
), 
ts5_ªsu…
, 
vÆues
);

60 
	`CHECK
(
ts5_ªsu…
->
c1
 == 7);

61 
	`CHECK
(
ts5_ªsu…
->
c2
 == 3);

64 
	`‰ì
 (
ts5_ªsu…
);

65 
	`exô
(0);

66 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct6.c

8 
	~"ffôe°.h
"

11 
	mf
;

12 
	md
;

13 } 
	tã°_°ru˘uª_6
;

15 
ã°_°ru˘uª_6
 
ABI_ATTR
 
	$°ru˘6
 (
ã°_°ru˘uª_6
 
ts
)

17 
ts
.
f
 += 1;

18 
ts
.
d
 += 1;

20  
ts
;

21 
	}
}

23 
	$maö
 ()

25 
ffi_cif
 
cif
;

26 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

27 *
vÆues
[
MAX_ARGS
];

28 
ffi_ty≥
 
ts6_ty≥
;

29 
ffi_ty≥
 *
ts6_ty≥_ñemíts
[3];

31 
ã°_°ru˘uª_6
 
ts6_¨g
;

34 
ã°_°ru˘uª_6
 *
ts6_ªsu…
 =

35 (
ã°_°ru˘uª_6
 *Ë
	`mÆloc
 ((test_structure_6));

37 
ts6_ty≥
.
size
 = 0;

38 
ts6_ty≥
.
Æignmít
 = 0;

39 
ts6_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

40 
ts6_ty≥
.
ñemíts
 = 
ts6_ty≥_ñemíts
;

41 
ts6_ty≥_ñemíts
[0] = &
ffi_ty≥_Êﬂt
;

42 
ts6_ty≥_ñemíts
[1] = &
ffi_ty≥_doubÀ
;

43 
ts6_ty≥_ñemíts
[2] = 
NULL
;

45 
¨gs
[0] = &
ts6_ty≥
;

46 
vÆues
[0] = &
ts6_¨g
;

49 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1, &
ts6_ty≥
, 
¨gs
Ë=
FFI_OK
);

51 
ts6_¨g
.
f
 = 5.55f;

52 
ts6_¨g
.
d
 = 6.66;

54 
	`¥ötf
 ("%g\n", 
ts6_¨g
.
f
);

55 
	`¥ötf
 ("%g\n", 
ts6_¨g
.
d
);

57 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
°ru˘6
), 
ts6_ªsu…
, 
vÆues
);

59 
	`CHECK
(
ts6_ªsu…
->
f
 == 5.55f + 1);

60 
	`CHECK
(
ts6_ªsu…
->
d
 == 6.66 + 1);

62 
	`‰ì
 (
ts6_ªsu…
);

63 
	`exô
(0);

64 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct7.c

8 
	~"ffôe°.h
"

11 
	mf1
;

12 
	mf2
;

13 
	md
;

14 } 
	tã°_°ru˘uª_7
;

16 
ã°_°ru˘uª_7
 
ABI_ATTR
 
	$°ru˘7
 (
ã°_°ru˘uª_7
 
ts
)

18 
ts
.
f1
 += 1;

19 
ts
.
f2
 += 1;

20 
ts
.
d
 += 1;

22  
ts
;

23 
	}
}

25 
	$maö
 ()

27 
ffi_cif
 
cif
;

28 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

29 *
vÆues
[
MAX_ARGS
];

30 
ffi_ty≥
 
ts7_ty≥
;

31 
ffi_ty≥
 *
ts7_ty≥_ñemíts
[4];

33 
ã°_°ru˘uª_7
 
ts7_¨g
;

36 
ã°_°ru˘uª_7
 *
ts7_ªsu…
 =

37 (
ã°_°ru˘uª_7
 *Ë
	`mÆloc
 ((test_structure_7));

39 
ts7_ty≥
.
size
 = 0;

40 
ts7_ty≥
.
Æignmít
 = 0;

41 
ts7_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

42 
ts7_ty≥
.
ñemíts
 = 
ts7_ty≥_ñemíts
;

43 
ts7_ty≥_ñemíts
[0] = &
ffi_ty≥_Êﬂt
;

44 
ts7_ty≥_ñemíts
[1] = &
ffi_ty≥_Êﬂt
;

45 
ts7_ty≥_ñemíts
[2] = &
ffi_ty≥_doubÀ
;

46 
ts7_ty≥_ñemíts
[3] = 
NULL
;

48 
¨gs
[0] = &
ts7_ty≥
;

49 
vÆues
[0] = &
ts7_¨g
;

52 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1, &
ts7_ty≥
, 
¨gs
Ë=
FFI_OK
);

54 
ts7_¨g
.
f1
 = 5.55f;

55 
ts7_¨g
.
f2
 = 55.5f;

56 
ts7_¨g
.
d
 = 6.66;

58 
	`¥ötf
 ("%g\n", 
ts7_¨g
.
f1
);

59 
	`¥ötf
 ("%g\n", 
ts7_¨g
.
f2
);

60 
	`¥ötf
 ("%g\n", 
ts7_¨g
.
d
);

62 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
°ru˘7
), 
ts7_ªsu…
, 
vÆues
);

64 
	`¥ötf
 ("%g\n", 
ts7_ªsu…
->
f1
);

65 
	`¥ötf
 ("%g\n", 
ts7_ªsu…
->
f2
);

66 
	`¥ötf
 ("%g\n", 
ts7_ªsu…
->
d
);

68 
	`CHECK
(
ts7_ªsu…
->
f1
 == 5.55f + 1);

69 
	`CHECK
(
ts7_ªsu…
->
f2
 == 55.5f + 1);

70 
	`CHECK
(
ts7_ªsu…
->
d
 == 6.66 + 1);

72 
	`‰ì
 (
ts7_ªsu…
);

73 
	`exô
(0);

74 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct8.c

8 
	~"ffôe°.h
"

11 
	mf1
;

12 
	mf2
;

13 
	mf3
;

14 
	mf4
;

15 } 
	tã°_°ru˘uª_8
;

17 
ã°_°ru˘uª_8
 
ABI_ATTR
 
	$°ru˘8
 (
ã°_°ru˘uª_8
 
ts
)

19 
ts
.
f1
 += 1;

20 
ts
.
f2
 += 1;

21 
ts
.
f3
 += 1;

22 
ts
.
f4
 += 1;

24  
ts
;

25 
	}
}

27 
	$maö
 ()

29 
ffi_cif
 
cif
;

30 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

31 *
vÆues
[
MAX_ARGS
];

32 
ffi_ty≥
 
ts8_ty≥
;

33 
ffi_ty≥
 *
ts8_ty≥_ñemíts
[5];

35 
ã°_°ru˘uª_8
 
ts8_¨g
;

38 
ã°_°ru˘uª_8
 *
ts8_ªsu…
 =

39 (
ã°_°ru˘uª_8
 *Ë
	`mÆloc
 ((test_structure_8));

41 
ts8_ty≥
.
size
 = 0;

42 
ts8_ty≥
.
Æignmít
 = 0;

43 
ts8_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

44 
ts8_ty≥
.
ñemíts
 = 
ts8_ty≥_ñemíts
;

45 
ts8_ty≥_ñemíts
[0] = &
ffi_ty≥_Êﬂt
;

46 
ts8_ty≥_ñemíts
[1] = &
ffi_ty≥_Êﬂt
;

47 
ts8_ty≥_ñemíts
[2] = &
ffi_ty≥_Êﬂt
;

48 
ts8_ty≥_ñemíts
[3] = &
ffi_ty≥_Êﬂt
;

49 
ts8_ty≥_ñemíts
[4] = 
NULL
;

51 
¨gs
[0] = &
ts8_ty≥
;

52 
vÆues
[0] = &
ts8_¨g
;

55 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1, &
ts8_ty≥
, 
¨gs
Ë=
FFI_OK
);

57 
ts8_¨g
.
f1
 = 5.55f;

58 
ts8_¨g
.
f2
 = 55.5f;

59 
ts8_¨g
.
f3
 = -5.55f;

60 
ts8_¨g
.
f4
 = -55.5f;

62 
	`¥ötf
 ("%g\n", 
ts8_¨g
.
f1
);

63 
	`¥ötf
 ("%g\n", 
ts8_¨g
.
f2
);

64 
	`¥ötf
 ("%g\n", 
ts8_¨g
.
f3
);

65 
	`¥ötf
 ("%g\n", 
ts8_¨g
.
f4
);

67 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
°ru˘8
), 
ts8_ªsu…
, 
vÆues
);

69 
	`¥ötf
 ("%g\n", 
ts8_ªsu…
->
f1
);

70 
	`¥ötf
 ("%g\n", 
ts8_ªsu…
->
f2
);

71 
	`¥ötf
 ("%g\n", 
ts8_ªsu…
->
f3
);

72 
	`¥ötf
 ("%g\n", 
ts8_ªsu…
->
f4
);

74 
	`CHECK
(
ts8_ªsu…
->
f1
 == 5.55f + 1);

75 
	`CHECK
(
ts8_ªsu…
->
f2
 == 55.5f + 1);

76 
	`CHECK
(
ts8_ªsu…
->
f3
 == -5.55f + 1);

77 
	`CHECK
(
ts8_ªsu…
->
f4
 == -55.5f + 1);

79 
	`‰ì
 (
ts8_ªsu…
);

80 
	`exô
(0);

81 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct9.c

8 
	~"ffôe°.h
"

12 
	mf
;

13 
	mi
;

14 } 
	tã°_°ru˘uª_9
;

16 
ã°_°ru˘uª_9
 
ABI_ATTR
 
	$°ru˘9
 (
ã°_°ru˘uª_9
 
ts
)

18 
ts
.
f
 += 1;

19 
ts
.
i
 += 1;

21  
ts
;

22 
	}
}

24 
	$maö
 ()

26 
ffi_cif
 
cif
;

27 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

28 *
vÆues
[
MAX_ARGS
];

29 
ffi_ty≥
 
ts9_ty≥
;

30 
ffi_ty≥
 *
ts9_ty≥_ñemíts
[3];

32 
ã°_°ru˘uª_9
 
ts9_¨g
;

35 
ã°_°ru˘uª_9
 *
ts9_ªsu…
 =

36 (
ã°_°ru˘uª_9
 *Ë
	`mÆloc
 ((test_structure_9));

38 
ts9_ty≥
.
size
 = 0;

39 
ts9_ty≥
.
Æignmít
 = 0;

40 
ts9_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

41 
ts9_ty≥
.
ñemíts
 = 
ts9_ty≥_ñemíts
;

42 
ts9_ty≥_ñemíts
[0] = &
ffi_ty≥_Êﬂt
;

43 
ts9_ty≥_ñemíts
[1] = &
ffi_ty≥_söt
;

44 
ts9_ty≥_ñemíts
[2] = 
NULL
;

46 
¨gs
[0] = &
ts9_ty≥
;

47 
vÆues
[0] = &
ts9_¨g
;

50 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
ABI_NUM
, 1, &
ts9_ty≥
, 
¨gs
Ë=
FFI_OK
);

52 
ts9_¨g
.
f
 = 5.55f;

53 
ts9_¨g
.
i
 = 5;

55 
	`¥ötf
 ("%g\n", 
ts9_¨g
.
f
);

56 
	`¥ötf
 ("%d\n", 
ts9_¨g
.
i
);

58 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
°ru˘9
), 
ts9_ªsu…
, 
vÆues
);

60 
	`¥ötf
 ("%g\n", 
ts9_ªsu…
->
f
);

61 
	`¥ötf
 ("%d\n", 
ts9_ªsu…
->
i
);

63 
	`CHECK
(
ts9_ªsu…
->
f
 == 5.55f + 1);

64 
	`CHECK
(
ts9_ªsu…
->
i
 == 5 + 1);

66 
	`‰ì
 (
ts9_ªsu…
);

67 
	`exô
(0);

68 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/testclosure.c

8 
	~"ffôe°.h
"

10 
	s˛s_°ru˘_comböed
 {

11 
	ma
;

12 
	mb
;

13 
	mc
;

14 
	md
;

15 } 
	t˛s_°ru˘_comböed
;

17 
	$˛s_°ru˘_comböed_‚
(
˛s_°ru˘_comböed
 
¨g
)

19 
	`¥ötf
("%g %g %g %g\n",

20 
¨g
.
a
,árg.
b
,

21 
¨g
.
c
,árg.
d
);

22 
	`fÊush
(
°dout
);

23 
	}
}

26 
	$˛s_°ru˘_comböed_gn
(
ffi_cif
* 
cif
 
__UNUSED__
, * 
ª•
 __UNUSED__,

27 ** 
¨gs
, * 
u£rd©a
 
__UNUSED__
)

29 
˛s_°ru˘_comböed
 
a0
;

31 
a0
 = *(
˛s_°ru˘_comböed
*)(
¨gs
[0]);

33 
	`˛s_°ru˘_comböed_‚
(
a0
);

34 
	}
}

37 
	$maö
 ()

39 
ffi_cif
 
cif
;

40 *
code
;

41 
ffi_˛osuª
 *
p˛
 = 
	`ffi_˛osuª_Æloc
((ffi_˛osuª), &
code
);

42 
ffi_ty≥
* 
˛s_°ru˘_fõlds0
[5];

43 
ffi_ty≥
 
˛s_°ru˘_ty≥0
;

44 
ffi_ty≥
* 
dbl_¨g_ty≥s
[5];

46 
˛s_°ru˘_comböed
 
g_dbl
 = {4.0, 5.0, 1.0, 8.0};

48 
˛s_°ru˘_ty≥0
.
size
 = 0;

49 
˛s_°ru˘_ty≥0
.
Æignmít
 = 0;

50 
˛s_°ru˘_ty≥0
.
ty≥
 = 
FFI_TYPE_STRUCT
;

51 
˛s_°ru˘_ty≥0
.
ñemíts
 = 
˛s_°ru˘_fõlds0
;

53 
˛s_°ru˘_fõlds0
[0] = &
ffi_ty≥_Êﬂt
;

54 
˛s_°ru˘_fõlds0
[1] = &
ffi_ty≥_Êﬂt
;

55 
˛s_°ru˘_fõlds0
[2] = &
ffi_ty≥_Êﬂt
;

56 
˛s_°ru˘_fõlds0
[3] = &
ffi_ty≥_Êﬂt
;

57 
˛s_°ru˘_fõlds0
[4] = 
NULL
;

59 
dbl_¨g_ty≥s
[0] = &
˛s_°ru˘_ty≥0
;

60 
dbl_¨g_ty≥s
[1] = 
NULL
;

62 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1, &
ffi_ty≥_void
,

63 
dbl_¨g_ty≥s
Ë=
FFI_OK
);

65 
	`CHECK
(
	`ffi_¥ï_˛osuª_loc
(
p˛
, &
cif
, 
˛s_°ru˘_comböed_gn
, 
NULL
, 
code
Ë=
FFI_OK
);

67 (((*)(
˛s_°ru˘_comböed
)Ë(
code
))(
g_dbl
);

69 
	`exô
(0);

70 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/uninitialized.c

2 
	~"ffôe°.h
"

6 
	muc
;

7 
	md
;

8 
	mui
;

9 } 
	tã°_°ru˘uª_1
;

11 
ã°_°ru˘uª_1
 
	$°ru˘1
(
ã°_°ru˘uª_1
 
ts
)

13 
ts
.
uc
++;

14 
ts
.
d
--;

15 
ts
.
ui
++;

17  
ts
;

18 
	}
}

20 
	$maö
 ()

22 
ffi_cif
 
cif
;

23 
ffi_ty≥
 *
¨gs
[
MAX_ARGS
];

24 *
vÆues
[
MAX_ARGS
];

25 
ffi_ty≥
 
ts1_ty≥
;

26 
ffi_ty≥
 *
ts1_ty≥_ñemíts
[4];

28 
	`mem£t
(&
cif
, 1, (cif));

29 
ts1_ty≥
.
size
 = 0;

30 
ts1_ty≥
.
Æignmít
 = 0;

31 
ts1_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

32 
ts1_ty≥
.
ñemíts
 = 
ts1_ty≥_ñemíts
;

33 
ts1_ty≥_ñemíts
[0] = &
ffi_ty≥_uch¨
;

34 
ts1_ty≥_ñemíts
[1] = &
ffi_ty≥_doubÀ
;

35 
ts1_ty≥_ñemíts
[2] = &
ffi_ty≥_uöt
;

36 
ts1_ty≥_ñemíts
[3] = 
NULL
;

38 
ã°_°ru˘uª_1
 
ts1_¨g
;

40 
ã°_°ru˘uª_1
 *
ts1_ªsu…
 =

41 (
ã°_°ru˘uª_1
 *Ë
	`mÆloc
 ((test_structure_1));

43 
¨gs
[0] = &
ts1_ty≥
;

44 
vÆues
[0] = &
ts1_¨g
;

47 
	`CHECK
(
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 1,

48 &
ts1_ty≥
, 
¨gs
Ë=
FFI_OK
);

50 
ts1_¨g
.
uc
 = '\x01';

51 
ts1_¨g
.
d
 = 3.14159;

52 
ts1_¨g
.
ui
 = 555;

54 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
°ru˘1
), 
ts1_ªsu…
, 
vÆues
);

56 
	`CHECK
(
ts1_ªsu…
->
ui
 == 556);

57 
	`CHECK
(
ts1_ªsu…
->
d
 == 3.14159 - 1);

59 
	`‰ì
 (
ts1_ªsu…
);

60 
	`exô
(0);

61 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/va_1.c

10 
	~"ffôe°.h
"

11 
	~<°d¨g.h
>

13 
	ssmÆl_èg


15 
	ma
;

16 
	mb
;

19 
	sœrge_èg


21 
	ma
;

22 
	mb
;

23 
	mc
;

24 
	md
;

25 
	me
;

29 
	$ã°_‚
 (
n
, ...)

31 
va_li°
 
≠
;

32 
smÆl_èg
 
s1
;

33 
smÆl_èg
 
s2
;

34 
œrge_èg
 
l
;

35 
uc
;

36 sig√d 
sc
;

37 
us
;

38 sig√d 
ss
;

39 
ui
;

40 sig√d 
si
;

41 
ul
;

42 sig√d 
¶
;

43 
f
;

44 
d
;

46 
	`va_°¨t
 (
≠
, 
n
);

47 
s1
 = 
	`va_¨g
 (
≠
, 
smÆl_èg
);

48 
l
 = 
	`va_¨g
 (
≠
, 
œrge_èg
);

49 
s2
 = 
	`va_¨g
 (
≠
, 
smÆl_èg
);

51 
uc
 = 
	`va_¨g
 (
≠
, );

52 
sc
 = 
	`va_¨g
 (
≠
, signed);

54 
us
 = 
	`va_¨g
 (
≠
, );

55 
ss
 = 
	`va_¨g
 (
≠
, signed);

57 
ui
 = 
	`va_¨g
 (
≠
, );

58 
si
 = 
	`va_¨g
 (
≠
, signed );

60 
ul
 = 
	`va_¨g
 (
≠
, );

61 
¶
 = 
	`va_¨g
 (
≠
, signed );

63 
f
 = 
	`va_¨g
 (
≠
, );

65 
d
 = 
	`va_¨g
 (
≠
, );

67 
	`¥ötf
 ("%u %u %u %u %u %u %u %u %u uc=%u sc=%d %u %d %u %d %lu %ld %f %f\n",

68 
s1
.
a
, s1.
b
, 
l
.a,Ü.b,Ü.
c
,Ü.
d
,Ü.
e
,

69 
s2
.
a
, s2.
b
,

70 
uc
, 
sc
,

71 
us
, 
ss
,

72 
ui
, 
si
,

73 
ul
, 
¶
,

74 
f
, 
d
);

75 
	`va_íd
 (
≠
);

76  
n
 + 1;

77 
	}
}

80 
	$maö
 ()

82 
ffi_cif
 
cif
;

83 * 
¨gs
[15];

84 
ffi_ty≥
* 
¨g_ty≥s
[15];

86 
ffi_ty≥
 
s_ty≥
;

87 
ffi_ty≥
 *
s_ty≥_ñemíts
[3];

89 
ffi_ty≥
 
l_ty≥
;

90 
ffi_ty≥
 *
l_ty≥_ñemíts
[6];

92 
smÆl_èg
 
s1
;

93 
smÆl_èg
 
s2
;

94 
œrge_èg
 
l1
;

96 
n
;

97 
ffi_¨g
 
ªs
;

99 
uc
;

100 sig√d 
sc
;

101 
us
;

102 sig√d 
ss
;

103 
ui
;

104 sig√d 
si
;

105 
ul
;

106 sig√d 
¶
;

107 
d1
;

108 
f1
;

110 
s_ty≥
.
size
 = 0;

111 
s_ty≥
.
Æignmít
 = 0;

112 
s_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

113 
s_ty≥
.
ñemíts
 = 
s_ty≥_ñemíts
;

115 
s_ty≥_ñemíts
[0] = &
ffi_ty≥_uch¨
;

116 
s_ty≥_ñemíts
[1] = &
ffi_ty≥_uch¨
;

117 
s_ty≥_ñemíts
[2] = 
NULL
;

119 
l_ty≥
.
size
 = 0;

120 
l_ty≥
.
Æignmít
 = 0;

121 
l_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

122 
l_ty≥
.
ñemíts
 = 
l_ty≥_ñemíts
;

124 
l_ty≥_ñemíts
[0] = &
ffi_ty≥_uöt
;

125 
l_ty≥_ñemíts
[1] = &
ffi_ty≥_uöt
;

126 
l_ty≥_ñemíts
[2] = &
ffi_ty≥_uöt
;

127 
l_ty≥_ñemíts
[3] = &
ffi_ty≥_uöt
;

128 
l_ty≥_ñemíts
[4] = &
ffi_ty≥_uöt
;

129 
l_ty≥_ñemíts
[5] = 
NULL
;

131 
¨g_ty≥s
[0] = &
ffi_ty≥_söt
;

132 
¨g_ty≥s
[1] = &
s_ty≥
;

133 
¨g_ty≥s
[2] = &
l_ty≥
;

134 
¨g_ty≥s
[3] = &
s_ty≥
;

135 
¨g_ty≥s
[4] = &
ffi_ty≥_uch¨
;

136 
¨g_ty≥s
[5] = &
ffi_ty≥_sch¨
;

137 
¨g_ty≥s
[6] = &
ffi_ty≥_ush‹t
;

138 
¨g_ty≥s
[7] = &
ffi_ty≥_ssh‹t
;

139 
¨g_ty≥s
[8] = &
ffi_ty≥_uöt
;

140 
¨g_ty≥s
[9] = &
ffi_ty≥_söt
;

141 
¨g_ty≥s
[10] = &
ffi_ty≥_ul⁄g
;

142 
¨g_ty≥s
[11] = &
ffi_ty≥_¶⁄g
;

143 
¨g_ty≥s
[12] = &
ffi_ty≥_doubÀ
;

144 
¨g_ty≥s
[13] = &
ffi_ty≥_doubÀ
;

145 
¨g_ty≥s
[14] = 
NULL
;

147 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 14, &
ffi_ty≥_söt
, 
¨g_ty≥s
Ë=
FFI_OK
);

149 
s1
.
a
 = 5;

150 
s1
.
b
 = 6;

152 
l1
.
a
 = 10;

153 
l1
.
b
 = 11;

154 
l1
.
c
 = 12;

155 
l1
.
d
 = 13;

156 
l1
.
e
 = 14;

158 
s2
.
a
 = 7;

159 
s2
.
b
 = 8;

161 
n
 = 41;

163 
uc
 = 9;

164 
sc
 = 10;

165 
us
 = 11;

166 
ss
 = 12;

167 
ui
 = 13;

168 
si
 = 14;

169 
ul
 = 15;

170 
¶
 = 16;

171 
f1
 = 2.12;

172 
d1
 = 3.13;

174 
¨gs
[0] = &
n
;

175 
¨gs
[1] = &
s1
;

176 
¨gs
[2] = &
l1
;

177 
¨gs
[3] = &
s2
;

178 
¨gs
[4] = &
uc
;

179 
¨gs
[5] = &
sc
;

180 
¨gs
[6] = &
us
;

181 
¨gs
[7] = &
ss
;

182 
¨gs
[8] = &
ui
;

183 
¨gs
[9] = &
si
;

184 
¨gs
[10] = &
ul
;

185 
¨gs
[11] = &
¶
;

186 
¨gs
[12] = &
f1
;

187 
¨gs
[13] = &
d1
;

188 
¨gs
[14] = 
NULL
;

190 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_‚
), &
ªs
, 
¨gs
);

192 
	`¥ötf
("ªs: %d\n", (Ë
ªs
);

196 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/va_struct1.c

10 
	~"ffôe°.h
"

11 
	~<°d¨g.h
>

13 
	ssmÆl_èg


15 
	ma
;

16 
	mb
;

19 
	sœrge_èg


21 
	ma
;

22 
	mb
;

23 
	mc
;

24 
	md
;

25 
	me
;

29 
	$ã°_‚
 (
n
, ...)

31 
va_li°
 
≠
;

32 
smÆl_èg
 
s1
;

33 
smÆl_èg
 
s2
;

34 
œrge_èg
 
l
;

36 
	`va_°¨t
 (
≠
, 
n
);

37 
s1
 = 
	`va_¨g
 (
≠
, 
smÆl_èg
);

38 
l
 = 
	`va_¨g
 (
≠
, 
œrge_èg
);

39 
s2
 = 
	`va_¨g
 (
≠
, 
smÆl_èg
);

40 
	`¥ötf
 ("%u %u %u %u %u %u %u %u %u\n", 
s1
.
a
, s1.
b
, 
l
.a,Ü.b,Ü.
c
,Ü.
d
,Ü.
e
,

41 
s2
.
a
, s2.
b
);

42 
	`va_íd
 (
≠
);

43  
n
 + 1;

44 
	}
}

47 
	$maö
 ()

49 
ffi_cif
 
cif
;

50 * 
¨gs
[5];

51 
ffi_ty≥
* 
¨g_ty≥s
[5];

53 
ffi_ty≥
 
s_ty≥
;

54 
ffi_ty≥
 *
s_ty≥_ñemíts
[3];

56 
ffi_ty≥
 
l_ty≥
;

57 
ffi_ty≥
 *
l_ty≥_ñemíts
[6];

59 
smÆl_èg
 
s1
;

60 
smÆl_èg
 
s2
;

61 
œrge_èg
 
l1
;

63 
n
;

64 
ffi_¨g
 
ªs
;

66 
s_ty≥
.
size
 = 0;

67 
s_ty≥
.
Æignmít
 = 0;

68 
s_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

69 
s_ty≥
.
ñemíts
 = 
s_ty≥_ñemíts
;

71 
s_ty≥_ñemíts
[0] = &
ffi_ty≥_uch¨
;

72 
s_ty≥_ñemíts
[1] = &
ffi_ty≥_uch¨
;

73 
s_ty≥_ñemíts
[2] = 
NULL
;

75 
l_ty≥
.
size
 = 0;

76 
l_ty≥
.
Æignmít
 = 0;

77 
l_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

78 
l_ty≥
.
ñemíts
 = 
l_ty≥_ñemíts
;

80 
l_ty≥_ñemíts
[0] = &
ffi_ty≥_uöt
;

81 
l_ty≥_ñemíts
[1] = &
ffi_ty≥_uöt
;

82 
l_ty≥_ñemíts
[2] = &
ffi_ty≥_uöt
;

83 
l_ty≥_ñemíts
[3] = &
ffi_ty≥_uöt
;

84 
l_ty≥_ñemíts
[4] = &
ffi_ty≥_uöt
;

85 
l_ty≥_ñemíts
[5] = 
NULL
;

87 
¨g_ty≥s
[0] = &
ffi_ty≥_söt
;

88 
¨g_ty≥s
[1] = &
s_ty≥
;

89 
¨g_ty≥s
[2] = &
l_ty≥
;

90 
¨g_ty≥s
[3] = &
s_ty≥
;

91 
¨g_ty≥s
[4] = 
NULL
;

93 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 4, &
ffi_ty≥_söt
, 
¨g_ty≥s
Ë=
FFI_OK
);

95 
s1
.
a
 = 5;

96 
s1
.
b
 = 6;

98 
l1
.
a
 = 10;

99 
l1
.
b
 = 11;

100 
l1
.
c
 = 12;

101 
l1
.
d
 = 13;

102 
l1
.
e
 = 14;

104 
s2
.
a
 = 7;

105 
s2
.
b
 = 8;

107 
n
 = 41;

109 
¨gs
[0] = &
n
;

110 
¨gs
[1] = &
s1
;

111 
¨gs
[2] = &
l1
;

112 
¨gs
[3] = &
s2
;

113 
¨gs
[4] = 
NULL
;

115 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_‚
), &
ªs
, 
¨gs
);

117 
	`¥ötf
("ªs: %d\n", (Ë
ªs
);

121 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/va_struct2.c

10 
	~"ffôe°.h
"

11 
	~<°d¨g.h
>

13 
	ssmÆl_èg


15 
	ma
;

16 
	mb
;

19 
	sœrge_èg


21 
	ma
;

22 
	mb
;

23 
	mc
;

24 
	md
;

25 
	me
;

28 
smÆl_èg


29 
	$ã°_‚
 (
n
, ...)

31 
va_li°
 
≠
;

32 
smÆl_èg
 
s1
;

33 
smÆl_èg
 
s2
;

34 
œrge_èg
 
l
;

36 
	`va_°¨t
 (
≠
, 
n
);

37 
s1
 = 
	`va_¨g
 (
≠
, 
smÆl_èg
);

38 
l
 = 
	`va_¨g
 (
≠
, 
œrge_èg
);

39 
s2
 = 
	`va_¨g
 (
≠
, 
smÆl_èg
);

40 
	`¥ötf
 ("%u %u %u %u %u %u %u %u %u\n", 
s1
.
a
, s1.
b
, 
l
.a,Ü.b,Ü.
c
,Ü.
d
,Ü.
e
,

41 
s2
.
a
, s2.
b
);

42 
	`va_íd
 (
≠
);

43 
s1
.
a
 +
s2
.a;

44 
s1
.
b
 +
s2
.b;

45  
s1
;

46 
	}
}

49 
	$maö
 ()

51 
ffi_cif
 
cif
;

52 * 
¨gs
[5];

53 
ffi_ty≥
* 
¨g_ty≥s
[5];

55 
ffi_ty≥
 
s_ty≥
;

56 
ffi_ty≥
 *
s_ty≥_ñemíts
[3];

58 
ffi_ty≥
 
l_ty≥
;

59 
ffi_ty≥
 *
l_ty≥_ñemíts
[6];

61 
smÆl_èg
 
s1
;

62 
smÆl_èg
 
s2
;

63 
œrge_èg
 
l1
;

65 
n
;

66 
smÆl_èg
 
ªs
;

68 
s_ty≥
.
size
 = 0;

69 
s_ty≥
.
Æignmít
 = 0;

70 
s_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

71 
s_ty≥
.
ñemíts
 = 
s_ty≥_ñemíts
;

73 
s_ty≥_ñemíts
[0] = &
ffi_ty≥_uch¨
;

74 
s_ty≥_ñemíts
[1] = &
ffi_ty≥_uch¨
;

75 
s_ty≥_ñemíts
[2] = 
NULL
;

77 
l_ty≥
.
size
 = 0;

78 
l_ty≥
.
Æignmít
 = 0;

79 
l_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

80 
l_ty≥
.
ñemíts
 = 
l_ty≥_ñemíts
;

82 
l_ty≥_ñemíts
[0] = &
ffi_ty≥_uöt
;

83 
l_ty≥_ñemíts
[1] = &
ffi_ty≥_uöt
;

84 
l_ty≥_ñemíts
[2] = &
ffi_ty≥_uöt
;

85 
l_ty≥_ñemíts
[3] = &
ffi_ty≥_uöt
;

86 
l_ty≥_ñemíts
[4] = &
ffi_ty≥_uöt
;

87 
l_ty≥_ñemíts
[5] = 
NULL
;

89 
¨g_ty≥s
[0] = &
ffi_ty≥_söt
;

90 
¨g_ty≥s
[1] = &
s_ty≥
;

91 
¨g_ty≥s
[2] = &
l_ty≥
;

92 
¨g_ty≥s
[3] = &
s_ty≥
;

93 
¨g_ty≥s
[4] = 
NULL
;

95 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 4, &
s_ty≥
, 
¨g_ty≥s
Ë=
FFI_OK
);

97 
s1
.
a
 = 5;

98 
s1
.
b
 = 6;

100 
l1
.
a
 = 10;

101 
l1
.
b
 = 11;

102 
l1
.
c
 = 12;

103 
l1
.
d
 = 13;

104 
l1
.
e
 = 14;

106 
s2
.
a
 = 7;

107 
s2
.
b
 = 8;

109 
n
 = 41;

111 
¨gs
[0] = &
n
;

112 
¨gs
[1] = &
s1
;

113 
¨gs
[2] = &
l1
;

114 
¨gs
[3] = &
s2
;

115 
¨gs
[4] = 
NULL
;

117 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_‚
), &
ªs
, 
¨gs
);

119 
	`¥ötf
("ªs: %d %d\n", 
ªs
.
a
,Ñes.
b
);

123 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/va_struct3.c

10 
	~"ffôe°.h
"

11 
	~<°d¨g.h
>

13 
	ssmÆl_èg


15 
	ma
;

16 
	mb
;

19 
	sœrge_èg


21 
	ma
;

22 
	mb
;

23 
	mc
;

24 
	md
;

25 
	me
;

28 
œrge_èg


29 
	$ã°_‚
 (
n
, ...)

31 
va_li°
 
≠
;

32 
smÆl_èg
 
s1
;

33 
smÆl_èg
 
s2
;

34 
œrge_èg
 
l
;

36 
	`va_°¨t
 (
≠
, 
n
);

37 
s1
 = 
	`va_¨g
 (
≠
, 
smÆl_èg
);

38 
l
 = 
	`va_¨g
 (
≠
, 
œrge_èg
);

39 
s2
 = 
	`va_¨g
 (
≠
, 
smÆl_èg
);

40 
	`¥ötf
 ("%u %u %u %u %u %u %u %u %u\n", 
s1
.
a
, s1.
b
, 
l
.a,Ü.b,Ü.
c
,Ü.
d
,Ü.
e
,

41 
s2
.
a
, s2.
b
);

42 
	`va_íd
 (
≠
);

43 
l
.
a
 +
s1
.a;

44 
l
.
b
 +
s1
.b;

45 
l
.
c
 +
s2
.
a
;

46 
l
.
d
 +
s2
.
b
;

47  
l
;

48 
	}
}

51 
	$maö
 ()

53 
ffi_cif
 
cif
;

54 * 
¨gs
[5];

55 
ffi_ty≥
* 
¨g_ty≥s
[5];

57 
ffi_ty≥
 
s_ty≥
;

58 
ffi_ty≥
 *
s_ty≥_ñemíts
[3];

60 
ffi_ty≥
 
l_ty≥
;

61 
ffi_ty≥
 *
l_ty≥_ñemíts
[6];

63 
smÆl_èg
 
s1
;

64 
smÆl_èg
 
s2
;

65 
œrge_èg
 
l1
;

67 
n
;

68 
œrge_èg
 
ªs
;

70 
s_ty≥
.
size
 = 0;

71 
s_ty≥
.
Æignmít
 = 0;

72 
s_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

73 
s_ty≥
.
ñemíts
 = 
s_ty≥_ñemíts
;

75 
s_ty≥_ñemíts
[0] = &
ffi_ty≥_uch¨
;

76 
s_ty≥_ñemíts
[1] = &
ffi_ty≥_uch¨
;

77 
s_ty≥_ñemíts
[2] = 
NULL
;

79 
l_ty≥
.
size
 = 0;

80 
l_ty≥
.
Æignmít
 = 0;

81 
l_ty≥
.
ty≥
 = 
FFI_TYPE_STRUCT
;

82 
l_ty≥
.
ñemíts
 = 
l_ty≥_ñemíts
;

84 
l_ty≥_ñemíts
[0] = &
ffi_ty≥_uöt
;

85 
l_ty≥_ñemíts
[1] = &
ffi_ty≥_uöt
;

86 
l_ty≥_ñemíts
[2] = &
ffi_ty≥_uöt
;

87 
l_ty≥_ñemíts
[3] = &
ffi_ty≥_uöt
;

88 
l_ty≥_ñemíts
[4] = &
ffi_ty≥_uöt
;

89 
l_ty≥_ñemíts
[5] = 
NULL
;

91 
¨g_ty≥s
[0] = &
ffi_ty≥_söt
;

92 
¨g_ty≥s
[1] = &
s_ty≥
;

93 
¨g_ty≥s
[2] = &
l_ty≥
;

94 
¨g_ty≥s
[3] = &
s_ty≥
;

95 
¨g_ty≥s
[4] = 
NULL
;

97 
	`CHECK
(
	`ffi_¥ï_cif_v¨
(&
cif
, 
FFI_DEFAULT_ABI
, 1, 4, &
l_ty≥
, 
¨g_ty≥s
Ë=
FFI_OK
);

99 
s1
.
a
 = 5;

100 
s1
.
b
 = 6;

102 
l1
.
a
 = 10;

103 
l1
.
b
 = 11;

104 
l1
.
c
 = 12;

105 
l1
.
d
 = 13;

106 
l1
.
e
 = 14;

108 
s2
.
a
 = 7;

109 
s2
.
b
 = 8;

111 
n
 = 41;

113 
¨gs
[0] = &
n
;

114 
¨gs
[1] = &
s1
;

115 
¨gs
[2] = &
l1
;

116 
¨gs
[3] = &
s2
;

117 
¨gs
[4] = 
NULL
;

119 
	`ffi_ˇŒ
(&
cif
, 
	`FFI_FN
(
ã°_‚
), &
ªs
, 
¨gs
);

121 
	`¥ötf
("ªs: %d %d %d %d %d\n", 
ªs
.
a
,Ñes.
b
,Ñes.
c
,Ñes.
d
,Ñes.
e
);

125 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/x86_64-unknown-linux-gnu/fficonfig.h

16 
	#EH_FRAME_FLAGS
 "a"

	)

37 
	#HAVE_ALLOCA
 1

	)

41 
	#HAVE_ALLOCA_H
 1

	)

44 
	#HAVE_AS_ASCII_PSEUDO_OP
 1

	)

47 
	#HAVE_AS_CFI_PSEUDO_OP
 1

	)

57 
	#HAVE_AS_STRING_PSEUDO_OP
 1

	)

60 
	#HAVE_AS_X86_64_UNWIND_SECTION_TYPE
 1

	)

63 
	#HAVE_AS_X86_PCREL
 1

	)

66 
	#HAVE_DLFCN_H
 1

	)

69 
	#HAVE_HIDDEN_VISIBILITY_ATTRIBUTE
 1

	)

72 
	#HAVE_INTTYPES_H
 1

	)

75 
	#HAVE_LONG_DOUBLE
 1

	)

81 
	#HAVE_MEMCPY
 1

	)

84 
	#HAVE_MEMORY_H
 1

	)

87 
	#HAVE_MKOSTEMP
 1

	)

90 
	#HAVE_MMAP
 1

	)

93 
	#HAVE_MMAP_ANON
 1

	)

96 
	#HAVE_MMAP_DEV_ZERO
 1

	)

99 
	#HAVE_MMAP_FILE
 1

	)

102 
	#HAVE_RO_EH_FRAME
 1

	)

105 
	#HAVE_STDINT_H
 1

	)

108 
	#HAVE_STDLIB_H
 1

	)

111 
	#HAVE_STRINGS_H
 1

	)

114 
	#HAVE_STRING_H
 1

	)

117 
	#HAVE_SYS_MMAN_H
 1

	)

120 
	#HAVE_SYS_STAT_H
 1

	)

123 
	#HAVE_SYS_TYPES_H
 1

	)

126 
	#HAVE_UNISTD_H
 1

	)

130 
	#LT_OBJDIR
 ".libs/"

	)

136 
	#PACKAGE
 "libffi"

	)

139 
	#PACKAGE_BUGREPORT
 "hâp://gôhub.com/©gªí/libffi/issues"

	)

142 
	#PACKAGE_NAME
 "libffi"

	)

145 
	#PACKAGE_STRING
 "libffò3.2.1"

	)

148 
	#PACKAGE_TARNAME
 "libffi"

	)

151 
	#PACKAGE_URL
 ""

	)

154 
	#PACKAGE_VERSION
 "3.2.1"

	)

157 
	#SIZEOF_DOUBLE
 8

	)

160 
	#SIZEOF_LONG_DOUBLE
 16

	)

163 
	#SIZEOF_SIZE_T
 8

	)

174 
	#STDC_HEADERS
 1

	)

184 
	#VERSION
 "3.2.1"

	)

188 #i‡
deföed
 
AC_APPLE_UNIVERSAL_BUILD


189 #i‡
deföed
 
__BIG_ENDIAN__


190 
	#WORDS_BIGENDIAN
 1

	)

193 #i‚de‡
WORDS_BIGENDIAN


202 #ifde‡
HAVE_HIDDEN_VISIBILITY_ATTRIBUTE


203 #ifde‡
LIBFFI_ASM


204 
	#FFI_HIDDEN
(
«me
Ë.
hiddí
 
	)
name

206 
	#FFI_HIDDEN
 
	`__©åibuã__
 ((
	`visibûôy
 ("hiddí")))

	)

209 #ifde‡
LIBFFI_ASM


210 
	#FFI_HIDDEN
(
«me
)

	)

212 
	#FFI_HIDDEN


	)

	@/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/x86_64-unknown-linux-gnu/include/ffi.h

53 #i‚de‡
LIBFFI_H


54 
	#LIBFFI_H


	)

56 #ifde‡
__˝lu•lus


61 #i‚de‡
X86_64


62 
	#X86_64


	)

67 
	~<ffô¨gë.h
>

69 #i‚de‡
LIBFFI_ASM


71 #i‡
deföed
(
_MSC_VER
Ë&& !deföed(
__˛™g__
)

72 
	#__©åibuã__
(
X
)

	)

75 
	~<°ddef.h
>

76 
	~<limôs.h
>

82 
	#FFI_64_BIT_MAX
 9223372036854775807

	)

84 #ifde‡
LONG_LONG_MAX


85 
	#FFI_LONG_LONG_MAX
 
LONG_LONG_MAX


	)

87 #ifde‡
LLONG_MAX


88 
	#FFI_LONG_LONG_MAX
 
LLONG_MAX


	)

89 #ifde‡
_AIX52


90 #unde‡
FFI_64_BIT_MAX


91 
	#FFI_64_BIT_MAX
 9223372036854775807LL

	)

94 #ifde‡
__GNUC__


95 
	#FFI_LONG_LONG_MAX
 
__LONG_LONG_MAX__


	)

97 #ifde‡
_AIX


98 #i‚de‡
__PPC64__


99 #i‡
deföed
 (
__IBMC__
Ë|| deföed (
__IBMCPP__
)

100 
	#FFI_LONG_LONG_MAX
 
LONGLONG_MAX


	)

103 #unde‡
FFI_64_BIT_MAX


104 
	#FFI_64_BIT_MAX
 9223372036854775807LL

	)

112 
	s_ffi_ty≥


114 
size_t
 
size
;

115 
Æignmít
;

116 
ty≥
;

117 
_ffi_ty≥
 **
ñemíts
;

118 } 
	tffi_ty≥
;

120 #i‚de‡
LIBFFI_HIDE_BASIC_TYPES


121 #i‡
SCHAR_MAX
 == 127

122 
	#ffi_ty≥_uch¨
 
ffi_ty≥_uöt8


	)

123 
	#ffi_ty≥_sch¨
 
ffi_ty≥_söt8


	)

128 #i‡
SHRT_MAX
 == 32767

129 
	#ffi_ty≥_ush‹t
 
ffi_ty≥_uöt16


	)

130 
	#ffi_ty≥_ssh‹t
 
ffi_ty≥_söt16


	)

131 #ñi‡
SHRT_MAX
 == 2147483647

132 
	#ffi_ty≥_ush‹t
 
ffi_ty≥_uöt32


	)

133 
	#ffi_ty≥_ssh‹t
 
ffi_ty≥_söt32


	)

138 #i‡
INT_MAX
 == 32767

139 
	#ffi_ty≥_uöt
 
ffi_ty≥_uöt16


	)

140 
	#ffi_ty≥_söt
 
ffi_ty≥_söt16


	)

141 #ñi‡
INT_MAX
 == 2147483647

142 
	#ffi_ty≥_uöt
 
ffi_ty≥_uöt32


	)

143 
	#ffi_ty≥_söt
 
ffi_ty≥_söt32


	)

144 #ñi‡
INT_MAX
 == 9223372036854775807

145 
	#ffi_ty≥_uöt
 
ffi_ty≥_uöt64


	)

146 
	#ffi_ty≥_söt
 
ffi_ty≥_söt64


	)

151 #i‡
LONG_MAX
 == 2147483647

152 #i‡
FFI_LONG_LONG_MAX
 !
FFI_64_BIT_MAX


155 #ñi‡
LONG_MAX
 !
FFI_64_BIT_MAX


159 #i‡
LONG_MAX
 == 2147483647

160 
	#ffi_ty≥_ul⁄g
 
ffi_ty≥_uöt32


	)

161 
	#ffi_ty≥_¶⁄g
 
ffi_ty≥_söt32


	)

162 #ñi‡
LONG_MAX
 =
FFI_64_BIT_MAX


163 
	#ffi_ty≥_ul⁄g
 
ffi_ty≥_uöt64


	)

164 
	#ffi_ty≥_¶⁄g
 
ffi_ty≥_söt64


	)

177 #i‡
deföed
 
_MSC_VER
 && !deföed 
FFI_BUILDING


178 
	#FFI_EXTERN
 
	`__de˛•ec
(
dŒimp‹t
)

	)

180 
	#FFI_EXTERN
 

	)

184 
FFI_EXTERN
 
ffi_ty≥
 
ffi_ty≥_void
;

185 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_uöt8
;

186 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_söt8
;

187 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_uöt16
;

188 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_söt16
;

189 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_uöt32
;

190 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_söt32
;

191 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_uöt64
;

192 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_söt64
;

193 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_Êﬂt
;

194 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_doubÀ
;

195 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_poöãr
;

198 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_l⁄gdoubÀ
;

200 
	#ffi_ty≥_l⁄gdoubÀ
 
ffi_ty≥_doubÀ


	)

203 #ifde‡
FFI_TARGET_HAS_COMPLEX_TYPE


204 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_com∂ex_Êﬂt
;

205 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_com∂ex_doubÀ
;

207 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_com∂ex_l⁄gdoubÀ
;

209 
	#ffi_ty≥_com∂ex_l⁄gdoubÀ
 
ffi_ty≥_com∂ex_doubÀ


	)

215 
	gFFI_OK
 = 0,

216 
	gFFI_BAD_TYPEDEF
,

217 
	gFFI_BAD_ABI


218 } 
	tffi_°©us
;

220 
	tFFI_TYPE
;

223 
ffi_abi
 
	gabi
;

224 
	g«rgs
;

225 
ffi_ty≥
 **
	g¨g_ty≥s
;

226 
ffi_ty≥
 *
	gπy≥
;

227 
	gbyãs
;

228 
	gÊags
;

229 #ifde‡
FFI_EXTRA_CIF_FIELDS


230 
	gFFI_EXTRA_CIF_FIELDS
;

232 } 
	tffi_cif
;

236 
ffi_¥ï_ty≥s
 (
ffi_abi
 
abi
);

240 
ffi_°©us
 
ffi_¥ï_cif_c‹e
(
ffi_cif
 *
cif
,

241 
ffi_abi
 
abi
,

242 
isv¨üdic
,

243 
nfixed¨gs
,

244 
¡ŸÆ¨gs
,

245 
ffi_ty≥
 *
πy≥
,

246 
ffi_ty≥
 **
©y≥s
);

250 #i‚de‡
FFI_SIZEOF_ARG


251 #i‡
LONG_MAX
 == 2147483647

252 
	#FFI_SIZEOF_ARG
 4

	)

253 #ñi‡
LONG_MAX
 =
FFI_64_BIT_MAX


254 
	#FFI_SIZEOF_ARG
 8

	)

258 #i‚de‡
FFI_SIZEOF_JAVA_RAW


259 
	#FFI_SIZEOF_JAVA_RAW
 
FFI_SIZEOF_ARG


	)

263 
ffi_ßrg
 
	gsöt
;

264 
ffi_¨g
 
	guöt
;

265 
	gÊt
;

266 
	gd©a
[
FFI_SIZEOF_ARG
];

267 * 
	g±r
;

268 } 
	tffi_øw
;

270 #i‡
FFI_SIZEOF_JAVA_RAW
 =4 && 
FFI_SIZEOF_ARG
 == 8

274 sig√d 
	gsöt
;

275 
	guöt
;

276 
	gÊt
;

277 
	gd©a
[
FFI_SIZEOF_JAVA_RAW
];

278 * 
	g±r
;

279 } 
	tffi_java_øw
;

281 
ffi_øw
 
	tffi_java_øw
;

285 
ffi_øw_ˇŒ
 (
ffi_cif
 *
cif
,

286 (*
‚
)(),

287 *
rvÆue
,

288 
ffi_øw
 *
avÆue
);

290 
ffi_±øºay_to_øw
 (
ffi_cif
 *
cif
, **
¨gs
, 
ffi_øw
 *
øw
);

291 
ffi_øw_to_±øºay
 (
ffi_cif
 *
cif
, 
ffi_øw
 *
øw
, **
¨gs
);

292 
size_t
 
ffi_øw_size
 (
ffi_cif
 *
cif
);

298 
ffi_java_øw_ˇŒ
 (
ffi_cif
 *
cif
,

299 (*
‚
)(),

300 *
rvÆue
,

301 
ffi_java_øw
 *
avÆue
);

303 
ffi_java_±øºay_to_øw
 (
ffi_cif
 *
cif
, **
¨gs
, 
ffi_java_øw
 *
øw
);

304 
ffi_java_øw_to_±øºay
 (
ffi_cif
 *
cif
, 
ffi_java_øw
 *
øw
, **
¨gs
);

305 
size_t
 
ffi_java_øw_size
 (
ffi_cif
 *
cif
);

309 #i‡
FFI_CLOSURES


311 #ifde‡
_MSC_VER


312 
__de˛•ec
(
Æign
(8))

316 *
	gåampﬁöe_èbÀ
;

317 *
	gåampﬁöe_èbÀ_íåy
;

319 
	gåamp
[
FFI_TRAMPOLINE_SIZE
];

321 
ffi_cif
 *
	gcif
;

322 (*
	gfun
)(
	gffi_cif
*,*,**,*);

323 *
	gu£r_d©a
;

324 #ifde‡
__GNUC__


325 } 
	tffi_˛osuª
 
	t__©åibuã__
((
	tÆig√d
 (8)));

327 } 
	gffi_˛osuª
;

328 #ifde‡
__sgi


329 #¥agm®
∑ck
 0

333 *
ffi_˛osuª_Æloc
 (
size_t
 
size
, **
code
);

334 
ffi_˛osuª_‰ì
 (*);

336 
ffi_°©us


337 
ffi_¥ï_˛osuª
 (
ffi_˛osuª
*,

338 
ffi_cif
 *,

339 (*
fun
)(
ffi_cif
*,*,**,*),

340 *
u£r_d©a
);

342 
ffi_°©us


343 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
*,

344 
ffi_cif
 *,

345 (*
fun
)(
ffi_cif
*,*,**,*),

346 *
u£r_d©a
,

347 *
codñoc
);

349 #ifde‡
__sgi


350 #¥agm®
∑ck
 8

354 *
	gåampﬁöe_èbÀ
;

355 *
	gåampﬁöe_èbÀ_íåy
;

357 
	gåamp
[
FFI_TRAMPOLINE_SIZE
];

359 
ffi_cif
 *
	gcif
;

361 #i‡!
FFI_NATIVE_RAW_API


367 (*
	gå™¶©e_¨gs
)(
	gffi_cif
*,*,**,*);

368 *
	gthis_˛osuª
;

372 (*
	gfun
)(
	gffi_cif
*,*,
	gffi_øw
*,*);

373 *
	gu£r_d©a
;

375 } 
	tffi_øw_˛osuª
;

379 *
	gåampﬁöe_èbÀ
;

380 *
	gåampﬁöe_èbÀ_íåy
;

382 
	gåamp
[
FFI_TRAMPOLINE_SIZE
];

385 
ffi_cif
 *
	gcif
;

387 #i‡!
FFI_NATIVE_RAW_API


393 (*
	gå™¶©e_¨gs
)(
	gffi_cif
*,*,**,*);

394 *
	gthis_˛osuª
;

398 (*
	gfun
)(
	gffi_cif
*,*,
	gffi_java_øw
*,*);

399 *
	gu£r_d©a
;

401 } 
	tffi_java_øw_˛osuª
;

403 
ffi_°©us


404 
ffi_¥ï_øw_˛osuª
 (
ffi_øw_˛osuª
*,

405 
ffi_cif
 *
cif
,

406 (*
fun
)(
ffi_cif
*,*,
ffi_øw
*,*),

407 *
u£r_d©a
);

409 
ffi_°©us


410 
ffi_¥ï_øw_˛osuª_loc
 (
ffi_øw_˛osuª
*,

411 
ffi_cif
 *
cif
,

412 (*
fun
)(
ffi_cif
*,*,
ffi_øw
*,*),

413 *
u£r_d©a
,

414 *
codñoc
);

416 
ffi_°©us


417 
ffi_¥ï_java_øw_˛osuª
 (
ffi_java_øw_˛osuª
*,

418 
ffi_cif
 *
cif
,

419 (*
fun
)(
ffi_cif
*,*,
ffi_java_øw
*,*),

420 *
u£r_d©a
);

422 
ffi_°©us


423 
ffi_¥ï_java_øw_˛osuª_loc
 (
ffi_java_øw_˛osuª
*,

424 
ffi_cif
 *
cif
,

425 (*
fun
)(
ffi_cif
*,*,
ffi_java_øw
*,*),

426 *
u£r_d©a
,

427 *
codñoc
);

433 
ffi_°©us
 
ffi_¥ï_cif
(
ffi_cif
 *
cif
,

434 
ffi_abi
 
abi
,

435 
«rgs
,

436 
ffi_ty≥
 *
πy≥
,

437 
ffi_ty≥
 **
©y≥s
);

439 
ffi_°©us
 
ffi_¥ï_cif_v¨
(
ffi_cif
 *
cif
,

440 
ffi_abi
 
abi
,

441 
nfixed¨gs
,

442 
¡ŸÆ¨gs
,

443 
ffi_ty≥
 *
πy≥
,

444 
ffi_ty≥
 **
©y≥s
);

446 
ffi_ˇŒ
(
ffi_cif
 *
cif
,

447 (*
‚
)(),

448 *
rvÆue
,

449 **
avÆue
);

452 
	#FFI_FN
(
f
Ë(((*)())f)

	)

459 
	#FFI_TYPE_VOID
 0

	)

460 
	#FFI_TYPE_INT
 1

	)

461 
	#FFI_TYPE_FLOAT
 2

	)

462 
	#FFI_TYPE_DOUBLE
 3

	)

464 
	#FFI_TYPE_LONGDOUBLE
 4

	)

466 
	#FFI_TYPE_LONGDOUBLE
 
FFI_TYPE_DOUBLE


	)

468 
	#FFI_TYPE_UINT8
 5

	)

469 
	#FFI_TYPE_SINT8
 6

	)

470 
	#FFI_TYPE_UINT16
 7

	)

471 
	#FFI_TYPE_SINT16
 8

	)

472 
	#FFI_TYPE_UINT32
 9

	)

473 
	#FFI_TYPE_SINT32
 10

	)

474 
	#FFI_TYPE_UINT64
 11

	)

475 
	#FFI_TYPE_SINT64
 12

	)

476 
	#FFI_TYPE_STRUCT
 13

	)

477 
	#FFI_TYPE_POINTER
 14

	)

478 
	#FFI_TYPE_COMPLEX
 15

	)

481 
	#FFI_TYPE_LAST
 
FFI_TYPE_COMPLEX


	)

483 #ifde‡
__˝lu•lus


	@/home/zilong/WorkSpace/ffi/libffi-test/libs/lib/libffi-3.2.1/include/ffi.h

53 #i‚de‡
LIBFFI_H


54 
	#LIBFFI_H


	)

56 #ifde‡
__˝lu•lus


61 #i‚de‡
X86_64


62 
	#X86_64


	)

67 
	~<ffô¨gë.h
>

69 #i‚de‡
LIBFFI_ASM


71 #i‡
deföed
(
_MSC_VER
Ë&& !deföed(
__˛™g__
)

72 
	#__©åibuã__
(
X
)

	)

75 
	~<°ddef.h
>

76 
	~<limôs.h
>

82 
	#FFI_64_BIT_MAX
 9223372036854775807

	)

84 #ifde‡
LONG_LONG_MAX


85 
	#FFI_LONG_LONG_MAX
 
LONG_LONG_MAX


	)

87 #ifde‡
LLONG_MAX


88 
	#FFI_LONG_LONG_MAX
 
LLONG_MAX


	)

89 #ifde‡
_AIX52


90 #unde‡
FFI_64_BIT_MAX


91 
	#FFI_64_BIT_MAX
 9223372036854775807LL

	)

94 #ifde‡
__GNUC__


95 
	#FFI_LONG_LONG_MAX
 
__LONG_LONG_MAX__


	)

97 #ifde‡
_AIX


98 #i‚de‡
__PPC64__


99 #i‡
deföed
 (
__IBMC__
Ë|| deföed (
__IBMCPP__
)

100 
	#FFI_LONG_LONG_MAX
 
LONGLONG_MAX


	)

103 #unde‡
FFI_64_BIT_MAX


104 
	#FFI_64_BIT_MAX
 9223372036854775807LL

	)

112 
	s_ffi_ty≥


114 
size_t
 
size
;

115 
Æignmít
;

116 
ty≥
;

117 
_ffi_ty≥
 **
ñemíts
;

118 } 
	tffi_ty≥
;

120 #i‚de‡
LIBFFI_HIDE_BASIC_TYPES


121 #i‡
SCHAR_MAX
 == 127

122 
	#ffi_ty≥_uch¨
 
ffi_ty≥_uöt8


	)

123 
	#ffi_ty≥_sch¨
 
ffi_ty≥_söt8


	)

128 #i‡
SHRT_MAX
 == 32767

129 
	#ffi_ty≥_ush‹t
 
ffi_ty≥_uöt16


	)

130 
	#ffi_ty≥_ssh‹t
 
ffi_ty≥_söt16


	)

131 #ñi‡
SHRT_MAX
 == 2147483647

132 
	#ffi_ty≥_ush‹t
 
ffi_ty≥_uöt32


	)

133 
	#ffi_ty≥_ssh‹t
 
ffi_ty≥_söt32


	)

138 #i‡
INT_MAX
 == 32767

139 
	#ffi_ty≥_uöt
 
ffi_ty≥_uöt16


	)

140 
	#ffi_ty≥_söt
 
ffi_ty≥_söt16


	)

141 #ñi‡
INT_MAX
 == 2147483647

142 
	#ffi_ty≥_uöt
 
ffi_ty≥_uöt32


	)

143 
	#ffi_ty≥_söt
 
ffi_ty≥_söt32


	)

144 #ñi‡
INT_MAX
 == 9223372036854775807

145 
	#ffi_ty≥_uöt
 
ffi_ty≥_uöt64


	)

146 
	#ffi_ty≥_söt
 
ffi_ty≥_söt64


	)

151 #i‡
LONG_MAX
 == 2147483647

152 #i‡
FFI_LONG_LONG_MAX
 !
FFI_64_BIT_MAX


155 #ñi‡
LONG_MAX
 !
FFI_64_BIT_MAX


159 #i‡
LONG_MAX
 == 2147483647

160 
	#ffi_ty≥_ul⁄g
 
ffi_ty≥_uöt32


	)

161 
	#ffi_ty≥_¶⁄g
 
ffi_ty≥_söt32


	)

162 #ñi‡
LONG_MAX
 =
FFI_64_BIT_MAX


163 
	#ffi_ty≥_ul⁄g
 
ffi_ty≥_uöt64


	)

164 
	#ffi_ty≥_¶⁄g
 
ffi_ty≥_söt64


	)

177 #i‡
deföed
 
_MSC_VER
 && !deföed 
FFI_BUILDING


178 
	#FFI_EXTERN
 
	`__de˛•ec
(
dŒimp‹t
)

	)

180 
	#FFI_EXTERN
 

	)

184 
FFI_EXTERN
 
ffi_ty≥
 
ffi_ty≥_void
;

185 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_uöt8
;

186 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_söt8
;

187 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_uöt16
;

188 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_söt16
;

189 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_uöt32
;

190 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_söt32
;

191 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_uöt64
;

192 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_söt64
;

193 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_Êﬂt
;

194 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_doubÀ
;

195 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_poöãr
;

198 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_l⁄gdoubÀ
;

200 
	#ffi_ty≥_l⁄gdoubÀ
 
ffi_ty≥_doubÀ


	)

203 #ifde‡
FFI_TARGET_HAS_COMPLEX_TYPE


204 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_com∂ex_Êﬂt
;

205 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_com∂ex_doubÀ
;

207 
FFI_EXTERN
 
ffi_ty≥
 
	gffi_ty≥_com∂ex_l⁄gdoubÀ
;

209 
	#ffi_ty≥_com∂ex_l⁄gdoubÀ
 
ffi_ty≥_com∂ex_doubÀ


	)

215 
	gFFI_OK
 = 0,

216 
	gFFI_BAD_TYPEDEF
,

217 
	gFFI_BAD_ABI


218 } 
	tffi_°©us
;

220 
	tFFI_TYPE
;

223 
ffi_abi
 
	gabi
;

224 
	g«rgs
;

225 
ffi_ty≥
 **
	g¨g_ty≥s
;

226 
ffi_ty≥
 *
	gπy≥
;

227 
	gbyãs
;

228 
	gÊags
;

229 #ifde‡
FFI_EXTRA_CIF_FIELDS


230 
	gFFI_EXTRA_CIF_FIELDS
;

232 } 
	tffi_cif
;

236 
ffi_¥ï_ty≥s
 (
ffi_abi
 
abi
);

240 
ffi_°©us
 
ffi_¥ï_cif_c‹e
(
ffi_cif
 *
cif
,

241 
ffi_abi
 
abi
,

242 
isv¨üdic
,

243 
nfixed¨gs
,

244 
¡ŸÆ¨gs
,

245 
ffi_ty≥
 *
πy≥
,

246 
ffi_ty≥
 **
©y≥s
);

250 #i‚de‡
FFI_SIZEOF_ARG


251 #i‡
LONG_MAX
 == 2147483647

252 
	#FFI_SIZEOF_ARG
 4

	)

253 #ñi‡
LONG_MAX
 =
FFI_64_BIT_MAX


254 
	#FFI_SIZEOF_ARG
 8

	)

258 #i‚de‡
FFI_SIZEOF_JAVA_RAW


259 
	#FFI_SIZEOF_JAVA_RAW
 
FFI_SIZEOF_ARG


	)

263 
ffi_ßrg
 
	gsöt
;

264 
ffi_¨g
 
	guöt
;

265 
	gÊt
;

266 
	gd©a
[
FFI_SIZEOF_ARG
];

267 * 
	g±r
;

268 } 
	tffi_øw
;

270 #i‡
FFI_SIZEOF_JAVA_RAW
 =4 && 
FFI_SIZEOF_ARG
 == 8

274 sig√d 
	gsöt
;

275 
	guöt
;

276 
	gÊt
;

277 
	gd©a
[
FFI_SIZEOF_JAVA_RAW
];

278 * 
	g±r
;

279 } 
	tffi_java_øw
;

281 
ffi_øw
 
	tffi_java_øw
;

285 
ffi_øw_ˇŒ
 (
ffi_cif
 *
cif
,

286 (*
‚
)(),

287 *
rvÆue
,

288 
ffi_øw
 *
avÆue
);

290 
ffi_±øºay_to_øw
 (
ffi_cif
 *
cif
, **
¨gs
, 
ffi_øw
 *
øw
);

291 
ffi_øw_to_±øºay
 (
ffi_cif
 *
cif
, 
ffi_øw
 *
øw
, **
¨gs
);

292 
size_t
 
ffi_øw_size
 (
ffi_cif
 *
cif
);

298 
ffi_java_øw_ˇŒ
 (
ffi_cif
 *
cif
,

299 (*
‚
)(),

300 *
rvÆue
,

301 
ffi_java_øw
 *
avÆue
);

303 
ffi_java_±øºay_to_øw
 (
ffi_cif
 *
cif
, **
¨gs
, 
ffi_java_øw
 *
øw
);

304 
ffi_java_øw_to_±øºay
 (
ffi_cif
 *
cif
, 
ffi_java_øw
 *
øw
, **
¨gs
);

305 
size_t
 
ffi_java_øw_size
 (
ffi_cif
 *
cif
);

309 #i‡
FFI_CLOSURES


311 #ifde‡
_MSC_VER


312 
__de˛•ec
(
Æign
(8))

316 *
	gåampﬁöe_èbÀ
;

317 *
	gåampﬁöe_èbÀ_íåy
;

319 
	gåamp
[
FFI_TRAMPOLINE_SIZE
];

321 
ffi_cif
 *
	gcif
;

322 (*
	gfun
)(
	gffi_cif
*,*,**,*);

323 *
	gu£r_d©a
;

324 #ifde‡
__GNUC__


325 } 
	tffi_˛osuª
 
	t__©åibuã__
((
	tÆig√d
 (8)));

327 } 
	gffi_˛osuª
;

328 #ifde‡
__sgi


329 #¥agm®
∑ck
 0

333 *
ffi_˛osuª_Æloc
 (
size_t
 
size
, **
code
);

334 
ffi_˛osuª_‰ì
 (*);

336 
ffi_°©us


337 
ffi_¥ï_˛osuª
 (
ffi_˛osuª
*,

338 
ffi_cif
 *,

339 (*
fun
)(
ffi_cif
*,*,**,*),

340 *
u£r_d©a
);

342 
ffi_°©us


343 
ffi_¥ï_˛osuª_loc
 (
ffi_˛osuª
*,

344 
ffi_cif
 *,

345 (*
fun
)(
ffi_cif
*,*,**,*),

346 *
u£r_d©a
,

347 *
codñoc
);

349 #ifde‡
__sgi


350 #¥agm®
∑ck
 8

354 *
	gåampﬁöe_èbÀ
;

355 *
	gåampﬁöe_èbÀ_íåy
;

357 
	gåamp
[
FFI_TRAMPOLINE_SIZE
];

359 
ffi_cif
 *
	gcif
;

361 #i‡!
FFI_NATIVE_RAW_API


367 (*
	gå™¶©e_¨gs
)(
	gffi_cif
*,*,**,*);

368 *
	gthis_˛osuª
;

372 (*
	gfun
)(
	gffi_cif
*,*,
	gffi_øw
*,*);

373 *
	gu£r_d©a
;

375 } 
	tffi_øw_˛osuª
;

379 *
	gåampﬁöe_èbÀ
;

380 *
	gåampﬁöe_èbÀ_íåy
;

382 
	gåamp
[
FFI_TRAMPOLINE_SIZE
];

385 
ffi_cif
 *
	gcif
;

387 #i‡!
FFI_NATIVE_RAW_API


393 (*
	gå™¶©e_¨gs
)(
	gffi_cif
*,*,**,*);

394 *
	gthis_˛osuª
;

398 (*
	gfun
)(
	gffi_cif
*,*,
	gffi_java_øw
*,*);

399 *
	gu£r_d©a
;

401 } 
	tffi_java_øw_˛osuª
;

403 
ffi_°©us


404 
ffi_¥ï_øw_˛osuª
 (
ffi_øw_˛osuª
*,

405 
ffi_cif
 *
cif
,

406 (*
fun
)(
ffi_cif
*,*,
ffi_øw
*,*),

407 *
u£r_d©a
);

409 
ffi_°©us


410 
ffi_¥ï_øw_˛osuª_loc
 (
ffi_øw_˛osuª
*,

411 
ffi_cif
 *
cif
,

412 (*
fun
)(
ffi_cif
*,*,
ffi_øw
*,*),

413 *
u£r_d©a
,

414 *
codñoc
);

416 
ffi_°©us


417 
ffi_¥ï_java_øw_˛osuª
 (
ffi_java_øw_˛osuª
*,

418 
ffi_cif
 *
cif
,

419 (*
fun
)(
ffi_cif
*,*,
ffi_java_øw
*,*),

420 *
u£r_d©a
);

422 
ffi_°©us


423 
ffi_¥ï_java_øw_˛osuª_loc
 (
ffi_java_øw_˛osuª
*,

424 
ffi_cif
 *
cif
,

425 (*
fun
)(
ffi_cif
*,*,
ffi_java_øw
*,*),

426 *
u£r_d©a
,

427 *
codñoc
);

433 
ffi_°©us
 
ffi_¥ï_cif
(
ffi_cif
 *
cif
,

434 
ffi_abi
 
abi
,

435 
«rgs
,

436 
ffi_ty≥
 *
πy≥
,

437 
ffi_ty≥
 **
©y≥s
);

439 
ffi_°©us
 
ffi_¥ï_cif_v¨
(
ffi_cif
 *
cif
,

440 
ffi_abi
 
abi
,

441 
nfixed¨gs
,

442 
¡ŸÆ¨gs
,

443 
ffi_ty≥
 *
πy≥
,

444 
ffi_ty≥
 **
©y≥s
);

446 
ffi_ˇŒ
(
ffi_cif
 *
cif
,

447 (*
‚
)(),

448 *
rvÆue
,

449 **
avÆue
);

452 
	#FFI_FN
(
f
Ë(((*)())f)

	)

459 
	#FFI_TYPE_VOID
 0

	)

460 
	#FFI_TYPE_INT
 1

	)

461 
	#FFI_TYPE_FLOAT
 2

	)

462 
	#FFI_TYPE_DOUBLE
 3

	)

464 
	#FFI_TYPE_LONGDOUBLE
 4

	)

466 
	#FFI_TYPE_LONGDOUBLE
 
FFI_TYPE_DOUBLE


	)

468 
	#FFI_TYPE_UINT8
 5

	)

469 
	#FFI_TYPE_SINT8
 6

	)

470 
	#FFI_TYPE_UINT16
 7

	)

471 
	#FFI_TYPE_SINT16
 8

	)

472 
	#FFI_TYPE_UINT32
 9

	)

473 
	#FFI_TYPE_SINT32
 10

	)

474 
	#FFI_TYPE_UINT64
 11

	)

475 
	#FFI_TYPE_SINT64
 12

	)

476 
	#FFI_TYPE_STRUCT
 13

	)

477 
	#FFI_TYPE_POINTER
 14

	)

478 
	#FFI_TYPE_COMPLEX
 15

	)

481 
	#FFI_TYPE_LAST
 
FFI_TYPE_COMPLEX


	)

483 #ifde‡
__˝lu•lus


	@/home/zilong/WorkSpace/ffi/libffi-test/libs/lib/libffi-3.2.1/include/ffitarget.h

30 #i‚de‡
LIBFFI_TARGET_H


31 
	#LIBFFI_TARGET_H


	)

33 #i‚de‡
LIBFFI_H


40 
	#X86_ANY


	)

42 #i‡
deföed
 (
X86_64
Ë&& deföed (
__i386__
)

43 #unde‡
X86_64


44 
	#X86


	)

47 #ifde‡
X86_WIN64


48 
	#FFI_SIZEOF_ARG
 8

	)

49 
	#USE_BUILTIN_FFS
 0

	)

52 
	#FFI_TARGET_SPECIFIC_STACK_SPACE_ALLOCATION


	)

53 
	#FFI_TARGET_HAS_COMPLEX_TYPE


	)

57 #i‚de‡
LIBFFI_ASM


58 #ifde‡
X86_WIN64


59 #ifde‡
_MSC_VER


60 
	t__öt64
 
	tffi_¨g
;

61 
__öt64
 
	tffi_ßrg
;

63 
	tffi_¨g
;

64 
	tffi_ßrg
;

67 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


68 
	#FFI_SIZEOF_ARG
 8

	)

69 
	#FFI_SIZEOF_JAVA_RAW
 4

	)

70 
	tffi_¨g
;

71 
	tffi_ßrg
;

73 
	tffi_¨g
;

74 sig√d 
	tffi_ßrg
;

78 
	effi_abi
 {

79 
	mFFI_FIRST_ABI
 = 0,

82 #ifde‡
X86_WIN32


83 
	mFFI_SYSV
,

84 
	mFFI_STDCALL
,

85 
	mFFI_THISCALL
,

86 
	mFFI_FASTCALL
,

87 
	mFFI_MS_CDECL
,

88 
	mFFI_PASCAL
,

89 
	mFFI_REGISTER
,

90 
	mFFI_LAST_ABI
,

91 #ifde‡
_MSC_VER


92 
	mFFI_DEFAULT_ABI
 = 
FFI_MS_CDECL


94 
FFI_DEFAULT_ABI
 = 
FFI_SYSV


97 #ñi‡
deföed
(
X86_WIN64
)

98 
FFI_WIN64
,

99 
	mFFI_LAST_ABI
,

100 
	mFFI_DEFAULT_ABI
 = 
FFI_WIN64


104 
FFI_SYSV
,

105 
	mFFI_UNIX64
,

106 
	mFFI_THISCALL
,

107 
	mFFI_FASTCALL
,

108 
	mFFI_STDCALL
,

109 
	mFFI_PASCAL
,

110 
	mFFI_REGISTER
,

111 
	mFFI_LAST_ABI
,

112 #i‡
deföed
(
__i386__
Ë|| deföed(
__i386
)

113 
	mFFI_DEFAULT_ABI
 = 
FFI_SYSV


115 
FFI_DEFAULT_ABI
 = 
FFI_UNIX64


118 } 
	tffi_abi
;

123 
	#FFI_CLOSURES
 1

	)

124 
	#FFI_TYPE_SMALL_STRUCT_1B
 (
FFI_TYPE_LAST
 + 1)

	)

125 
	#FFI_TYPE_SMALL_STRUCT_2B
 (
FFI_TYPE_LAST
 + 2)

	)

126 
	#FFI_TYPE_SMALL_STRUCT_4B
 (
FFI_TYPE_LAST
 + 3)

	)

127 
	#FFI_TYPE_MS_STRUCT
 (
FFI_TYPE_LAST
 + 4)

	)

129 #i‡
deföed
 (
X86_64
Ë|| (deföed (
__x86_64__
Ë&& deföed (
X86_DARWIN
))

130 
	#FFI_TRAMPOLINE_SIZE
 24

	)

131 
	#FFI_NATIVE_RAW_API
 0

	)

133 #ifde‡
X86_WIN32


134 
	#FFI_TRAMPOLINE_SIZE
 52

	)

136 #ifde‡
X86_WIN64


137 
	#FFI_TRAMPOLINE_SIZE
 29

	)

138 
	#FFI_NATIVE_RAW_API
 0

	)

139 
	#FFI_NO_RAW_API
 1

	)

141 
	#FFI_TRAMPOLINE_SIZE
 10

	)

144 #i‚de‡
X86_WIN64


145 
	#FFI_NATIVE_RAW_API
 1

	)

	@/home/zilong/WorkSpace/ffi/libffi-test/test.c

1 
	~<°dio.h
>

2 
	~<dlf˙.h
>

3 
	~<ffi.h
>

5 
	$maö
() {

6 
ffi_cif
 
cif
;

7 *
lib_h™dÀ
 = 
	`dl›í
("./ã°_ªtu∫.so", 
RTLD_NOW
|
RTLD_GLOBAL
);

8 * 
íåy_poöt
 = 
	`dlsym
(
lib_h™dÀ
, "test_return_sshort");

9 
ffi_°©us
 
°©us
 = 
	`ffi_¥ï_cif
(&
cif
, 
FFI_DEFAULT_ABI
, 0, &
ffi_ty≥_ssh‹t
, 
NULL
);

11 sig√d 
ªt
;

12 
	`ffi_ˇŒ
(&
cif
, 
íåy_poöt
, &
ªt
, 
NULL
);

13 
	`Ârötf
(
°dîr
, "%d\n", (sig√d )
ªt
);

16 
	}
}

	@/home/zilong/WorkSpace/ffi/libffi-test/test_return.c

1 sig√d 
	$ã°_ªtu∫_ssh‹t
() {

3 
	}
}

	@/usr/include/malloc.h

19 #i‚de‡
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<°ddef.h
>

24 
	~<°dio.h
>

26 #ifde‡
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vﬁ©ûe

	)

31 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

35 
__BEGIN_DECLS


38 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

41 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

42 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

49 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

53 
	$‰ì
 (*
__±r
Ë
__THROW
;

56 
	$c‰ì
 (*
__±r
Ë
__THROW
;

59 *
	$memÆign
 (
size_t
 
__Æignmít
, size_à
__size
)

60 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

63 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

67 *
	$pvÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

71 *(*
__m‹ec‹e
Ë(
±rdiff_t
 
__size
);

74 *
	$__deÁu…_m‹ec‹e
 (
±rdiff_t
 
__size
)

75 
__THROW
 
__©åibuã_mÆloc__
;

79 
	smÆlöfo


81 
¨ía
;

82 
‹dblks
;

83 
smblks
;

84 
hblks
;

85 
hblkhd
;

86 
usmblks
;

87 
fsmblks
;

88 
u‹dblks
;

89 
f‹dblks
;

90 
kìpco°
;

94 
mÆlöfo
 
	$mÆlöfo
 (Ë
__THROW
;

97 #i‚de‡
M_MXFAST


98 
	#M_MXFAST
 1

	)

100 #i‚de‡
M_NLBLKS


101 
	#M_NLBLKS
 2

	)

103 #i‚de‡
M_GRAIN


104 
	#M_GRAIN
 3

	)

106 #i‚de‡
M_KEEP


107 
	#M_KEEP
 4

	)

111 
	#M_TRIM_THRESHOLD
 -1

	)

112 
	#M_TOP_PAD
 -2

	)

113 
	#M_MMAP_THRESHOLD
 -3

	)

114 
	#M_MMAP_MAX
 -4

	)

115 
	#M_CHECK_ACTION
 -5

	)

116 
	#M_PERTURB
 -6

	)

117 
	#M_ARENA_TEST
 -7

	)

118 
	#M_ARENA_MAX
 -8

	)

121 
	$mÆl›t
 (
__∑øm
, 
__vÆ
Ë
__THROW
;

125 
	$mÆloc_åim
 (
size_t
 
__∑d
Ë
__THROW
;

129 
size_t
 
	$mÆloc_ußbÀ_size
 (*
__±r
Ë
__THROW
;

132 
	$mÆloc_°©s
 (Ë
__THROW
;

135 
	$mÆloc_öfo
 (
__›ti⁄s
, 
FILE
 *
__Â
Ë
__THROW
;

138 *
	$mÆloc_gë_°©e
 (Ë
__THROW
;

142 
	$mÆloc_£t_°©e
 (*
__±r
Ë
__THROW
;

147 (*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_öôülize_hook
) ()

148 
__MALLOC_DEPRECATED
;

150 (*
__MALLOC_HOOK_VOLATILE
 
__‰ì_hook
Ë(*
__±r
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_hook
)(
size_t
 
__size
,

155 
__MALLOC_DEPRECATED
;

156 *(*
__MALLOC_HOOK_VOLATILE
 
__ªÆloc_hook
)(*
__±r
,

157 
size_t
 
__size
,

159 
__MALLOC_DEPRECATED
;

160 *(*
__MALLOC_HOOK_VOLATILE
 
__memÆign_hook
)(
size_t
 
__Æignmít
,

161 
size_t
 
__size
,

163 
__MALLOC_DEPRECATED
;

164 (*
__MALLOC_HOOK_VOLATILE
 
__a·î_m‹ec‹e_hook
) ();

167 
	$__mÆloc_check_öô
 (Ë
__THROW
 
__MALLOC_DEPRECATED
;

170 
__END_DECLS


	@
1
.
0
259
20602
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/include/ffi_common.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/aarch64/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/aarch64/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/aarch64/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/alpha/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/alpha/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/alpha/osf.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arc/arcompact.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arc/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arc/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arm/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arm/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arm/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/arm/trampoline.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/avr32/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/avr32/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/avr32/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/bfin/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/bfin/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/bfin/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/closures.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/cris/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/cris/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/cris/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/debug.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/dlmalloc.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/frv/eabi.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/frv/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/frv/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/ia64/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/ia64/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/ia64/ia64_flags.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/ia64/unix.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/java_raw_api.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m32r/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m32r/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m32r/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m68k/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m68k/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m68k/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m88k/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m88k/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/m88k/obsd.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/metag/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/metag/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/metag/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/microblaze/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/microblaze/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/microblaze/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/mips/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/mips/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/mips/n32.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/mips/o32.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/moxie/eabi.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/moxie/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/moxie/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/nios2/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/nios2/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/nios2/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/or1k/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/or1k/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/or1k/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/pa/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/pa/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/pa/hpux32.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/pa/linux.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/aix.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/aix_closure.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/asm.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/darwin.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/darwin_closure.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi_darwin.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi_linux64.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi_powerpc.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffi_sysv.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/linux64.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/linux64_closure.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/ppc_closure.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/powerpc/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/prep_cif.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/raw_api.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/s390/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/s390/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/s390/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh64/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh64/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sh64/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sparc/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sparc/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sparc/v8.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/sparc/v9.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/tile/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/tile/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/tile/tile.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/types.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/vax/elfbsd.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/vax/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/vax/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/darwin.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/darwin64.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/ffi64.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/freebsd.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/unix64.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/win32.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/x86/win64.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/xtensa/ffi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/xtensa/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/src/xtensa/sysv.S
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn0.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn3.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn4.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn5.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_fn6.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_loc_fn0.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/closure_simple.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_12byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_16byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_18byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_19byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_1_1byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_20byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_20byte1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_24byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_2byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_3_1byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_3byte1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_3byte2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_4_1byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_4byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_5_1_byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_5byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_64byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_6_1_byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_6byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_7_1_byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_7byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_8byte.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_9byte1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_9byte2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_double.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_float.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_longdouble.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_longdouble_split.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_longdouble_split2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_pointer.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_sint16.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_sint32.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_sint64.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_uint16.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_uint32.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_align_uint64.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_dbls_struct.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_double.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_double_va.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_float.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_longdouble.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_longdouble_va.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_schar.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_sshort.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_sshortchar.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_uchar.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_ushort.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_multi_ushortchar.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_pointer.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_pointer_stack.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_schar.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_sint.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_sshort.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_struct_va1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_uchar.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_uchar_va.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_uint.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_uint_va.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_ulong_va.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_ulonglong.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_ushort.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/cls_ushort_va.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/err_bad_abi.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/err_bad_typedef.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/ffitest.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float3.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float4.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/float_va.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/huge_struct.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/many.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/many2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/negint.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct10.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct11.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct3.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct4.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct5.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct6.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct7.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct8.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/nested_struct9.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/problem1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/promotion.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/pyobjc-tc.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_dbl.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_dbl1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_dbl2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_fl.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_fl1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_fl2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_fl3.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_ldl.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_ll.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_ll1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_sc.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_sl.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_uc.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/return_ul.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/stret_large.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/stret_large2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/stret_medium.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/stret_medium2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/strlen.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/strlen2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/strlen3.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/strlen4.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct3.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct4.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct5.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct6.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct7.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct8.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/struct9.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/testclosure.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/uninitialized.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/va_1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/va_struct1.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/va_struct2.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/testsuite/libffi.call/va_struct3.c
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/x86_64-unknown-linux-gnu/fficonfig.h
/home/zilong/WorkSpace/ffi/libffi-test/libffi-3.2.1/x86_64-unknown-linux-gnu/include/ffi.h
/home/zilong/WorkSpace/ffi/libffi-test/libs/lib/libffi-3.2.1/include/ffi.h
/home/zilong/WorkSpace/ffi/libffi-test/libs/lib/libffi-3.2.1/include/ffitarget.h
/home/zilong/WorkSpace/ffi/libffi-test/test.c
/home/zilong/WorkSpace/ffi/libffi-test/test_return.c
/usr/include/malloc.h
